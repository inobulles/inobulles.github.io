<!DOCTYPE html>
<html><head><meta charset=utf-8><title>bsdinstall(8)</title><keywords content=man,bsdinstall></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>bsdinstall(8)</h1><table class=head><tr><td class=head-ltitle>BSDINSTALL(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>BSDINSTALL(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>bsdinstall</code> — <div class=Nd>system installer</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>bsdinstall</code></td><td>[<var class=Ar>options</var>] [<var class=Ar>target</var>] [<var class=Ar>...</var>]</td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2><code class=Nm>bsdinstall</code> is used for installation of new systems, both for system setup from installation media, e.g., CD-ROMs, and for use on live systems to prepare VM images and jails. <p class=Pp>Much like <a class=Xr href=make.1.html>make(1)</a>, <code class=Nm>bsdinstall</code> takes a target and possible parameters of the target as arguments. If invoked with no arguments, it will invoke the <code class=Cm>auto</code> target, which provides a standard interactive installation, invoking the others in sequence. To perform a scripted installation, these subtargets can be invoked separately by an installation script.</p></section><section class=Sh><h2 class=Sh id=OPTIONS><a class=permalink href=#OPTIONS>OPTIONS</a></h2><code class=Nm>bsdinstall</code> supports the following options, global to all targets: <dl class=Bl-tag><dt><a class=permalink href=#D><code class=Fl id=D>-D</code></a><var class=Ar>file</var></dt><dd>Provide a path for the installation log file (overrides <code class=Ev>BSDINSTALL_LOG</code>). See <a class=Sx href=#ENVIRONMENT_VARIABLES>ENVIRONMENT VARIABLES</a> for more information on <code class=Ev>BSDINSTALL_LOG</code>.</dd></dl></section><section class=Sh><h2 class=Sh id=TARGETS><a class=permalink href=#TARGETS>TARGETS</a></h2> Most of the following targets are only useful for scripting the installer. For interactive use, most users will be interested only in the <code class=Cm>auto</code>, <code class=Cm>jail</code>, and <code class=Cm>script</code> targets. <dl class=Bl-tag><dt><a class=permalink href=#auto><code class=Cm id=auto>auto</code></a></dt><dd>Run the standard interactive installation, including disk partitioning.</dd><dt><a class=permalink href=#jail><code class=Cm id=jail>jail</code></a><var class=Ar>destination</var></dt><dd>Sets up a new chroot system at <span class=Pa>destination</span>, suitable for use with <a class=Xr href=jail.8.html>jail(8)</a>. Behavior is generally similar to <code class=Cm>auto</code>, except that disk partitioning and network setup are skipped and a kernel is not installed into the new system.</dd><dt><a class=permalink href=#script><code class=Cm id=script>script</code></a><var class=Ar>script</var></dt><dd>Runs the installation script at <span class=Pa>script</span>. See <a class=Sx href=#SCRIPTING>SCRIPTING</a> for more information on this target.</dd><dt><a class=permalink href=#keymap><code class=Cm id=keymap>keymap</code></a></dt><dd>If the current controlling TTY is a <a class=Xr href=syscons.4.html>syscons(4)</a> or <a class=Xr href=vt.4.html>vt(4)</a> console, asks the user to set the current keymap, and saves the result to the new system's <span class=Pa>rc.conf</span>.</dd><dt><a class=permalink href=#hostname><code class=Cm id=hostname>hostname</code></a></dt><dd>Prompts the user for a host name for the new system and saves the result to the new system's <span class=Pa>rc.conf</span>. If <code class=Ev>BSDINSTALL_CONFIGCURRENT</code> is set, also sets the host name of the current system.</dd><dt><a class=permalink href=#netconfig><code class=Cm id=netconfig>netconfig</code></a></dt><dd>Interactively configures network interfaces (first invoking <code class=Cm>wlanconfig</code> on wireless interfaces), saving the result to the new system's <span class=Pa>rc.conf</span> and <span class=Pa>resolv.conf</span>. If <code class=Ev>BSDINSTALL_CONFIGCURRENT</code> is set, also configures the network interfaces of the current system to match.</dd><dt><a class=permalink href=#autopart><code class=Cm id=autopart>autopart</code></a></dt><dd>Provides the installer's interactive guided disk partitioner for single-disk installations. Defaults to UFS.</dd><dt><a class=permalink href=#bootconfig><code class=Cm id=bootconfig>bootconfig</code></a></dt><dd>Detects an appropriate partition and installs UEFI boot loader files.</dd><dt><a class=permalink href=#zfsboot><code class=Cm id=zfsboot>zfsboot</code></a></dt><dd>Provides a ZFS-only automatic interactive disk partitioner. Creates a single <code class=Ic>zpool</code> with separate datasets for <span class=Pa>/tmp</span>, <span class=Pa>/usr</span>, <span class=Pa>/usr/home</span>, <span class=Pa>/usr/ports</span>, <span class=Pa>/usr/src</span>, and <span class=Pa>/var</span>. Optionally can set up <a class=Xr href=geli.8.html>geli(8)</a> to encrypt the disk.</dd><dt><a class=permalink href=#partedit><code class=Cm id=partedit>partedit</code></a></dt><dd>Provides the installer's interactive manual disk partitioner with an interface identical to <a class=Xr href=sade.8.html>sade(8)</a>. Supports multiple disks as well as UFS, ZFS, and FAT file systems. ZFS is set up with one pool and dataset per partition.</dd><dt><a class=permalink href=#scriptedpart><code class=Cm id=scriptedpart>scriptedpart</code></a><var class=Ar>parameters</var></dt><dd>Sets up disks like <code class=Cm>autopart</code> and <code class=Cm>partedit</code>, but non-interactively according to the disk setup specified in <var class=Ar>parameters</var>. Each disk setup is specified by a three-part argument: <p class=Pp><var class=Ar>disk</var> [<var class=Ar>scheme</var>] [<var class=Ar>{partitions}</var>]</p><p class=Pp>Multiple disk setups are separated by semicolons. The <var class=Ar>disk</var> argument specifies the disk on which to operate (which will be erased), or the special value <i class=Em>DEFAULT</i>, which will result in either a selection window (as in <code class=Cm>autopart</code>) for the destination disk or, if there is only one possible disk, will automatically select it. The <var class=Ar>scheme</var> argument specifies the <a class=Xr href=gpart.8.html>gpart(8)</a> partition scheme to apply to the disk. If <var class=Ar>scheme</var> is unspecified, <code class=Cm>scriptedpart</code> will apply the default bootable scheme on your platform. The <var class=Ar>partitions</var> argument is also optional and specifies how to partition <var class=Ar>disk</var>. It consists of a comma-separated list of partitions to create enclosed in curly braces. Each partition declaration takes the form</p><p class=Pp><var class=Ar>size</var><var class=Ar>type</var> [<var class=Ar>mount point</var>]</p><p class=Pp><var class=Ar>size</var> specifies the partition size to create in bytes (K, M, and G suffixes can be appended to specify kilobytes, megabytes, and gigabytes respectively), while the <i class=Em>auto</i> keyword causes the partition to take all the remaining space on the disk. The <var class=Ar>type</var> option chooses the <a class=Xr href=gpart.8.html>gpart(8)</a> filesystem type, e.g., freebsd-ufs, freebsd-zfs, or freebsd-swap. The optional <var class=Ar>mount point</var> argument sets where the created partition is to be mounted in the installed system. As an example, a typical invocation looks like:</p><p class=Pp>bsdinstall scriptedpart ada0 { 20G freebsd-ufs /, 4G freebsd-swap, 20G freebsd-ufs /var, auto freebsd-ufs /usr }</p><p class=Pp>Note that the list of partitions should <i class=Em>not</i> include boot partitions (e.g. EFI system partitions), which will be created automatically on whatever disk includes /.</p><p class=Pp>A shorter invocation to use the default partitioning (as <code class=Cm>autopart</code> would have used) on the same disk:</p><p class=Pp>bsdinstall scriptedpart ada0</p><p class=Pp>or, even shorter:</p><p class=Pp>bsdinstall scriptedpart DEFAULT</p></dd><dt><a class=permalink href=#mount><code class=Cm id=mount>mount</code></a></dt><dd>Mounts the file systems previously configured by <code class=Cm>autopart</code>, <code class=Cm>partedit</code>, or <code class=Cm>scriptedpart</code> under <code class=Ev>BSDINSTALL_CHROOT</code>.</dd><dt><a class=permalink href=#distfetch><code class=Cm id=distfetch>distfetch</code></a></dt><dd>Fetches the distributions in <code class=Ev>DISTRIBUTIONS</code> to <code class=Ev>BSDINSTALL_DISTDIR</code> from <code class=Ev>BSDINSTALL_DISTSITE</code>.</dd><dt><a class=permalink href=#checksum><code class=Cm id=checksum>checksum</code></a></dt><dd>Verifies the checksums of the distributions listed in <code class=Ev>DISTRIBUTIONS</code> against the distribution manifest.</dd><dt><a class=permalink href=#distextract><code class=Cm id=distextract>distextract</code></a></dt><dd>Extracts the distributions listed in <code class=Ev>DISTRIBUTIONS</code> into <code class=Ev>BSDINSTALL_CHROOT</code>.</dd><dt><a class=permalink href=#rootpass><code class=Cm id=rootpass>rootpass</code></a></dt><dd>Interactively invokes <a class=Xr href=passwd.1.html>passwd(1)</a> in the new system to set the root user's password.</dd><dt><a class=permalink href=#adduser><code class=Cm id=adduser>adduser</code></a></dt><dd>Interactively invokes <a class=Xr href=adduser.8.html>adduser(8)</a> in the new system.</dd><dt><a class=permalink href=#time><code class=Cm id=time>time</code></a></dt><dd>Interactively sets the time, date, and time zone of the new system.</dd><dt><a class=permalink href=#services><code class=Cm id=services>services</code></a></dt><dd>Queries the user for the system daemons to begin at system startup, writing the result into the new system's <span class=Pa>rc.conf</span>.</dd><dt><a class=permalink href=#entropy><code class=Cm id=entropy>entropy</code></a></dt><dd>Reads a small amount of data from <span class=Pa>/dev/random</span> and stores it in a file in the new system's root directory.</dd><dt><a class=permalink href=#config><code class=Cm id=config>config</code></a></dt><dd>Installs the configuration files destined for the new system, e.g., <a class=Xr href=rc.conf.5.html>rc.conf(5)</a> fragments generated by <code class=Cm>netconfig</code>, etc.) onto the new system.</dd></dl></section><section class=Sh><h2 class=Sh id=ENVIRONMENT_VARIABLES><a class=permalink href=#ENVIRONMENT_VARIABLES>ENVIRONMENT VARIABLES</a></h2> The following environment variables control various aspects of the installation process. Many are used internally during installation and have reasonable default values for most installation scenarios. Others are set by various interactive user prompts, and can be usefully overridden when making scripted or customized installers. <dl class=Bl-tag><dt><a class=permalink href=#TMPDIR><code class=Ev id=TMPDIR>TMPDIR</code></a></dt><dd>The directory to use for temporary files. Default: “<span class=Pa>/tmp</span>”</dd><dt><a class=permalink href=#DISTRIBUTIONS><code class=Ev id=DISTRIBUTIONS>DISTRIBUTIONS</code></a></dt><dd>The set of distributions to install, e.g., "base.txz kernel.txz ports.txz". Default: unset</dd><dt><a class=permalink href=#PARTITIONS><code class=Ev id=PARTITIONS>PARTITIONS</code></a></dt><dd>The partitioning of the disk onto which the system is being installed. See <code class=Cm>scriptedpart</code> of the <a class=Sx href=#TARGETS>TARGETS</a> section for format details. If this variable is unset, the installer will use the default partitioning as in <code class=Cm>autopart</code>. Default: unset</dd><dt><a class=permalink href=#BSDINSTALL_DISTDIR><code class=Ev id=BSDINSTALL_DISTDIR>BSDINSTALL_DISTDIR</code></a></dt><dd>The directory in which the distribution files can be found (or to which they should be downloaded). Default: “<span class=Pa>/usr/freebsd-dist</span>”</dd><dt><a class=permalink href=#BSDINSTALL_DISTSITE><code class=Ev id=BSDINSTALL_DISTSITE>BSDINSTALL_DISTSITE</code></a></dt><dd>URL from which the distribution files should be downloaded if they are not already present in the directory defined by <code class=Ev>BSDINSTALL_DISTDIR</code>. This should be a full path to the files, including architecture and release names. Most targets, e.g., <code class=Cm>auto</code> and <code class=Cm>jail</code>, that prompt for a <span class=Ux>FreeBSD</span> mirror will skip that step if this variable is already defined in the environment. Example: <span class=Pa>https://download.freebsd.org/ftp/releases/powerpc/powerpc64/13.1-RELEASE/</span> or <span class=Pa>http://ftp-archive.freebsd.org/pub/FreeBSD-Archive/old-releases/amd64/12.2-RELEASE/</span>.</dd><dt><a class=permalink href=#BSDINSTALL_CHROOT><code class=Ev id=BSDINSTALL_CHROOT>BSDINSTALL_CHROOT</code></a></dt><dd>The directory into which the distribution files should be unpacked and the directory at which the root file system of the new system should be mounted. Default: “<span class=Pa>/mnt</span>”</dd><dt><a class=permalink href=#BSDINSTALL_LOG><code class=Ev id=BSDINSTALL_LOG>BSDINSTALL_LOG</code></a></dt><dd>Path to a log file for the installation. Default: “<span class=Pa>$TMPDIR/bsdinstall_log</span>”</dd><dt><a class=permalink href=#BSDINSTALL_TMPETC><code class=Ev id=BSDINSTALL_TMPETC>BSDINSTALL_TMPETC</code></a></dt><dd>Directory where files destined for the new system's <span class=Pa>/etc</span> will be stored until the <code class=Cm>config</code> target is executed. If this directory does not already exist, it will be created. Default: “<span class=Pa>$TMPDIR/bsdinstall_etc</span>”</dd><dt><a class=permalink href=#BSDINSTALL_TMPBOOT><code class=Ev id=BSDINSTALL_TMPBOOT>BSDINSTALL_TMPBOOT</code></a></dt><dd>Directory where files destined for the new system's <span class=Pa>/boot</span> will be stored until the <code class=Cm>config</code> target is executed. If this directory does not already exist, it will be created. Default: “<span class=Pa>$TMPDIR/bsdinstall_boot</span>”</dd><dt><a class=permalink href=#ROOTPASS_ENC><code class=Ev id=ROOTPASS_ENC>ROOTPASS_ENC</code></a></dt><dd>Encrypted string to set the root password to in the format expected by <a class=Xr href=pw.8.html>pw(8)</a><code class=Fl>-H</code><var class=Ar>0</var>. This option is used if both it and <code class=Ev>ROOTPASS_PLAIN</code> are set.</dd><dt><a class=permalink href=#ROOTPASS_PLAIN><code class=Ev id=ROOTPASS_PLAIN>ROOTPASS_PLAIN</code></a></dt><dd>Plain text string to set the root password to.</dd><dt><a class=permalink href=#ZFSBOOT_POOL_NAME><code class=Ev id=ZFSBOOT_POOL_NAME>ZFSBOOT_POOL_NAME</code></a></dt><dd>Name for the pool containing the base system. Default: “zroot”</dd><dt><a class=permalink href=#ZFSBOOT_POOL_CREATE_OPTIONS><code class=Ev id=ZFSBOOT_POOL_CREATE_OPTIONS>ZFSBOOT_POOL_CREATE_OPTIONS</code></a></dt><dd>Options to be used when creating the base system's pool. Each option must be preceded by the -O flag to be taken into consideration or the pool will not be created due to errors using the command <code class=Cm>zpool</code>. Default: “<code class=Li>-O compress=lz4 -O atime=off</code>”</dd><dt><a class=permalink href=#ZFSBOOT_BEROOT_NAME><code class=Ev id=ZFSBOOT_BEROOT_NAME>ZFSBOOT_BEROOT_NAME</code></a></dt><dd>Name for the boot environment parent dataset. This is a non-mountable dataset meant to be a parent dataset where different boot environment are going to be created. Default: “ROOT”</dd><dt><a class=permalink href=#ZFSBOOT_BOOTFS_NAME><code class=Ev id=ZFSBOOT_BOOTFS_NAME>ZFSBOOT_BOOTFS_NAME</code></a></dt><dd>Name for the primary boot environment, which will be the default boot environment for the system. Default: “default”</dd><dt><a class=permalink href=#ZFSBOOT_VDEV_TYPE><code class=Ev id=ZFSBOOT_VDEV_TYPE>ZFSBOOT_VDEV_TYPE</code></a></dt><dd>The type of pool to be created for the base system. This variable can take one of this values: stripe (No redundancy), mirror (n-Way mirroring), raid10 (RAID 1+0 - n x 2-Way Mirrors), raidz1 (RAID-Z1 - Single Redundancy RAID), raidz2 (RAID-Z2 - Double Redundancy RAID) or raidz3 (RAID-Z3 Triple Redundancy RAID). Default: “stripe”</dd><dt><a class=permalink href=#ZFSBOOT_FORCE_4K_SECTORS><code class=Ev id=ZFSBOOT_FORCE_4K_SECTORS>ZFSBOOT_FORCE_4K_SECTORS</code></a></dt><dd>Indicates either the pool will use 4K or 512 sectors. If this variable is not empty, 4K sectors will be used. Default: “1”</dd><dt><a class=permalink href=#ZFSBOOT_GELI_ENCRYPTION><code class=Ev id=ZFSBOOT_GELI_ENCRYPTION>ZFSBOOT_GELI_ENCRYPTION</code></a></dt><dd>If this variable is not empty, it will use <a class=Xr href=geli.8.html>geli(8)</a> to encrypt the root pool, enabling automatically the <code class=Ev>ZFSBOOT_BOOT_POOL</code> variable. Default: “”</dd><dt><a class=permalink href=#ZFSBOOT_GELI_KEY_FILE><code class=Ev id=ZFSBOOT_GELI_KEY_FILE>ZFSBOOT_GELI_KEY_FILE</code></a></dt><dd>Path to the <a class=Xr href=geli.8.html>geli(8)</a> keyfile used to encrypt the pool where the base system is stored. Default: “<span class=Pa>/boot/encryption.key</span>”</dd><dt><a class=permalink href=#ZFSBOOT_BOOT_POOL><code class=Ev id=ZFSBOOT_BOOT_POOL>ZFSBOOT_BOOT_POOL</code></a></dt><dd>If set, a separated boot pool will be created for the kernel of the system and <a class=Xr href=loader.8.html>loader(8)</a>. Default: unset</dd><dt><a class=permalink href=#ZFSBOOT_BOOT_POOL_CREATE_OPTIONS><code class=Ev id=ZFSBOOT_BOOT_POOL_CREATE_OPTIONS>ZFSBOOT_BOOT_POOL_CREATE_OPTIONS</code></a></dt><dd>Options to use when creating the boot pool, when enabled (See <code class=Ev>ZFSBOOT_BOOT_POOL ).</code> Default: unset</dd><dt><a class=permalink href=#ZFSBOOT_BOOT_POOL_NAME><code class=Ev id=ZFSBOOT_BOOT_POOL_NAME>ZFSBOOT_BOOT_POOL_NAME</code></a></dt><dd>Name for the optional boot pool when it is enabled, (See <code class=Ev>ZFSBOOT_BOOT_POOL ).</code> Default: “bootpool”</dd><dt><a class=permalink href=#ZFSBOOT_BOOT_POOL_SIZE><code class=Ev id=ZFSBOOT_BOOT_POOL_SIZE>ZFSBOOT_BOOT_POOL_SIZE</code></a></dt><dd>Size of the boot pool when it is enabled (See <code class=Ev>ZFSBOOT_BOOT_POOL ).</code> Default: “2g”</dd><dt><a class=permalink href=#ZFSBOOT_DISKS><code class=Ev id=ZFSBOOT_DISKS>ZFSBOOT_DISKS</code></a></dt><dd>Disks to be used for the base system, including the boot pool. This variable must only be used on a scripted installation. See <a class=Sx href=#SCRIPTING>SCRIPTING</a> for more information. Default: unset</dd><dt><a class=permalink href=#ZFSBOOT_SWAP_SIZE><code class=Ev id=ZFSBOOT_SWAP_SIZE>ZFSBOOT_SWAP_SIZE</code></a></dt><dd>Size of the swap partition on each block device. This variable will be passed to <a class=Xr href=gpart.8.html>gpart(8)</a>; which supports SI unit suffixes. Default: “2g”</dd><dt><a class=permalink href=#ZFSBOOT_SWAP_ENCRYPTION><code class=Ev id=ZFSBOOT_SWAP_ENCRYPTION>ZFSBOOT_SWAP_ENCRYPTION</code></a></dt><dd>If set, enables the encryption of the swap partition using <a class=Xr href=geli.8.html>geli(8)</a>. Default: ""</dd><dt><a class=permalink href=#ZFSBOOT_SWAP_MIRROR><code class=Ev id=ZFSBOOT_SWAP_MIRROR>ZFSBOOT_SWAP_MIRROR</code></a></dt><dd>If set, enables a swap mirroring using <a class=Xr href=gmirror.8.html>gmirror(8)</a>. Default: unset</dd><dt><a class=permalink href=#ZFSBOOT_DATASETS><code class=Ev id=ZFSBOOT_DATASETS>ZFSBOOT_DATASETS</code></a></dt><dd>ZFS datasets to be created on the root zpool, it requires the following datasets: <span class=Pa>/tmp</span>, <span class=Pa>/var/tmp</span>, <span class=Pa>/$ZFSBOOT_BEROOT_NAME/$ZFSBOOT_BOOTFS_NAME</span>. See <a class=Sx href=#ZFS_DATASETS>ZFS DATASETS</a> for more information about how to populate this variable and its default value.</dd><dt><a class=permalink href=#ZFSBOOT_CONFIRM_LAYOUT><code class=Ev id=ZFSBOOT_CONFIRM_LAYOUT>ZFSBOOT_CONFIRM_LAYOUT</code></a></dt><dd>If set and the installation is interactive, allow the user to confirm the layout before continuing with the installation. Default: “1”</dd></dl></section><section class=Sh><h2 class=Sh id=SCRIPTING><a class=permalink href=#SCRIPTING>SCRIPTING</a></h2><code class=Nm>bsdinstall</code> supports unattended, or minimally-attended, installations using scripting. This can be used with either modified physical installation media or with <a class=Xr href=diskless.8.html>diskless(8)</a> installations over the network; information on preparing such media can be found in <a class=Sx href=#BUILDING_AUTOMATIC_INSTALL_MEDIA>BUILDING AUTOMATIC INSTALL MEDIA</a><p class=Pp>Scripted installations follow an essentially identical path to interactive installations, though with some minor feature differences (for example, scripted installations do not support fetching of remote distribution files since scripted installations normally install the same files and the distributions can be added directly to the installation media). <code class=Nm>bsdinstall</code> scripts consist of two parts: a <i class=Em>preamble</i> and a <i class=Em>setup script</i>. The preamble sets up the options for the installation (how to partition the disk[s], which distributions to install, etc.) and the optional second part is a shell script run under <a class=Xr href=chroot.8.html>chroot(8)</a> in the newly installed system before <code class=Nm>bsdinstall</code> exits. The two parts are separated by the usual script header (#!), which also sets the interpreter for the setup script.</p><p class=Pp>A typical bsdinstall script, using the default filesystem layout and the UFS filesystem, looks like this:</p><div class="Bd Pp Bd-indent"><pre>
PARTITIONS=DEFAULT
DISTRIBUTIONS="kernel.txz base.txz"

#!/bin/sh
sysrc ifconfig_DEFAULT=DHCP
sysrc sshd_enable=YES
pkg install puppet
</pre></div><p class=Pp>For a scripted installation involving a ZFS pool spanning multiple disks, the script instead looks like this:</p><div class="Bd Pp Bd-indent"><pre>
DISTRIBUTIONS="kernel.txz base.txz"
export ZFSBOOT_VDEV_TYPE=stripe
export ZFSBOOT_DISKS="ada0 ada1"
export nonInteractive="YES"

#!/bin/sh
echo "ifconfig_DEFAULT=DHCP" &gt;&gt; /etc/rc.conf
echo "sshd_enable=YES" &gt;&gt; /etc/rc.conf
pkg install puppet
</pre></div><p class=Pp>On <span class=Ux>FreeBSD</span> release media, such a script placed at <span class=Pa>/etc/installerconfig</span> will be run at boot time and the system will be rebooted automatically after the installation has completed. This can be used for unattended network installation of new systems; see <a class=Xr href=diskless.8.html>diskless(8)</a> for details.</p><section class=Ss><h2 class=Ss id=PREAMBLE><a class=permalink href=#PREAMBLE>PREAMBLE</a></h2> The preamble consists of installer settings. These control global installation parameters (see <a class=Sx href=#ENVIRONMENT_VARIABLES>ENVIRONMENT VARIABLES</a>) as well as disk partitioning. The preamble is interpreted as a <a class=Xr href=sh.1.html>sh(1)</a> script run at the very beginning of the install. If more complicated behavior than setting these variables is desired, arbitrary commands can be run here to extend the installer. In addition to the variables in <a class=Sx href=#ENVIRONMENT_VARIABLES>ENVIRONMENT VARIABLES</a>, in particular <code class=Ev>DISTRIBUTIONS</code>, the preamble can contain a variable <code class=Ev>PARTITIONS</code> which is passed to the <code class=Cm>scriptedpart</code> target to control disk setup. <p class=Pp>Alternatively, to use <code class=Cm>zfsboot</code> instead of <code class=Cm>partedit</code>, the preamble can contain the variable <code class=Ev>ZFSBOOT_DATASETS</code> instead of <code class=Ev>PARTITIONS</code> (see below). If using <code class=Cm>zfsboot</code>, the variables <code class=Ev>ZFSBOOT_DISKS</code> and <code class=Ev>ZFSBOOT_VDEV_TYPE</code> must be set to create the pool of disks for the base system. Usually, for a mirrored booting disk, these two variables look like this:</p><div class="Bd Pp Bd-indent"><pre>
ZFSBOOT_DISKS="ada0 ada1"
ZFSBOOT_VDEV_TYPE=mirror
</pre></div><p class=Pp>Remember to export all the variables for the <code class=Cm>zfsboot</code> command, otherwise installation will fail.</p></section><section class=Ss><h2 class=Ss id=SETUP_SCRIPT><a class=permalink href=#SETUP_SCRIPT>SETUP SCRIPT</a></h2> Following the preamble is an optional shell script, beginning with a #! declaration. This script will be run at the end of the installation process inside a <a class=Xr href=chroot.8.html>chroot(8)</a> environment in the newly installed system and can be used to set up configuration files, install packages, etc. Note that newly configured system services, e.g., networking have not been started in the installed system at this time and only installation host services are available. </section><section class=Ss><h2 class=Ss id=ZFS_DATASETS><a class=permalink href=#ZFS_DATASETS>ZFS DATASETS</a></h2> If using <code class=Cm>zfsboot</code> in an installation script, the <code class=Cm>zfsboot</code> partitioning tool takes the <code class=Ev>ZFSBOOT_DATASETS</code> variable to create the ZFS datasets on the base system. This variable definition can become large if the pool contains many datasets. The default value of <code class=Ev>ZFSBOOT_DATASETS</code> is: <div class="Bd Pp Bd-indent"><pre>
# DATASET	OPTIONS (comma or space separated; or both)

# Boot Environment [BE] root and default boot dataset
/$ZFSBOOT_BEROOT_NAME				mountpoint=none
/$ZFSBOOT_BEROOT_NAME/$ZFSBOOT_BOOTFS_NAME	mountpoint=/

# Compress /tmp, allow exec but not setuid
/tmp		mountpoint=/tmp,exec=on,setuid=off

# Do not mount /usr so that 'base' files go to the BEROOT
/usr		mountpoint=/usr,canmount=off

# Home directories separated so they are common to all BEs
/usr/home	# NB: /home is a symlink to /usr/home

# Ports tree
/usr/ports	setuid=off

# Source tree (compressed)
/usr/src

# Create /var and friends
/var		mountpoint=/var,canmount=off
/var/audit	exec=off,setuid=off
/var/crash	exec=off,setuid=off
/var/log	exec=off,setuid=off
/var/mail	atime=on
/var/tmp	setuid=off
</pre></div><p class=Pp>The first column is the name of the dataset to be created as part of the <code class=Ev>ZFSBOOT_POOL_NAME</code> pool and the remainder of each line contains the options to be set on each dataset. If multiple options are given, they can be separated by either commas or whitespace; everything following a pound/hash character is ignored as a comment.</p></section><section class=Ss><h2 class=Ss id=BUILDING_AUTOMATIC_INSTALL_MEDIA><a class=permalink href=#BUILDING_AUTOMATIC_INSTALL_MEDIA>BUILDING AUTOMATIC INSTALL MEDIA</a></h2> If building automatic install media, use tar to extract a release ISO: <div class="Bd Bd-indent"><code class=Li>mkdir release-media</code></div><div class="Bd Bd-indent"><code class=Li>tar -C release-media -xvf FreeBSD-13.0-RELEASE-amd64-disc1.iso</code></div><p class=Pp>Then place a script as above in <span class=Pa>etc/installerconfig</span></p><p class=Pp>This directory can then be used directly as an NFS root for <a class=Xr href=diskless.8.html>diskless(8)</a> installations or it can be rebuilt into an ISO image using the release scripts in <span class=Pa>/usr/src/release</span>. For example, on amd64:</p><div class="Bd Bd-indent"><code class=Li>sh /usr/src/release/amd64/mkisoimages.sh -b '13_0_RELEASE_AMD64_CD' output.iso release-media</code></div></section></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> This version of <code class=Nm>bsdinstall</code> first appeared in <span class=Ux>FreeBSD 9.0</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Nathan Whitehorn</span> &lt;<a class=Mt href=mailto:nwhitehorn@FreeBSD.org>nwhitehorn@FreeBSD.org</a>&gt; <br><span class=An>Devin Teske</span> &lt;<a class=Mt href=mailto:dteske@FreeBSD.org>dteske@FreeBSD.org</a>&gt; <br><span class=An>Allan Jude</span> &lt;<a class=Mt href=mailto:allanjude@FreeBSD.org>allanjude@FreeBSD.org</a>&gt; </section></div><table class=foot><tr><td class=foot-date>July 18, 2022</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>