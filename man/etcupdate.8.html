<!DOCTYPE html>
<html><head><meta charset=utf-8><title>etcupdate(8)</title><keywords content=man,etcupdate></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>etcupdate(8)</h1><table class=head><tr><td class=head-ltitle>ETCUPDATE(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>ETCUPDATE(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>etcupdate</code> — <div class=Nd>manage updates to system files not updated by installworld</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>etcupdate</code></td><td>[<code class=Fl>-npBFN</code>] [<code class=Fl>-d</code><var class=Ar>workdir</var>] [<code class=Fl>-r</code> | <code class=Fl>-s</code><var class=Ar>source</var> | <code class=Fl>-t</code><var class=Ar>tarball</var>] [<code class=Fl>-A</code><var class=Ar>patterns</var>] [<code class=Fl>-D</code><var class=Ar>destdir</var>] [<code class=Fl>-I</code><var class=Ar>patterns</var>] [<code class=Fl>-L</code><var class=Ar>logfile</var>] [<code class=Fl>-M</code><var class=Ar>options</var>] [<code class=Fl>-m</code><var class=Ar>make</var>]</td></tr></table><br><table class=Nm><tr><td><code class=Nm>etcupdate</code></td><td><code class=Cm>build</code> [<code class=Fl>-BN</code>] [<code class=Fl>-d</code><var class=Ar>workdir</var>] [<code class=Fl>-s</code><var class=Ar>source</var>] [<code class=Fl>-L</code><var class=Ar>logfile</var>] [<code class=Fl>-M</code><var class=Ar>options</var>] [<code class=Fl>-m</code><var class=Ar>make</var>] <var class=Ar>tarball</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>etcupdate</code></td><td><code class=Cm>diff</code> [<code class=Fl>-d</code><var class=Ar>workdir</var>] [<code class=Fl>-D</code><var class=Ar>destdir</var>] [<code class=Fl>-I</code><var class=Ar>patterns</var>] [<code class=Fl>-L</code><var class=Ar>logfile</var>]</td></tr></table><br><table class=Nm><tr><td><code class=Nm>etcupdate</code></td><td><code class=Cm>extract</code> [<code class=Fl>-BN</code>] [<code class=Fl>-d</code><var class=Ar>workdir</var>] [<code class=Fl>-s</code><var class=Ar>source</var> | <code class=Fl>-t</code><var class=Ar>tarball</var>] [<code class=Fl>-D</code><var class=Ar>destdir</var>] [<code class=Fl>-L</code><var class=Ar>logfile</var>] [<code class=Fl>-M</code><var class=Ar>options</var>] [<code class=Fl>-m</code><var class=Ar>make</var>]</td></tr></table><br><table class=Nm><tr><td><code class=Nm>etcupdate</code></td><td><code class=Cm>resolve</code> [<code class=Fl>-p</code>] [<code class=Fl>-d</code><var class=Ar>workdir</var>] [<code class=Fl>-D</code><var class=Ar>destdir</var>] [<code class=Fl>-L</code><var class=Ar>logfile</var>]</td></tr></table><br><table class=Nm><tr><td><code class=Nm>etcupdate</code></td><td><code class=Cm>revert</code> [<code class=Fl>-d</code><var class=Ar>workdir</var>] [<code class=Fl>-D</code><var class=Ar>destdir</var>] [<code class=Fl>-L</code><var class=Ar>logfile</var>] <var class=Ar>file ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>etcupdate</code></td><td><code class=Cm>status</code> [<code class=Fl>-d</code><var class=Ar>workdir</var>] [<code class=Fl>-D</code><var class=Ar>destdir</var>]</td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>etcupdate</code> utility is a tool for managing updates to files that are not updated as part of ‘make installworld’ such as files in <span class=Pa>/etc</span>. It manages updates by doing a three-way merge of changes made to these files against the local versions. It is also designed to minimize the amount of user intervention with the goal of simplifying upgrades for clusters of machines. <p class=Pp>To perform a three-way merge, <code class=Nm>etcupdate</code> keeps copies of the current and previous versions of files that it manages. These copies are stored in two trees known as the “current” and “previous” trees. During a merge, <code class=Nm>etcupdate</code> compares the “current” and “previous” copies of each file to determine which changes need to be merged into the local version of each file. If a file can be updated without generating a conflict, <code class=Nm>etcupdate</code> will update the file automatically. If the local changes to a file conflict with the changes made to a file in the source tree, then a merge conflict is generated. The conflict must be resolved after the merge has finished. The <code class=Nm>etcupdate</code> utility will not perform a new merge until all conflicts from an earlier merge are resolved.</p></section><section class=Sh><h2 class=Sh id=MODES><a class=permalink href=#MODES>MODES</a></h2> The <code class=Nm>etcupdate</code> utility supports several modes of operation. The mode is specified via an optional command argument. If present, the command must be the first argument on the command line. If a command is not specified, the default mode is used. <section class=Ss><h2 class=Ss id=Default_Mode><a class=permalink href=#Default_Mode>Default Mode</a></h2> The default mode merges changes from the source tree to the destination directory. First, it updates the “current” and “previous” trees. Next, it compares the two trees merging changes into the destination directory. Finally, it displays warnings for any conditions it could not handle automatically. <p class=Pp>If the <code class=Fl>-r</code> option is not specified, then the first step taken is to update the “current” and “previous” trees. If a “current” tree already exists, then that tree is saved as the “previous” tree. An older “previous” tree is removed if it exists. By default the new “current” tree is built from a source tree. However, if a tarball is specified via the <code class=Fl>-t</code> option, then the tree is extracted from that tarball instead.</p><p class=Pp>Next, <code class=Nm>etcupdate</code> compares the files in the “current” and “previous” trees. If a file was removed from the “current” tree, then it will be removed from the destination directory only if it does not have any local modifications. If a file was added to the “current” tree, then it will be copied to the destination directory only if it would not clobber an existing file. If a file is changed in the “current” tree, then <code class=Nm>etcupdate</code> will attempt to merge the changes into the version of the file in the destination directory. If the merge encounters conflicts, then a version of the file with conflict markers will be saved for future resolution. If the merge does not encounter conflicts, then the merged version of the file will be saved in the destination directory. If <code class=Nm>etcupdate</code> is not able to safely merge in changes to a file other than a merge conflict, it will generate a warning.</p><p class=Pp>For each file that is updated a line will be output with a leading character to indicate the action taken. The possible actions follow:</p><p class=Pp></p><div class=Bd-indent><dl class="Bl-tag Bl-compact"><dt>A</dt><dd>Added</dd><dt>C</dt><dd>Conflict</dd><dt>D</dt><dd>Deleted</dd><dt>M</dt><dd>Merged</dd><dt>U</dt><dd>Updated</dd></dl></div><p class=Pp>Finally, if any warnings were encountered they are displayed after the merge has completed.</p><p class=Pp>Note that for certain files <code class=Nm>etcupdate</code> will perform post-install actions any time that the file is updated. Specifically, <a class=Xr href=pwd_mkdb.8.html>pwd_mkdb(8)</a> is invoked if <span class=Pa>/etc/master.passwd</span> is changed, <a class=Xr href=cap_mkdb.1.html>cap_mkdb(1)</a> is invoked to update <span class=Pa>/etc/login.conf.db</span> if <span class=Pa>/etc/login.conf</span> is changed, <a class=Xr href=newaliases.1.html>newaliases(1)</a> is invoked if <span class=Pa>/etc/mail/aliases</span> is changed, <a class=Xr href=services_mkdb.8.html>services_mkdb(8)</a> is invoked if <span class=Pa>/etc/services</span> is changed, <a class=Xr href=tzsetup.8.html>tzsetup(8)</a> is invoked if <span class=Pa>/etc/localtime</span> is changed and if <var class=Fa>/var/db/zoneinfo</var> exists, and <span class=Pa>/etc/rc.d/motd</span> is invoked if <span class=Pa>/etc/motd</span> is changed. One exception is that if <span class=Pa>/etc/mail/aliases</span> is changed and the destination directory is not the default, then a warning will be issued instead. This is due to a limitation of the <a class=Xr href=newaliases.1.html>newaliases(1)</a> command. Similarly, if <span class=Pa>/etc/motd</span> is changed and the destination directory is not the default, then <span class=Pa>/etc/rc.d/motd</span> will not be executed due to a limitation of that script. In this case no warning is issued as the result of <span class=Pa>/etc/rc.d/motd</span> is merely cosmetic and will be corrected on the next reboot.</p></section><section class=Ss><h2 class=Ss id=Build_Mode><a class=permalink href=#Build_Mode>Build Mode</a></h2> The <code class=Cm>build</code> mode is used to build a tarball that contains a snapshot of a “current” tree. This tarball can be used by the default and extract modes. Using a tarball can allow <code class=Nm>etcupdate</code> to perform a merge without requiring a source tree that matches the currently installed world. The <var class=Fa>tarball</var> argument specifies the name of the file to create. The file will be a <a class=Xr href=tar.5.html>tar(5)</a> file compressed with <a class=Xr href=bzip2.1.html>bzip2(1)</a>. </section><section class=Ss><h2 class=Ss id=Diff_Mode><a class=permalink href=#Diff_Mode>Diff Mode</a></h2> The <code class=Cm>diff</code> mode compares the versions of files in the destination directory to the “current” tree and generates a unified format diff of the changes. This can be used to determine which files have been locally modified and how. Note that <code class=Nm>etcupdate</code> does not manage files that are not maintained in the source tree such as <span class=Pa>/etc/fstab</span> and <span class=Pa>/etc/rc.conf</span>. </section><section class=Ss><h2 class=Ss id=Extract_Mode><a class=permalink href=#Extract_Mode>Extract Mode</a></h2> The <code class=Cm>extract</code> mode generates a new “current” tree. Unlike the default mode, it does not save any existing “current” tree and does not modify any existing “previous” tree. The new “current” tree can either be built from a source tree or extracted from a tarball. </section><section class=Ss><h2 class=Ss id=Resolve_Mode><a class=permalink href=#Resolve_Mode>Resolve Mode</a></h2> The <code class=Cm>resolve</code> mode is used to resolve any conflicts encountered during a merge. In this mode, <code class=Nm>etcupdate</code> iterates over any existing conflicts prompting the user for actions to take on each conflicted file. For each file, the following actions are available: <p class=Pp></p><dl class="Bl-tag Bl-compact"><dt>(p) postpone</dt><dd>Ignore this conflict for now.</dd><dt>(df) diff-full</dt><dd>Show all changes made to the merged file as a unified diff.</dd><dt>(e) edit</dt><dd>Change the merged file in an editor.</dd><dt>(r) resolved</dt><dd>Install the merged version of the file into the destination directory.</dd><dt>(mf) mine-full</dt><dd>Use the version of the file in the destination directory and ignore any changes made to the file in the “current” tree.</dd><dt>(tf) theirs-full</dt><dd>Use the version of the file from the “current” tree and discard any local changes made to the file.</dd><dt>(h) help</dt><dd>Display the list of commands.</dd></dl></section><section class=Ss><h2 class=Ss id=Revert_Mode><a class=permalink href=#Revert_Mode>Revert Mode</a></h2> The <code class=Cm>revert</code> mode is used to restore the stock versions of files. In this mode, <code class=Nm>etcupdate</code> installs the stock version of requested files. This mode cannot be used to restore directories, only individual files. </section><section class=Ss><h2 class=Ss id=Status_Mode><a class=permalink href=#Status_Mode>Status Mode</a></h2> The <code class=Cm>status</code> mode shows a summary of the results of the most recent merge. First it lists any files for which there are unresolved conflicts. Next it lists any warnings generated during the last merge. If the last merge did not generate any conflicts or warnings, then nothing will be output. </section></section><section class=Sh><h2 class=Sh id=OPTIONS><a class=permalink href=#OPTIONS>OPTIONS</a></h2> The following options are available. Note that most options do not apply to all modes. <dl class=Bl-tag><dt><a class=permalink href=#A><code class=Fl id=A>-A</code></a><var class=Ar>patterns</var></dt><dd>Always install the new version of any files that match any of the patterns listed in <var class=Ar>patterns</var>. Each pattern is evaluated as an <a class=Xr href=sh.1.html>sh(1)</a> shell pattern. This option may be specified multiple times to specify multiple patterns. Multiple space-separated patterns may also be specified in a single option. Note that ignored files specified via the <code class=Ev>IGNORE_FILES</code> variable or the <code class=Fl>-I</code> option will not be installed.</dd><dt><a class=permalink href=#B><code class=Fl id=B>-B</code></a></dt><dd>Do not build generated files in a private object tree. Instead, reuse the generated files from a previously built object tree that matches the source tree. This can be useful to avoid gratuitous conflicts in <a class=Xr href=sendmail.8.html>sendmail(8)</a> configuration files when bootstrapping. It can also be useful for building a tarball that matches a specific world build.</dd><dt><a class=permalink href=#D><code class=Fl id=D>-D</code></a><var class=Ar>destdir</var></dt><dd>Specify an alternate destination directory as the target of a merge. This is analogous to the <code class=Dv>DESTDIR</code> variable used with ‘make installworld’. The default destination directory is an empty string which results in merges updating <span class=Pa>/etc</span> on the local machine.</dd><dt><a class=permalink href=#d><code class=Fl id=d>-d</code></a><var class=Ar>workdir</var></dt><dd>Specify an alternate directory to use as the work directory. The work directory is used to store the “current” and “previous” trees as well as unresolved conflicts. The default work directory is <span class=Pa>&lt;destdir&gt;/var/db/etcupdate</span>.</dd><dt><a class=permalink href=#F><code class=Fl id=F>-F</code></a></dt><dd>Ignore changes in the FreeBSD ID string when comparing files in the destination directory to files in either of the “current” or “previous” trees. In <code class=Cm>diff</code> mode, this reduces noise due to FreeBSD ID string changes in the output. During an update this can simplify handling for harmless conflicts caused by FreeBSD ID string changes. <p class=Pp>Specifically, if a file in the destination directory is identical to the same file in the “previous” tree modulo the FreeBSD ID string, then the file is treated as if it was unmodified and the “current” version of the file will be installed. Similarly, if a file in the destination directory is identical to the same file in the “current” tree modulo the FreeBSD ID string, then the “current” version of the file will be installed to update the ID string. If the “previous” and “current” versions of the file are identical, then <code class=Nm>etcupdate</code> will not change the file in the destination directory.</p><p class=Pp>Due to limitations in the <a class=Xr href=diff.1.html>diff(1)</a> command, this option may not have an effect if there are other changes in a file that are close to the FreeBSD ID string.</p></dd><dt><a class=permalink href=#I><code class=Fl id=I>-I</code></a><var class=Ar>patterns</var></dt><dd>Ignore any files that match any of the patterns listed in <var class=Ar>patterns</var>. No warnings or other messages will be generated for those files during a merge. Each pattern is evaluated as an <a class=Xr href=sh.1.html>sh(1)</a> shell pattern. This option may be specified multiple times to specify multiple patterns. Multiple space-separated patterns may also be specified in a single option.</dd><dt><a class=permalink href=#L><code class=Fl id=L>-L</code></a><var class=Ar>logfile</var></dt><dd>Specify an alternate path for the log file. The <code class=Nm>etcupdate</code> utility logs each command that it invokes along with the standard output and standard error to this file. By default the log file is stored in a file named <span class=Pa>log</span> in the work directory.</dd><dt><a class=permalink href=#M><code class=Fl id=M>-M</code></a><var class=Ar>options</var></dt><dd>Pass <var class=Ar>options</var> as additional parameters to <a class=Xr href=make.1.html>make(1)</a> when building a “current” tree. This can be used for to set the <code class=Dv>TARGET</code> or <code class=Dv>TARGET_ARCH</code> variables for a cross-build.</dd><dt><a class=permalink href=#m><code class=Fl id=m>-m</code></a><var class=Ar>make</var></dt><dd>Use <var class=Ar>make</var> as the <a class=Xr href=make.1.html>make(1)</a> binary when building a “current” tree.</dd><dt><a class=permalink href=#n><code class=Fl id=n>-n</code></a></dt><dd>Enable “dry-run” mode. Do not merge any changes to the destination directory. Instead, report what actions would be taken during a merge. Note that the existing “current” and “previous” trees will not be changed. If the <code class=Fl>-r</code> option is not specified, then a temporary “current” tree will be extracted to perform the comparison.</dd><dt><a class=permalink href=#N><code class=Fl id=N>-N</code></a></dt><dd>Perform a <code class=Dv>NO_ROOT</code> build when building a “current” tree. The resulting tree will include a corresponding <span class=Pa>METALOG</span> file at its root.</dd><dt><a class=permalink href=#p><code class=Fl id=p>-p</code></a></dt><dd>Enable “pre-world” mode. Only merge changes to files that are necessary to successfully run ‘make installworld’ or ‘make installkernel’. When this flag is enabled, the existing “current” and “previous” trees are left alone. Instead, a temporary tree is populated with the necessary files. This temporary tree is compared against the “current” tree. This allows a normal update to be run after ‘make installworld’ has completed. Any conflicts generated during a “pre-world” update should be resolved by a “pre-world” <code class=Cm>resolve</code>.</dd><dt><a class=permalink href=#r><code class=Fl id=r>-r</code></a></dt><dd>Do not update the “current” and “previous” trees during a merge. This can be used to “re-run” a previous merge operation.</dd><dt><a class=permalink href=#s><code class=Fl id=s>-s</code></a><var class=Ar>source</var></dt><dd>Specify an alternate source tree to use when building or extracting a “current” tree. The default source tree is <span class=Pa>/usr/src</span>.</dd><dt><a class=permalink href=#t><code class=Fl id=t>-t</code></a><var class=Ar>tarball</var></dt><dd>Extract a new “current” tree from a tarball previously generated by the <code class=Cm>build</code> command rather than building the tree from a source tree.</dd></dl></section><section class=Sh><h2 class=Sh id=CONFIG_FILE><a class=permalink href=#CONFIG_FILE>CONFIG FILE</a></h2> The <code class=Nm>etcupdate</code> utility can also be configured by setting variables in an optional configuration file named <span class=Pa>/etc/etcupdate.conf</span>. Note that command line options override settings in the configuration file. The configuration file is executed by <a class=Xr href=sh.1.html>sh(1)</a>, so it uses that syntax to set configuration variables. The following variables can be set: <dl class=Bl-tag><dt><a class=permalink href=#ALWAYS_INSTALL><code class=Ev id=ALWAYS_INSTALL>ALWAYS_INSTALL</code></a></dt><dd>Always install files that match any of the patterns listed in this variable similar to the <code class=Fl>-A</code> option.</dd><dt><a class=permalink href=#DESTDIR><code class=Ev id=DESTDIR>DESTDIR</code></a></dt><dd>Specify an alternate destination directory similar to the <code class=Fl>-D</code> option.</dd><dt><a class=permalink href=#EDITOR><code class=Ev id=EDITOR>EDITOR</code></a></dt><dd>Specify a program to edit merge conflicts.</dd><dt><a class=permalink href=#FREEBSD_ID><code class=Ev id=FREEBSD_ID>FREEBSD_ID</code></a></dt><dd>Ignore changes in the FreeBSD ID string similar to the <code class=Fl>-F</code> option. This is enabled by setting the variable to a non-empty value.</dd><dt><a class=permalink href=#IGNORE_FILES><code class=Ev id=IGNORE_FILES>IGNORE_FILES</code></a></dt><dd>Ignore files that match any of the patterns listed in this variable similar to the <code class=Fl>-I</code> option.</dd><dt><a class=permalink href=#LOGFILE><code class=Ev id=LOGFILE>LOGFILE</code></a></dt><dd>Specify an alternate path for the log file similar to the <code class=Fl>-L</code> option.</dd><dt><a class=permalink href=#MAKE_CMD><code class=Ev id=MAKE_CMD>MAKE_CMD</code></a></dt><dd>Specify the <a class=Xr href=make.1.html>make(1)</a> binary when building a “current” tree similar to the <code class=Fl>-m</code> option.</dd><dt><a class=permalink href=#MAKE_OPTIONS><code class=Ev id=MAKE_OPTIONS>MAKE_OPTIONS</code></a></dt><dd>Pass additional options to <a class=Xr href=make.1.html>make(1)</a> when building a “current” tree similar to the <code class=Fl>-M</code> option.</dd><dt><a class=permalink href=#SRCDIR><code class=Ev id=SRCDIR>SRCDIR</code></a></dt><dd>Specify an alternate source tree similar to the <code class=Fl>-s</code> option.</dd><dt><a class=permalink href=#WORKDIR><code class=Ev id=WORKDIR>WORKDIR</code></a></dt><dd>Specify an alternate work directory similar to the <code class=Fl>-d</code> option.</dd></dl></section><section class=Sh><h2 class=Sh id=ENVIRONMENT><a class=permalink href=#ENVIRONMENT>ENVIRONMENT</a></h2> The <code class=Nm>etcupdate</code> utility uses the program identified in the <code class=Ev>EDITOR</code> environment variable to edit merge conflicts. If <code class=Ev>EDITOR</code> is not set, <a class=Xr href=vi.1.html>vi(1)</a> is used as the default editor. </section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><dl class="Bl-tag Bl-compact"><dt><span class=Pa>/etc/etcupdate.conf</span></dt><dd>Optional config file.</dd><dt><span class=Pa>/var/db/etcupdate</span></dt><dd>Default work directory used to store trees and other data.</dd><dt><span class=Pa>/var/db/etcupdate/log</span></dt><dd>Default log file.</dd></dl></section><section class=Sh><h2 class=Sh id=EXIT_STATUS><a class=permalink href=#EXIT_STATUS>EXIT STATUS</a></h2> The <code class=Nm>etcupdate</code> utility exits 0 on success, and &gt;0 if an error occurs. </section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> To compare the files in <span class=Pa>/etc</span> with the stock versions: <p class=Pp></p><div class="Bd Bd-indent"><code class=Li>etcupdate diff</code></div><p class=Pp>To merge changes after an upgrade via the buildworld and installworld process:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>etcupdate</code></div><p class=Pp>To resolve any conflicts generated during a merge:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>etcupdate resolve</code></div><section class=Ss><h2 class=Ss id=Bootstrapping><a class=permalink href=#Bootstrapping>Bootstrapping</a></h2> The <code class=Nm>etcupdate</code> utility may need to be bootstrapped before it can be used. The <code class=Cm>diff</code> command will fail with an error about a missing reference tree if bootstrapping is needed. <p class=Pp>Bootstrapping <code class=Nm>etcupdate</code> requires a source tree that matches the currently installed world. The easiest way to ensure this is to bootstrap <code class=Nm>etcupdate</code> before updating the source tree to start the next world upgrade cycle. First, generate a reference tree:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>etcupdate extract</code></div><p class=Pp>Second, use the <code class=Cm>diff</code> command to compare the reference tree to your current files in <span class=Pa>/etc</span>. Undesired differences should be removed using an editor, <a class=Xr href=patch.1.html>patch(1)</a>, or by copying files from the reference tree (located at <span class=Pa>/var/db/etcupdate/current</span> by default)</p><p class=Pp>If the tree at <span class=Pa>/usr/src</span> is already newer than the currently installed world, a new tree matching the currently installed world can be checked out to a temporary location. The reference tree for <code class=Nm>etcupdate</code> can then be generated via:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>etcupdate extract -s /path/to/tree</code></div><p class=Pp>The <code class=Cm>diff</code> command can be used as above to remove undesired differences. Afterwards, the changes in the tree at <span class=Pa>/usr/src</span> can be merged via a regular merge.</p></section></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2> The following warning messages may be generated during a merge. Note that several of these warnings cover obscure cases that should occur rarely if at all in practice. For example, if a file changes from a file to a directory in the “current” tree and the file was modified in the destination directory, then a warning will be triggered. In general, when a warning references a pathname, the corresponding file in the destination directory is not changed by a merge operation. <dl class=Bl-diag><dt>Directory mismatch: &lt;path&gt; (&lt;type&gt;)</dt><dd>An attempt was made to create a directory at <span class=Pa>path</span> but an existing file of type “type” already exists for that path name.</dd><dt>Modified link changed: &lt;file&gt; (&lt;old&gt; became &lt;new&gt;)</dt><dd>The target of a symbolic link named <span class=Pa>file</span> was changed from “old” to “new” in the “current” tree. The symbolic link has been modified to point to a target that is neither “old” nor “new” in the destination directory.</dd><dt>Modified mismatch: &lt;file&gt; (&lt;new&gt; vs &lt;dest&gt;)</dt><dd>A file named <span class=Pa>file</span> of type “new” was modified in the “current” tree, but the file exists as a different type “dest” in the destination directory.</dd><dt>Modified &lt;type&gt; changed: &lt;file&gt; (&lt;old&gt; became &lt;new&gt;)</dt><dd>A file named <span class=Pa>file</span> changed type from “old” in the “previous” tree to type “new” in the “current” tree. The file in the destination directory of type “type” has been modified, so it could not be merged automatically.</dd><dt>Modified &lt;type&gt; remains: &lt;file&gt;</dt><dd>The file of type “type” named <span class=Pa>file</span> has been removed from the “current” tree, but it has been locally modified. The modified version of the file remains in the destination directory.</dd><dt>Needs update: /etc/localtime (required manual update via tzsetup(8))</dt><dd>The <var class=Fa>/var/db/zoneinfo</var> file does not exist, so <code class=Nm>etcupdate</code> was not able to refresh <var class=Fa>/etc/localtime</var> from its source file in <var class=Fa>/usr/share/zoneinfo</var>. Running <a class=Xr href=tzsetup.8.html>tzsetup(8)</a> will both refresh <var class=Fa>/etc/localtime</var> and generate <var class=Fa>/var/db/zoneinfo</var> permitting future updates to refresh <var class=Fa>/etc/localtime</var> automatically.</dd><dt>Needs update: /etc/mail/aliases.db (required manual update via newaliases(1))</dt><dd>The file <span class=Pa>/etc/mail/aliases</span> was updated during a merge with a non-empty destination directory. Due to a limitation of the <a class=Xr href=newaliases.1.html>newaliases(1)</a> command, <code class=Nm>etcupdate</code> was not able to automatically update the corresponding aliases database.</dd><dt>New file mismatch: &lt;file&gt; (&lt;new&gt; vs &lt;dest&gt;)</dt><dd>A new file named <span class=Pa>file</span> of type “new” has been added to the “current” tree. A file of that name already exists in the destination directory, but it is of a different type “dest”.</dd><dt>New link conflict: &lt;file&gt; (&lt;new&gt; vs &lt;dest&gt;)</dt><dd>A symbolic link named <span class=Pa>file</span> has been added to the “current” tree that links to “new”. A symbolic link of the same name already exists in the destination directory, but it links to a different target “dest”.</dd><dt>Non-empty directory remains: &lt;file&gt;</dt><dd>The directory <span class=Pa>file</span> was removed from the “current” tree, but it contains additional files in the destination directory. These additional files as well as the directory remain.</dd><dt>Remove mismatch: &lt;file&gt; (&lt;old&gt; became &lt;new&gt;)</dt><dd>A file named <span class=Pa>file</span> changed from type “old” in the “previous” tree to type “new” in the “current” tree, but it has been removed in the destination directory.</dd><dt>Removed file changed: &lt;file&gt;</dt><dd>A file named <span class=Pa>file</span> was modified in the “current” tree, but it has been removed in the destination directory.</dd><dt>Removed link changed: &lt;file&gt; (&lt;old&gt; became &lt;new&gt;)</dt><dd>The target of a symbolic link named <span class=Pa>file</span> was changed from “old” to “new” in the “current” tree, but it has been removed in the destination directory.</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=cap_mkdb.1.html>cap_mkdb(1)</a>, <a class=Xr href=diff.1.html>diff(1)</a>, <a class=Xr href=make.1.html>make(1)</a>, <a class=Xr href=newaliases.1.html>newaliases(1)</a>, <a class=Xr href=sh.1.html>sh(1)</a>, <a class=Xr href=mergemaster.8.html>mergemaster(8)</a>, <a class=Xr href=pwd_mkdb.8.html>pwd_mkdb(8)</a>, <a class=Xr href=services_mkdb.8.html>services_mkdb(8)</a>, <a class=Xr href=tzsetup.8.html>tzsetup(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>etcupdate</code> utility first appeared in <span class=Ux>FreeBSD 10.0</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> The <code class=Nm>etcupdate</code> utility was written by <span class=An>John Baldwin</span> &lt;<a class=Mt href=mailto:jhb@FreeBSD.org>jhb@FreeBSD.org</a>&gt;. </section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> Rerunning a merge does not automatically delete conflicts left over from a previous merge. Any conflicts must be resolved before the merge can be rerun. It is not clear if this is a feature or a bug. <p class=Pp>There is no way to easily automate conflict resolution for specific files. For example, one can imagine a syntax along the lines of</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>etcupdate resolve tf /some/file</code></div><p class=Pp>to resolve a specific conflict in an automated fashion.</p><p class=Pp>Bootstrapping <code class=Nm>etcupdate</code> often results in gratuitous diffs in <span class=Pa>/etc/mail/*.cf</span> that cause conflicts in the first merge. If an object tree that matches the source tree is present when bootstrapping, then passing the <code class=Fl>-B</code> flag to the <code class=Cm>extract</code> command can work around this.</p></section></div><table class=foot><tr><td class=foot-date>August 9, 2022</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>