<!DOCTYPE html>
<html><head><meta charset=utf-8><title>login_getcapsize(3)</title><keywords content=man,login_getcapsize></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>login_getcapsize(3)</h1><table class=head><tr><td class=head-ltitle>LOGIN_CAP(3)</td><td class=head-vol>FreeBSD Library Functions Manual</td><td class=head-rtitle>LOGIN_CAP(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>login_close</code>, <code class=Nm>login_getcapbool</code>, <code class=Nm>login_getcaplist</code>, <code class=Nm>login_getcapnum</code>, <code class=Nm>login_getcapstr</code>, <code class=Nm>login_getcapsize</code>, <code class=Nm>login_getcaptime</code>, <code class=Nm>login_getclass</code>, <code class=Nm>login_getclassbyname</code>, <code class=Nm>login_getpwclass</code>, <code class=Nm>login_getstyle</code>, <code class=Nm>login_getuserclass</code>, <code class=Nm>login_setcryptfmt</code> — <div class=Nd>functions for accessing the login class capabilities database</div></section><section class=Sh><h2 class=Sh id=LIBRARY><a class=permalink href=#LIBRARY>LIBRARY</a></h2><span class=Lb>System Utilities Library (libutil, -lutil)</span></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/sys/types.h.html>sys/types.h</a>&gt;</code><br><code class=In>#include &lt;<a class=In href=../src/login_cap.h.html>login_cap.h</a>&gt;</code><p class=Pp><var class=Ft>void</var><br><code class=Fn>login_close</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>);</p><p class=Pp><var class=Ft>login_cap_t *</var><br><code class=Fn>login_getclassbyname</code>(<var class=Fa style="white-space: nowrap;">const char *nam</var>, <var class=Fa style="white-space: nowrap;">const struct passwd *pwd</var>);</p><p class=Pp><var class=Ft>login_cap_t *</var><br><code class=Fn>login_getclass</code>(<var class=Fa style="white-space: nowrap;">const char *nam</var>);</p><p class=Pp><var class=Ft>login_cap_t *</var><br><code class=Fn>login_getpwclass</code>(<var class=Fa style="white-space: nowrap;">const struct passwd *pwd</var>);</p><p class=Pp><var class=Ft>login_cap_t *</var><br><code class=Fn>login_getuserclass</code>(<var class=Fa style="white-space: nowrap;">const struct passwd *pwd</var>);</p><p class=Pp><var class=Ft>const char *</var><br><code class=Fn>login_getcapstr</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *cap</var>, <var class=Fa style="white-space: nowrap;">const char *def</var>, <var class=Fa style="white-space: nowrap;">const char *error</var>);</p><p class=Pp><var class=Ft>const char **</var><br><code class=Fn>login_getcaplist</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *cap</var>, <var class=Fa style="white-space: nowrap;">const char *chars</var>);</p><p class=Pp><var class=Ft>const char *</var><br><code class=Fn>login_getpath</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *cap</var>, <var class=Fa style="white-space: nowrap;">const char *error</var>);</p><p class=Pp><var class=Ft>rlim_t</var><br><code class=Fn>login_getcaptime</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *cap</var>, <var class=Fa style="white-space: nowrap;">rlim_t def</var>, <var class=Fa style="white-space: nowrap;">rlim_t error</var>);</p><p class=Pp><var class=Ft>rlim_t</var><br><code class=Fn>login_getcapnum</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *cap</var>, <var class=Fa style="white-space: nowrap;">rlim_t def</var>, <var class=Fa style="white-space: nowrap;">rlim_t error</var>);</p><p class=Pp><var class=Ft>rlim_t</var><br><code class=Fn>login_getcapsize</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *cap</var>, <var class=Fa style="white-space: nowrap;">rlim_t def</var>, <var class=Fa style="white-space: nowrap;">rlim_t error</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>login_getcapbool</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *cap</var>, <var class=Fa style="white-space: nowrap;">int def</var>);</p><p class=Pp><var class=Ft>const char *</var><br><code class=Fn>login_getstyle</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *style</var>, <var class=Fa style="white-space: nowrap;">const char *auth</var>);</p><p class=Pp><var class=Ft>const char *</var><br><code class=Fn>login_setcryptfmt</code>(<var class=Fa style="white-space: nowrap;">login_cap_t *lc</var>, <var class=Fa style="white-space: nowrap;">const char *def</var>, <var class=Fa style="white-space: nowrap;">const char *error</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> These functions represent a programming interface to the login classes database provided in <a class=Xr href=login.conf.5.html>login.conf(5)</a>. This database contains capabilities, attributes and default environment and accounting settings for users and programs running as specific users, as determined by the login class field within entries in <span class=Pa>/etc/master.passwd</span>. <p class=Pp>Entries in <a class=Xr href=login.conf.5.html>login.conf(5)</a> consist of colon ‘<code class=Li>:</code>’ separated fields, the first field in each record being one or more identifiers for the record (which must be unique for the entire database), each separated by a ‘<code class=Li>|</code>’, and may optionally include a description as the last ‘name’. Remaining fields in the record consist of keyword/data pairs. Long lines may be continued with a backslash within empty entries, with the second and subsequent lines optionally indented for readability. This is similar to the format used in <a class=Xr href=termcap.5.html>termcap(5)</a>, except that keywords are not limited to two significant characters, and are usually longer for improved readability. As with termcap entries, multiple records can be linked together (one record including another) using a field containing ‘<code class=Li>tc=<var class=Va>&lt;recordid&gt;</var></code>’. The result is that the entire record referenced by <var class=Va>&lt;recordid&gt;</var> replaces the <var class=Va>tc=</var> field at the point at which it occurs. See <a class=Xr href=getcap.3.html>getcap(3)</a> for further details on the format and use of a capabilities database.</p><p class=Pp>The <code class=Nm>login_cap</code> interface provides a convenient means of retrieving login class records with all <var class=Va>tc=</var> references expanded. A program will typically call one of <code class=Fn>login_getclass</code>(), <code class=Fn>login_getpwclass</code>(), <code class=Fn>login_getuserclass</code>() or <code class=Fn>login_getclassbyname</code>() according to its requirements. Each of these functions returns a login capabilities structure, <var class=Vt>login_cap_t</var>, which may subsequently be used to interrogate the database for specific values using the rest of the API. Once the <var class=Vt>login_cap_t</var> is of no further use, the <code class=Fn>login_close</code>() function should be called to free all resources used.</p><p class=Pp>The structure of <var class=Vt>login_cap_t</var> is defined in <code class=In>&lt;<a class=In href=../src/login_cap.h.html>login_cap.h</a>&gt;</code>, as:</p><div class="Bd Pp Bd-indent"><pre>
typedef struct {
	char *lc_class;
	char *lc_cap;
	char *lc_style;
} login_cap_t;
</pre></div><p class=Pp>The <var class=Fa>lc_class</var> member contains a pointer to the name of the login class retrieved. This may not necessarily be the same as the one requested, either directly via <code class=Fn>login_getclassbyname</code>(), or indirectly via a user's login record using <code class=Fn>login_getpwclass</code>(), by class name using <code class=Fn>login_getclass</code>(). If the referenced user has no login class specified in <span class=Pa>/etc/master.passwd</span>, the class name is <code class=Dv>NULL</code> or an empty string. If the class specified does not exist in the database, each of these functions will search for a record with an id of ‘<code class=Li>default</code>’, with that name returned in the <var class=Fa>lc_class</var> field. In addition, if the referenced user has a UID of 0 (normally, ‘<code class=Li>root</code>’, although the user name is not considered) then <code class=Fn>login_getpwclass</code>() will search for a record with an id of ‘<code class=Li>root</code>’ before it searches for the record with the id of ‘<code class=Li>default</code>’.</p><p class=Pp>The <var class=Fa>lc_cap</var> field is used internally by the library to contain the expanded login capabilities record. Programs with unusual requirements may wish to use this with the lower-level <code class=Fn>getcap</code>() style functions to access the record directly.</p><p class=Pp>The <var class=Fa>lc_style</var> field is set by the <code class=Fn>login_getstyle</code>() function to the authorisation style, according to the requirements of the program handling a login itself.</p><p class=Pp>The <code class=Fn>login_getclassbyname</code>() function is the basic means to get a <var class=Vt>login_cap_t</var> object. It accepts two arguments: the first one, <var class=Fa>name</var>, is the record identifier of the record to be retrieved; the second, <var class=Fa>pwd</var>, is an optional pointer to a <var class=Vt>passwd</var> structure. First of all, its arguments are used by the function to choose between system and user modes of operation. When in system mode, only the system login class database is used. When in user mode, the supplemental login class database in the user's home directory is allowed to override settings from the system database in a limited way as noted below. To minimize security implications, user mode is entered by <code class=Fn>login_getclassbyname</code>() if and only if <var class=Fa>name</var> is <code class=Dv>LOGIN_MECLASS</code> (‘<code class=Li>me</code>’) and <var class=Fa>pwd</var> is not <code class=Dv>NULL</code>. Otherwise system mode is chosen.</p><p class=Pp>In system mode, any record in the system database <span class=Pa>/etc/login.conf</span> can be accessed, and a fallback to the default record is provided as follows. If <var class=Fa>name</var> is <code class=Dv>NULL</code>, an empty string, or a class that does not exist in the login class database, then the <code class=Dv>LOGIN_DEFCLASS</code> record (‘<code class=Li>default</code>’) is returned instead.</p><p class=Pp>In user mode, only the <code class=Dv>LOGIN_MECLASS</code> record (‘<code class=Li>me</code>’) is accessed and no fallback to the ‘<code class=Li>default</code>’ record is provided. The directory specified by <var class=Fa>pwd-&gt;pw_dir</var> is searched for a login database file called <span class=Pa>.login_conf</span>, and only the ‘<code class=Li>me</code>’ capability record contained within it may override the system record with the same name while other records are ignored. Using this scheme, an application can explicitly allow users to override a selected subset of login settings. To do so, the application should obtain two <var class=Vt>login_cap_t</var> objects, one in user mode and the other in system mode, and then query the user object before the system object for login parameters that are allowed to be overridden by the user. For example, the user's <span class=Pa>.login_conf</span> can provide a convenient way for a user to set up their preferred login environment before the shell is invoked on login if supported by <a class=Xr href=login.1.html>login(1)</a>.</p><p class=Pp>Note that access to the <span class=Pa>/etc/login.conf</span> and <span class=Pa>.login_conf</span> files will only be performed subject to the security checks documented in <a class=Xr href=_secure_path.3.html>_secure_path(3)</a> for the uids 0 and <var class=Fa>pwd-&gt;pw_uid</var> respectively.</p><p class=Pp>If the specified record is <code class=Dv>NULL</code>, empty or does not exist, and the system has no ‘<code class=Li>default</code>’ record available to fall back to, there is a memory allocation error or for some reason <a class=Xr href=cgetent.3.html>cgetent(3)</a> is unable to access the login capabilities database, this function returns <code class=Dv>NULL</code>.</p><p class=Pp>The functions <code class=Fn>login_getclass</code>(), <code class=Fn>login_getpwclass</code>() and <code class=Fn>login_getuserclass</code>() retrieve the applicable login class record for the user's passwd entry or class name by calling <code class=Fn>login_getclassbyname</code>(). On failure, <code class=Dv>NULL</code> is returned. The difference between these functions is that <code class=Fn>login_getuserclass</code>() includes the user's overriding <span class=Pa>.login_conf</span> that exists in the user's home directory, and <code class=Fn>login_getpwclass</code>() and <code class=Fn>login_getclass</code>() restrict lookup only to the system login class database in <span class=Pa>/etc/login.conf</span>. As explained earlier, <code class=Fn>login_getpwclass</code>() differs from <code class=Fn>login_getclass</code>() in that it allows the default class for a super-user as ‘<code class=Li>root</code>’ if none has been specified in the password database. Otherwise, if the passwd pointer is <code class=Dv>NULL</code>, or the user record has no login class, then the system ‘<code class=Li>default</code>’ entry is retrieved. Essentially, <code class=Fn>login_getclass</code>(<var class=Fa>name</var>) is equivalent to <code class=Fn>login_getclassbyname</code>(<var class=Fa>name</var>, <var class=Fa>NULL</var>) and <code class=Fn>login_getuserclass</code>(<var class=Fa>pwd</var>) to <code class=Fn>login_getclassbyname</code>(<var class=Fa>LOGIN_MECLASS</var>, <var class=Fa>pwd</var>).</p><p class=Pp>Once a program no longer wishes to use a <var class=Vt>login_cap_t</var> object, <code class=Fn>login_close</code>() may be called to free all resources used by the login class. The <code class=Fn>login_close</code>() function may be passed a <code class=Dv>NULL</code> pointer with no harmful side-effects.</p><p class=Pp>The remaining functions may be used to retrieve individual capability records. Each function takes a <var class=Vt>login_cap_t</var> object as its first parameter, a capability tag as the second, and remaining parameters being default and error values that are returned if the capability is not found. The type of the additional parameters passed and returned depend on the <i class=Em>type</i> of capability each deals with, be it a simple string, a list, a time value, a file or memory size value, a path (consisting of a colon-separated list of directories) or a boolean flag. The manpage for <a class=Xr href=login.conf.5.html>login.conf(5)</a> deals in specific tags and their type.</p><p class=Pp>Note that with all functions in this group, you should not call <a class=Xr href=free.3.html>free(3)</a> on any pointers returned. Memory allocated during retrieval or processing of capability tags is automatically reused by subsequent calls to functions in this group, or deallocated on calling <code class=Fn>login_close</code>().</p><dl class=Bl-tag><dt><code class=Fn>login_getcapstr</code>()</dt><dd>This function returns a simple string capability. If the string is not found, then the value in <var class=Fa>def</var> is returned as the default value, or if an error occurs, the value in the <var class=Fa>error</var> parameter is returned.</dd><dt><code class=Fn>login_getcaplist</code>()</dt><dd>This function returns the value corresponding to the named capability tag as a list of values in a <code class=Dv>NULL</code> terminated array. Within the login class database, some tags are of type <var class=Vt>list</var>, which consist of one or more comma- or space separated values. Usually, this function is not called directly from an application, but is used indirectly via <code class=Fn>login_getstyle</code>().</dd><dt><code class=Fn>login_getpath</code>()</dt><dd>This function returns a list of directories separated by colons ‘<code class=Li>:</code>’. Capability tags for which this function is called consist of a list of directories separated by spaces.</dd><dt><code class=Fn>login_getcaptime</code>()</dt><dd>This function returns a <var class=Vt>time value</var> associated with a particular capability tag with the value expressed in seconds (the default), minutes, hours, days, weeks or (365 day) years or any combination of these. A suffix determines the units used: ‘<code class=Li>S</code>’ for seconds, ‘<code class=Li>M</code>’ for minutes, ‘<code class=Li>H</code>’ for hours, ‘<code class=Li>D</code>’ for days, ‘<code class=Li>W</code>’ for weeks and ‘<code class=Li>Y</code>’ for 365 day years. Case of the units suffix is ignored. <p class=Pp>Time values are normally used for setting resource, accounting and session limits. If supported by the operating system and compiler (which is true of <span class=Ux>FreeBSD</span>), the value returned is a <var class=Vt>quad</var> (<var class=Vt>long long</var>), of type <var class=Vt>rlim_t</var>. A value ‘<code class=Li>inf</code>’ or ‘<code class=Li>infinity</code>’ may be used to express an infinite value, in which case <code class=Dv>RLIM_INFINITY</code> is returned.</p></dd><dt><code class=Fn>login_getcapnum</code>()</dt><dd>This function returns a numeric value for a tag, expressed either as ‘<code class=Li>tag=&lt;value&gt;</code>’ or the standard <code class=Fn>cgetnum</code>() format ‘<code class=Li>tag#&lt;value&gt;</code>’. The first format should be used in preference to the second, the second format is provided for compatibility and consistency with the <a class=Xr href=getcap.3.html>getcap(3)</a> database format where numeric types use the ‘<code class=Li>#</code>’ as the delimiter for numeric values. If in the first format, then the value given may be ‘<code class=Li>inf</code>’ or ‘<code class=Li>infinity</code>’ which results in a return value of <code class=Dv>RLIM_INFINITY</code>. If the given capability tag cannot be found, the <var class=Fa>def</var> parameter is returned, and if an error occurs, the <var class=Fa>error</var> parameter is returned.</dd><dt><code class=Fn>login_getcapsize</code>()</dt><dd><code class=Fn>login_getcapsize</code>() returns a value representing a size (typically, file or memory) which may be expressed as bytes (the default), 512 byte blocks, kilobytes, megabytes, gigabytes, and on systems that support the <var class=Vt>long long</var> type, terabytes. The suffix used determines the units, and multiple values and units may be used in combination (e.g. 1m500k = 1.5 megabytes). A value with no suffix is interpreted as bytes, ‘<code class=Li>B</code>’ as 512-byte blocks, ‘<code class=Li>K</code>’ as kilobytes, ‘<code class=Li>M</code>’ as megabytes, ‘<code class=Li>G</code>’ as gigabytes and ‘<code class=Li>T</code>’ as terabytes. Case is ignored. The error value is returned if there is a login capabilities database error, if an invalid suffix is used, or if a numeric value cannot be interpreted.</dd><dt><code class=Fn>login_getcapbool</code>()</dt><dd>This function returns a boolean value tied to a particular flag. It returns 0 if the given capability tag is not present or is negated by the presence of a ‘<code class=Li>tag@</code>’ (see <a class=Xr href=getcap.3.html>getcap(3)</a> for more information on boolean flags), and returns 1 if the tag is found.</dd><dt><code class=Fn>login_getstyle</code>()</dt><dd>This function is used by the login authorisation system to determine the style of login available in a particular case. The function accepts three parameters, the <var class=Fa>lc</var> entry itself and two optional parameters, and authorisation type <var class=Fa>auth</var> and <var class=Fa>style</var>, and applies these to determine the authorisation style that best suites these rules. <ul class=Bl-bullet><li>If <var class=Fa>auth</var> is neither <code class=Dv>NULL</code> nor an empty string, look for a tag of type ‘<code class=Li>auth-<var class=Fa>&lt;auth&gt;</var></code>’ in the capability record. If not present, then look for the default tag <var class=Va>auth=</var>.</li><li>If no valid authorisation list was found from the previous step, then default to ‘<code class=Li>passwd</code>’ as the authorisation list.</li><li>If <var class=Fa>style</var> is not <code class=Dv>NULL</code> or empty, look for it in the list of authorisation methods found from the previous step. If <var class=Fa>style</var> is <code class=Dv>NULL</code> or an empty string, then default to ‘<code class=Li>passwd</code>’ authorisation.</li><li>If <var class=Fa>style</var> is found in the chosen list of authorisation methods, then return that, otherwise return <code class=Dv>NULL</code>.</li></ul><p class=Pp>This scheme allows the administrator to determine the types of authorisation methods accepted by the system, depending on the means by which the access occurs. For example, the administrator may require skey or kerberos as the authentication method used for access to the system via the network, and standard methods via direct dialup or console logins, significantly reducing the risk of password discovery by "snooping" network packets.</p></dd><dt><code class=Fn>login_setcryptfmt</code>()</dt><dd>The <code class=Fn>login_setcryptfmt</code>() function is used to set the <a class=Xr href=crypt.3.html>crypt(3)</a> format using the <var class=Va>passwd_format</var> configuration entry. If no entry is found, <var class=Fa>def</var> is taken to be used as the fallback. If calling <a class=Xr href=crypt_set_format.3.html>crypt_set_format(3)</a> on the specifier fails, <var class=Fa>error</var> is returned to indicate this.</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=login.1.html>login(1)</a>, <a class=Xr href=crypt.3.html>crypt(3)</a>, <a class=Xr href=getcap.3.html>getcap(3)</a>, <a class=Xr href=login_class.3.html>login_class(3)</a>, <a class=Xr href=login.conf.5.html>login.conf(5)</a>, <a class=Xr href=termcap.5.html>termcap(5)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The functions <code class=Fn>login_close</code>(), <code class=Fn>login_getcapbool</code>(), <code class=Fn>login_getcaplist</code>(), <code class=Fn>login_getcapnum</code>(), <code class=Fn>login_getcapstr</code>(), <code class=Fn>login_getcapsize</code>(), <code class=Fn>login_getcaptime</code>(), <code class=Fn>login_getclass</code>(), <code class=Fn>login_getclassbyname</code>(), <code class=Fn>login_getpwclass</code>(), <code class=Fn>login_getstyle</code>(), <code class=Fn>login_getuserclass</code>() and <code class=Fn>login_setcryptfmt</code>() first appeared in <span class=Ux>FreeBSD 2.1.5</span>. </section></div><table class=foot><tr><td class=foot-date>May 10, 2020</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>