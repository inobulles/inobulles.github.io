<!DOCTYPE html>
<html><head><meta charset=utf-8><title>patch(1)</title><keywords content=man,patch></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>patch(1)</h1><table class=head><tr><td class=head-ltitle>PATCH(1)</td><td class=head-vol>FreeBSD General Commands Manual</td><td class=head-rtitle>PATCH(1)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>patch</code> — <div class=Nd>apply a diff file to an original</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>patch</code></td><td>[<code class=Fl>-bCcEeflNnRstuv</code>] [<code class=Fl>-B</code> <var class=Ar>backup-prefix</var>] [<code class=Fl>-D</code> <var class=Ar>symbol</var>] [<code class=Fl>-d</code> <var class=Ar>directory</var>] [<code class=Fl>-F</code> <var class=Ar>max-fuzz</var>] [<code class=Fl>-i</code> <var class=Ar>patchfile</var>] [<code class=Fl>-o</code> <var class=Ar>out-file</var>] [<code class=Fl>-p</code> <var class=Ar>strip-count</var>] [<code class=Fl>-r</code> <var class=Ar>rej-name</var>] [<code class=Fl>-V</code> <code class=Cm>t</code> | <code class=Cm>nil</code> | <code class=Cm>never</code> | <code class=Cm>none</code>] [<code class=Fl>-x</code> <var class=Ar>number</var>] [<code class=Fl>-z</code> <var class=Ar>backup-ext</var>] [<code class=Fl>-</code><code class=Fl>-posix</code>] [<var class=Ar>origfile</var> [<var class=Ar>patchfile</var>]]</td></tr></table><br><table class=Nm><tr><td><code class=Nm>patch</code></td><td>&lt;<var class=Ar>patchfile</var></td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2><code class=Nm>patch</code> will take a patch file containing any of the four forms of difference listing produced by the <a class=Xr href=diff.1.html>diff(1)</a> program and apply those differences to an original file, producing a patched version. If <var class=Ar>patchfile</var> is omitted, or is a hyphen, the patch will be read from the standard input. <p class=Pp><code class=Nm>patch</code> will attempt to determine the type of the diff listing, unless overruled by a <code class=Fl>-c</code>, <code class=Fl>-e</code>, <code class=Fl>-n</code>, or <code class=Fl>-u</code> option. Context diffs (old-style, new-style, and unified) and normal diffs are applied directly by the <code class=Nm>patch</code> program itself, whereas ed diffs are simply fed to the <a class=Xr href=ed.1.html>ed(1)</a> editor via a pipe.</p><p class=Pp>If the <var class=Ar>patchfile</var> contains more than one patch, <code class=Nm>patch</code> will try to apply each of them as if they came from separate patch files. This means, among other things, that it is assumed that the name of the file to patch must be determined for each diff listing, and that the garbage before each diff listing will be examined for interesting things such as file names and revision level (see the section on <a class=Sx href=#Filename_Determination>Filename Determination</a> below).</p><p class=Pp>The options are as follows:</p><dl class=Bl-tag><dt><a class=permalink href=#B><code class=Fl id=B>-B</code></a><var class=Ar>backup-prefix</var>, <code class=Fl>-</code><code class=Fl>-prefix</code><var class=Ar>backup-prefix</var></dt><dd>Causes the next argument to be interpreted as a prefix to the backup file name. If this argument is specified, any argument to <code class=Fl>-z</code> will be ignored.</dd><dt><a class=permalink href=#b><code class=Fl id=b>-b</code></a>, <code class=Fl>-</code><code class=Fl>-backup</code></dt><dd>Save a backup copy of the file before it is modified. By default the original file is saved with a backup extension of “.orig” unless the file already has a numbered backup, in which case a numbered backup is made. This is equivalent to specifying “<code class=Fl>-V</code><code class=Cm>existing</code>”. This option is currently the default, unless <code class=Fl>--posix</code> is specified.</dd><dt><a class=permalink href=#C><code class=Fl id=C>-C</code></a>, <code class=Fl>-</code><code class=Fl>-check</code>, <code class=Fl>-</code><code class=Fl>-dry-run</code></dt><dd>Checks that the patch would apply cleanly, but does not modify anything.</dd><dt><a class=permalink href=#c><code class=Fl id=c>-c</code></a>, <code class=Fl>-</code><code class=Fl>-context</code></dt><dd>Forces <code class=Nm>patch</code> to interpret the patch file as a context diff.</dd><dt><a class=permalink href=#D><code class=Fl id=D>-D</code></a><var class=Ar>symbol</var>, <code class=Fl>-</code><code class=Fl>-ifdef</code><var class=Ar>symbol</var></dt><dd>Causes <code class=Nm>patch</code> to use the “#ifdef...#endif” construct to mark changes. The argument following will be used as the differentiating symbol. Note that, unlike the C compiler, there must be a space between the <code class=Fl>-D</code> and the argument.</dd><dt><a class=permalink href=#d><code class=Fl id=d>-d</code></a><var class=Ar>directory</var>, <code class=Fl>-</code><code class=Fl>-directory</code><var class=Ar>directory</var></dt><dd>Causes <code class=Nm>patch</code> to interpret the next argument as a directory, and change the working directory to it before doing anything else.</dd><dt><a class=permalink href=#E><code class=Fl id=E>-E</code></a>, <code class=Fl>-</code><code class=Fl>-remove-empty-files</code></dt><dd>Causes <code class=Nm>patch</code> to remove output files that are empty after the patches have been applied. This option is useful when applying patches that create or remove files.</dd><dt><a class=permalink href=#e><code class=Fl id=e>-e</code></a>, <code class=Fl>-</code><code class=Fl>-ed</code></dt><dd>Forces <code class=Nm>patch</code> to interpret the patch file as an <a class=Xr href=ed.1.html>ed(1)</a> script.</dd><dt><a class=permalink href=#F><code class=Fl id=F>-F</code></a><var class=Ar>max-fuzz</var>, <code class=Fl>-</code><code class=Fl>-fuzz</code><var class=Ar>max-fuzz</var></dt><dd>Sets the maximum fuzz factor. This option only applies to context diffs, and causes <code class=Nm>patch</code> to ignore up to that many lines in looking for places to install a hunk. Note that a larger fuzz factor increases the odds of a faulty patch. The default fuzz factor is 2, and it may not be set to more than the number of lines of context in the context diff, ordinarily 3.</dd><dt><a class=permalink href=#f><code class=Fl id=f>-f</code></a>, <code class=Fl>-</code><code class=Fl>-force</code></dt><dd>Forces <code class=Nm>patch</code> to assume that the user knows exactly what he or she is doing, and to not ask any questions. It assumes the following: skip patches for which a file to patch cannot be found; patch files even though they have the wrong version for the “Prereq”: line in the patch; and assume that patches are not reversed even if they look like they are. This option does not suppress commentary; use <code class=Fl>-s</code> for that.</dd><dt><a class=permalink href=#i><code class=Fl id=i>-i</code></a><var class=Ar>patchfile</var>, <code class=Fl>-</code><code class=Fl>-input</code><var class=Ar>patchfile</var></dt><dd>Causes the next argument to be interpreted as the input file name (i.e., a patchfile). This option may be specified multiple times.</dd><dt><a class=permalink href=#l><code class=Fl id=l>-l</code></a>, <code class=Fl>-</code><code class=Fl>-ignore-whitespace</code></dt><dd>Causes the pattern matching to be done loosely, in case the tabs and spaces have been munged in your input file. Any sequence of whitespace in the pattern line will match any sequence in the input file. Normal characters must still match exactly. Each line of the context must still match a line in the input file.</dd><dt><a class=permalink href=#N><code class=Fl id=N>-N</code></a>, <code class=Fl>-</code><code class=Fl>-forward</code></dt><dd>Causes <code class=Nm>patch</code> to ignore patches that it thinks are reversed or already applied. See also <code class=Fl>-R</code>.</dd><dt><a class=permalink href=#n><code class=Fl id=n>-n</code></a>, <code class=Fl>-</code><code class=Fl>-normal</code></dt><dd>Forces <code class=Nm>patch</code> to interpret the patch file as a normal diff.</dd><dt><a class=permalink href=#o><code class=Fl id=o>-o</code></a><var class=Ar>out-file</var>, <code class=Fl>-</code><code class=Fl>-output</code><var class=Ar>out-file</var></dt><dd>Causes the next argument to be interpreted as the output file name.</dd><dt><a class=permalink href=#p><code class=Fl id=p>-p</code></a><var class=Ar>strip-count</var>, <code class=Fl>-</code><code class=Fl>-strip</code><var class=Ar>strip-count</var></dt><dd>Sets the pathname strip count, which controls how pathnames found in the patch file are treated, in case you keep your files in a different directory than the person who sent out the patch. The strip count specifies how many slashes are to be stripped from the front of the pathname. (Any intervening directory names also go away.) For example, supposing the file name in the patch file was <span class=Pa>/u/howard/src/blurfl/blurfl.c</span>: <p class=Pp>Setting <code class=Fl>-p</code><var class=Ar>0</var> gives the entire pathname unmodified.</p><p class=Pp><code class=Fl>-p</code><var class=Ar>1</var> gives</p><p class=Pp></p><div class="Bd Bd-indent"><span class=Pa>u/howard/src/blurfl/blurfl.c</span></div><p class=Pp>without the leading slash.</p><p class=Pp><code class=Fl>-p</code><var class=Ar>4</var> gives</p><p class=Pp></p><div class="Bd Bd-indent"><span class=Pa>blurfl/blurfl.c</span></div><p class=Pp>Not specifying <code class=Fl>-p</code> at all just gives you <span class=Pa>blurfl.c</span>, unless all of the directories in the leading path (<span class=Pa>u/howard/src/blurfl</span>) exist and that path is relative, in which case you get the entire pathname unmodified. Whatever you end up with is looked for either in the current directory, or the directory specified by the <code class=Fl>-d</code> option.</p></dd><dt><a class=permalink href=#R><code class=Fl id=R>-R</code></a>, <code class=Fl>-</code><code class=Fl>-reverse</code></dt><dd>Tells <code class=Nm>patch</code> that this patch was created with the old and new files swapped. (Yes, I am afraid that does happen occasionally, human nature being what it is.) <code class=Nm>patch</code> will attempt to swap each hunk around before applying it. Rejects will come out in the swapped format. The <code class=Fl>-R</code> option will not work with ed diff scripts because there is too little information to reconstruct the reverse operation. <p class=Pp>If the first hunk of a patch fails, <code class=Nm>patch</code> will reverse the hunk to see if it can be applied that way. If it can, you will be asked if you want to have the <code class=Fl>-R</code> option set. If it cannot, the patch will continue to be applied normally. (Note: this method cannot detect a reversed patch if it is a normal diff and if the first command is an append (i.e., it should have been a delete) since appends always succeed, due to the fact that a null context will match anywhere. Luckily, most patches add or change lines rather than delete them, so most reversed normal diffs will begin with a delete, which will fail, triggering the heuristic.)</p></dd><dt><a class=permalink href=#r><code class=Fl id=r>-r</code></a><var class=Ar>rej-name</var>, <code class=Fl>-</code><code class=Fl>-reject-file</code><var class=Ar>rej-name</var></dt><dd>Causes the next argument to be interpreted as the reject file name.</dd><dt><a class=permalink href=#s><code class=Fl id=s>-s</code></a>, <code class=Fl>-</code><code class=Fl>-quiet</code>, <code class=Fl>-</code><code class=Fl>-silent</code></dt><dd>Makes <code class=Nm>patch</code> do its work silently, unless an error occurs.</dd><dt><a class=permalink href=#t><code class=Fl id=t>-t</code></a>, <code class=Fl>-</code><code class=Fl>-batch</code></dt><dd>Similar to <code class=Fl>-f</code>, in that it suppresses questions, but makes some different assumptions: skip patches for which a file to patch cannot be found (the same as <code class=Fl>-f</code>); skip patches for which the file has the wrong version for the “Prereq”: line in the patch; and assume that patches are reversed if they look like they are.</dd><dt><a class=permalink href=#u><code class=Fl id=u>-u</code></a>, <code class=Fl>-</code><code class=Fl>-unified</code></dt><dd>Forces <code class=Nm>patch</code> to interpret the patch file as a unified context diff (a unidiff).</dd><dt><a class=permalink href=#V><code class=Fl id=V>-V</code></a><code class=Cm>t</code> | <a class=permalink href=#nil><code class=Cm id=nil>nil</code></a> | <a class=permalink href=#never><code class=Cm id=never>never</code></a> | <a class=permalink href=#none><code class=Cm id=none>none</code></a>, <code class=Fl>-</code><code class=Fl>-version-control</code><code class=Cm>t</code> | <a class=permalink href=#nil_2><code class=Cm id=nil_2>nil</code></a> | <a class=permalink href=#never_2><code class=Cm id=never_2>never</code></a> | <a class=permalink href=#none_2><code class=Cm id=none_2>none</code></a></dt><dd>Causes the next argument to be interpreted as a method for creating backup file names. The type of backups made can also be given in the <code class=Ev>PATCH_VERSION_CONTROL</code> or <code class=Ev>VERSION_CONTROL</code> environment variables, which are overridden by this option. The <code class=Fl>-B</code> option overrides this option, causing the prefix to always be used for making backup file names. The values of the <code class=Ev>PATCH_VERSION_CONTROL</code> and <code class=Ev>VERSION_CONTROL</code> environment variables and the argument to the <code class=Fl>-V</code> option are like the GNU Emacs “version-control” variable; they also recognize synonyms that are more descriptive. The valid values are (unique abbreviations are accepted): <div class=Bd-indent><dl class=Bl-tag><dt><a class=permalink href=#t_2><code class=Cm id=t_2>t</code></a>, <code class=Cm>numbered</code></dt><dd>Always make numbered backups.</dd><dt><a class=permalink href=#nil_3><code class=Cm id=nil_3>nil</code></a>, <code class=Cm>existing</code></dt><dd>Make numbered backups of files that already have them, simple backups of the others.</dd><dt><a class=permalink href=#never_3><code class=Cm id=never_3>never</code></a>, <code class=Cm>simple</code></dt><dd>Always make simple backups.</dd><dt><a class=permalink href=#none_3><code class=Cm id=none_3>none</code></a></dt><dd>Do not make backups.</dd></dl></div></dd><dt><a class=permalink href=#v><code class=Fl id=v>-v</code></a>, <code class=Fl>-</code><code class=Fl>-version</code></dt><dd>Causes <code class=Nm>patch</code> to print out its revision header and patch level.</dd><dt><a class=permalink href=#x><code class=Fl id=x>-x</code></a><var class=Ar>number</var>, <code class=Fl>-</code><code class=Fl>-debug</code><var class=Ar>number</var></dt><dd>Sets internal debugging flags, and is of interest only to <code class=Nm>patch</code> patchers.</dd><dt><a class=permalink href=#z><code class=Fl id=z>-z</code></a><var class=Ar>backup-ext</var>, <code class=Fl>-</code><code class=Fl>-suffix</code><var class=Ar>backup-ext</var></dt><dd>Causes the next argument to be interpreted as the backup extension, to be used in place of “.orig”.</dd><dt><code class=Fl>-</code><code class=Fl>-posix</code></dt><dd>Enables strict <span class=St>IEEE Std 1003.1-2008 (“POSIX.1”)</span> conformance, specifically: <ol class=Bl-enum><li>Backup files are not created unless the <code class=Fl>-b</code> option is specified.</li><li>If unspecified, the file name used is the first of the old, new and index files that exists.</li></ol></dd></dl><section class=Ss><h2 class=Ss id=Patch_Application><a class=permalink href=#Patch_Application>Patch Application</a></h2><code class=Nm>patch</code> will try to skip any leading garbage, apply the diff, and then skip any trailing garbage. Thus you could feed an article or message containing a diff listing to <code class=Nm>patch</code>, and it should work. If the entire diff is indented by a consistent amount, this will be taken into account. <p class=Pp>With context diffs, and to a lesser extent with normal diffs, <code class=Nm>patch</code> can detect when the line numbers mentioned in the patch are incorrect, and will attempt to find the correct place to apply each hunk of the patch. As a first guess, it takes the line number mentioned for the hunk, plus or minus any offset used in applying the previous hunk. If that is not the correct place, <code class=Nm>patch</code> will scan both forwards and backwards for a set of lines matching the context given in the hunk. First <code class=Nm>patch</code> looks for a place where all lines of the context match. If no such place is found, and it is a context diff, and the maximum fuzz factor is set to 1 or more, then another scan takes place ignoring the first and last line of context. If that fails, and the maximum fuzz factor is set to 2 or more, the first two and last two lines of context are ignored, and another scan is made. (The default maximum fuzz factor is 2).</p><p class=Pp>If <code class=Nm>patch</code> cannot find a place to install that hunk of the patch, it will put the hunk out to a reject file, which normally is the name of the output file plus “.rej”. (Note that the rejected hunk will come out in context diff form whether the input patch was a context diff or a normal diff. If the input was a normal diff, many of the contexts will simply be null.) The line numbers on the hunks in the reject file may be different than in the patch file: they reflect the approximate location patch thinks the failed hunks belong in the new file rather than the old one.</p><p class=Pp>As each hunk is completed, you will be told whether the hunk succeeded or failed, and which line (in the new file) <code class=Nm>patch</code> thought the hunk should go on. If this is different from the line number specified in the diff, you will be told the offset. A single large offset MAY be an indication that a hunk was installed in the wrong place. You will also be told if a fuzz factor was used to make the match, in which case you should also be slightly suspicious.</p></section><section class=Ss><h2 class=Ss id=Filename_Determination><a class=permalink href=#Filename_Determination>Filename Determination</a></h2> If no original file is specified on the command line, <code class=Nm>patch</code> will try to figure out from the leading garbage what the name of the file to edit is. When checking a prospective file name, pathname components are stripped as specified by the <code class=Fl>-p</code> option and the file's existence and writability are checked relative to the current working directory (or the directory specified by the <code class=Fl>-d</code> option). <p class=Pp>If the diff is a context or unified diff, <code class=Nm>patch</code> is able to determine the old and new file names from the diff header. For context diffs, the “old” file is specified in the line beginning with “***” and the “new” file is specified in the line beginning with “---”. For a unified diff, the “old” file is specified in the line beginning with “---” and the “new” file is specified in the line beginning with “+++”. If there is an “Index”: line in the leading garbage (regardless of the diff type), <code class=Nm>patch</code> will use the file name from that line as the “index” file.</p><p class=Pp><code class=Nm>patch</code> will choose the file name by performing the following steps, with the first match used:</p><ol class=Bl-enum><li>If <code class=Nm>patch</code> is operating in strict <span class=St>IEEE Std 1003.1-2008 (“POSIX.1”)</span> mode, the first of the “old”, “new” and “index” file names that exist is used. Otherwise, <code class=Nm>patch</code> will examine either the “old” and “new” file names or, for a non-context diff, the “index” file name, and choose the file name with the fewest path components, the shortest basename, and the shortest total file name length (in that order).</li><li>If no suitable file was found to patch, the patch file is a context or unified diff, and the old file was zero length, the new file name is created and used.</li><li>If the file name still cannot be determined, <code class=Nm>patch</code> will prompt the user for the file name to use.</li></ol><p class=Pp>Additionally, if the leading garbage contains a “Prereq: ” line, <code class=Nm>patch</code> will take the first word from the prerequisites line (normally a version number) and check the input file to see if that word can be found. If not, <code class=Nm>patch</code> will ask for confirmation before proceeding.</p><p class=Pp>The upshot of all this is that you should be able to say, while in a news interface, the following:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>| patch -d /usr/src/local/blurfl</code></div><p class=Pp>and patch a file in the blurfl directory directly from the article containing the patch.</p></section><section class=Ss><h2 class=Ss id=Backup_Files><a class=permalink href=#Backup_Files>Backup Files</a></h2> By default, the patched version is put in place of the original, with the original file backed up to the same name with the extension “.orig”, or as specified by the <code class=Fl>-B</code>, <code class=Fl>-V</code>, or <code class=Fl>-z</code> options. The extension used for making backup files may also be specified in the <code class=Ev>SIMPLE_BACKUP_SUFFIX</code> environment variable, which is overridden by the options above. <p class=Pp>If the backup file is a symbolic or hard link to the original file, <code class=Nm>patch</code> creates a new backup file name by changing the first lowercase letter in the last component of the file's name into uppercase. If there are no more lowercase letters in the name, it removes the first character from the name. It repeats this process until it comes up with a backup file that does not already exist or is not linked to the original file.</p><p class=Pp>You may also specify where you want the output to go with the <code class=Fl>-o</code> option; if that file already exists, it is backed up first.</p></section><section class=Ss><h2 class=Ss id=Notes_For_Patch_Senders><a class=permalink href=#Notes_For_Patch_Senders>Notes For Patch Senders</a></h2> There are several things you should bear in mind if you are going to be sending out patches: <p class=Pp>First, you can save people a lot of grief by keeping a <span class=Pa>patchlevel.h</span> file which is patched to increment the patch level as the first diff in the patch file you send out. If you put a “Prereq”: line in with the patch, it will not let them apply patches out of order without some warning.</p><p class=Pp>Second, make sure you have specified the file names right, either in a context diff header, or with an “Index”: line. If you are patching something in a subdirectory, be sure to tell the patch user to specify a <code class=Fl>-p</code> option as needed.</p><p class=Pp>Third, you can create a file by sending out a diff that compares a null file to the file you want to create. If the file you want to create already exists in the target directory when the diff is applied, then <code class=Nm>patch</code> will identify the patch as potentially reversed and offer to reverse the patch.</p><p class=Pp>Fourth, take care not to send out reversed patches, since it makes people wonder whether they already applied the patch.</p><p class=Pp>Fifth, while you may be able to get away with putting 582 diff listings into one file, it is probably wiser to group related patches into separate files in case something goes haywire.</p></section></section><section class=Sh><h2 class=Sh id=ENVIRONMENT><a class=permalink href=#ENVIRONMENT>ENVIRONMENT</a></h2><dl class="Bl-tag Bl-compact"><dt><a class=permalink href=#POSIXLY_CORRECT><code class=Ev id=POSIXLY_CORRECT>POSIXLY_CORRECT</code></a></dt><dd>When set, <code class=Nm>patch</code> behaves as if the <code class=Fl>-</code><code class=Fl>-posix</code> option has been specified.</dd><dt><a class=permalink href=#SIMPLE_BACKUP_SUFFIX><code class=Ev id=SIMPLE_BACKUP_SUFFIX>SIMPLE_BACKUP_SUFFIX</code></a></dt><dd>Extension to use for backup file names instead of “.orig”.</dd><dt><a class=permalink href=#TMPDIR><code class=Ev id=TMPDIR>TMPDIR</code></a></dt><dd>Directory to put temporary files in; default is <span class=Pa>/tmp</span>.</dd><dt><a class=permalink href=#PATCH_VERSION_CONTROL><code class=Ev id=PATCH_VERSION_CONTROL>PATCH_VERSION_CONTROL</code></a></dt><dd>Selects when numbered backup files are made.</dd><dt><a class=permalink href=#VERSION_CONTROL><code class=Ev id=VERSION_CONTROL>VERSION_CONTROL</code></a></dt><dd>Same as <code class=Ev>PATCH_VERSION_CONTROL</code>.</dd></dl></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><dl class="Bl-tag Bl-compact"><dt><span class=Pa>$TMPDIR/patch*</span></dt><dd><code class=Nm>patch</code> temporary files</dd><dt><span class=Pa>/dev/tty</span></dt><dd>used to read input when <code class=Nm>patch</code> prompts the user</dd></dl></section><section class=Sh><h2 class=Sh id=EXIT_STATUS><a class=permalink href=#EXIT_STATUS>EXIT STATUS</a></h2> The <code class=Nm>patch</code> utility exits with one of the following values: <p class=Pp></p><div class=Bd-indent><dl class="Bl-tag Bl-compact"><dt>0</dt><dd>Successful completion.</dd><dt>1</dt><dd>One or more lines were written to a reject file.</dd><dt>&gt;1</dt><dd>An error occurred.</dd></dl></div><p class=Pp>When applying a set of patches in a loop it behooves you to check this exit status so you do not apply a later patch to a partially patched file.</p></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2> Too many to list here, but generally indicative that <code class=Nm>patch</code> couldn't parse your patch file. <p class=Pp>The message “Hmm...” indicates that there is unprocessed text in the patch file and that <code class=Nm>patch</code> is attempting to intuit whether there is a patch in that text and, if so, what kind of patch it is.</p></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=diff.1.html>diff(1)</a></section><section class=Sh><h2 class=Sh id=STANDARDS><a class=permalink href=#STANDARDS>STANDARDS</a></h2> The <code class=Nm>patch</code> utility is compliant with the <span class=St>IEEE Std 1003.1-2008 (“POSIX.1”)</span> specification, except as detailed above for the <code class=Fl>--posix</code> option. <p class=Pp>The flags [<code class=Fl>-BCEFfstVvxz</code>] and [<code class=Fl>--posix</code>] are extensions to that specification.</p></section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Larry Wall</span> with many other contributors. </section><section class=Sh><h2 class=Sh id=CAVEATS><a class=permalink href=#CAVEATS>CAVEATS</a></h2><code class=Nm>patch</code> cannot tell if the line numbers are off in an ed script, and can only detect bad line numbers in a normal diff when it finds a “change” or a “delete” command. A context diff using fuzz factor 3 may have the same problem. Until a suitable interactive interface is added, you should probably do a context diff in these cases to see if the changes made sense. Of course, compiling without errors is a pretty good indication that the patch worked, but not always. <p class=Pp><code class=Nm>patch</code> usually produces the correct results, even when it has to do a lot of guessing. However, the results are guaranteed to be correct only when the patch is applied to exactly the same version of the file that the patch was generated from.</p></section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> Could be smarter about partial matches, excessively deviant offsets and swapped code, but that would take an extra pass. <p class=Pp>Check patch mode (<code class=Fl>-C</code>) will fail if you try to check several patches in succession that build on each other. The entire <code class=Nm>patch</code> code would have to be restructured to keep temporary files around so that it can handle this situation.</p><p class=Pp>If code has been duplicated (for instance with #ifdef OLDCODE ... #else ... #endif), <code class=Nm>patch</code> is incapable of patching both versions, and, if it works at all, will likely patch the wrong one, and tell you that it succeeded to boot.</p><p class=Pp>If you apply a patch you have already applied, <code class=Nm>patch</code> will think it is a reversed patch, and offer to un-apply the patch. This could be construed as a feature.</p></section></div><table class=foot><tr><td class=foot-date>November 3, 2019</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>