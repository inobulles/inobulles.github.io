<!DOCTYPE html>
<html><head><meta charset=utf-8><title>auditon(2)</title><keywords content=man,auditon></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>auditon(2)</h1><table class=head><tr><td class=head-ltitle>AUDITON(2)</td><td class=head-vol>FreeBSD System Calls Manual</td><td class=head-rtitle>AUDITON(2)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>auditon</code> — <div class=Nd>configure system audit parameters</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/bsm/audit.h.html>bsm/audit.h</a>&gt;</code><p class=Pp><var class=Ft>int</var><br><code class=Fn>auditon</code>(<var class=Fa style="white-space: nowrap;">int cmd</var>, <var class=Fa style="white-space: nowrap;">void *data</var>, <var class=Fa style="white-space: nowrap;">u_int length</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Fn>auditon</code>() system call is used to manipulate various audit control operations. The <var class=Fa>data</var> argument should point to a structure whose type depends on the command. The <var class=Fa>length</var> argument specifies the size of <var class=Fa>*data</var> in bytes. The <var class=Fa>cmd</var> argument may be any of the following: <dl class=Bl-tag><dt><a class=permalink href=#A_SETPOLICY><code class=Dv id=A_SETPOLICY>A_SETPOLICY</code></a></dt><dd>Set audit policy flags. The <var class=Fa>data</var> argument must point to a <var class=Vt>int</var> value set to one or more the following audit policy control values bitwise OR'ed together: <code class=Dv>AUDIT_CNT</code>, <code class=Dv>AUDIT_AHLT</code>, <code class=Dv>AUDIT_ARGV</code>, and <code class=Dv>AUDIT_ARGE</code>. If <code class=Dv>AUDIT_CNT is set, the system will continue even if it becomes low</code> on space and discontinue logging events until the low space condition is remedied. If it is not set, audited events will block until the low space condition is remedied. Unaudited events, however, are unaffected. If <code class=Dv>AUDIT_AHLT is set, a</code><a class=Xr href=panic.9.html>panic(9)</a> if it cannot write an event to the global audit log file. If <code class=Dv>AUDIT_ARGV</code> is set, then the argument list passed to the <a class=Xr href=execve.2.html>execve(2)</a> system call will be audited. If <code class=Dv>AUDIT_ARGE</code> is set, then the environment variables passed to the <a class=Xr href=execve.2.html>execve(2)</a> system call will be audited. The default policy is none of the audit policy control flags set.</dd><dt><a class=permalink href=#A_SETKAUDIT><code class=Dv id=A_SETKAUDIT>A_SETKAUDIT</code></a></dt><dd>Set the host information. The <var class=Fa>data</var> argument must point to a <var class=Vt>auditinfo_addr_t</var> structure containing the host IP address information. After setting, audit records that are created as a result of kernel events will contain this information.</dd><dt><a class=permalink href=#A_SETKMASK><code class=Dv id=A_SETKMASK>A_SETKMASK</code></a></dt><dd>Set the kernel preselection masks (success and failure). The <var class=Fa>data</var> argument must point to a <var class=Vt>au_mask_t</var> structure containing the mask values as defined in <code class=In>&lt;<a class=In href=../src/bsm/audit.h.html>bsm/audit.h</a>&gt;</code>. These masks are used for non-attributable audit event preselection. The field <var class=Fa>am_success</var> specifies which classes of successful audit events are to be logged to the audit trail. The field <var class=Fa>am_failure</var> specifies which classes of failed audit events are to be logged. The value of both fields is the bitwise OR'ing of the audit event classes specified in <var class=Fa>bsm/audit.h</var>. The various audit classes are described more fully in <a class=Xr href=audit_class.5.html>audit_class(5)</a>.</dd><dt><a class=permalink href=#A_SETQCTRL><code class=Dv id=A_SETQCTRL>A_SETQCTRL</code></a></dt><dd>Set kernel audit queue parameters. The <var class=Fa>data</var> argument must point to a <var class=Vt>au_qctrl_t</var> structure (defined in <code class=In>&lt;<a class=In href=../src/bsm/audit.h.html>bsm/audit.h</a>&gt;</code>) containing the kernel audit queue control settings: <var class=Fa>aq_hiwater</var>, <var class=Fa>aq_lowater</var>, <var class=Fa>aq_bufsz</var>, <var class=Fa>aq_delay</var>, and <var class=Fa>aq_minfree</var>. The field <var class=Fa>aq_hiwater</var> defines the maximum number of audit record entries in the queue used to store the audit records ready for delivery to disk. New records are inserted at the tail of the queue and removed from the head. For new records which would exceed the high water mark, the calling thread is inserted into the wait queue, waiting for the audit queue to have enough space available as defined with the field <var class=Fa>aq_lowater</var>. The field <var class=Fa>aq_bufsz</var> defines the maximum length of the audit record that can be supplied with <a class=Xr href=audit.2.html>audit(2)</a>. The field <var class=Fa>aq_delay</var> is unused. The field <var class=Fa>aq_minfree</var> specifies the minimum amount of free blocks on the disk device used to store audit records. If the value of free blocks falls below the configured minimum amount, the kernel informs the audit daemon about low disk space. The value is to be specified in percent of free file system blocks. A value of 0 results in a disabling of the check. The default and maximum values (default/maximum) for the audit queue control parameters are: <p class=Pp></p><table class="Bl-column Bd-indent Bl-compact"><tr><td>aq_hiwater</td><td>100/10000 (audit records)</td></tr><tr><td>aq_lowater</td><td>10/aq_hiwater (audit records)</td></tr><tr><td>aq_bufsz</td><td>32767/1048576 (bytes)</td></tr><tr><td>aq_delay</td><td>(Not currently used.)</td></tr></table></dd><dt><a class=permalink href=#A_SETSTAT><code class=Dv id=A_SETSTAT>A_SETSTAT</code></a></dt><dd>Return <code class=Er>ENOSYS</code>. (Not implemented.)</dd><dt><a class=permalink href=#A_SETUMASK><code class=Dv id=A_SETUMASK>A_SETUMASK</code></a></dt><dd>Return <code class=Er>ENOSYS</code>. (Not implemented.)</dd><dt><a class=permalink href=#A_SETSMASK><code class=Dv id=A_SETSMASK>A_SETSMASK</code></a></dt><dd>Return <code class=Er>ENOSYS</code>. (Not implemented.)</dd><dt><a class=permalink href=#A_SETCOND><code class=Dv id=A_SETCOND>A_SETCOND</code></a></dt><dd>Set the current auditing condition. The <var class=Fa>data</var> argument must point to a <var class=Vt>int</var> value containing the new audit condition, one of <code class=Dv>AUC_AUDITING</code>, <code class=Dv>AUC_NOAUDIT</code>, or <code class=Dv>AUC_DISABLED</code>. If <code class=Dv>AUC_NOAUDIT</code> is set, then auditing is temporarily suspended. If <code class=Dv>AUC_AUDITING</code> is set, auditing is resumed. If <code class=Dv>AUC_DISABLED</code> is set, the auditing system will shutdown, draining all audit records and closing out the audit trail file.</dd><dt><a class=permalink href=#A_SETCLASS><code class=Dv id=A_SETCLASS>A_SETCLASS</code></a></dt><dd>Set the event class preselection mask for an audit event. The <var class=Fa>data</var> argument must point to a <var class=Vt>au_evclass_map_t</var> structure containing the audit event and mask. The field <var class=Fa>ec_number</var> is the audit event and <var class=Fa>ec_class</var> is the audit class mask. See <a class=Xr href=audit_event.5.html>audit_event(5)</a> for more information on audit event to class mapping.</dd><dt><a class=permalink href=#A_SETPMASK><code class=Dv id=A_SETPMASK>A_SETPMASK</code></a></dt><dd>Set the preselection masks for a process. The <var class=Fa>data</var> argument must point to a <var class=Vt>auditpinfo_t</var> structure that contains the given process's audit preselection masks for both success and failure. The field <var class=Fa>ap_pid</var> is the process id of the target process. The field <var class=Fa>ap_mask</var> must point to a <var class=Fa>au_mask_t</var> structure which holds the preselection masks as described in the <code class=Dv>A_SETKMASK</code> section above.</dd><dt><a class=permalink href=#A_SETFSIZE><code class=Dv id=A_SETFSIZE>A_SETFSIZE</code></a></dt><dd>Set the maximum size of the audit log file. The <var class=Fa>data</var> argument must point to a <var class=Vt>au_fstat_t</var> structure with the <var class=Va>af_filesz</var> field set to the maximum audit log file size. A value of 0 indicates no limit to the size.</dd><dt><a class=permalink href=#A_GETCLASS><code class=Dv id=A_GETCLASS>A_GETCLASS</code></a></dt><dd>Return the event to class mapping for the designated audit event. The <var class=Fa>data</var> argument must point to a <var class=Vt>au_evclass_map_t</var> structure. See the <code class=Dv>A_SETCLASS</code> section above for more information.</dd><dt><a class=permalink href=#A_GETKAUDIT><code class=Dv id=A_GETKAUDIT>A_GETKAUDIT</code></a></dt><dd>Get the current host information. The <var class=Fa>data</var> argument must point to a <var class=Vt>auditinfo_addr_t</var> structure.</dd><dt><a class=permalink href=#A_GETPINFO><code class=Dv id=A_GETPINFO>A_GETPINFO</code></a></dt><dd>Return the audit settings for a process. The <var class=Fa>data</var> argument must point to a <var class=Vt>auditpinfo_t</var> structure which will be set to contain <var class=Fa>ap_auid</var> (the audit ID), <var class=Fa>ap_mask</var> (the preselection mask), <var class=Fa>ap_termid</var> (the terminal ID), and <var class=Fa>ap_asid</var> (the audit session ID) of the given target process. The process ID of the target process is passed into the kernel using the <var class=Fa>ap_pid</var> field. See the section <code class=Dv>A_SETPMASK</code> above and <a class=Xr href=getaudit.2.html>getaudit(2)</a> for more information.</dd><dt><a class=permalink href=#A_GETPINFO_ADDR><code class=Dv id=A_GETPINFO_ADDR>A_GETPINFO_ADDR</code></a></dt><dd>Return the extended audit settings for a process. The <var class=Fa>data</var> argument must point to a <var class=Vt>auditpinfo_addr_t</var> structure which is similar to the <var class=Vt>auditpinfo_t</var> structure described above. The exception is the <var class=Fa>ap_termid</var> (the terminal ID) field which points to a <var class=Vt>au_tid_addr_t</var> structure can hold much a larger terminal address and an address type. The process ID of the target process is passed into the kernel using the <var class=Fa>ap_pid</var> field. See the section <code class=Dv>A_SETPMASK</code> above and <a class=Xr href=getaudit.2.html>getaudit(2)</a> for more information.</dd><dt><a class=permalink href=#A_GETSINFO_ADDR><code class=Dv id=A_GETSINFO_ADDR>A_GETSINFO_ADDR</code></a></dt><dd>Return the extended audit settings for a session. The <var class=Fa>data</var> argument must point to a <var class=Vt>auditinfo_addr_t</var> structure. The audit session ID of the target session is passed into the kernel using the <var class=Fa>ai_asid</var> field. See <a class=Xr href=getaudit_addr.2.html>getaudit_addr(2)</a> for more information about the <var class=Vt>auditinfo_addr_t</var> structure.</dd><dt><a class=permalink href=#A_GETKMASK><code class=Dv id=A_GETKMASK>A_GETKMASK</code></a></dt><dd>Return the current kernel preselection masks. The <var class=Fa>data</var> argument must point to a <var class=Vt>au_mask_t</var> structure which will be set to the current kernel preselection masks for non-attributable events.</dd><dt><a class=permalink href=#A_GETPOLICY><code class=Dv id=A_GETPOLICY>A_GETPOLICY</code></a></dt><dd>Return the current audit policy setting. The <var class=Fa>data</var> argument must point to a <var class=Vt>int</var> value which will be set to one of the current audit policy flags. The audit policy flags are described in the <code class=Dv>A_SETPOLICY</code> section above.</dd><dt><a class=permalink href=#A_GETQCTRL><code class=Dv id=A_GETQCTRL>A_GETQCTRL</code></a></dt><dd>Return the current kernel audit queue control parameters. The <var class=Fa>data</var> argument must point to a <var class=Vt>au_qctrl_t</var> structure which will be set to the current kernel audit queue control parameters. See the <code class=Dv>A_SETQCTL</code> section above for more information.</dd><dt><a class=permalink href=#A_GETFSIZE><code class=Dv id=A_GETFSIZE>A_GETFSIZE</code></a></dt><dd>Returns the maximum size of the audit log file. The <var class=Fa>data</var> argument must point to a <var class=Vt>au_fstat_t</var> structure. The <var class=Va>af_filesz</var> field will be set to the maximum audit log file size. A value of 0 indicates no limit to the size. The <var class=Va>af_currsz</var> field will be set to the current audit log file size.</dd><dt><a class=permalink href=#A_GETCWD><code class=Dv id=A_GETCWD>A_GETCWD</code></a></dt><dd>Return <code class=Er>ENOSYS</code>. (Not implemented.)</dd><dt><a class=permalink href=#A_GETCAR><code class=Dv id=A_GETCAR>A_GETCAR</code></a></dt><dd>Return <code class=Er>ENOSYS</code>. (Not implemented.)</dd><dt><a class=permalink href=#A_GETSTAT><code class=Dv id=A_GETSTAT>A_GETSTAT</code></a></dt><dd>Return <code class=Er>ENOSYS</code>. (Not implemented.)</dd><dt><a class=permalink href=#A_GETCOND><code class=Dv id=A_GETCOND>A_GETCOND</code></a></dt><dd>Return the current auditing condition. The <var class=Fa>data</var> argument must point to a <var class=Vt>int</var> value which will be set to the current audit condition, one of <code class=Dv>AUC_AUDITING</code>, <code class=Dv>AUC_NOAUDIT</code> or <code class=Dv>AUC_DISABLED</code>. See the <code class=Dv>A_SETCOND</code> section above for more information.</dd><dt><a class=permalink href=#A_SENDTRIGGER><code class=Dv id=A_SENDTRIGGER>A_SENDTRIGGER</code></a></dt><dd>Send a trigger to the audit daemon. The <var class=Fa>data</var> argument must point to a <var class=Vt>int</var> value set to one of the acceptable trigger values: <code class=Dv>AUDIT_TRIGGER_LOW_SPACE</code> (low disk space where the audit log resides), <code class=Dv>AUDIT_TRIGGER_OPEN_NEW</code> (open a new audit log file), <code class=Dv>AUDIT_TRIGGER_READ_FILE</code> (read the <span class=Pa>audit_control</span> file), <code class=Dv>AUDIT_TRIGGER_CLOSE_AND_DIE</code> (close the current log file and exit), <code class=Dv>AUDIT_TRIGGER_NO_SPACE</code> (no disk space left for audit log file). <code class=Dv>AUDIT_TRIGGER_ROTATE_USER</code> (request audit log file rotation). <code class=Dv>AUDIT_TRIGGER_INITIALIZE</code> (initialize audit subsystem for Mac OS X only). or <code class=Dv>AUDIT_TRIGGER_EXPIRE_TRAILS</code> (request audit log file expiration).</dd></dl></section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2> Upon successful completion, the value 0 is returned; otherwise the value -1 is returned and the global variable <var class=Va>errno</var> is set to indicate the error. </section><section class=Sh><h2 class=Sh id=ERRORS><a class=permalink href=#ERRORS>ERRORS</a></h2> The <code class=Fn>auditon</code>() function will fail if: <dl class=Bl-tag><dt>[<a class=permalink href=#ENOSYS><code class=Er id=ENOSYS>ENOSYS</code></a>]</dt><dd>Returned by options not yet implemented.</dd><dt>[<a class=permalink href=#EFAULT><code class=Er id=EFAULT>EFAULT</code></a>]</dt><dd>A failure occurred while data transferred to or from the kernel failed.</dd><dt>[<a class=permalink href=#EINVAL><code class=Er id=EINVAL>EINVAL</code></a>]</dt><dd>Illegal argument was passed by a system call.</dd><dt>[<a class=permalink href=#EPERM><code class=Er id=EPERM>EPERM</code></a>]</dt><dd>The process does not have sufficient permission to complete the operation.</dd></dl><p class=Pp>The <code class=Dv>A_SENDTRIGGER</code> command is specific to the <span class=Ux>FreeBSD</span> and Mac OS X implementations, and is not present in Solaris.</p></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=audit.2.html>audit(2)</a>, <a class=Xr href=auditctl.2.html>auditctl(2)</a>, <a class=Xr href=getaudit.2.html>getaudit(2)</a>, <a class=Xr href=getaudit_addr.2.html>getaudit_addr(2)</a>, <a class=Xr href=getauid.2.html>getauid(2)</a>, <a class=Xr href=setaudit.2.html>setaudit(2)</a>, <a class=Xr href=setaudit_addr.2.html>setaudit_addr(2)</a>, <a class=Xr href=setauid.2.html>setauid(2)</a>, <a class=Xr href=libbsm.3.html>libbsm(3)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The OpenBSM implementation was created by McAfee Research, the security division of McAfee Inc., under contract to Apple Computer Inc. in 2004. It was subsequently adopted by the TrustedBSD Project as the foundation for the OpenBSM distribution. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> This software was created by McAfee Research, the security research division of McAfee, Inc., under contract to Apple Computer Inc. Additional authors include <span class=An>Wayne Salamon</span>, <span class=An>Robert Watson</span>, and SPARTA Inc. <p class=Pp>The Basic Security Module (BSM) interface to audit records and audit event stream format were defined by Sun Microsystems.</p><p class=Pp>This manual page was written by <span class=An>Tom Rhodes</span> ⟨trhodes@FreeBSD.org⟩, <span class=An>Robert Watson</span> ⟨rwatson@FreeBSD.org⟩, and <span class=An>Wayne Salamon</span> ⟨wsalamon@FreeBSD.org⟩.</p></section></div><table class=foot><tr><td class=foot-date>April 7, 2016</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>