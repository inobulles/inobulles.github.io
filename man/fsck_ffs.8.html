<!DOCTYPE html>
<html><head><meta charset=utf-8><title>fsck_ffs(8)</title><keywords content=man,fsck_ffs></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>fsck_ffs(8)</h1><table class=head><tr><td class=head-ltitle>FSCK_FFS(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>FSCK_FFS(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>fsck_ffs</code>, <code class=Nm>fsck_ufs</code> — <div class=Nd>file system consistency check and interactive repair</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>fsck_ffs</code></td><td>[<code class=Fl>-BCdEFfnpRrSyZz</code>] [<code class=Fl>-b</code><var class=Ar>block</var>] [<code class=Fl>-c</code><var class=Ar>level</var>] [<code class=Fl>-m</code><var class=Ar>mode</var>] <var class=Ar>filesystem</var><var class=Ar>...</var></td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The specified disk partitions and/or file systems are checked. In "preen" or "check clean" mode the clean flag of each file system's superblock is examined and only those file systems that are not marked clean are checked. File systems are marked clean when they are unmounted, when they have been mounted read-only, or when <code class=Nm>fsck_ffs</code> runs on them successfully. If the <code class=Fl>-f</code> option is specified, the file systems will be checked regardless of the state of their clean flag. <p class=Pp>The kernel takes care that only a restricted class of innocuous file system inconsistencies can happen unless hardware or software failures intervene. These are limited to the following:</p><p class=Pp></p><ul class="Bl-item Bd-indent Bl-compact"><li>Unreferenced inodes</li><li>Link counts in inodes too large</li><li>Missing blocks in the free map</li><li>Blocks in the free map also in files</li><li>Counts in the super-block wrong</li></ul><p class=Pp>These are the only inconsistencies that <code class=Nm>fsck_ffs</code> with the <code class=Fl>-p</code> option will correct; if it encounters other inconsistencies, it exits with an abnormal return status and an automatic reboot will then fail. For each corrected inconsistency one or more lines will be printed identifying the file system on which the correction will take place, and the nature of the correction. After successfully correcting a file system, <code class=Nm>fsck_ffs</code> will print the number of files on that file system, the number of used and free blocks, and the percentage of fragmentation.</p><p class=Pp>If sent a <code class=Dv>QUIT</code> signal, <code class=Nm>fsck_ffs</code> will finish the file system checks, then exit with an abnormal return status that causes an automatic reboot to fail. This is useful when you want to finish the file system checks during an automatic reboot, but do not want the machine to come up multiuser after the checks complete.</p><p class=Pp>If <code class=Nm>fsck_ffs</code> receives a <code class=Dv>SIGINFO</code> (see the “status” argument for <a class=Xr href=stty.1.html>stty(1)</a>) signal, a line will be written to the standard output indicating the name of the device currently being checked, the current phase number and phase-specific progress information.</p><p class=Pp>Without the <code class=Fl>-p</code> option, <code class=Nm>fsck_ffs</code> audits and interactively repairs inconsistent conditions for file systems. If the file system is inconsistent the operator is prompted for concurrence before each correction is attempted. It should be noted that some of the corrective actions which are not correctable under the <code class=Fl>-p</code> option will result in some loss of data. The amount and severity of data lost may be determined from the diagnostic output. The default action for each consistency correction is to wait for the operator to respond <code class=Li>yes</code> or <code class=Li>no</code>. If the operator does not have write permission on the file system <code class=Nm>fsck_ffs</code> will default to a <code class=Fl>-n</code> action.</p><p class=Pp>The following flags are interpreted by <code class=Nm>fsck_ffs</code>:</p><dl class=Bl-tag><dt><a class=permalink href=#B><code class=Fl id=B>-B</code></a></dt><dd>A check is done on the specified and possibly active file system. The set of corrections that can be done is limited to those done when running in preen mode (see the <code class=Fl>-p</code> flag). If unexpected errors are found, the file system is marked as needing a foreground check and <code class=Nm>fsck_ffs</code> exits without attempting any further cleaning.</dd><dt><a class=permalink href=#b><code class=Fl id=b>-b</code></a></dt><dd>Use the block specified immediately after the flag as the super block for the file system. An alternate super block is usually located at block 32 for UFS1, and block 192 for UFS2. <p class=Pp>See the <code class=Fl>-N</code> flag of <a class=Xr href=newfs.8.html>newfs(8)</a>.</p></dd><dt><a class=permalink href=#C><code class=Fl id=C>-C</code></a></dt><dd>Check if file system was dismounted cleanly. If so, skip file system checks (like "preen"). However, if the file system was not cleanly dismounted, do full checks, as if <code class=Nm>fsck_ffs</code> was invoked without <code class=Fl>-C</code>.</dd><dt><a class=permalink href=#c><code class=Fl id=c>-c</code></a></dt><dd>Convert the file system to the specified level. Note that the level of a file system can only be raised. There are currently four levels defined: <dl class=Bl-tag><dt>0</dt><dd>The file system is in the old (static table) format.</dd><dt>1</dt><dd>The file system is in the new (dynamic table) format.</dd><dt>2</dt><dd>The file system supports 32-bit uid's and gid's, short symbolic links are stored in the inode, and directories have an added field showing the file type.</dd><dt>3</dt><dd>If maxcontig is greater than one, build the free segment maps to aid in finding contiguous sets of blocks. If maxcontig is equal to one, delete any existing segment maps.</dd></dl><p class=Pp>In interactive mode, <code class=Nm>fsck_ffs</code> will list the conversion to be made and ask whether the conversion should be done. If a negative answer is given, no further operations are done on the file system. In preen mode, the conversion is listed and done if possible without user interaction. Conversion in preen mode is best used when all the file systems are being converted at once. The format of a file system can be determined from the first line of output from <a class=Xr href=dumpfs.8.html>dumpfs(8)</a>.</p><p class=Pp>This option implies the <code class=Fl>-f</code> flag.</p></dd><dt><a class=permalink href=#d><code class=Fl id=d>-d</code></a></dt><dd>Enable debugging messages.</dd><dt><a class=permalink href=#E><code class=Fl id=E>-E</code></a></dt><dd>Clear unallocated blocks, notifying the underlying device that they are not used and that their contents may be discarded. This is useful for filesystems which have been mounted on systems without TRIM support, or with TRIM support disabled, as well as filesystems which have been copied from one device to another. <p class=Pp>See the <code class=Fl>-E</code> and <code class=Fl>-t</code> flags of <a class=Xr href=newfs.8.html>newfs(8)</a>, and the <code class=Fl>-t</code> flag of <a class=Xr href=tunefs.8.html>tunefs(8)</a>.</p></dd><dt><a class=permalink href=#F><code class=Fl id=F>-F</code></a></dt><dd>Determine whether the file system needs to be cleaned immediately in foreground, or if its cleaning can be deferred to background. To be eligible for background cleaning it must have been running with soft updates, not have been marked as needing a foreground check, and be mounted and writable when the background check is to be done. If these conditions are met, then <code class=Nm>fsck_ffs</code> exits with a zero exit status. Otherwise it exits with a non-zero exit status. If the file system is clean, it will exit with a non-zero exit status so that the clean status of the file system can be verified and reported during the foreground checks. Note that when invoked with the <code class=Fl>-F</code> flag, no cleanups are done. The only thing that <code class=Nm>fsck_ffs</code> does is to determine whether a foreground or background check is needed and exit with an appropriate status code.</dd><dt><a class=permalink href=#f><code class=Fl id=f>-f</code></a></dt><dd>Force <code class=Nm>fsck_ffs</code> to check ‘clean’ file systems when preening.</dd><dt><a class=permalink href=#m><code class=Fl id=m>-m</code></a></dt><dd>Use the mode specified in octal immediately after the flag as the permission bits to use when creating the <span class=Pa>lost+found</span> directory rather than the default 1777. In particular, systems that do not wish to have lost files accessible by all users on the system should use a more restrictive set of permissions such as 700.</dd><dt><a class=permalink href=#n><code class=Fl id=n>-n</code></a></dt><dd>Assume a no response to all questions asked by <code class=Nm>fsck_ffs</code> except for ‘<code class=Li>CONTINUE?</code>’, which is assumed to be affirmative; do not open the file system for writing.</dd><dt><a class=permalink href=#p><code class=Fl id=p>-p</code></a></dt><dd>Preen file systems (see above).</dd><dt><a class=permalink href=#R><code class=Fl id=R>-R</code></a></dt><dd>Instruct fsck_ffs to restart itself if it encounters certain errors that warrant another run. It will limit itself to a maximum of 10 restarts in a given run in order to avoid an endless loop with extremely corrupted filesystems.</dd><dt><a class=permalink href=#r><code class=Fl id=r>-r</code></a></dt><dd>Free up excess unused inodes. Decreasing the number of preallocated inodes reduces the running time of future runs of <code class=Nm>fsck_ffs</code> and frees up space that can allocated to files. The <code class=Fl>-r</code> option is ignored when running in preen mode.</dd><dt><a class=permalink href=#S><code class=Fl id=S>-S</code></a></dt><dd>Surrender on error. With this flag enabled, a hard error returned on disk i/o will cause <code class=Nm>fsck_ffs</code> to abort instead of continuing on and possibly tripping over more i/o errors.</dd><dt><a class=permalink href=#y><code class=Fl id=y>-y</code></a></dt><dd>Assume a yes response to all questions asked by <code class=Nm>fsck_ffs</code>; this should be used with great caution as this is a free license to continue after essentially unlimited trouble has been encountered.</dd><dt><a class=permalink href=#Z><code class=Fl id=Z>-Z</code></a></dt><dd>Similar to <code class=Fl>-E</code>, but overwrites unused blocks with zeroes. If both <code class=Fl>-E</code> and <code class=Fl>-Z</code> are specified, blocks are first zeroed and then erased.</dd><dt><a class=permalink href=#z><code class=Fl id=z>-z</code></a></dt><dd>Clear unused directory space. The cleared space includes deleted file names and name padding.</dd></dl><p class=Pp>Inconsistencies checked are as follows:</p><p class=Pp></p><ol class="Bl-enum Bl-compact"><li>Blocks claimed by more than one inode or the free map.</li><li>Blocks claimed by an inode outside the range of the file system.</li><li>Incorrect link counts.</li><li>Size checks: <ul class="Bl-item Bd-indent Bl-compact"><li>Directory size not a multiple of DIRBLKSIZ.</li><li>Partially truncated file.</li></ul></li><li>Bad inode format.</li><li>Blocks not accounted for anywhere.</li><li>Directory checks: <ul class="Bl-item Bd-indent Bl-compact"><li>File pointing to unallocated inode.</li><li>Inode number out of range.</li><li>Directories with unallocated blocks (holes).</li><li>Dot or dot-dot not the first two entries of a directory or having the wrong inode number.</li></ul></li><li>Super Block checks: <ul class="Bl-item Bd-indent Bl-compact"><li>More blocks for inodes than there are in the file system.</li><li>Bad free block map format.</li><li>Total free block and/or free inode count incorrect.</li></ul></li></ol><p class=Pp>Orphaned files and directories (allocated but unreferenced) are, with the operator's concurrence, reconnected by placing them in the <span class=Pa>lost+found</span> directory. The name assigned is the inode number. If the <span class=Pa>lost+found</span> directory does not exist, it is created. If there is insufficient space its size is increased.</p><p class=Pp>The full foreground <code class=Nm>fsck_ffs</code> checks for many more problems that may occur after an unrecoverable disk write error. Thus, it is recommended that you perform foreground <code class=Nm>fsck_ffs</code> on your systems periodically and whenever you encounter unrecoverable disk write errors or file-system-related panics.</p></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><dl class="Bl-tag Bl-compact"><dt><span class=Pa>/etc/fstab</span></dt><dd>contains default list of file systems to check.</dd></dl></section><section class=Sh><h2 class=Sh id=EXIT_STATUS><a class=permalink href=#EXIT_STATUS>EXIT STATUS</a></h2> The <code class=Nm>fsck_ffs</code> utility exits 0 on success, and &gt;0 if an error occurs. <p class=Pp>Specific non-zero exit status values used are:</p><dl class=Bl-tag><dt>1</dt><dd>Usage error (missing or invalid command arguments).</dd><dt>2</dt><dd>The <code class=Fl>-p</code> option was used and a <code class=Dv>SIGQUIT</code> was received, indicating that the system should be returned to single user mode after the file system check.</dd><dt>3</dt><dd>The file system superblock cannot be read. This could indicate that the file system device does not exist or is not yet ready.</dd><dt>4</dt><dd>A mounted file system was modified; the system should be rebooted.</dd><dt>5</dt><dd>The <code class=Fl>-B</code> option was used and soft updates are not enabled on the file system.</dd><dt>6</dt><dd>The <code class=Fl>-B</code> option was used and the kernel lacks needed support.</dd><dt>7</dt><dd>The <code class=Fl>-F</code> option was used and the file system is clean.</dd><dt>8</dt><dd>General error exit.</dd><dt>16</dt><dd>The file system could not be completely repaired. The file system may be able to be repaired by running <code class=Nm>fsck_ffs</code> on the file system again.</dd></dl></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2> The diagnostics produced by <code class=Nm>fsck_ffs</code> are fully enumerated and explained in Appendix A of <cite class=Rs><span class=RsT>Fsck - The UNIX File System Check Program</span>.</cite></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=fs.5.html>fs(5)</a>, <a class=Xr href=fstab.5.html>fstab(5)</a>, <a class=Xr href=fsck.8.html>fsck(8)</a>, <a class=Xr href=fsdb.8.html>fsdb(8)</a>, <a class=Xr href=newfs.8.html>newfs(8)</a>, <a class=Xr href=reboot.8.html>reboot(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> A <code class=Nm>fsck</code> utility appeared in <span class=Ux>4.0BSD</span>. It became <code class=Nm>fsck_ffs</code> in <span class=Ux>FreeBSD 5.0</span> with the introduction of the filesystem independent wrapper as <code class=Nm>fsck</code>. </section></div><table class=foot><tr><td class=foot-date>May 3, 2019</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>