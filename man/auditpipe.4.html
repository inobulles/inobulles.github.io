<!DOCTYPE html>
<html><head><meta charset=utf-8><title>auditpipe(4)</title><keywords content=man,auditpipe></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>auditpipe(4)</h1><table class=head><tr><td class=head-ltitle>AUDITPIPE(4)</td><td class=head-vol>FreeBSD Kernel Interfaces Manual</td><td class=head-rtitle>AUDITPIPE(4)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>auditpipe</code> — <div class=Nd>pseudo-device for live audit event tracking</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=Cd>options AUDIT</code></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> While audit trail files generated with <a class=Xr href=audit.4.html>audit(4)</a> and maintained by <a class=Xr href=auditd.8.html>auditd(8)</a> provide a reliable long-term store for audit log information, current log files are owned by the audit daemon until terminated making them somewhat unwieldy for live monitoring applications such as host-based intrusion detection. For example, the log may be cycled and new records written to a new file without notice to applications that may be accessing the file. <p class=Pp>The audit facility provides an audit pipe facility for applications requiring direct access to live BSM audit data for the purposes of real-time monitoring. Audit pipes are available via a clonable special device, <span class=Pa>/dev/auditpipe</span>, subject to the permissions on the device node, and provide a “tee” of the audit event stream. As the device is clonable, more than one instance of the device may be opened at a time; each device instance will provide independent access to all records.</p><p class=Pp>The audit pipe device provides discrete BSM audit records; if the read buffer passed by the application is too small to hold the next record in the sequence, it will be dropped. Unlike audit data written to the audit trail, the reliability of record delivery is not guaranteed. In particular, when an audit pipe queue fills, records will be dropped. Audit pipe devices are blocking by default, but support non-blocking I/O, asynchronous I/O using <code class=Dv>SIGIO</code>, and polled operation via <a class=Xr href=select.2.html>select(2)</a> and <a class=Xr href=poll.2.html>poll(2)</a>.</p><p class=Pp>Applications may choose to track the global audit trail, or configure local preselection parameters independent of the global audit trail parameters.</p><section class=Ss><h2 class=Ss id=Audit_Pipe_Queue_Ioctls><a class=permalink href=#Audit_Pipe_Queue_Ioctls>Audit Pipe Queue Ioctls</a></h2> The following ioctls retrieve and set various audit pipe record queue properties: <dl class=Bl-tag><dt><a class=permalink href=#AUDITPIPE_GET_QLEN><code class=Dv id=AUDITPIPE_GET_QLEN>AUDITPIPE_GET_QLEN</code></a></dt><dd>Query the current number of records available for reading on the pipe.</dd><dt><a class=permalink href=#AUDITPIPE_GET_QLIMIT><code class=Dv id=AUDITPIPE_GET_QLIMIT>AUDITPIPE_GET_QLIMIT</code></a></dt><dd>Retrieve the current maximum number of records that may be queued for reading on the pipe.</dd><dt><a class=permalink href=#AUDITPIPE_SET_QLIMIT><code class=Dv id=AUDITPIPE_SET_QLIMIT>AUDITPIPE_SET_QLIMIT</code></a></dt><dd>Set the current maximum number of records that may be queued for reading on the pipe. The new limit must fall between the queue limit minimum and queue limit maximum queryable using the following two ioctls.</dd><dt><a class=permalink href=#AUDITPIPE_GET_QLIMIT_MIN><code class=Dv id=AUDITPIPE_GET_QLIMIT_MIN>AUDITPIPE_GET_QLIMIT_MIN</code></a></dt><dd>Query the lowest possible maximum number of records that may be queued for reading on the pipe.</dd><dt><a class=permalink href=#AUDITPIPE_GET_QLIMIT_MAX><code class=Dv id=AUDITPIPE_GET_QLIMIT_MAX>AUDITPIPE_GET_QLIMIT_MAX</code></a></dt><dd>Query the highest possible maximum number of records that may be queued for reading on the pipe.</dd><dt><a class=permalink href=#AUDITPIPE_FLUSH><code class=Dv id=AUDITPIPE_FLUSH>AUDITPIPE_FLUSH</code></a></dt><dd>Flush all outstanding records on the audit pipe; useful after setting initial preselection properties to delete records queued during the configuration process which may not match the interests of the user process.</dd><dt><a class=permalink href=#AUDITPIPE_GET_MAXAUDITDATA><code class=Dv id=AUDITPIPE_GET_MAXAUDITDATA>AUDITPIPE_GET_MAXAUDITDATA</code></a></dt><dd>Query the maximum size of an audit record, which is a useful minimum size for a user space buffer intended to hold audit records read from the audit pipe.</dd></dl></section><section class=Ss><h2 class=Ss id=Audit_Pipe_Preselection_Mode_Ioctls><a class=permalink href=#Audit_Pipe_Preselection_Mode_Ioctls>Audit Pipe Preselection Mode Ioctls</a></h2> By default, the audit pipe facility configures pipes to present records matched by the system-wide audit trail, configured by <a class=Xr href=auditd.8.html>auditd(8)</a>. However, the preselection mechanism for audit pipes can be configured using alternative criteria, including pipe-local flags and naflags settings, as well as auid-specific selection masks. This allows applications to track events not captured in the global audit trail, as well as limit records presented to those of specific interest to the application. <p class=Pp>The following ioctls configure the preselection mode on an audit pipe:</p><dl class=Bl-tag><dt><a class=permalink href=#AUDITPIPE_GET_PRESELECT_MODE><code class=Dv id=AUDITPIPE_GET_PRESELECT_MODE>AUDITPIPE_GET_PRESELECT_MODE</code></a></dt><dd>Return the current preselect mode on the audit pipe. The ioctl argument should be of type <var class=Vt>int</var>.</dd><dt><a class=permalink href=#AUDITPIPE_SET_PRESELECT_MODE><code class=Dv id=AUDITPIPE_SET_PRESELECT_MODE>AUDITPIPE_SET_PRESELECT_MODE</code></a></dt><dd>Set the current preselection mode on the audit pipe. The ioctl argument should be of type <var class=Vt>int</var>.</dd></dl><p class=Pp>Possible preselection mode values are:</p><dl class=Bl-tag><dt><a class=permalink href=#AUDITPIPE_PRESELECT_MODE_TRAIL><code class=Dv id=AUDITPIPE_PRESELECT_MODE_TRAIL>AUDITPIPE_PRESELECT_MODE_TRAIL</code></a></dt><dd>Use the global audit trail preselection parameters to select records for the audit pipe.</dd><dt><a class=permalink href=#AUDITPIPE_PRESELECT_MODE_LOCAL><code class=Dv id=AUDITPIPE_PRESELECT_MODE_LOCAL>AUDITPIPE_PRESELECT_MODE_LOCAL</code></a></dt><dd>Use local audit pipe preselection; this model is similar to the global audit trail configuration model, consisting of global flags and naflags parameters, as well as a set of per-auid masks. These parameters are configured using further ioctls.</dd></dl><p class=Pp>After changing the audit pipe preselection mode, records selected under earlier preselection configuration may still be in the audit pipe queue. The application may flush the current record queue after changing the configuration to remove possibly undesired records.</p></section><section class=Ss><h2 class=Ss id=Audit_Pipe_Local_Preselection_Mode_Ioctls><a class=permalink href=#Audit_Pipe_Local_Preselection_Mode_Ioctls>Audit Pipe Local Preselection Mode Ioctls</a></h2> The following ioctls configure the preselection parameters used when an audit pipe is configured for the <code class=Dv>AUDITPIPE_PRESELECT_MODE_LOCAL</code> preselection mode. <dl class=Bl-tag><dt><a class=permalink href=#AUDITPIPE_GET_PRESELECT_FLAGS><code class=Dv id=AUDITPIPE_GET_PRESELECT_FLAGS>AUDITPIPE_GET_PRESELECT_FLAGS</code></a></dt><dd>Retrieve the current default preselection flags for attributable events on the pipe. These flags correspond to the <var class=Va>flags</var> field in <a class=Xr href=audit_control.5.html>audit_control(5)</a>. The ioctl argument should be of type <var class=Vt>au_mask_t</var>.</dd><dt><a class=permalink href=#AUDITPIPE_SET_PRESELECT_FLAGS><code class=Dv id=AUDITPIPE_SET_PRESELECT_FLAGS>AUDITPIPE_SET_PRESELECT_FLAGS</code></a></dt><dd>Set the current default preselection flags for attributable events on the pipe. These flags correspond to the <var class=Va>flags</var> field in <a class=Xr href=audit_control.5.html>audit_control(5)</a>. The ioctl argument should be of type <var class=Vt>au_mask_t</var>.</dd><dt><a class=permalink href=#AUDITPIPE_GET_PRESELECT_NAFLAGS><code class=Dv id=AUDITPIPE_GET_PRESELECT_NAFLAGS>AUDITPIPE_GET_PRESELECT_NAFLAGS</code></a></dt><dd>Retrieve the current default preselection flags for non-attributable events on the pipe. These flags correspond to the <var class=Va>naflags</var> field in <a class=Xr href=audit_control.5.html>audit_control(5)</a>. The ioctl argument should be of type <var class=Vt>au_mask_t</var>.</dd><dt><a class=permalink href=#AUDITPIPE_SET_PRESELECT_NAFLAGS><code class=Dv id=AUDITPIPE_SET_PRESELECT_NAFLAGS>AUDITPIPE_SET_PRESELECT_NAFLAGS</code></a></dt><dd>Set the current default preselection flags for non-attributable events on the pipe. These flags correspond to the <var class=Va>naflags</var> field in <a class=Xr href=audit_control.5.html>audit_control(5)</a>. The ioctl argument should be of type <var class=Vt>au_mask_t</var>.</dd><dt><a class=permalink href=#AUDITPIPE_GET_PRESELECT_AUID><code class=Dv id=AUDITPIPE_GET_PRESELECT_AUID>AUDITPIPE_GET_PRESELECT_AUID</code></a></dt><dd>Query the current preselection masks for a specific auid on the pipe. The ioctl argument should be of type <var class=Vt>struct auditpipe_ioctl_preselect</var>. The auid to query is specified via the <var class=Va>ap_auid</var> field of type <var class=Vt>au_id_t</var>; the mask will be returned via <var class=Va>ap_mask</var> of type <var class=Vt>au_mask_t</var>.</dd><dt><a class=permalink href=#AUDITPIPE_SET_PRESELECT_AUID><code class=Dv id=AUDITPIPE_SET_PRESELECT_AUID>AUDITPIPE_SET_PRESELECT_AUID</code></a></dt><dd>Set the current preselection masks for a specific auid on the pipe. Arguments are identical to <code class=Dv>AUDITPIPE_GET_PRESELECT_AUID</code>, except that the caller should properly initialize the <var class=Va>ap_mask</var> field to hold the desired preselection mask.</dd><dt><a class=permalink href=#AUDITPIPE_DELETE_PRESELECT_AUID><code class=Dv id=AUDITPIPE_DELETE_PRESELECT_AUID>AUDITPIPE_DELETE_PRESELECT_AUID</code></a></dt><dd>Delete the current preselection mask for a specific auid on the pipe. Once called, events associated with the specified auid will use the default flags mask. The ioctl argument should be of type <var class=Vt>au_id_t</var>.</dd><dt><a class=permalink href=#AUDITPIPE_FLUSH_PRESELECT_AUID><code class=Dv id=AUDITPIPE_FLUSH_PRESELECT_AUID>AUDITPIPE_FLUSH_PRESELECT_AUID</code></a></dt><dd>Delete all auid specific preselection specifications.</dd></dl></section></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> The <a class=Xr href=praudit.1.html>praudit(1)</a> utility may be directly executed on <span class=Pa>/dev/auditpipe</span> to review the default audit trail. </section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=poll.2.html>poll(2)</a>, <a class=Xr href=select.2.html>select(2)</a>, <a class=Xr href=audit.4.html>audit(4)</a>, <a class=Xr href=dtaudit.4.html>dtaudit(4)</a>, <a class=Xr href=audit_control.5.html>audit_control(5)</a>, <a class=Xr href=audit.8.html>audit(8)</a>, <a class=Xr href=auditd.8.html>auditd(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The OpenBSM implementation was created by McAfee Research, the security division of McAfee Inc., under contract to Apple Computer Inc. in 2004. It was subsequently adopted by the TrustedBSD Project as the foundation for the OpenBSM distribution. <p class=Pp>Support for kernel audit first appeared in <span class=Ux>FreeBSD 6.2</span>.</p></section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> The audit pipe facility was designed and implemented by <span class=An>Robert Watson</span> &lt;<a class=Mt href=mailto:rwatson@FreeBSD.org>rwatson@FreeBSD.org</a>&gt;. <p class=Pp>The Basic Security Module (BSM) interface to audit records and audit event stream format were defined by Sun Microsystems.</p></section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> See the <a class=Xr href=audit.4.html>audit(4)</a> manual page for information on audit-related bugs and limitations. <p class=Pp>The configurable preselection mechanism mirrors the selection model present for the global audit trail. It might be desirable to provide a more flexible selection model.</p><p class=Pp>The per-pipe audit event queue is fifo, with drops occurring if either the user thread provides in sufficient for the record on the queue head, or on enqueue if there is insufficient room. It might be desirable to support partial reads of records, which would be more compatible with buffered I/O as implemented in system libraries, and to allow applications to select which records are dropped, possibly in the style of preselection.</p></section></div><table class=foot><tr><td class=foot-date>April 28, 2019</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>