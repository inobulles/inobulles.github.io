<!DOCTYPE html>
<html><head><meta charset=utf-8><title>gvirstor(8)</title><keywords content=man,gvirstor></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>gvirstor(8)</h1><table class=head><tr><td class=head-ltitle>GVIRSTOR(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>GVIRSTOR(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>gvirstor</code> — <div class=Nd>control utility for virtual data storage devices</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>label</code> [<code class=Fl>-hv</code>] [<code class=Fl>-s</code><var class=Ar>virsize</var>] [<code class=Fl>-m</code><var class=Ar>chunksize</var>] <var class=Ar>name</var><var class=Ar>prov ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>stop</code> [<code class=Fl>-fv</code>] <var class=Ar>name ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>destroy</code> [<code class=Fl>-fv</code>] <var class=Ar>name ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>add</code> [<code class=Fl>-vh</code>] <var class=Ar>name prov ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>remove</code> [<code class=Fl>-v</code>] <var class=Ar>name prov ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>clear</code> [<code class=Fl>-v</code>] <var class=Ar>prov ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>dump</code><var class=Ar>prov ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>list</code></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>status</code></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>load</code></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gvirstor</code></td><td><code class=Cm>unload</code></td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>gvirstor</code> utility is used for setting up a virtual storage device of arbitrary large size (for example, several TB), consisting of an arbitrary number of physical storage devices with the total size which is equal to or smaller than the virtual size. Data for the virtual devices will be allocated from physical devices on demand. The idea behind <code class=Nm>gvirstor</code> is similar to the concept of Virtual Memory in operating systems, effectively allowing users to overcommit on storage (free file system space). The concept is also known as "thin provisioning" in virtualization environments, only here it is implemented on the level of physical storage devices. <p class=Pp>The first argument to <code class=Nm>gvirstor</code> indicates an action to be performed:</p><dl class=Bl-tag><dt><a class=permalink href=#label><code class=Cm id=label>label</code></a></dt><dd>Set up a virtual device from the given components with the specified <var class=Ar>name</var>. Metadata is stored in the last sector of every component. Argument <code class=Fl>-s</code><var class=Ar>virsize</var> is the size of new virtual device, with default being set to 2 TiB (2097152 MiB). Argument <code class=Fl>-m</code><var class=Ar>chunksize</var> is the chunk size, with default being set to 4 MiB (4096 KiB). The default arguments are thus “<code class=Fl>-s</code><var class=Ar>2097152</var><code class=Fl>-m</code><var class=Ar>4096</var>”.</dd><dt><a class=permalink href=#stop><code class=Cm id=stop>stop</code></a></dt><dd>Turn off an existing virtual device with the given <var class=Ar>name</var>. This command does not touch on-disk metadata. As with other GEOM classes, stopped geoms cannot be started manually.</dd><dt><a class=permalink href=#destroy><code class=Cm id=destroy>destroy</code></a></dt><dd>Same as <code class=Cm>stop.</code></dd><dt><a class=permalink href=#add><code class=Cm id=add>add</code></a></dt><dd>Adds new components to existing virtual device with the given <var class=Ar>name</var>. The specified virstor device must exist and be active (i.e. module loaded, device present in <span class=Pa>/dev</span>). This action can be safely performed while the virstor device is in use (“hot” operation).</dd><dt><a class=permalink href=#remove><code class=Cm id=remove>remove</code></a></dt><dd>Removes components from existing virtual device with the given <var class=Ar>name</var>. Only unallocated providers can be removed.</dd><dt><a class=permalink href=#clear><code class=Cm id=clear>clear</code></a></dt><dd>Clear metadata on the given providers.</dd><dt><a class=permalink href=#dump><code class=Cm id=dump>dump</code></a></dt><dd>Dump metadata stored on the given providers.</dd><dt><a class=permalink href=#list><code class=Cm id=list>list</code></a></dt><dd>See <a class=Xr href=geom.8.html>geom(8)</a>.</dd><dt><a class=permalink href=#status><code class=Cm id=status>status</code></a></dt><dd>See <a class=Xr href=geom.8.html>geom(8)</a>.</dd><dt><a class=permalink href=#load><code class=Cm id=load>load</code></a></dt><dd>See <a class=Xr href=geom.8.html>geom(8)</a>.</dd><dt><a class=permalink href=#unload><code class=Cm id=unload>unload</code></a></dt><dd>See <a class=Xr href=geom.8.html>geom(8)</a>.</dd></dl><p class=Pp>Additional options:</p><dl class=Bl-tag><dt><a class=permalink href=#f><code class=Fl id=f>-f</code></a></dt><dd>Force the removal of the specified virtual device.</dd><dt><a class=permalink href=#h><code class=Fl id=h>-h</code></a></dt><dd>Hardcode providers' names in metadata.</dd><dt><a class=permalink href=#v><code class=Fl id=v>-v</code></a></dt><dd>Be more verbose.</dd></dl></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> The following example shows how to create a virtual device of default size (2 TiB), of default chunk (extent) size (4 MiB), with two physical devices for backing storage. <div class="Bd Pp Bd-indent"><pre>
<span class=No>gvirstor label -v
</span> <var class=Ar>mydata
</var> <var class=Ar>/dev/ada4
</var> <var class=Ar>/dev/ada6
</var>
<span class=No>newfs
</span> <var class=Ar>/dev/virstor/mydata
</var>
</pre></div><p class=Pp>From now on, the virtual device will be available via the <span class=Pa>/dev/virstor/mydata</span> device entry. To add a new physical device / component to an active virstor device:</p><div class="Bd Pp Bd-indent"><pre>
<span class=No>gvirstor add
</span> <var class=Ar>mydata
</var> <var class=Ar>ada8
</var>
</pre></div><p class=Pp>This will add physical storage of <var class=Ar>ada8</var> to <span class=Pa>/dev/virstor/mydata</span> device.</p><p class=Pp>To see the device status information (including how much physical storage is still available for the virtual device), use:</p><div class="Bd Pp Bd-indent"><pre>
gvirstor list
</pre></div><p class=Pp>All standard <a class=Xr href=geom.8.html>geom(8)</a> subcommands (e.g. <code class=Cm>status</code>, <code class=Cm>help</code>) are also supported.</p></section><section class=Sh><h2 class=Sh id=SYSCTL_VARIABLES><a class=permalink href=#SYSCTL_VARIABLES>SYSCTL VARIABLES</a></h2><code class=Nm>gvirstor</code> has several <a class=Xr href=sysctl.8.html>sysctl(8)</a> tunable variables. <div class="Bd Pp Bd-indent"><pre>
<var class=Va>int kern.geom.virstor.debug
</var>
</pre></div><p class=Pp>This sysctl controls verbosity of the kernel module, in the range 1 to 15. Messages that are marked with higher verbosity levels than this are suppressed. Default value is 5 and it is not recommended to set this tunable to less than 2, because level 1 messages are error events, and level 2 messages are system warnings.</p><div class="Bd Pp Bd-indent"><pre>
<var class=Va>int kern.geom.virstor.chunk_watermark
</var>
</pre></div><p class=Pp>Value in this sysctl sets warning watermark level for physical chunk usage on a single component. The warning is issued when a virstor component has less than this many free chunks (default 100).</p><div class="Bd Pp Bd-indent"><pre>
<var class=Va>int kern.geom.virstor.component_watermark
</var>
</pre></div><p class=Pp>Value in this sysctl sets warning watermark level for component usage. The warning is issued when there are less than this many unallocated components (default is 1).</p><p class=Pp>All these sysctls are also available as <a class=Xr href=loader.8.html>loader(8)</a> tunables.</p></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2> The <code class=Nm>gvirstor</code> utility exits 0 on success, and &gt;0 if an error occurs. <p class=Pp><code class=Nm>gvirstor</code> kernel module issues log messages with prefixes in standardized format, which is useful for log message filtering and dispatching. Each message line begins with</p><div class="Bd Pp Bd-indent"><pre>
<code class=Li>GEOM_VIRSTOR[%d]:
</code>
</pre></div><p class=Pp>The number (%d) is message verbosity / importance level, in the range 1 to 15. If a message filtering, dispatching or operator alert system is used, it is recommended that messages with levels 1 and 2 be taken seriously (for example, to catch out-of-space conditions as set by watermark) sysctls.</p></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=geom.4.html>geom(4)</a>, <a class=Xr href=fstab.5.html>fstab(5)</a>, <a class=Xr href=geom.8.html>geom(8)</a>, <a class=Xr href=glabel.8.html>glabel(8)</a>, <a class=Xr href=newfs.8.html>newfs(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>gvirstor</code> utility first appeared in <span class=Ux>FreeBSD 7.0</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Ivan Voras</span> &lt;<a class=Mt href=mailto:ivoras@FreeBSD.org>ivoras@FreeBSD.org</a>&gt; <p class=Pp>Sponsored by Google Summer of Code 2006.</p></section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> Commands <code class=Cm>add</code> and <code class=Cm>remove</code> contain unavoidable critical sections which may make the virstor device unusable if a power failure (or other disruptive event) happens during their execution. It is recommended to run them when the system is quiescent. </section><section class=Sh><h2 class=Sh id=ASSUMPTIONS_AND_INTERACTION_WITH_FILE_SYSTEMS><a class=permalink href=#ASSUMPTIONS_AND_INTERACTION_WITH_FILE_SYSTEMS>ASSUMPTIONS AND INTERACTION WITH FILE SYSTEMS</a></h2> There are several assumptions that <code class=Nm>gvirstor</code> has in its operation: that the size of the virtual storage device will not change once it is set, and that the sizes of individual physical storage components will always remain constant during their existence. For alternative ways to implement virtual or resizable file systems see <a class=Xr href=zfs.1M.html>zfs(1M)</a>, <a class=Xr href=gconcat.8.html>gconcat(8)</a> and <a class=Xr href=growfs.8.html>growfs(8)</a>. <p class=Pp>Note that <code class=Nm>gvirstor</code> has nontrivial interaction with file systems which initialize a large number of on-disk structures during newfs. If such file systems attempt to spread their structures across the drive media (like UFS/UFS2 does), their efforts will be effectively foiled by sequential allocation of chunks in <code class=Nm>gvirstor</code> and all their structures will be physically allocated at the start of the first virstor component. This could have a significant impact on file system performance (which can in some rare cases be even positive).</p></section></div><table class=foot><tr><td class=foot-date>October 1, 2013</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>