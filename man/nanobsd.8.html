<!DOCTYPE html>
<html><head><meta charset=utf-8><title>nanobsd(8)</title><keywords content=man,nanobsd></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>nanobsd(8)</h1><table class=head><tr><td class=head-ltitle>NANOBSD(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>NANOBSD(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>nanobsd.sh</code> — <div class=Nd>utility used to create a FreeBSD system image suitable for embedded applications</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>nanobsd.sh</code></td><td>[<code class=Fl>-bfhiKknqvwX</code>] [<code class=Fl>-c</code><var class=Ar>config-file</var>]</td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>nanobsd.sh</code> utility is a script which produces a minimal implementation of <span class=Ux>FreeBSD</span> (called <code class=Nm>NanoBSD</code>), which typically fits on a small media such as a Compact Flash card, or other mass storage medium. It can be used to build specialized install images, designed for easy installation and maintenance. <p class=Pp>The following options are available:</p><div class=Bd-indent><dl class=Bl-tag><dt><a class=permalink href=#b><code class=Fl id=b>-b</code></a></dt><dd>Skip the build stages (both for kernel and world).</dd><dt><a class=permalink href=#c><code class=Fl id=c>-c</code></a><var class=Ar>config-file</var></dt><dd>Specify the configuration file to use.</dd><dt><a class=permalink href=#f><code class=Fl id=f>-f</code></a></dt><dd>Skip the code slice extraction.</dd><dt><a class=permalink href=#h><code class=Fl id=h>-h</code></a></dt><dd>Display usage information.</dd><dt><a class=permalink href=#i><code class=Fl id=i>-i</code></a></dt><dd>Skip the disk image build stage.</dd><dt><a class=permalink href=#K><code class=Fl id=K>-K</code></a></dt><dd>Skip the <code class=Cm>installkernel</code> stage of the build.</dd><dt><a class=permalink href=#k><code class=Fl id=k>-k</code></a></dt><dd>Skip the <code class=Cm>buildkernel</code> stage of the build.</dd><dt><a class=permalink href=#n><code class=Fl id=n>-n</code></a></dt><dd>Do not cleanup before each build stage. This suppresses the normal cleanup work done before the <code class=Cm>buildworld</code> stage and adds -DNO_CLEAN to the make command line used for each build stage (world and kernel).</dd><dt><a class=permalink href=#q><code class=Fl id=q>-q</code></a></dt><dd>Make output more quiet.</dd><dt><a class=permalink href=#v><code class=Fl id=v>-v</code></a></dt><dd>Make output more verbose.</dd><dt><a class=permalink href=#w><code class=Fl id=w>-w</code></a></dt><dd>Skip the <code class=Cm>buildworld</code> stage of the build.</dd><dt><a class=permalink href=#X><code class=Fl id=X>-X</code></a></dt><dd>Make <code class=Cm>native-xtools.</code></dd></dl></div><p class=Pp>The features of <code class=Nm>NanoBSD</code> include:</p><p class=Pp></p><ul class="Bl-bullet Bd-indent Bl-compact"><li>Ports and packages work as in <span class=Ux>FreeBSD</span>. Every single application can be installed and used in a <code class=Nm>NanoBSD</code> image, the same way as in <span class=Ux>FreeBSD</span>.</li><li>No missing functionality. If it is possible to do something with <span class=Ux>FreeBSD</span>, it is possible to do the same thing with <code class=Nm>NanoBSD</code>, unless the specific feature or features were explicitly removed from the <code class=Nm>NanoBSD</code> image when it was created.</li><li>Everything is read-only at run-time. It is safe to pull the power-plug. There is no necessity to run <a class=Xr href=fsck.8.html>fsck(8)</a> after a non-graceful shutdown of the system.</li><li>Easy to build and customize. Making use of just one shell script and one configuration file it is possible to build reduced and customized images satisfying any arbitrary set of requirements.</li></ul><section class=Ss><h2 class=Ss id=NanoBSD_Media_Layout><a class=permalink href=#NanoBSD_Media_Layout>NanoBSD Media Layout</a></h2> The mass storage medium is divided into three parts by default (which are normally mounted read-only): <p class=Pp></p><ul class="Bl-bullet Bd-indent Bl-compact"><li>Two image partitions: <code class=Li>code#1</code> and <code class=Li>code#2</code>.</li><li>The configuration file partition, which can be mounted under the <span class=Pa>/cfg</span> directory at run time.</li></ul><p class=Pp>The <span class=Pa>/etc</span> and <span class=Pa>/var</span> directories are <a class=Xr href=md.4.html>md(4)</a> (malloc backed) disks.</p><p class=Pp>The configuration file partition persists under the <span class=Pa>/cfg</span> directory. It contains files for <span class=Pa>/etc</span> directory and is briefly mounted read-only right after the system boot, therefore it is required to copy modified files from <span class=Pa>/etc</span> back to the <span class=Pa>/cfg</span> directory if changes are expected to persist after the system restarts.</p></section></section><section class=Sh><h2 class=Sh>BUILDING <code class=Nm>NanoBSD</code></h2> A <code class=Nm>NanoBSD</code> image is built using a simple <code class=Nm>nanobsd.sh</code> shell script, which can be found in the <span class=Pa>src/tools/tools/nanobsd</span> directory. This script creates a bootable image, which can be copied on the storage medium using the <a class=Xr href=dd.1.html>dd(1)</a> utility. <p class=Pp>The necessary commands to build and install a <code class=Nm>NanoBSD</code> image are:</p><div class="Bd Pp Bd-indent"><pre>
cd /usr/src/tools/tools/nanobsd
sh nanobsd.sh
cd /usr/obj/nanobsd.full
dd if=_.disk.full of=/dev/da0 bs=64k
</pre></div></section><section class=Sh><h2 class=Sh>CUSTOMIZING <code class=Nm>NanoBSD</code></h2> This is probably the most important and most interesting feature of <code class=Nm>NanoBSD</code>. This is also where you will be spending most of the time when developing with <code class=Nm>NanoBSD</code>. <p class=Pp>Customization is done in two ways:</p><p class=Pp></p><ul class="Bl-bullet Bd-indent Bl-compact"><li>Configuration options.</li><li>Custom functions.</li></ul><p class=Pp>With configuration settings, it is possible to configure options passed to both the <code class=Cm>buildworld</code> and <code class=Cm>installworld</code> stages of the <code class=Nm>NanoBSD</code> build process, as well as internal options passed to the main build process of <code class=Nm>NanoBSD</code>. Through these options it is possible to cut the system down, so it will fit on as little as 64MB. You can use the configuration options to trim down the system even more, until it will consist of just the kernel and two or three files in the userland.</p><p class=Pp>The configuration file consists of configuration options, which override the default values. The most important directives are:</p><div class=Bd-indent><dl class=Bl-tag><dt><var class=Va>NANO_NAME</var></dt><dd>Build name (used to construct the working directory names).</dd><dt><var class=Va>NANO_SRC</var></dt><dd>Path to the source tree used to build the image.</dd><dt><var class=Va>NANO_KERNEL</var></dt><dd>Name of the kernel configuration file used to build the kernel.</dd><dt><var class=Va>NANO_ARCH</var></dt><dd>Machine processor architecture to build. Defaults to output of <code class=Cm>uname -p</code>.</dd><dt><var class=Va>NANO_BOOT0CFG</var></dt><dd>Controls the options passed to <a class=Xr href=boot0cfg.8.html>boot0cfg(8)</a>; these dictate <code class=Nm>boot0</code>'s behaviour.</dd><dt><var class=Va>NANO_BOOTLOADER</var></dt><dd>The <code class=Nm>boot0</code> loader to use relative to the <var class=Va>NANO_WORLDDIR</var> variable. This defaults to <span class=Pa>boot/boot0sio</span> and should be overridden to <span class=Pa>boot/boot0</span> to provide a VGA console.</dd><dt><var class=Va>CONF_BUILD</var></dt><dd>Options passed to the <code class=Cm>buildworld</code> stage of the build.</dd><dt><var class=Va>CONF_INSTALL</var></dt><dd>Options passed to the <code class=Cm>installworld</code> stage of the build.</dd><dt><var class=Va>CONF_WORLD</var></dt><dd>Options passed to both the <code class=Cm>buildworld</code> and <code class=Cm>installworld</code> stages of the build.</dd><dt><var class=Va>FlashDevice</var></dt><dd>Defines the type of media to use. Check the <span class=Pa>FlashDevice.sub</span> file for more details.</dd></dl></div><p class=Pp>For more configuration options, please check the <code class=Nm>nanobsd.sh</code> script.</p><p class=Pp>To build <code class=Nm>NanoBSD</code> image using the <span class=Pa>nanobsd.conf</span> configuration file, use the following command:</p><div class="Bd Pp Bd-indent"><pre>
sh nanobsd.sh -c nanobsd.conf
</pre></div><p class=Pp>It is possible to fine-tune <code class=Nm>NanoBSD</code> using shell functions in the configuration file. The following example illustrates the basic model of custom functions:</p><div class="Bd Pp Bd-indent"><pre>
cust_foo () (
	echo "bar=topless" &gt; \
	     ${NANO_WORLDDIR}/etc/foo
)
customize_cmd cust_foo
</pre></div><p class=Pp>There are a few pre-defined customization functions ready for use:</p><div class=Bd-indent><dl class=Bl-tag><dt><a class=permalink href=#cust_comconsole><code class=Cm id=cust_comconsole>cust_comconsole</code></a></dt><dd>Disables <a class=Xr href=getty.8.html>getty(8)</a> on the virtual <a class=Xr href=syscons.4.html>syscons(4)</a> or <a class=Xr href=vt.4.html>vt(4)</a> terminals (<span class=Pa>/dev/ttyv*</span>) and enables the use of the first serial port as the system console.</dd><dt><a class=permalink href=#cust_allow_ssh_root><code class=Cm id=cust_allow_ssh_root>cust_allow_ssh_root</code></a></dt><dd>Allow root to log in via <a class=Xr href=sshd.8.html>sshd(8)</a>.</dd><dt><a class=permalink href=#cust_install_files><code class=Cm id=cust_install_files>cust_install_files</code></a></dt><dd>Installs files from the <span class=Pa>nanobsd/Files</span> directory, which contains some useful scripts for system administration.</dd></dl></div></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><dl class="Bl-tag Bl-compact"><dt><span class=Pa>src/tools/tools/nanobsd</span></dt><dd>Base directory of the <code class=Nm>NanoBSD</code> build script.</dd></dl></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> Making persistent changes to <span class=Pa>/etc/resolv.conf</span>: <div class="Bd Pp Bd-indent"><pre>
vi /etc/resolv.conf
...
mount /cfg
cp /etc/resolv.conf /cfg
umount /cfg
</pre></div><p class=Pp>A more useful example of a customization function is the following, which changes the default size of the <span class=Pa>/etc</span> directory from 5MB to 30MB:</p><div class="Bd Pp Bd-indent"><pre>
cust_etc_size () (
	cd ${NANO_WORLDDIR}/conf
	echo 30000 &gt; default/etc/md_size
)
customize_cmd cust_etc_size
</pre></div></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=make.conf.5.html>make.conf(5)</a>, <a class=Xr href=boot.8.html>boot(8)</a>, <a class=Xr href=boot0cfg.8.html>boot0cfg(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>nanobsd.sh</code> utility first appeared in <span class=Ux>FreeBSD 6.0</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><code class=Nm>NanoBSD</code> was developed by <span class=An>Poul-Henning Kamp</span> &lt;<a class=Mt href=mailto:phk@FreeBSD.org>phk@FreeBSD.org</a>&gt;. This manual page was written by <span class=An>Daniel Gerzo</span> &lt;<a class=Mt href=mailto:danger@FreeBSD.org>danger@FreeBSD.org</a>&gt;. </section></div><table class=foot><tr><td class=foot-date>May 19, 2016</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>