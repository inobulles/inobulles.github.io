<!DOCTYPE html>
<html><head><meta charset=utf-8><title>dumpon(8)</title><keywords content=man,dumpon></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>dumpon(8)</h1><table class=head><tr><td class=head-ltitle>DUMPON(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>DUMPON(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>dumpon</code> — <div class=Nd>specify a device for crash dumps</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>dumpon</code></td><td>[<code class=Fl>-i</code><var class=Ar>index</var>] [<code class=Fl>-r</code>] [<code class=Fl>-v</code>] [<code class=Fl>-C</code><var class=Ar>cipher</var>] [<code class=Fl>-k</code><var class=Ar>pubkey</var>] [<code class=Fl>-Z</code>] [<code class=Fl>-z</code>] <var class=Ar>device</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>dumpon</code></td><td>[<code class=Fl>-i</code><var class=Ar>index</var>] [<code class=Fl>-r</code>] [<code class=Fl>-v</code>] [<code class=Fl>-C</code><var class=Ar>cipher</var>] [<code class=Fl>-k</code><var class=Ar>pubkey</var>] [<code class=Fl>-Z</code>] [<code class=Fl>-z</code>] [<code class=Fl>-g</code><var class=Ar>gateway</var>] <code class=Fl>-s</code><var class=Ar>server</var><code class=Fl>-c</code><var class=Ar>client</var><var class=Ar>iface</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>dumpon</code></td><td>[<code class=Fl>-v</code>] <code class=Cm>off</code></td></tr></table><br><table class=Nm><tr><td><code class=Nm>dumpon</code></td><td>[<code class=Fl>-v</code>] <code class=Fl>-l</code></td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>dumpon</code> utility is used to configure where the kernel can save a crash dump in the case of a panic. <p class=Pp>System administrators should typically configure <code class=Nm>dumpon</code> in a persistent fashion using the <a class=Xr href=rc.conf.5.html>rc.conf(5)</a> variables <var class=Va>dumpdev</var> and <var class=Va>dumpon_flags</var>. For more information on this usage, see <a class=Xr href=rc.conf.5.html>rc.conf(5)</a>.</p><p class=Pp>Starting in <span class=Ux>FreeBSD 13.0</span>, <code class=Nm>dumpon</code> can configure a series of fallback dump devices. For example, an administrator may prefer <a class=Xr href=netdump.4.html>netdump(4)</a> by default, but if the <a class=Xr href=netdump.4.html>netdump(4)</a> service cannot be reached or some other failure occurs, they might choose a local disk dump as a second choice option.</p><section class=Ss><h2 class=Ss id=General_options><a class=permalink href=#General_options>General options</a></h2><dl class=Bl-tag><dt><a class=permalink href=#i><code class=Fl id=i>-i</code></a><var class=Ar>index</var></dt><dd>Insert the specified dump configuration into the prioritized fallback dump device list at the specified index, starting at zero. <p class=Pp>If <code class=Fl>-i</code> is not specified, the configured dump device is appended to the prioritized list.</p></dd><dt><a class=permalink href=#r><code class=Fl id=r>-r</code></a></dt><dd>Remove the specified dump device configuration or configurations from the fallback dump device list rather than inserting or appending it. In contrast, “<code class=Nm>dumpon</code> off” removes all configured devices. Conflicts with <code class=Fl>-i</code>.</dd><dt><a class=permalink href=#k><code class=Fl id=k>-k</code></a><var class=Ar>pubkey</var></dt><dd>Configure encrypted kernel dumps. <p class=Pp>A random, one-time symmetric key is automatically generated for bulk kernel dump encryption every time <code class=Nm>dumpon</code> is used. The provided <var class=Ar>pubkey</var> is used to encrypt a copy of the symmetric key. The encrypted dump contents consist of a standard dump header, the pubkey-encrypted symmetric key contents, and the symmetric key encrypted core dump contents.</p><p class=Pp>As a result, only someone with the corresponding private key can decrypt the symmetric key. The symmetric key is necessary to decrypt the kernel core. The goal of the mechanism is to provide confidentiality.</p><p class=Pp>The <var class=Va>pubkey</var> file should be a PEM-formatted RSA key of at least 2048 bits.</p></dd><dt><a class=permalink href=#C><code class=Fl id=C>-C</code></a><var class=Ar>cipher</var></dt><dd>Select the symmetric algorithm used for encrypted kernel crash dump. The default is “chacha20” but “aes256-cbc” is also available. (AES256-CBC mode does not work in conjunction with compression.)</dd><dt><a class=permalink href=#l><code class=Fl id=l>-l</code></a></dt><dd>List the currently configured dump device(s), or /dev/null if no devices are configured.</dd><dt><a class=permalink href=#v><code class=Fl id=v>-v</code></a></dt><dd>Enable verbose mode.</dd><dt><a class=permalink href=#Z><code class=Fl id=Z>-Z</code></a></dt><dd>Enable compression (Zstandard).</dd><dt><a class=permalink href=#z><code class=Fl id=z>-z</code></a></dt><dd>Enable compression (gzip). Only one compression method may be enabled at a time, so <code class=Fl>-z</code> is incompatible with <code class=Fl>-Z</code>. <p class=Pp>Zstandard provides superior compression ratio and performance.</p></dd></dl></section><section class=Ss><h2 class=Ss id=Netdump><a class=permalink href=#Netdump>Netdump</a></h2><code class=Nm>dumpon</code> may also configure the kernel to dump to a remote <a class=Xr href=netdumpd.8.html>netdumpd(8)</a> server. (The <a class=Xr href=netdumpd.8.html>netdumpd(8)</a> server is available in ports.) <a class=Xr href=netdump.4.html>netdump(4)</a> eliminates the need to reserve space for crash dumps. It is especially useful in diskless environments. When <code class=Nm>dumpon</code> is used to configure netdump, the <var class=Ar>device</var> (or <var class=Ar>iface</var>) parameter should specify a network interface (e.g., <var class=Va>igb1</var>). The specified NIC must be up (online) to configure netdump. <p class=Pp><a class=Xr href=netdump.4.html>netdump(4)</a> specific options include:</p><dl class=Bl-tag><dt><a class=permalink href=#c><code class=Fl id=c>-c</code></a><var class=Ar>client</var></dt><dd>The local IP address of the <a class=Xr href=netdump.4.html>netdump(4)</a> client.</dd><dt><a class=permalink href=#g><code class=Fl id=g>-g</code></a><var class=Ar>gateway</var></dt><dd>The first-hop router between <var class=Ar>client</var> and <var class=Ar>server</var>. If the <code class=Fl>-g</code> option is not specified and the system has a default route, the default router is used as the <a class=Xr href=netdump.4.html>netdump(4)</a> gateway. If the <code class=Fl>-g</code> option is not specified and the system does not have a default route, <var class=Ar>server</var> is assumed to be on the same link as <var class=Ar>client</var>.</dd><dt><a class=permalink href=#s><code class=Fl id=s>-s</code></a><var class=Ar>server</var></dt><dd>The IP address of the <a class=Xr href=netdumpd.8.html>netdumpd(8)</a> server.</dd></dl><p class=Pp>All of these options can be specified in the <a class=Xr href=rc.conf.5.html>rc.conf(5)</a> variable <var class=Va>dumpon_flags</var>.</p></section><section class=Ss><h2 class=Ss id=Minidumps><a class=permalink href=#Minidumps>Minidumps</a></h2> The default type of kernel crash dump is the mini crash dump. Mini crash dumps hold only memory pages in use by the kernel. Alternatively, full memory dumps can be enabled by setting the <var class=Va>debug.minidump</var><a class=Xr href=sysctl.8.html>sysctl(8)</a> variable to 0. </section><section class=Ss><h2 class=Ss id=Full_dumps><a class=permalink href=#Full_dumps>Full dumps</a></h2> For systems using full memory dumps, the size of the specified dump device must be at least the size of physical memory. Even though an additional 64 kB header is added to the dump, the BIOS for a platform typically holds back some memory, so it is not usually necessary to size the dump device larger than the actual amount of RAM available in the machine. Also, when using full memory dumps, the <code class=Nm>dumpon</code> utility will refuse to enable a dump device which is smaller than the total amount of physical memory as reported by the <var class=Va>hw.physmem</var><a class=Xr href=sysctl.8.html>sysctl(8)</a> variable. </section></section><section class=Sh><h2 class=Sh id=IMPLEMENTATION_NOTES><a class=permalink href=#IMPLEMENTATION_NOTES>IMPLEMENTATION NOTES</a></h2> Because the file system layer is already dead by the time a crash dump is taken, it is not possible to send crash dumps directly to a file. <p class=Pp>The <a class=Xr href=loader.8.html>loader(8)</a> variable <var class=Va>dumpdev</var> may be used to enable early kernel core dumps for system panics which occur before userspace starts.</p></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> In order to generate an RSA private key, a user can use the <a class=Xr href=genrsa.1.html>genrsa(1)</a> tool: <p class=Pp></p><div class="Bd Bd-indent"><code class=Li># openssl genrsa -out private.pem 4096</code></div><p class=Pp>A public key can be extracted from the private key using the <a class=Xr href=rsa.1.html>rsa(1)</a> tool:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># openssl rsa -in private.pem -out public.pem -pubout</code></div><p class=Pp>Once the RSA keys are created in a safe place, the public key may be moved to the untrusted netdump client machine. Now <span class=Pa>public.pem</span> can be used by <code class=Nm>dumpon</code> to configure encrypted kernel crash dumps:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># dumpon -k public.pem /dev/ada0s1b</code></div><p class=Pp>It is recommended to test if the kernel saves encrypted crash dumps using the current configuration. The easiest way to do that is to cause a kernel panic using the <a class=Xr href=ddb.4.html>ddb(4)</a> debugger:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># sysctl debug.kdb.panic=1</code></div><p class=Pp>In the debugger the following commands should be typed to write a core dump and reboot:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>db&gt; dump</code></div><div class="Bd Bd-indent"><code class=Li>db&gt; reset</code></div><p class=Pp>After reboot <a class=Xr href=savecore.8.html>savecore(8)</a> should be able to save the core dump in the “dumpdir” directory, which is <span class=Pa>/var/crash</span> by default:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># savecore /dev/ada0s1b</code></div><p class=Pp>Three files should be created in the core directory: <span class=Pa>info.#</span>, <span class=Pa>key.#</span> and <span class=Pa>vmcore_encrypted.#</span> (where “#” is the number of the last core dump saved by <a class=Xr href=savecore.8.html>savecore(8)</a>). The <span class=Pa>vmcore_encrypted.#</span> can be decrypted using the <a class=Xr href=decryptcore.8.html>decryptcore(8)</a> utility:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># decryptcore -p private.pem -k key.# -e vmcore_encrypted.# -c vmcore.#</code></div><p class=Pp>or shorter:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># decryptcore -p private.pem -n #</code></div><p class=Pp>The <span class=Pa>vmcore.#</span> can be now examined using <a class=Xr href=kgdb.1.html>kgdb(1)</a> (<span class=Pa>ports/devel/gdb</span>):</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># kgdb /boot/kernel/kernel vmcore.#</code></div><p class=Pp>or shorter:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># kgdb -n #</code></div><p class=Pp>The core was decrypted properly if <a class=Xr href=kgdb.1.html>kgdb(1)</a> (<span class=Pa>ports/devel/gdb</span>) does not print any errors. Note that the live kernel might be at a different path which can be examined by looking at the <var class=Va>kern.bootfile</var><a class=Xr href=sysctl.8.html>sysctl(8)</a>.</p><p class=Pp>The <code class=Nm>dumpon</code><a class=Xr href=rc.8.html>rc(8)</a> script runs early during boot, typically before networking is configured. This makes it unsuitable for configuring <a class=Xr href=netdump.4.html>netdump(4)</a> when the client address is dynamic. To configure <a class=Xr href=netdump.4.html>netdump(4)</a> when <a class=Xr href=dhclient.8.html>dhclient(8)</a> binds to a server, <a class=Xr href=dhclient-script.8.html>dhclient-script(8)</a> can be used to run <a class=Xr href=dumpon.8.html>dumpon(8)</a>. For example, to automatically configure <a class=Xr href=netdump.4.html>netdump(4)</a> on the vtnet0 interface, add the following to <span class=Pa>/etc/dhclient-exit-hooks</span>.</p><div class="Bd Pp"><pre>
case $reason in
BOUND|REBIND|REBOOT|RENEW)
	if [ "$interface" != vtnet0 ] || [ -n "$old_ip_address" -a \
	     "$old_ip_address" = "$new_ip_address" ]; then
		break
	fi
	if [ -n "$new_routers" ]; then
		# Take the first router in the list.
		gateway_flag="-g ${new_routers%% *}"
	fi
	# Configure as the highest-priority dump device.
	dumpon -i 0 -c $new_ip_address -s $server $gateway_flag vtnet0
	;;
esac
</pre></div><p class=Pp>Be sure to fill in the server IP address and change the interface name if needed.</p></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=gzip.1.html>gzip(1)</a>, <a class=Xr href=kgdb.1.html>kgdb(1)</a> (<span class=Pa>ports/devel/gdb</span>), <a class=Xr href=zstd.1.html>zstd(1)</a>, <a class=Xr href=ddb.4.html>ddb(4)</a>, <a class=Xr href=netdump.4.html>netdump(4)</a>, <a class=Xr href=fstab.5.html>fstab(5)</a>, <a class=Xr href=rc.conf.5.html>rc.conf(5)</a>, <a class=Xr href=config.8.html>config(8)</a>, <a class=Xr href=decryptcore.8.html>decryptcore(8)</a>, <a class=Xr href=init.8.html>init(8)</a>, <a class=Xr href=loader.8.html>loader(8)</a>, <a class=Xr href=rc.8.html>rc(8)</a>, <a class=Xr href=savecore.8.html>savecore(8)</a>, <a class=Xr href=swapon.8.html>swapon(8)</a>, <a class=Xr href=panic.9.html>panic(9)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>dumpon</code> utility appeared in <span class=Ux>FreeBSD 2.0.5</span>. <p class=Pp>Support for encrypted kernel core dumps and netdump was added in <span class=Ux>FreeBSD 12.0</span>.</p></section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> The <code class=Nm>dumpon</code> manual page was written by <span class=An>Mark Johnston</span> &lt;<a class=Mt href=mailto:markj@FreeBSD.org>markj@FreeBSD.org</a>&gt;, <br><span class=An>Conrad Meyer</span> &lt;<a class=Mt href=mailto:cem@FreeBSD.org>cem@FreeBSD.org</a>&gt;, <br><span class=An>Konrad Witaszczyk</span> &lt;<a class=Mt href=mailto:def@FreeBSD.org>def@FreeBSD.org</a>&gt;, and countless others. </section><section class=Sh><h2 class=Sh id=CAVEATS><a class=permalink href=#CAVEATS>CAVEATS</a></h2> To configure encrypted kernel core dumps, the running kernel must have been compiled with the <code class=Dv>EKCD</code> option. <p class=Pp>Netdump does not automatically update the configured <var class=Ar>gateway</var> if routing topology changes.</p><p class=Pp>The size of a compressed dump or a minidump is not a fixed function of RAM size. Therefore, when at least one of these options is enabled, the <code class=Nm>dumpon</code> utility cannot verify that the <var class=Ar>device</var> has sufficient space for a dump. <code class=Nm>dumpon</code> is also unable to verify that a configured <a class=Xr href=netdumpd.8.html>netdumpd(8)</a> server has sufficient space for a dump.</p><p class=Pp><code class=Fl>-Z</code> requires a kernel compiled with the <code class=Dv>ZSTDIO</code> kernel option. Similarly, <code class=Fl>-z</code> requires the <code class=Dv>GZIO</code> option.</p></section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> Netdump only supports IPv4 at this time. </section><section class=Sh><h2 class=Sh id=SECURITY_CONSIDERATIONS><a class=permalink href=#SECURITY_CONSIDERATIONS>SECURITY CONSIDERATIONS</a></h2> The current encrypted kernel core dump scheme does not provide integrity nor authentication. That is, the recipient of an encrypted kernel core dump cannot know if they received an intact core dump, nor can they verify the provenance of the dump. <p class=Pp>RSA keys smaller than 1024 bits are practical to factor and therefore weak. Even 1024 bit keys may not be large enough to ensure privacy for many years, so NIST recommends a minimum of 2048 bit RSA keys. As a seatbelt, <code class=Nm>dumpon</code> prevents users from configuring encrypted kernel dumps with extremely weak RSA keys. If you do not care for cryptographic privacy guarantees, just use <code class=Nm>dumpon</code> without specifying a <code class=Fl>-k</code><var class=Ar>pubkey</var> option.</p><p class=Pp>This process is sandboxed using <a class=Xr href=capsicum.4.html>capsicum(4)</a>.</p></section></div><table class=foot><tr><td class=foot-date>April 23, 2020</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>