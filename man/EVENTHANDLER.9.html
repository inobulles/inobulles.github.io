<!DOCTYPE html>
<html><head><meta charset=utf-8><title>EVENTHANDLER(9)</title><keywords content=man,EVENTHANDLER></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>EVENTHANDLER(9)</h1><table class=head><tr><td class=head-ltitle>EVENTHANDLER(9)</td><td class=head-vol>FreeBSD Kernel Developer's Manual</td><td class=head-rtitle>EVENTHANDLER(9)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>EVENTHANDLER</code> — <div class=Nd>kernel event handling functions</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/sys/eventhandler.h.html>sys/eventhandler.h</a>&gt;</code><p class=Pp><code class=Fn>EVENTHANDLER_DECLARE</code>(<var class=Fa style="white-space: nowrap;">name</var>, <var class=Fa style="white-space: nowrap;">type</var>);</p><p class=Pp><code class=Fn>EVENTHANDLER_DEFINE</code>(<var class=Fa style="white-space: nowrap;">name</var>, <var class=Fa style="white-space: nowrap;">func</var>, <var class=Fa style="white-space: nowrap;">arg</var>, <var class=Fa style="white-space: nowrap;">priority</var>);</p><p class=Pp><code class=Fn>EVENTHANDLER_INVOKE</code>(<var class=Fa style="white-space: nowrap;">name</var>, <var class=Fa style="white-space: nowrap;">...</var>);</p><p class=Pp><var class=Ft>eventhandler_tag</var><br><code class=Fn>EVENTHANDLER_REGISTER</code>(<var class=Fa style="white-space: nowrap;">name</var>, <var class=Fa style="white-space: nowrap;">func</var>, <var class=Fa style="white-space: nowrap;">arg</var>, <var class=Fa style="white-space: nowrap;">priority</var>);</p><p class=Pp><code class=Fn>EVENTHANDLER_DEREGISTER</code>(<var class=Fa style="white-space: nowrap;">name</var>, <var class=Fa style="white-space: nowrap;">tag</var>);</p><p class=Pp><code class=Fn>EVENTHANDLER_DEREGISTER_NOWAIT</code>(<var class=Fa style="white-space: nowrap;">name</var>, <var class=Fa style="white-space: nowrap;">tag</var>);</p><p class=Pp><code class=Fn>EVENTHANDLER_LIST_DECLARE</code>(<var class=Fa style="white-space: nowrap;">name</var>);</p><p class=Pp><code class=Fn>EVENTHANDLER_LIST_DEFINE</code>(<var class=Fa style="white-space: nowrap;">name</var>);</p><p class=Pp><code class=Fn>EVENTHANDLER_DIRECT_INVOKE</code>(<var class=Fa style="white-space: nowrap;">name</var>);</p><p class=Pp><var class=Ft>eventhandler_tag</var><br><code class=Fn>eventhandler_register</code>(<var class=Fa>struct eventhandler_list *list</var>, <var class=Fa>const char *name</var>, <var class=Fa>void *func</var>, <var class=Fa>void *arg</var>, <var class=Fa>int priority</var>);</p><p class=Pp><var class=Ft>void</var><br><code class=Fn>eventhandler_deregister</code>(<var class=Fa>struct eventhandler_list *list</var>, <var class=Fa>eventhandler_tag tag</var>);</p><p class=Pp><var class=Ft>void</var><br><code class=Fn>eventhandler_deregister_nowait</code>(<var class=Fa>struct eventhandler_list *list</var>, <var class=Fa>eventhandler_tag tag</var>);</p><p class=Pp><var class=Ft>struct eventhandler_list *</var><br><code class=Fn>eventhandler_find_list</code>(<var class=Fa style="white-space: nowrap;">const char *name</var>);</p><p class=Pp><var class=Ft>void</var><br><code class=Fn>eventhandler_prune_list</code>(<var class=Fa style="white-space: nowrap;">struct eventhandler_list *list</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>EVENTHANDLER</code> mechanism provides a way for kernel subsystems to register interest in kernel events and have their callback functions invoked when these events occur. <p class=Pp>Callback functions are invoked in order of priority. The relative priority of each callback among other callbacks associated with an event is given by argument <var class=Fa>priority</var>, which is an integer ranging from <code class=Dv>EVENTHANDLER_PRI_FIRST</code> (highest priority), to <code class=Dv>EVENTHANDLER_PRI_LAST</code> (lowest priority). The symbol <code class=Dv>EVENTHANDLER_PRI_ANY</code> may be used if the handler does not have a specific priority associated with it.</p><p class=Pp>The normal way to use this subsystem is via the macro interface. For events that are high frequency it is suggested that you additionally use <code class=Fn>EVENTHANDLER_LIST_DEFINE</code>() so that the event handlers can be invoked directly using <code class=Fn>EVENTHANDLER_DIRECT_INVOKE</code>() (see below). This saves the invoker from having to do a locked traversal of a global list of event handler lists.</p><dl class=Bl-tag><dt><code class=Fn>EVENTHANDLER_DECLARE</code>()</dt><dd>This macro declares an event handler named by argument <var class=Fa>name</var> with callback functions of type <var class=Fa>type</var>.</dd><dt><code class=Fn>EVENTHANDLER_DEFINE</code>()</dt><dd>This macro uses <a class=Xr href=SYSINIT.9.html>SYSINIT(9)</a> to register a callback function <var class=Fa>func</var> with event handler <var class=Fa>name</var>. When invoked, function <var class=Fa>func</var> will be invoked with argument <var class=Fa>arg</var> as its first parameter along with any additional parameters passed in via macro <code class=Fn>EVENTHANDLER_INVOKE</code>() (see below).</dd><dt><code class=Fn>EVENTHANDLER_REGISTER</code>()</dt><dd>This macro registers a callback function <var class=Fa>func</var> with event handler <var class=Fa>name</var>. When invoked, function <var class=Fa>func</var> will be invoked with argument <var class=Fa>arg</var> as its first parameter along with any additional parameters passed in via macro <code class=Fn>EVENTHANDLER_INVOKE</code>() (see below). If registration is successful, <code class=Fn>EVENTHANDLER_REGISTER</code>() returns a cookie of type <var class=Vt>eventhandler_tag</var>.</dd><dt><code class=Fn>EVENTHANDLER_DEREGISTER</code>()</dt><dd>This macro removes a previously registered callback associated with tag <var class=Fa>tag</var> from the event handler named by argument <var class=Fa>name</var>. It waits until no threads are running handlers for this event before returning, making it safe to unload a module immediately upon return from this function.</dd><dt><code class=Fn>EVENTHANDLER_DEREGISTER_NOWAIT</code>()</dt><dd>This macro removes a previously registered callback associated with tag <var class=Fa>tag</var> from the event handler named by argument <var class=Fa>name</var>. Upon return, one or more threads could still be running the removed function(s), but no new calls will be made. To remove a handler function from within that function, use this version of deregister, to avoid a deadlock.</dd><dt><code class=Fn>EVENTHANDLER_INVOKE</code>()</dt><dd>This macro is used to invoke all the callbacks associated with event handler <var class=Fa>name</var>. This macro is a variadic one. Additional arguments to the macro after the <var class=Fa>name</var> parameter are passed as the second and subsequent arguments to each registered callback function.</dd><dt><code class=Fn>EVENTHANDLER_LIST_DEFINE</code>()</dt><dd>This macro defines a reference to an event handler list named by argument <var class=Fa>name</var>. It uses <a class=Xr href=SYSINIT.9.html>SYSINIT(9)</a> to initialize the reference and the eventhandler list.</dd><dt><code class=Fn>EVENTHANDLER_LIST_DECLARE</code>()</dt><dd>This macro declares an event handler list named by argument <var class=Fa>name</var>. This is only needed for users of <code class=Fn>EVENTHANDLER_DIRECT_INVOKE</code>() which are not in the same compilation unit of that list's definition.</dd><dt><code class=Fn>EVENTHANDLER_DIRECT_INVOKE</code>()</dt><dd>This macro invokes the event handlers registered for the list named by argument <var class=Fa>name</var>. This macro can only be used if the list was defined with <code class=Fn>EVENTHANDLER_LIST_DEFINE</code>(). The macro is variadic with the same semantics as <code class=Fn>EVENTHANDLER_INVOKE</code>().</dd></dl><p class=Pp>The macros are implemented using the following functions:</p><dl class=Bl-tag><dt><code class=Fn>eventhandler_register</code>()</dt><dd>The <code class=Fn>eventhandler_register</code>() function is used to register a callback with a given event. The arguments expected by this function are: <dl class=Bl-tag><dt><var class=Fa>list</var></dt><dd>A pointer to an existing event handler list, or <code class=Dv>NULL</code>. If <var class=Fa>list</var> is <code class=Dv>NULL</code>, the event handler list corresponding to argument <var class=Fa>name</var> is used.</dd><dt><var class=Fa>name</var></dt><dd>The name of the event handler list.</dd><dt><var class=Fa>func</var></dt><dd>A pointer to a callback function. Argument <var class=Fa>arg</var> is passed to the callback function <var class=Fa>func</var> as its first argument when it is invoked.</dd><dt><var class=Fa>priority</var></dt><dd>The relative priority of this callback among all the callbacks registered for this event. Valid values are those in the range <code class=Dv>EVENTHANDLER_PRI_FIRST</code> to <code class=Dv>EVENTHANDLER_PRI_LAST</code>.</dd></dl><p class=Pp>The <code class=Fn>eventhandler_register</code>() function returns a <var class=Fa>tag</var> that can later be used with <code class=Fn>eventhandler_deregister</code>() to remove the particular callback function.</p></dd><dt><code class=Fn>eventhandler_deregister</code>()</dt><dd>The <code class=Fn>eventhandler_deregister</code>() function removes the callback associated with tag <var class=Fa>tag</var> from the event handler list pointed to by <var class=Fa>list</var>. If <var class=Fa>tag</var> is <var class=Va>NULL</var>, all callback functions for the event are removed. This function will not return until all threads have exited from the removed handler callback function(s). This function is not safe to call from inside an event handler callback.</dd><dt><code class=Fn>eventhandler_deregister_nowait</code>()</dt><dd>The <code class=Fn>eventhandler_deregister</code>() function removes the callback associated with tag <var class=Fa>tag</var> from the event handler list pointed to by <var class=Fa>list</var>. This function is safe to call from inside an event handler callback.</dd><dt><code class=Fn>eventhandler_find_list</code>()</dt><dd>The <code class=Fn>eventhandler_find_list</code>() function returns a pointer to event handler list structure corresponding to event <var class=Fa>name</var>.</dd><dt><code class=Fn>eventhandler_prune_list</code>()</dt><dd>The <code class=Fn>eventhandler_prune_list</code>() function removes all deregistered callbacks from the event list <var class=Fa>list</var>.</dd></dl><section class=Ss><h2 class=Ss id=Kernel_Event_Handlers><a class=permalink href=#Kernel_Event_Handlers>Kernel Event Handlers</a></h2> The following event handlers are present in the kernel: <dl class=Bl-tag><dt><var class=Vt>acpi_sleep_event</var></dt><dd>Callbacks invoked when the system is being sent to sleep.</dd><dt><var class=Vt>acpi_wakeup_event</var></dt><dd>Callbacks invoked when the system is being woken up.</dd><dt><var class=Vt>app_coredump_start</var></dt><dd>Callbacks invoked at start of application core dump.</dd><dt><var class=Vt>app_coredump_progress</var></dt><dd>Callbacks invoked during progress of application core dump.</dd><dt><var class=Vt>app_coredump_finish</var></dt><dd>Callbacks invoked at finish of application core dump.</dd><dt><var class=Vt>app_coredump_error</var></dt><dd>Callbacks invoked on error of application core dump.</dd><dt><var class=Vt>bpf_track</var></dt><dd>Callbacks invoked when a BPF listener attaches to/detaches from network interface.</dd><dt><var class=Vt>cpufreq_levels_changed</var></dt><dd>Callback invoked when cpu frequency levels have changed.</dd><dt><var class=Vt>cpufreq_post_change</var></dt><dd>Callback invoked after cpu frequency has changed.</dd><dt><var class=Vt>cpufreq_pre_change</var></dt><dd>Callback invoked before cpu frequency has changed.</dd><dt><var class=Vt>dcons_poll</var></dt><dd>Callback invoked to poll for dcons changes.</dd><dt><var class=Vt>device_attach</var></dt><dd>Callback invoked after a device has attached.</dd><dt><var class=Vt>device_detach</var></dt><dd>Callbacks invoked before and after a device has detached.</dd><dt><var class=Vt>dev_clone</var></dt><dd>Callbacks invoked when a new entry is created under <span class=Pa>/dev</span>.</dd><dt><var class=Vt>group_attach_event</var></dt><dd>Callback invoked when an interfance has been added to an interface group.</dd><dt><var class=Vt>group_change_event</var></dt><dd>Callback invoked when an change has been made to an interface group.</dd><dt><var class=Vt>group_detach_event</var></dt><dd>Callback invoked when an interfance has been removed from an interface group.</dd><dt><var class=Vt>ifaddr_event</var></dt><dd>Callbacks invoked when an address is set up on a network interface.</dd><dt><var class=Vt>ifaddr_event_ext</var></dt><dd>Callback invoked when an address has been added or removed from an interface.</dd><dt><var class=Vt>if_clone_event</var></dt><dd>Callbacks invoked when an interface is cloned.</dd><dt><var class=Vt>iflladdr_event</var></dt><dd>Callback invoked when an if link layer address event has happened.</dd><dt><var class=Vt>ifnet_arrival_event</var></dt><dd>Callbacks invoked when a new network interface appears.</dd><dt><var class=Vt>ifnet_departure_event</var></dt><dd>Callbacks invoked when a network interface is taken down.</dd><dt><var class=Vt>ifnet_link_event</var></dt><dd>Callback invoked when an interfance link event has happened.</dd><dt><var class=Vt>kld_load</var></dt><dd>Callbacks invoked after a linker file has been loaded.</dd><dt><var class=Vt>kld_unload</var></dt><dd>Callbacks invoked after a linker file has been successfully unloaded.</dd><dt><var class=Vt>kld_unload_try</var></dt><dd>Callbacks invoked before a linker file is about to be unloaded. These callbacks may be used to return an error and prevent the unload from proceeding.</dd><dt><var class=Vt>livedumper_start</var></dt><dd>Callback invoked before beginning a kernel dump of the live system.</dd><dt><var class=Vt>livedumper_dump</var></dt><dd>Callback invoked for each dumped block of data during a live kernel dump.</dd><dt><var class=Vt>livedumper_finish</var></dt><dd>Callback invoked once a live kernel dump has completed.</dd><dt><var class=Vt>lle_event</var></dt><dd>Callback invoked when a link layer event has happened.</dd><dt><var class=Vt>nmbclusters_change</var></dt><dd>Callback invoked when the number of mbuf clusters has changed.</dd><dt><var class=Vt>nmbufs_change</var></dt><dd>Callback invoked when the number of mbufs has changed.</dd><dt><var class=Vt>maxsockets_change</var></dt><dd>Callback invoked when the maximum number of sockets has changed.</dd><dt><var class=Vt>mountroot</var></dt><dd>Callback invoked when root has been mounted.</dd><dt><var class=Vt>power_profile_change</var></dt><dd>Callbacks invoked when the power profile of the system changes.</dd><dt><var class=Vt>power_resume</var></dt><dd>Callback invoked when the system has resumed.</dd><dt><var class=Vt>power_suspend</var></dt><dd>Callback invoked just before the system is suspended.</dd><dt><var class=Vt>process_ctor</var></dt><dd>Callback invoked when a process is created.</dd><dt><var class=Vt>process_dtor</var></dt><dd>Callback invoked when a process is destroyed.</dd><dt><var class=Vt>process_exec</var></dt><dd>Callbacks invoked when a process performs an <code class=Fn>exec</code>() operation.</dd><dt><var class=Vt>process_exit</var></dt><dd>Callbacks invoked when a process exits.</dd><dt><var class=Vt>process_fini</var></dt><dd>Callback invoked when a process memory is destroyed. This is never called.</dd><dt><var class=Vt>process_fork</var></dt><dd>Callbacks invoked when a process forks a child.</dd><dt><var class=Vt>process_init</var></dt><dd>Callback invoked when a process is initialized.</dd><dt><var class=Vt>random_adaptor_attach</var></dt><dd>Callback invoked when a new random module has been loaded.</dd><dt><var class=Vt>register_framebuffer</var></dt><dd>Callback invoked when a new frame buffer is registered.</dd><dt><var class=Vt>route_redirect_event</var></dt><dd>Callback invoked when a route gets redirected to a new location.</dd><dt><var class=Vt>shutdown_pre_sync</var></dt><dd>Callbacks invoked at shutdown time, before file systems are synchronized.</dd><dt><var class=Vt>shutdown_post_sync</var></dt><dd>Callbacks invoked at shutdown time, after all file systems are synchronized.</dd><dt><var class=Vt>shutdown_final</var></dt><dd>Callbacks invoked just before halting the system.</dd><dt><var class=Vt>tcp_offload_listen_start</var></dt><dd>Callback invoked for TCP Offload to start listening for new connections.</dd><dt><var class=Vt>tcp_offload_listen_stop</var></dt><dd>Callback invoked ror TCP Offload to stop listening for new connections.</dd><dt><var class=Vt>thread_ctor</var></dt><dd>Callback invoked when a thread object is created.</dd><dt><var class=Vt>thread_dtor</var></dt><dd>Callback invoked when a thread object is destroyed.</dd><dt><var class=Vt>thread_init</var></dt><dd>Callback invoked when a thread object is initialized.</dd><dt><var class=Vt>thread_fini</var></dt><dd>Callback invoked when a thread object is deinitalized.</dd><dt><var class=Vt>usb_dev_configured</var></dt><dd>Callback invoked when a USB device is configured</dd><dt><var class=Vt>unregister_framebuffer</var></dt><dd>Callback invoked when a frame buffer is deregistered.</dd><dt><var class=Vt>vfs_mounted</var></dt><dd>Callback invoked when a file system is mounted.</dd><dt><var class=Vt>vfs_unmounted</var></dt><dd>Callback invoked when a file system is unmounted.</dd><dt><var class=Vt>vlan_config</var></dt><dd>Callback invoked when the vlan configuration has changed.</dd><dt><var class=Vt>vlan_unconfig</var></dt><dd>Callback invoked when a vlan is destroyed.</dd><dt><var class=Vt>vm_lowmem</var></dt><dd>Callbacks invoked when virtual memory is low.</dd><dt><var class=Vt>vxlan_start</var></dt><dd>Callback invoked when a vxlan interface starts.</dd><dt><var class=Vt>vxlan_stop</var></dt><dd>Callback invoked when a vxlan interface stops.</dd><dt><var class=Vt>watchdog_list</var></dt><dd>Callbacks invoked when the system watchdog timer is reinitialized.</dd></dl></section></section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2> The macro <code class=Fn>EVENTHANDLER_REGISTER</code>() and function <code class=Fn>eventhandler_register</code>() return a cookie of type <var class=Vt>eventhandler_tag</var>, which may be used in a subsequent call to <code class=Fn>EVENTHANDLER_DEREGISTER</code>() or <code class=Fn>eventhandler_deregister</code>(). <p class=Pp>The <code class=Fn>eventhandler_find_list</code>() function returns a pointer to an event handler list corresponding to parameter <var class=Fa>name</var>, or <code class=Dv>NULL</code> if no such list was found.</p></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>EVENTHANDLER</code> facility first appeared in <span class=Ux>FreeBSD 4.0</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> This manual page was written by <span class=An>Joseph Koshy</span> &lt;<a class=Mt href=mailto:jkoshy@FreeBSD.org>jkoshy@FreeBSD.org</a>&gt; and <br><span class=An>Matt Joras</span> &lt;<a class=Mt href=mailto:mjoras@FreeBSD.org>mjoras@FreeBSD.org</a>&gt;. </section></div><table class=foot><tr><td class=foot-date>September 17, 2020</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>