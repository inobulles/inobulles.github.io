<!DOCTYPE html>
<html><head><meta charset=utf-8><title>zfs-send(8)</title><keywords content=man,zfs-send></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>zfs-send(8)</h1><table class=head><tr><td class=head-ltitle>ZFS-SEND(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>ZFS-SEND(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>zfs-send</code> — <div class=Nd>generate backup stream of ZFS dataset</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>zfs</code></td><td><code class=Cm>send</code> [<code class=Fl>-DLPbcehnpsvw</code>] [<code class=Fl>-R</code> [<code class=Fl>-X</code><var class=Ar>dataset</var>[,<var class=Ar>dataset</var>]…]] [[<code class=Fl>-I</code>|<code class=Fl>-i</code>] <var class=Ar>snapshot</var>] <var class=Ar>snapshot</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>zfs</code></td><td><code class=Cm>send</code> [<code class=Fl>-DLPcensvw</code>] [<code class=Fl>-i</code><var class=Ar>snapshot</var>|<var class=Ar>bookmark</var>] <var class=Ar>filesystem</var>|<var class=Ar>volume</var>|<var class=Ar>snapshot</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>zfs</code></td><td><code class=Cm>send</code><code class=Fl>--redact</code><var class=Ar>redaction_bookmark</var> [<code class=Fl>-DLPcenpv</code>] [<code class=Fl>-i</code><var class=Ar>snapshot</var>|<var class=Ar>bookmark</var>] <var class=Ar>snapshot</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>zfs</code></td><td><code class=Cm>send</code> [<code class=Fl>-Penv</code>] <code class=Fl>-t</code><var class=Ar>receive_resume_token</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>zfs</code></td><td><code class=Cm>send</code> [<code class=Fl>-Pnv</code>] <code class=Fl>-S</code><var class=Ar>filesystem</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>zfs</code></td><td><code class=Cm>redact</code><var class=Ar>snapshot redaction_bookmark</var><var class=Ar>redaction_snapshot</var>…</td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2><dl class=Bl-tag><dt><code class=Nm>zfs</code><code class=Cm>send</code> [<code class=Fl>-DLPbcehnpsvw</code>] [<code class=Fl>-R</code> [<code class=Fl>-X</code><var class=Ar>dataset</var>[,<var class=Ar>dataset</var>]…]] [[<code class=Fl>-I</code>|<code class=Fl>-i</code>] <var class=Ar>snapshot</var>] <var class=Ar>snapshot</var></dt><dd>Creates a stream representation of the second <var class=Ar>snapshot</var>, which is written to standard output. The output can be redirected to a file or to a different system (for example, using <a class=Xr href=ssh.1.html>ssh(1)</a>). By default, a full stream is generated. <dl class=Bl-tag><dt><a class=permalink href=#D><code class=Fl id=D>-D</code></a>, <code class=Fl>--dedup</code></dt><dd>Deduplicated send is no longer supported. This flag is accepted for backwards compatibility, but a regular, non-deduplicated stream will be generated.</dd><dt><a class=permalink href=#I><code class=Fl id=I>-I</code></a><var class=Ar>snapshot</var></dt><dd>Generate a stream package that sends all intermediary snapshots from the first snapshot to the second snapshot. For example, <code class=Fl>-I</code><i class=Em>@a</i><i class=Em>fs@d</i> is similar to <code class=Fl>-i</code><i class=Em>@a</i><i class=Em>fs@b</i>; <code class=Fl>-i</code><i class=Em>@b</i><i class=Em>fs@c</i>; <code class=Fl>-i</code><i class=Em>@c</i><i class=Em>fs@d</i>. The incremental source may be specified as with the <code class=Fl>-i</code> option.</dd><dt><a class=permalink href=#L><code class=Fl id=L>-L</code></a>, <code class=Fl>--large-block</code></dt><dd>Generate a stream which may contain blocks larger than 128 KiB. This flag has no effect if the <b class=Sy>large_blocks</b> pool feature is disabled, or if the <b class=Sy>recordsize</b> property of this filesystem has never been set above 128 KiB. The receiving system must have the <b class=Sy>large_blocks</b> pool feature enabled as well. See <a class=Xr href=zpool-features.7.html>zpool-features(7)</a> for details on ZFS feature flags and the <b class=Sy>large_blocks</b> feature.</dd><dt><a class=permalink href=#P><code class=Fl id=P>-P</code></a>, <code class=Fl>--parsable</code></dt><dd>Print machine-parsable verbose information about the stream package generated.</dd><dt><a class=permalink href=#R><code class=Fl id=R>-R</code></a>, <code class=Fl>--replicate</code></dt><dd>Generate a replication stream package, which will replicate the specified file system, and all descendent file systems, up to the named snapshot. When received, all properties, snapshots, descendent file systems, and clones are preserved. <p class=Pp>If the <code class=Fl>-i</code> or <code class=Fl>-I</code> flags are used in conjunction with the <code class=Fl>-R</code> flag, an incremental replication stream is generated. The current values of properties, and current snapshot and file system names are set when the stream is received. If the <code class=Fl>-F</code> flag is specified when this stream is received, snapshots and file systems that do not exist on the sending side are destroyed. If the <code class=Fl>-R</code> flag is used to send encrypted datasets, then <code class=Fl>-w</code> must also be specified.</p></dd><dt><a class=permalink href=#X><code class=Fl id=X>-X</code></a>, <code class=Fl>--exclude</code><var class=Ar>dataset</var>[,<var class=Ar>dataset</var>]…</dt><dd>With <code class=Fl>-R</code>, <code class=Fl>-X</code> specifies a set of datasets (and, hence, their descendants), to be excluded from the send stream. The root dataset may not be excluded. <code class=Fl>-X</code><var class=Ar>a</var><code class=Fl>-X</code><var class=Ar>b</var> is equivalent to <code class=Fl>-X</code><var class=Ar>a</var>,<var class=Ar>b</var>.</dd><dt><a class=permalink href=#e><code class=Fl id=e>-e</code></a>, <code class=Fl>--embed</code></dt><dd>Generate a more compact stream by using <b class=Sy>WRITE_EMBEDDED</b> records for blocks which are stored more compactly on disk by the <b class=Sy>embedded_data</b> pool feature. This flag has no effect if the <b class=Sy>embedded_data</b> feature is disabled. The receiving system must have the <b class=Sy>embedded_data</b> feature enabled. If the <b class=Sy>lz4_compress</b> feature is active on the sending system, then the receiving system must have that feature enabled as well. Datasets that are sent with this flag may not be received as an encrypted dataset, since encrypted datasets cannot use the <b class=Sy>embedded_data</b> feature. See <a class=Xr href=zpool-features.7.html>zpool-features(7)</a> for details on ZFS feature flags and the <b class=Sy>embedded_data</b> feature.</dd><dt><a class=permalink href=#b><code class=Fl id=b>-b</code></a>, <code class=Fl>--backup</code></dt><dd>Sends only received property values whether or not they are overridden by local settings, but only if the dataset has ever been received. Use this option when you want <code class=Nm>zfs</code><code class=Cm>receive</code> to restore received properties backed up on the sent dataset and to avoid sending local settings that may have nothing to do with the source dataset, but only with how the data is backed up.</dd><dt><a class=permalink href=#c><code class=Fl id=c>-c</code></a>, <code class=Fl>--compressed</code></dt><dd>Generate a more compact stream by using compressed WRITE records for blocks which are compressed on disk and in memory (see the <b class=Sy>compression</b> property for details). If the <b class=Sy>lz4_compress</b> feature is active on the sending system, then the receiving system must have that feature enabled as well. If the <b class=Sy>large_blocks</b> feature is enabled on the sending system but the <code class=Fl>-L</code> option is not supplied in conjunction with <code class=Fl>-c</code>, then the data will be decompressed before sending so it can be split into smaller block sizes. Streams sent with <code class=Fl>-c</code> will not have their data recompressed on the receiver side using <code class=Fl>-o</code><b class=Sy>compress</b>= <var class=Ar>value</var>. The data will stay compressed as it was from the sender. The new compression property will be set for future data. Note that uncompressed data from the sender will still attempt to compress on the receiver, unless you specify <code class=Fl>-o</code><b class=Sy>compress</b>= <i class=Em>off</i>.</dd><dt><a class=permalink href=#w><code class=Fl id=w>-w</code></a>, <code class=Fl>--raw</code></dt><dd>For encrypted datasets, send data exactly as it exists on disk. This allows backups to be taken even if encryption keys are not currently loaded. The backup may then be received on an untrusted machine since that machine will not have the encryption keys to read the protected data or alter it without being detected. Upon being received, the dataset will have the same encryption keys as it did on the send side, although the <b class=Sy>keylocation</b> property will be defaulted to <b class=Sy>prompt</b> if not otherwise provided. For unencrypted datasets, this flag will be equivalent to <code class=Fl>-Lec</code>. Note that if you do not use this flag for sending encrypted datasets, data will be sent unencrypted and may be re-encrypted with a different encryption key on the receiving system, which will disable the ability to do a raw send to that system for incrementals.</dd><dt><a class=permalink href=#h><code class=Fl id=h>-h</code></a>, <code class=Fl>--holds</code></dt><dd>Generate a stream package that includes any snapshot holds (created with the <code class=Nm>zfs</code><code class=Cm>hold</code> command), and indicating to <code class=Nm>zfs</code><code class=Cm>receive</code> that the holds be applied to the dataset on the receiving system.</dd><dt><a class=permalink href=#i><code class=Fl id=i>-i</code></a><var class=Ar>snapshot</var></dt><dd>Generate an incremental stream from the first <var class=Ar>snapshot</var> (the incremental source) to the second <var class=Ar>snapshot</var> (the incremental target). The incremental source can be specified as the last component of the snapshot name (the <b class=Sy>@</b> character and following) and it is assumed to be from the same file system as the incremental target. <p class=Pp>If the destination is a clone, the source may be the origin snapshot, which must be fully specified (for example, <i class=Em>pool/fs@origin</i>, not just <i class=Em>@origin</i>).</p></dd><dt><a class=permalink href=#n><code class=Fl id=n>-n</code></a>, <code class=Fl>--dryrun</code></dt><dd>Do a dry-run (“No-op”) send. Do not generate any actual send data. This is useful in conjunction with the <code class=Fl>-v</code> or <code class=Fl>-P</code> flags to determine what data will be sent. In this case, the verbose output will be written to standard output (contrast with a non-dry-run, where the stream is written to standard output and the verbose output goes to standard error).</dd><dt><a class=permalink href=#p><code class=Fl id=p>-p</code></a>, <code class=Fl>--props</code></dt><dd>Include the dataset's properties in the stream. This flag is implicit when <code class=Fl>-R</code> is specified. The receiving system must also support this feature. Sends of encrypted datasets must use <code class=Fl>-w</code> when using this flag.</dd><dt><a class=permalink href=#s><code class=Fl id=s>-s</code></a>, <code class=Fl>--skip-missing</code></dt><dd>Allows sending a replication stream even when there are snapshots missing in the hierarchy. When a snapshot is missing, instead of throwing an error and aborting the send, a warning is printed to the standard error stream and the dataset to which it belongs and its descendents are skipped. This flag can only be used in conjunction with <code class=Fl>-R</code>.</dd><dt><a class=permalink href=#v><code class=Fl id=v>-v</code></a>, <code class=Fl>--verbose</code></dt><dd>Print verbose information about the stream package generated. This information includes a per-second report of how much data has been sent. <p class=Pp>The format of the stream is committed. You will be able to receive your streams on future versions of ZFS.</p></dd></dl></dd><dt><code class=Nm>zfs</code><code class=Cm>send</code> [<code class=Fl>-DLPcenvw</code>] [<code class=Fl>-i</code><var class=Ar>snapshot</var>|<var class=Ar>bookmark</var>] <var class=Ar>filesystem</var>|<var class=Ar>volume</var>|<var class=Ar>snapshot</var></dt><dd>Generate a send stream, which may be of a filesystem, and may be incremental from a bookmark. If the destination is a filesystem or volume, the pool must be read-only, or the filesystem must not be mounted. When the stream generated from a filesystem or volume is received, the default snapshot name will be “--head--”. <dl class=Bl-tag><dt><a class=permalink href=#D_2><code class=Fl id=D_2>-D</code></a>, <code class=Fl>--dedup</code></dt><dd>Deduplicated send is no longer supported. This flag is accepted for backwards compatibility, but a regular, non-deduplicated stream will be generated.</dd><dt><a class=permalink href=#L_2><code class=Fl id=L_2>-L</code></a>, <code class=Fl>--large-block</code></dt><dd>Generate a stream which may contain blocks larger than 128 KiB. This flag has no effect if the <b class=Sy>large_blocks</b> pool feature is disabled, or if the <b class=Sy>recordsize</b> property of this filesystem has never been set above 128 KiB. The receiving system must have the <b class=Sy>large_blocks</b> pool feature enabled as well. See <a class=Xr href=zpool-features.7.html>zpool-features(7)</a> for details on ZFS feature flags and the <b class=Sy>large_blocks</b> feature.</dd><dt><a class=permalink href=#P_2><code class=Fl id=P_2>-P</code></a>, <code class=Fl>--parsable</code></dt><dd>Print machine-parsable verbose information about the stream package generated.</dd><dt><a class=permalink href=#c_2><code class=Fl id=c_2>-c</code></a>, <code class=Fl>--compressed</code></dt><dd>Generate a more compact stream by using compressed WRITE records for blocks which are compressed on disk and in memory (see the <b class=Sy>compression</b> property for details). If the <b class=Sy>lz4_compress</b> feature is active on the sending system, then the receiving system must have that feature enabled as well. If the <b class=Sy>large_blocks</b> feature is enabled on the sending system but the <code class=Fl>-L</code> option is not supplied in conjunction with <code class=Fl>-c</code>, then the data will be decompressed before sending so it can be split into smaller block sizes.</dd><dt><a class=permalink href=#w_2><code class=Fl id=w_2>-w</code></a>, <code class=Fl>--raw</code></dt><dd>For encrypted datasets, send data exactly as it exists on disk. This allows backups to be taken even if encryption keys are not currently loaded. The backup may then be received on an untrusted machine since that machine will not have the encryption keys to read the protected data or alter it without being detected. Upon being received, the dataset will have the same encryption keys as it did on the send side, although the <b class=Sy>keylocation</b> property will be defaulted to <b class=Sy>prompt</b> if not otherwise provided. For unencrypted datasets, this flag will be equivalent to <code class=Fl>-Lec</code>. Note that if you do not use this flag for sending encrypted datasets, data will be sent unencrypted and may be re-encrypted with a different encryption key on the receiving system, which will disable the ability to do a raw send to that system for incrementals.</dd><dt><a class=permalink href=#e_2><code class=Fl id=e_2>-e</code></a>, <code class=Fl>--embed</code></dt><dd>Generate a more compact stream by using <b class=Sy>WRITE_EMBEDDED</b> records for blocks which are stored more compactly on disk by the <b class=Sy>embedded_data</b> pool feature. This flag has no effect if the <b class=Sy>embedded_data</b> feature is disabled. The receiving system must have the <b class=Sy>embedded_data</b> feature enabled. If the <b class=Sy>lz4_compress</b> feature is active on the sending system, then the receiving system must have that feature enabled as well. Datasets that are sent with this flag may not be received as an encrypted dataset, since encrypted datasets cannot use the <b class=Sy>embedded_data</b> feature. See <a class=Xr href=zpool-features.7.html>zpool-features(7)</a> for details on ZFS feature flags and the <b class=Sy>embedded_data</b> feature.</dd><dt><a class=permalink href=#i_2><code class=Fl id=i_2>-i</code></a><var class=Ar>snapshot</var>|<var class=Ar>bookmark</var></dt><dd>Generate an incremental send stream. The incremental source must be an earlier snapshot in the destination's history. It will commonly be an earlier snapshot in the destination's file system, in which case it can be specified as the last component of the name (the <b class=Sy>#</b> or <b class=Sy>@</b> character and following). <p class=Pp>If the incremental target is a clone, the incremental source can be the origin snapshot, or an earlier snapshot in the origin's filesystem, or the origin's origin, etc.</p></dd><dt><a class=permalink href=#n_2><code class=Fl id=n_2>-n</code></a>, <code class=Fl>--dryrun</code></dt><dd>Do a dry-run (“No-op”) send. Do not generate any actual send data. This is useful in conjunction with the <code class=Fl>-v</code> or <code class=Fl>-P</code> flags to determine what data will be sent. In this case, the verbose output will be written to standard output (contrast with a non-dry-run, where the stream is written to standard output and the verbose output goes to standard error).</dd><dt><a class=permalink href=#v_2><code class=Fl id=v_2>-v</code></a>, <code class=Fl>--verbose</code></dt><dd>Print verbose information about the stream package generated. This information includes a per-second report of how much data has been sent.</dd></dl></dd><dt><code class=Nm>zfs</code><code class=Cm>send</code><code class=Fl>--redact</code><var class=Ar>redaction_bookmark</var> [<code class=Fl>-DLPcenpv</code>] [<code class=Fl>-i</code><var class=Ar>snapshot</var>|<var class=Ar>bookmark</var>] <var class=Ar>snapshot</var></dt><dd>Generate a redacted send stream. This send stream contains all blocks from the snapshot being sent that aren't included in the redaction list contained in the bookmark specified by the <code class=Fl>--redact</code> (or <code class=Fl>-d</code>) flag. The resulting send stream is said to be redacted with respect to the snapshots the bookmark specified by the <code class=Fl>--redact</code><span class=No>flag was created with.</span> The bookmark must have been created by running <code class=Nm>zfs</code><code class=Cm>redact</code> on the snapshot being sent. <p class=Pp>This feature can be used to allow clones of a filesystem to be made available on a remote system, in the case where their parent need not (or needs to not) be usable. For example, if a filesystem contains sensitive data, and it has clones where that sensitive data has been secured or replaced with dummy data, redacted sends can be used to replicate the secured data without replicating the original sensitive data, while still sharing all possible blocks. A snapshot that has been redacted with respect to a set of snapshots will contain all blocks referenced by at least one snapshot in the set, but will contain none of the blocks referenced by none of the snapshots in the set. In other words, if all snapshots in the set have modified a given block in the parent, that block will not be sent; but if one or more snapshots have not modified a block in the parent, they will still reference the parent's block, so that block will be sent. Note that only user data will be redacted.</p><p class=Pp>When the redacted send stream is received, we will generate a redacted snapshot. Due to the nature of redaction, a redacted dataset can only be used in the following ways:</p><ol class=Bl-enum><li>To receive, as a clone, an incremental send from the original snapshot to one of the snapshots it was redacted with respect to. In this case, the stream will produce a valid dataset when received because all blocks that were redacted in the parent are guaranteed to be present in the child's send stream. This use case will produce a normal snapshot, which can be used just like other snapshots.</li><li>To receive an incremental send from the original snapshot to something redacted with respect to a subset of the set of snapshots the initial snapshot was redacted with respect to. In this case, each block that was redacted in the original is still redacted (redacting with respect to additional snapshots causes less data to be redacted (because the snapshots define what is permitted, and everything else is redacted)). This use case will produce a new redacted snapshot.</li><li>To receive an incremental send from a redaction bookmark of the original snapshot that was created when redacting with respect to a subset of the set of snapshots the initial snapshot was created with respect to anything else. A send stream from such a redaction bookmark will contain all of the blocks necessary to fill in any redacted data, should it be needed, because the sending system is aware of what blocks were originally redacted. This will either produce a normal snapshot or a redacted one, depending on whether the new send stream is redacted.</li><li>To receive an incremental send from a redacted version of the initial snapshot that is redacted with respect to a subject of the set of snapshots the initial snapshot was created with respect to. A send stream from a compatible redacted dataset will contain all of the blocks necessary to fill in any redacted data. This will either produce a normal snapshot or a redacted one, depending on whether the new send stream is redacted.</li><li>To receive a full send as a clone of the redacted snapshot. Since the stream is a full send, it definitionally contains all the data needed to create a new dataset. This use case will either produce a normal snapshot or a redacted one, depending on whether the full send stream was redacted.</li></ol><p class=Pp>These restrictions are detected and enforced by <code class=Nm>zfs</code><code class=Cm>receive</code>; a redacted send stream will contain the list of snapshots that the stream is redacted with respect to. These are stored with the redacted snapshot, and are used to detect and correctly handle the cases above. Note that for technical reasons, raw sends and redacted sends cannot be combined at this time.</p></dd><dt><code class=Nm>zfs</code><code class=Cm>send</code> [<code class=Fl>-Penv</code>] <code class=Fl>-t</code><var class=Ar>receive_resume_token</var></dt><dd>Creates a send stream which resumes an interrupted receive. The <var class=Ar>receive_resume_token</var> is the value of this property on the filesystem or volume that was being received into. See the documentation for <code class=Nm>zfs</code><code class=Cm>receive</code><code class=Fl>-s</code> for more details.</dd><dt><code class=Nm>zfs</code><code class=Cm>send</code> [<code class=Fl>-Pnv</code>] [<code class=Fl>-i</code><var class=Ar>snapshot</var>|<var class=Ar>bookmark</var>] <code class=Fl>-S</code><var class=Ar>filesystem</var></dt><dd>Generate a send stream from a dataset that has been partially received. <dl class=Bl-tag><dt><a class=permalink href=#S><code class=Fl id=S>-S</code></a>, <code class=Fl>--saved</code></dt><dd>This flag requires that the specified filesystem previously received a resumable send that did not finish and was interrupted. In such scenarios this flag enables the user to send this partially received state. Using this flag will always use the last fully received snapshot as the incremental source if it exists.</dd></dl></dd><dt><code class=Nm>zfs</code><code class=Cm>redact</code><var class=Ar>snapshot redaction_bookmark</var><var class=Ar>redaction_snapshot</var>…</dt><dd>Generate a new redaction bookmark. In addition to the typical bookmark information, a redaction bookmark contains the list of redacted blocks and the list of redaction snapshots specified. The redacted blocks are blocks in the snapshot which are not referenced by any of the redaction snapshots. These blocks are found by iterating over the metadata in each redaction snapshot to determine what has been changed since the target snapshot. Redaction is designed to support redacted zfs sends; see the entry for <code class=Nm>zfs</code><code class=Cm>send</code> for more information on the purpose of this operation. If a redact operation fails partway through (due to an error or a system failure), the redaction can be resumed by rerunning the same command.</dd></dl><section class=Ss><h2 class=Ss id=Redaction><a class=permalink href=#Redaction>Redaction</a></h2> ZFS has support for a limited version of data subsetting, in the form of redaction. Using the <code class=Nm>zfs</code><code class=Cm>redact</code> command, a <b class=Sy>redaction bookmark</b> can be created that stores a list of blocks containing sensitive information. When provided to <code class=Nm>zfs</code><code class=Cm>send</code>, this causes a <b class=Sy>redacted send</b> to occur. Redacted sends omit the blocks containing sensitive information, replacing them with REDACT records. When these send streams are received, a <b class=Sy>redacted dataset</b> is created. A redacted dataset cannot be mounted by default, since it is incomplete. It can be used to receive other send streams. In this way datasets can be used for data backup and replication, with all the benefits that zfs send and receive have to offer, while protecting sensitive information from being stored on less-trusted machines or services. <p class=Pp>For the purposes of redaction, there are two steps to the process. A redact step, and a send/receive step. First, a redaction bookmark is created. This is done by providing the <code class=Nm>zfs</code><code class=Cm>redact</code> command with a parent snapshot, a bookmark to be created, and a number of redaction snapshots. These redaction snapshots must be descendants of the parent snapshot, and they should modify data that is considered sensitive in some way. Any blocks of data modified by all of the redaction snapshots will be listed in the redaction bookmark, because it represents the truly sensitive information. When it comes to the send step, the send process will not send the blocks listed in the redaction bookmark, instead replacing them with REDACT records. When received on the target system, this will create a redacted dataset, missing the data that corresponds to the blocks in the redaction bookmark on the sending system. The incremental send streams from the original parent to the redaction snapshots can then also be received on the target system, and this will produce a complete snapshot that can be used normally. Incrementals from one snapshot on the parent filesystem and another can also be done by sending from the redaction bookmark, rather than the snapshots themselves.</p><p class=Pp>In order to make the purpose of the feature more clear, an example is provided. Consider a zfs filesystem containing four files. These files represent information for an online shopping service. One file contains a list of usernames and passwords, another contains purchase histories, a third contains click tracking data, and a fourth contains user preferences. The owner of this data wants to make it available for their development teams to test against, and their market research teams to do analysis on. The development teams need information about user preferences and the click tracking data, while the market research teams need information about purchase histories and user preferences. Neither needs access to the usernames and passwords. However, because all of this data is stored in one ZFS filesystem, it must all be sent and received together. In addition, the owner of the data wants to take advantage of features like compression, checksumming, and snapshots, so they do want to continue to use ZFS to store and transmit their data. Redaction can help them do so. First, they would make two clones of a snapshot of the data on the source. In one clone, they create the setup they want their market research team to see; they delete the usernames and passwords file, and overwrite the click tracking data with dummy information. In another, they create the setup they want the development teams to see, by replacing the passwords with fake information and replacing the purchase histories with randomly generated ones. They would then create a redaction bookmark on the parent snapshot, using snapshots on the two clones as redaction snapshots. The parent can then be sent, redacted, to the target server where the research and development teams have access. Finally, incremental sends from the parent snapshot to each of the clones can be sent to and received on the target server; these snapshots are identical to the ones on the source, and are ready to be used, while the parent snapshot on the target contains none of the username and password data present on the source, because it was removed by the redacted send operation.</p></section></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2><section class=Ss><h2 class=Ss>Example 1: <span class=No>Remotely Replicating ZFS Data</span></h2> The following commands send a full stream and then an incremental stream to a remote machine, restoring them into <i class=Em>poolB/received/fs@a</i> and <i class=Em>poolB/received/fs@b</i>, respectively. <i class=Em>poolB</i> must contain the file system <i class=Em>poolB/received</i>, and must not initially contain <i class=Em>poolB/received/fs</i>. <div class="Bd Bd-indent"><pre>
<span class=No>#
</span> <code class=Nm>zfs
</code> <code class=Cm>send
</code> <var class=Ar>pool/fs@a
</var> |
<span class=No>   
</span> <code class=Nm>ssh
</code> <var class=Ar>host
</var> <code class=Nm>zfs
</code> <code class=Cm>receive
</code> <var class=Ar>poolB/received/fs
</var>@<var class=Ar>a
</var>
<span class=No>#
</span> <code class=Nm>zfs
</code> <code class=Cm>send
</code> <code class=Fl>-i
</code> <var class=Ar>a pool/fs@b
</var> |
<span class=No>   
</span> <code class=Nm>ssh
</code> <var class=Ar>host
</var> <code class=Nm>zfs
</code> <code class=Cm>receive
</code> <var class=Ar>poolB/received/fs
</var>
</pre></div></section><section class=Ss><h2 class=Ss>Example 2: <span class=No>Using the</span><code class=Nm>zfs</code><code class=Cm>receive</code><code class=Fl>-d</code><span class=No>Option</span></h2> The following command sends a full stream of <var class=Ar>poolA/fsA/fsB@snap</var> to a remote machine, receiving it into <var class=Ar>poolB/received/fsA/fsB@snap</var>. The <var class=Ar>fsA/fsB@snap</var> portion of the received snapshot's name is determined from the name of the sent snapshot. <var class=Ar>poolB</var> must contain the file system <var class=Ar>poolB/received</var>. If <var class=Ar>poolB/received/fsA</var> does not exist, it is created as an empty file system. <div class="Bd Bd-indent"><pre>
<span class=No>#
</span> <code class=Nm>zfs
</code> <code class=Cm>send
</code> <var class=Ar>poolA/fsA/fsB@snap
</var> |
<span class=No>   
</span> <code class=Nm>ssh
</code> <var class=Ar>host
</var> <code class=Nm>zfs
</code> <code class=Cm>receive
</code> <code class=Fl>-d
</code> <var class=Ar>poolB/received
</var>
</pre></div></section></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=zfs-bookmark.8.html>zfs-bookmark(8)</a>, <a class=Xr href=zfs-receive.8.html>zfs-receive(8)</a>, <a class=Xr href=zfs-redact.8.html>zfs-redact(8)</a>, <a class=Xr href=zfs-snapshot.8.html>zfs-snapshot(8)</a></section></div><table class=foot><tr><td class=foot-date>March 16, 2022</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>