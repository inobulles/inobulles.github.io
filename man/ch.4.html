<!DOCTYPE html>
<html><head><meta charset=utf-8><title>ch(4)</title><keywords content=man,ch></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>ch(4)</h1><table class=head><tr><td class=head-ltitle>CH(4)</td><td class=head-vol>FreeBSD Kernel Interfaces Manual</td><td class=head-rtitle>CH(4)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>ch</code> — <div class=Nd>SCSI media-changer (juke box) driver</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=Cd>device ch</code></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>ch</code> driver provides support for a <i class=Em>SCSI</i> media changer. It allows many slots of media to be multiplexed between a number of drives. The changer device may optionally be equipped with a bar code reader, which reads label information attached to the media. <p class=Pp>A SCSI adapter must also be separately configured into the system before a SCSI changer can be configured.</p><p class=Pp>As the SCSI adapter is probed during boot, the <i class=Em>SCSI</i> bus is scanned for devices. Any devices found which answer as 'Changer' type devices will be 'attached' to the <code class=Nm>ch</code> driver. In <span class=Ux>FreeBSD</span> releases prior to 2.1, the first found will be attached as <i class=Em>ch0</i> and the next, <i class=Em>ch1</i> etc. Beginning in 2.1 it is possible to specify what ch unit a device should come on line as; refer to <a class=Xr href=scsi.4.html>scsi(4)</a> for details on kernel configuration.</p></section><section class=Sh><h2 class=Sh id=KERNEL_CONFIGURATION><a class=permalink href=#KERNEL_CONFIGURATION>KERNEL CONFIGURATION</a></h2> It is only necessary to explicitly configure one <code class=Nm>ch</code> device; data structures are dynamically allocated as media changes are found on the SCSI bus. </section><section class=Sh><h2 class=Sh id=IOCTLS><a class=permalink href=#IOCTLS>IOCTLS</a></h2> User mode programs communicate with the changer driver through a number of ioctls which are described below. Changer element addresses used in the communication between the kernel and the changer device are mapped to zero-based logical addresses. Element types are specified as follows: <dl class=Bl-tag><dt><a class=permalink href=#CHET_MT><code class=Dv id=CHET_MT>CHET_MT</code></a></dt><dd>Medium transport element (picker).</dd><dt><a class=permalink href=#CHET_ST><code class=Dv id=CHET_ST>CHET_ST</code></a></dt><dd>Storage element (slot).</dd><dt><a class=permalink href=#CHET_IE><code class=Dv id=CHET_IE>CHET_IE</code></a></dt><dd>Import/export element (portal).</dd><dt><a class=permalink href=#CHET_DT><code class=Dv id=CHET_DT>CHET_DT</code></a></dt><dd>Data transfer element (drive).</dd></dl><p class=Pp>The following <a class=Xr href=ioctl.2.html>ioctl(2)</a> calls apply to the changer. They are defined in the header file <code class=In>&lt;<a class=In href=../src/sys/chio.h.html>sys/chio.h</a>&gt;</code>.</p><dl class=Bl-tag><dt><a class=permalink href=#CHIOMOVE><code class=Dv id=CHIOMOVE>CHIOMOVE</code></a></dt><dd>(<var class=Vt>struct changer_move</var>) Move a medium from one element to another (<b class=Sy>MOVE MEDIUM</b>) using the current picker. The source and destination elements are specified in a changer_move structure, which includes at least the following fields: <div class="Bd Pp Bd-indent"><pre>
u_int cm_fromtype; /* element type to move from */
u_int cm_fromunit; /* logical unit of from element */
u_int cm_totype;   /* element type to move to */
u_int cm_tounit;   /* logical unit of to element */
u_int cm_flags;	   /* misc. flags */
    </pre></div> If the <code class=Dv>CM_INVERT</code> in the <var class=Va>cm_flags</var> field is set, the medium changer is instructed to flip the medium while moving it.</dd><dt><a class=permalink href=#CHIOEXCHANGE><code class=Dv id=CHIOEXCHANGE>CHIOEXCHANGE</code></a></dt><dd>(<var class=Vt>struct changer_exchange</var>) Move the medium located in the source element to the first destination element, and move the medium that had been in the first destination element to the second destination element. In case of a simple exchange, the source and second destination elements should be the same. The current picker is used to perform the operation. The addresses of the affected elements is specified to the ioctl in a <var class=Vt>changer_exchange</var> structure which includes at least the following fields: <div class="Bd Pp Bd-indent"><pre>
u_int ce_srctype;	 /* element type of source */
u_int ce_srcunit;	 /* logical unit of source */
u_int ce_fdsttype; /* element type of first destination */
u_int ce_fdstunit; /* logical unit of first destination */
u_int ce_sdsttype; /* element type of second destination */
u_int ce_sdstunit; /* logical unit of second destination */
u_int ce_flags;	 /* misc. flags */
    </pre></div> In <var class=Va>ce_flags</var>, <code class=Dv>CM_INVERT1</code> and/or <code class=Dv>CM_INVERT2</code> may be set to flip the first or second medium during the exchange operation, respectively. <p class=Pp><i class=Em>This operation is untested</i>.</p></dd><dt><a class=permalink href=#CHIOPOSITION><code class=Dv id=CHIOPOSITION>CHIOPOSITION</code></a></dt><dd>(<var class=Vt>struct changer_position</var>) Position the current picker in front of the specified element. The element is specified with a changer_position structure, which includes at least the following elements: <div class="Bd Pp Bd-indent"><pre>
u_int cp_type;  /* element type */
u_int cp_unit;  /* logical unit of element */
u_int cp_flags; /* misc. flags */
    </pre></div> The <var class=Va>cp_flags</var> field may be set to <code class=Dv>CP_INVERT</code> to invert the picker during the operation.</dd><dt><a class=permalink href=#CHIOGPICKER><code class=Dv id=CHIOGPICKER>CHIOGPICKER</code></a></dt><dd>(<var class=Vt>int</var>) Return the logical address of the current picker.</dd><dt><a class=permalink href=#CHIOSPICKER><code class=Dv id=CHIOSPICKER>CHIOSPICKER</code></a></dt><dd>(<var class=Vt>int</var>) Select the picker specified by the given logical address.</dd><dt><a class=permalink href=#CHIOGPARAMS><code class=Dv id=CHIOGPARAMS>CHIOGPARAMS</code></a></dt><dd>(<var class=Vt>struct changer_params</var>) Return the configuration parameters for the media changer. This ioctl fills the changer_params structure passed by the user with at least the following fields: <div class="Bd Pp Bd-indent"><pre>
u_int cp_npickers; /* number of pickers */
u_int cp_nslots;   /* number of slots */
u_int cp_nportals; /* number of import/export portals */
u_int cp_ndrives;  /* number of drives */
    </pre></div><p class=Pp>This call can be used by applications to query the dimensions of the jukebox before using the <code class=Dv>CHIGSTATUS</code> ioctl to query the jukebox status.</p></dd><dt><a class=permalink href=#CHIOIELEM><code class=Dv id=CHIOIELEM>CHIOIELEM</code></a></dt><dd>Perform the <b class=Sy>INITIALIZE ELEMENT STATUS</b> call on the media changer device. This forces the media changer to update its internal status information with respect to loaded media. It also scans any barcode labels provided that it has a label reader. The <code class=Nm>ch</code> driver's status is not affected by this call.</dd><dt><a class=permalink href=#CHIOGSTATUS><code class=Dv id=CHIOGSTATUS>CHIOGSTATUS</code></a></dt><dd>(<var class=Vt>struct changer_element_status_request</var>) Perform the <b class=Sy>READ ELEMENT STATUS</b> call on the media changer device. This call reads the element status information of the media changer and converts it to an array of <var class=Vt>changer_element_status</var> structures. <p class=Pp>With each call to <code class=Dv>CHIOGSTATUS</code>, the status of one or more elements of one type may be queried.</p><p class=Pp>The application passes a <var class=Vt>changer_element_status_request</var> structure to the <code class=Nm>ch</code> driver which contains the following fields:</p><div class="Bd Pp Bd-indent"><pre>
u_int                          cesr_element_type;
u_int                          cesr_element_base;
u_int                          cesr_element_count;
u_int                          cesr_flags;
struct changer_element_status *cesr_element_status;
    </pre></div><p class=Pp>This structure is read by the driver to determine the type, logical base address and number of elements for which information is to be returned in the array of <var class=Vt>changer_element_status</var> structures pointed to by the <var class=Va>cesr_element_status</var> field. The application must allocate enough memory for <var class=Va>cesr_element_count</var> status structures (see below). The <var class=Va>cesr_flags</var> can optionally be set to <code class=Dv>CESR_VOLTAGS</code> to indicate that volume tag (bar code) information is to be read from the jukebox and returned.</p><p class=Pp>The <var class=Va>cesr_element_base</var> and <var class=Va>cesr_element_count</var> fields must be valid with respect to the physical configuration of the changer. If they are not, the <code class=Dv>CHIOGSTATUS</code> ioctl returns the <code class=Er>EINVAL</code> error code.</p><p class=Pp>The information about the elements is returned in an array of <var class=Vt>changer_element_status</var> structures. This structure include at least the following fields:</p><div class="Bd Pp Bd-indent"><pre>
u_int            ces_addr;      /* element address in media changer */
u_char           ces_flags;     /* see CESTATUS definitions below */
u_char           ces_sensecode; /* additional sense code for element */
u_char           ces_sensequal; /* additional sense code qualifier */
u_char           ces_invert;    /* invert bit */
u_char           ces_svalid;    /* source address (ces_source) valid */
u_short          ces_source;    /* source address of medium */
changer_voltag_t ces_pvoltag;   /* primary volume tag */
changer_voltag_t ces_avoltag;   /* alternate volume tag */
u_char           ces_idvalid;   /* ces_scsi_id is valid */
u_char           ces_scsi_id;   /* SCSI id of element (if ces_idvalid is nonzero) */
u_char           ces_lunvalid;  /* ces_scsi_lun is valid */
u_char           ces_scsi_lun;  /* SCSI lun of element (if ces_lunvalid is nonzero) */
    </pre></div><p class=Pp>The <var class=Va>ces_addr</var> field contains the address of the element in the coordinate system of the media changer. It is not used by the driver, and should be used for diagnostic purposes only.</p><p class=Pp>The following flags are defined for the <var class=Va>ces_flags</var> field:</p><dl class=Bl-tag><dt><a class=permalink href=#CESTATUS_FULL><code class=Dv id=CESTATUS_FULL>CESTATUS_FULL</code></a></dt><dd>A medium is present.</dd><dt><a class=permalink href=#CESTATUS_IMPEXP><code class=Dv id=CESTATUS_IMPEXP>CESTATUS_IMPEXP</code></a></dt><dd>The medium has been deposited by the operator (and not by a picker).</dd><dt><a class=permalink href=#CESTATUS_EXCEPT><code class=Dv id=CESTATUS_EXCEPT>CESTATUS_EXCEPT</code></a></dt><dd>The element is in an exceptional state (e.g. invalid barcode label, barcode not yet scanned).</dd><dt><a class=permalink href=#CESTATUS_ACCESS><code class=Dv id=CESTATUS_ACCESS>CESTATUS_ACCESS</code></a></dt><dd>The element is accessible by the picker.</dd><dt><a class=permalink href=#CESTATUS_EXENAB><code class=Dv id=CESTATUS_EXENAB>CESTATUS_EXENAB</code></a></dt><dd>The element supports medium export.</dd><dt><a class=permalink href=#CESTATUS_INENAB><code class=Dv id=CESTATUS_INENAB>CESTATUS_INENAB</code></a></dt><dd>The element supports medium import.</dd></dl><p class=Pp>Note that not all flags are valid for all element types.</p></dd></dl></section><section class=Sh><h2 class=Sh id=NOTES><a class=permalink href=#NOTES>NOTES</a></h2> This version of the <code class=Nm>ch</code> driver has been tested with a DEC TZ875 (5 slot, one DLT drive) and a Breece Hill Q47 (60 slot, four DLT drives, barcode reader). <p class=Pp>Many of the features the <code class=Nm>ch</code> driver supports are not thoroughly tested due to the fact that the devices available for testing do not support the necessary commands. This is true for alternate volume tags, media flipping, import/export element handling, multiple picker operation and other things.</p></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><dl class="Bl-tag Bl-compact"><dt><span class=Pa>/dev/ch[0-9]</span></dt><dd>device entries</dd></dl></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2> If the media changer does not support features requested by the <code class=Nm>ch</code> driver, it will produce both console error messages and failure return codes to the ioctls described here. </section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=chio.1.html>chio(1)</a>, <a class=Xr href=cam.4.html>cam(4)</a>, <a class=Xr href=cd.4.html>cd(4)</a>, <a class=Xr href=da.4.html>da(4)</a>, <a class=Xr href=sa.4.html>sa(4)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>ch</code> driver appeared in <span class=Ux>386BSD-0.1</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> The <code class=Nm>ch</code> driver was written by <span class=An>Jason R. Thorpe</span> &lt;<a class=Mt href=mailto:thorpej@and.com>thorpej@and.com</a>&gt; for And Communications, <span class=Pa>http://www.and.com/</span>. It was added to the system by <span class=An>Stefan Grefen</span> &lt;<a class=Mt href=mailto:grefen@goofy.zdv.uni-mainz.de>grefen@goofy.zdv.uni-mainz.de</a>&gt; who apparently had such a device. It was ported to CAM by <span class=An>Kenneth Merry</span> &lt;<a class=Mt href=mailto:ken@FreeBSD.org>ken@FreeBSD.org</a>&gt;. It was updated to support volume tags by <span class=An>Hans Huebner</span> &lt;<a class=Mt href=mailto:hans@artcom.de>hans@artcom.de</a>&gt;. </section></div><table class=foot><tr><td class=foot-date>May 14, 1998</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>