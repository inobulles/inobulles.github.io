<!DOCTYPE html>
<html><head><meta charset=utf-8><title>pfctl(8)</title><keywords content=man,pfctl></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>pfctl(8)</h1><table class=head><tr><td class=head-ltitle>PFCTL(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>PFCTL(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>pfctl</code> — <div class=Nd>control the packet filter (PF) device</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>pfctl</code></td><td>[<code class=Fl>-AdeghMmNnOPqRrvz</code>] [<code class=Fl>-a</code> <var class=Ar>anchor</var>] [<code class=Fl>-D</code> <var class=Ar>macro</var>= <var class=Ar>value</var>] [<code class=Fl>-F</code> <var class=Ar>modifier</var>] [<code class=Fl>-f</code> <var class=Ar>file</var>] [<code class=Fl>-i</code> <var class=Ar>interface</var>] [<code class=Fl>-K</code> <var class=Ar>host</var> | <var class=Ar>network</var>] [<code class=Fl>-k</code> <var class=Ar>host</var> | <var class=Ar>network</var> | <var class=Ar>label</var> | <var class=Ar>id</var> | <var class=Ar>gateway</var>] [<code class=Fl>-o</code> <var class=Ar>level</var>] [<code class=Fl>-p</code> <var class=Ar>device</var>] [<code class=Fl>-s</code> <var class=Ar>modifier</var>] [<code class=Fl>-t</code> <var class=Ar>table</var> <code class=Fl>-T</code><var class=Ar>command</var> [<var class=Ar>address ...</var>]] [<code class=Fl>-x</code> <var class=Ar>level</var>]</td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>pfctl</code> utility communicates with the packet filter device using the ioctl interface described in <a class=Xr href=pf.4.html>pf(4)</a>. It allows ruleset and parameter configuration and retrieval of status information from the packet filter. <p class=Pp>Packet filtering restricts the types of packets that pass through network interfaces entering or leaving the host based on filter rules as described in <a class=Xr href=pf.conf.5.html>pf.conf(5)</a>. The packet filter can also replace addresses and ports of packets. Replacing source addresses and ports of outgoing packets is called NAT (Network Address Translation) and is used to connect an internal network (usually reserved address space) to an external one (the Internet) by making all connections to external hosts appear to come from the gateway. Replacing destination addresses and ports of incoming packets is used to redirect connections to different hosts and/or ports. A combination of both translations, bidirectional NAT, is also supported. Translation rules are described in <a class=Xr href=pf.conf.5.html>pf.conf(5)</a>.</p><p class=Pp>When the variable <var class=Va>pf</var> is set to <code class=Dv>YES</code> in <a class=Xr href=rc.conf.5.html>rc.conf(5)</a>, the rule file specified with the variable <var class=Va>pf_rules</var> is loaded automatically by the <a class=Xr href=rc.8.html>rc(8)</a> scripts and the packet filter is enabled.</p><p class=Pp>The packet filter does not itself forward packets between interfaces. Forwarding can be enabled by setting the <a class=Xr href=sysctl.8.html>sysctl(8)</a> variables <i class=Em>net.inet.ip.forwarding</i> and/or <i class=Em>net.inet6.ip6.forwarding</i> to 1. Set them permanently in <a class=Xr href=sysctl.conf.5.html>sysctl.conf(5)</a>.</p><p class=Pp>The <code class=Nm>pfctl</code> utility provides several commands. The options are as follows:</p><dl class=Bl-tag><dt><a class=permalink href=#A><code class=Fl id=A>-A</code></a></dt><dd>Load only the queue rules present in the rule file. Other rules and options are ignored.</dd><dt><a class=permalink href=#a><code class=Fl id=a>-a</code></a><var class=Ar>anchor</var></dt><dd>Apply flags <code class=Fl>-f</code>, <code class=Fl>-F</code>, and <code class=Fl>-s</code> only to the rules in the specified <var class=Ar>anchor</var>. In addition to the main ruleset, <code class=Nm>pfctl</code> can load and manipulate additional rulesets by name, called anchors. The main ruleset is the default anchor. <p class=Pp>Anchors are referenced by name and may be nested, with the various components of the anchor path separated by ‘/’ characters, similar to how file system hierarchies are laid out. The last component of the anchor path is where ruleset operations are performed.</p><p class=Pp>Evaluation of <var class=Ar>anchor</var> rules from the main ruleset is described in <a class=Xr href=pf.conf.5.html>pf.conf(5)</a>.</p><p class=Pp>For example, the following will show all filter rules (see the <code class=Fl>-s</code> flag below) inside the anchor “authpf/smith(1234)”, which would have been created for user “smith” by <a class=Xr href=authpf.8.html>authpf(8)</a>, PID 1234:</p><div class="Bd Pp Bd-indent"><pre>
# pfctl -a "authpf/smith(1234)" -s rules
    </pre></div><p class=Pp>Private tables can also be put inside anchors, either by having table statements in the <a class=Xr href=pf.conf.5.html>pf.conf(5)</a> file that is loaded in the anchor, or by using regular table commands, as in:</p><div class="Bd Pp Bd-indent"><pre>
# pfctl -a foo/bar -t mytable -T add 1.2.3.4 5.6.7.8
    </pre></div><p class=Pp>When a rule referring to a table is loaded in an anchor, the rule will use the private table if one is defined, and then fall back to the table defined in the main ruleset, if there is one. This is similar to C rules for variable scope. It is possible to create distinct tables with the same name in the global ruleset and in an anchor, but this is often bad design and a warning will be issued in that case.</p><p class=Pp>By default, recursive inline printing of anchors applies only to unnamed anchors specified inline in the ruleset. If the anchor name is terminated with a ‘*’ character, the <code class=Fl>-s</code> flag will recursively print all anchors in a brace delimited block. For example the following will print the “authpf” ruleset recursively:</p><div class="Bd Pp Bd-indent"><pre>
# pfctl -a 'authpf/*' -sr
    </pre></div><p class=Pp>To print the main ruleset recursively, specify only ‘*’ as the anchor name:</p><div class="Bd Pp Bd-indent"><pre>
# pfctl -a '*' -sr
    </pre></div></dd><dt><a class=permalink href=#D><code class=Fl id=D>-D</code></a><var class=Ar>macro</var>=<var class=Ar>value</var></dt><dd>Define <var class=Ar>macro</var> to be set to <var class=Ar>value</var> on the command line. Overrides the definition of <var class=Ar>macro</var> in the ruleset.</dd><dt><a class=permalink href=#d><code class=Fl id=d>-d</code></a></dt><dd>Disable the packet filter.</dd><dt><a class=permalink href=#e><code class=Fl id=e>-e</code></a></dt><dd>Enable the packet filter.</dd><dt><a class=permalink href=#F><code class=Fl id=F>-F</code></a><var class=Ar>modifier</var></dt><dd>Flush the filter parameters specified by <var class=Ar>modifier</var> (may be abbreviated): <p class=Pp></p><dl class="Bl-tag Bl-compact"><dt><a class=permalink href=#F_2><code class=Fl id=F_2>-F</code></a><code class=Cm>nat</code></dt><dd>Flush the NAT rules.</dd><dt><a class=permalink href=#F_3><code class=Fl id=F_3>-F</code></a><code class=Cm>queue</code></dt><dd>Flush the queue rules.</dd><dt><a class=permalink href=#F_4><code class=Fl id=F_4>-F</code></a><code class=Cm>ethernet</code></dt><dd>Flush the Ethernet filter rules.</dd><dt><a class=permalink href=#F_5><code class=Fl id=F_5>-F</code></a><code class=Cm>rules</code></dt><dd>Flush the filter rules.</dd><dt><a class=permalink href=#F_6><code class=Fl id=F_6>-F</code></a><code class=Cm>states</code></dt><dd>Flush the state table (NAT and filter).</dd><dt><a class=permalink href=#F_7><code class=Fl id=F_7>-F</code></a><code class=Cm>Sources</code></dt><dd>Flush the source tracking table.</dd><dt><a class=permalink href=#F_8><code class=Fl id=F_8>-F</code></a><code class=Cm>info</code></dt><dd>Flush the filter information (statistics that are not bound to rules).</dd><dt><a class=permalink href=#F_9><code class=Fl id=F_9>-F</code></a><code class=Cm>Tables</code></dt><dd>Flush the tables.</dd><dt><a class=permalink href=#F_10><code class=Fl id=F_10>-F</code></a><code class=Cm>osfp</code></dt><dd>Flush the passive operating system fingerprints.</dd><dt><a class=permalink href=#F_11><code class=Fl id=F_11>-F</code></a><code class=Cm>all</code></dt><dd>Flush all of the above.</dd></dl></dd><dt><a class=permalink href=#f><code class=Fl id=f>-f</code></a><var class=Ar>file</var></dt><dd>Load the rules contained in <var class=Ar>file</var>. This <var class=Ar>file</var> may contain macros, tables, options, and normalization, queueing, translation, and filtering rules. With the exception of macros and tables, the statements must appear in that order.</dd><dt><a class=permalink href=#g><code class=Fl id=g>-g</code></a></dt><dd>Include output helpful for debugging.</dd><dt><a class=permalink href=#h><code class=Fl id=h>-h</code></a></dt><dd>Help.</dd><dt><a class=permalink href=#i><code class=Fl id=i>-i</code></a><var class=Ar>interface</var></dt><dd>Restrict the operation to the given <var class=Ar>interface</var>.</dd><dt><a class=permalink href=#K><code class=Fl id=K>-K</code></a><var class=Ar>host</var> | <var class=Ar>network</var></dt><dd>Kill all of the source tracking entries originating from the specified <var class=Ar>host</var> or <var class=Ar>network</var>. A second <code class=Fl>-K</code><var class=Ar>host</var> or <code class=Fl>-K</code><var class=Ar>network</var> option may be specified, which will kill all the source tracking entries from the first host/network to the second.</dd><dt><a class=permalink href=#k><code class=Fl id=k>-k</code></a><var class=Ar>host</var> | <var class=Ar>network</var> | <var class=Ar>label</var> | <var class=Ar>id</var> | <var class=Ar>gateway</var></dt><dd>Kill all of the state entries matching the specified <var class=Ar>host</var>, <var class=Ar>network</var>, <var class=Ar>label</var>, <var class=Ar>id</var>, or <var class=Ar>gateway.</var><p class=Pp>For example, to kill all of the state entries originating from “host”:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k host</code></div><p class=Pp>A second <code class=Fl>-k</code><var class=Ar>host</var> or <code class=Fl>-k</code><var class=Ar>network</var> option may be specified, which will kill all the state entries from the first host/network to the second. To kill all of the state entries from “host1” to “host2”:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k host1 -k host2</code></div><p class=Pp>To kill all states originating from 192.168.1.0/24 to 172.16.0.0/16:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k 192.168.1.0/24 -k 172.16.0.0/16</code></div><p class=Pp>A network prefix length of 0 can be used as a wildcard. To kill all states with the target “host2”:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k 0.0.0.0/0 -k host2</code></div><p class=Pp>It is also possible to kill states by rule label or state ID. In this mode the first <code class=Fl>-k</code> argument is used to specify the type of the second argument. The following command would kill all states that have been created from rules carrying the label “foobar”:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k label -k foobar</code></div><p class=Pp>To kill one specific state by its unique state ID (as shown by pfctl -s state -vv), use the <var class=Ar>id</var> modifier and as a second argument the state ID and optional creator ID. To kill a state with ID 4823e84500000003 use:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k id -k 4823e84500000003</code></div><p class=Pp>To kill a state with ID 4823e84500000018 created from a backup firewall with hostid 00000002 use:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k id -k 4823e84500000018/2</code></div><p class=Pp>It is also possible to kill states created from a rule with the route-to/reply-to parameter set to route the connection through a particular gateway. Note that rules routing via the default routing table (not via a route-to rule) will have their rt_addr set as 0.0.0.0 or ::. To kill all states using a gateway of 192.168.0.1 use:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k gateway -k 192.168.0.1</code></div><p class=Pp>A network prefix length can also be specified. To kill all states using a gateway in 192.168.0.0/24:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -k gateway -k 192.168.0.0/24</code></div></dd><dt><a class=permalink href=#M><code class=Fl id=M>-M</code></a></dt><dd>Kill matching states in the opposite direction (on other interfaces) when killing states. This applies to states killed using the -k option and also will apply to the flush command when flushing states. This is useful when an interface is specified when flushing states. Example: <p class=Pp></p><div class="Bd Bd-indent"><code class=Li># pfctl -M -i interface -Fs</code></div></dd><dt><a class=permalink href=#m><code class=Fl id=m>-m</code></a></dt><dd>Merge in explicitly given options without resetting those which are omitted. Allows single options to be modified without disturbing the others: <div class="Bd Pp Bd-indent"><pre>
# echo "set loginterface fxp0" | pfctl -mf -
    </pre></div></dd><dt><a class=permalink href=#N><code class=Fl id=N>-N</code></a></dt><dd>Load only the NAT rules present in the rule file. Other rules and options are ignored.</dd><dt><a class=permalink href=#n><code class=Fl id=n>-n</code></a></dt><dd>Do not actually load rules, just parse them.</dd><dt><a class=permalink href=#O><code class=Fl id=O>-O</code></a></dt><dd>Load only the options present in the rule file. Other rules and options are ignored.</dd><dt><a class=permalink href=#o><code class=Fl id=o>-o</code></a><var class=Ar>level</var></dt><dd>Control the ruleset optimizer, overriding any rule file settings. <p class=Pp></p><dl class="Bl-tag Bl-compact"><dt><a class=permalink href=#o_2><code class=Fl id=o_2>-o</code></a><code class=Cm>none</code></dt><dd>Disable the ruleset optimizer.</dd><dt><a class=permalink href=#o_3><code class=Fl id=o_3>-o</code></a><code class=Cm>basic</code></dt><dd>Enable basic ruleset optimizations. This is the default behaviour.</dd><dt><a class=permalink href=#o_4><code class=Fl id=o_4>-o</code></a><code class=Cm>profile</code></dt><dd>Enable basic ruleset optimizations with profiling.</dd></dl> For further information on the ruleset optimizer, see <a class=Xr href=pf.conf.5.html>pf.conf(5)</a>.</dd><dt><a class=permalink href=#P><code class=Fl id=P>-P</code></a></dt><dd>Do not perform service name lookup for port specific rules, instead display the ports numerically.</dd><dt><a class=permalink href=#p><code class=Fl id=p>-p</code></a><var class=Ar>device</var></dt><dd>Use the device file <var class=Ar>device</var> instead of the default <span class=Pa>/dev/pf</span>.</dd><dt><a class=permalink href=#q><code class=Fl id=q>-q</code></a></dt><dd>Only print errors and warnings.</dd><dt><a class=permalink href=#R><code class=Fl id=R>-R</code></a></dt><dd>Load only the filter rules present in the rule file. Other rules and options are ignored.</dd><dt><a class=permalink href=#r><code class=Fl id=r>-r</code></a></dt><dd>Perform reverse DNS lookups on states when displaying them.</dd><dt><a class=permalink href=#s><code class=Fl id=s>-s</code></a><var class=Ar>modifier</var></dt><dd>Show the filter parameters specified by <var class=Ar>modifier</var> (may be abbreviated): <p class=Pp></p><dl class="Bl-tag Bl-compact"><dt><a class=permalink href=#s_2><code class=Fl id=s_2>-s</code></a><code class=Cm>nat</code></dt><dd>Show the currently loaded NAT rules.</dd><dt><a class=permalink href=#s_3><code class=Fl id=s_3>-s</code></a><code class=Cm>queue</code></dt><dd>Show the currently loaded queue rules. When used together with <code class=Fl>-v</code>, per-queue statistics are also shown. When used together with <code class=Fl>-v</code><code class=Fl>-v</code>, <code class=Nm>pfctl</code> will loop and show updated queue statistics every five seconds, including measured bandwidth and packets per second.</dd><dt><a class=permalink href=#s_4><code class=Fl id=s_4>-s</code></a><code class=Cm>ether</code></dt><dd>Show the currently loaded Ethernet rules. When used together with <code class=Fl>-v</code>, the per-rule statistics (number of evaluations, packets, and bytes) are also shown.</dd><dt><a class=permalink href=#s_5><code class=Fl id=s_5>-s</code></a><code class=Cm>rules</code></dt><dd>Show the currently loaded filter rules. When used together with <code class=Fl>-v</code>, the per-rule statistics (number of evaluations, packets, and bytes) are also shown. Note that the “skip step” optimization done automatically by the kernel will skip evaluation of rules where possible. Packets passed statefully are counted in the rule that created the state (even though the rule is not evaluated more than once for the entire connection).</dd><dt><a class=permalink href=#s_6><code class=Fl id=s_6>-s</code></a><code class=Cm>Anchors</code></dt><dd>Show the currently loaded anchors directly attached to the main ruleset. If <code class=Fl>-a</code><var class=Ar>anchor</var> is specified as well, the anchors loaded directly below the given <var class=Ar>anchor</var> are shown instead. If <code class=Fl>-v</code> is specified, all anchors attached under the target anchor will be displayed recursively.</dd><dt><a class=permalink href=#s_7><code class=Fl id=s_7>-s</code></a><code class=Cm>states</code></dt><dd>Show the contents of the state table.</dd><dt><a class=permalink href=#s_8><code class=Fl id=s_8>-s</code></a><code class=Cm>Sources</code></dt><dd>Show the contents of the source tracking table.</dd><dt><a class=permalink href=#s_9><code class=Fl id=s_9>-s</code></a><code class=Cm>info</code></dt><dd>Show filter information (statistics and counters). When used together with <code class=Fl>-v</code>, source tracking statistics are also shown.</dd><dt><a class=permalink href=#s_10><code class=Fl id=s_10>-s</code></a><code class=Cm>Running</code></dt><dd>Show the running status and provide a non-zero exit status when disabled.</dd><dt><a class=permalink href=#s_11><code class=Fl id=s_11>-s</code></a><code class=Cm>labels</code></dt><dd>Show per-rule statistics (label, evaluations, packets total, bytes total, packets in, bytes in, packets out, bytes out, state creations) of filter rules with labels, useful for accounting.</dd><dt><a class=permalink href=#s_12><code class=Fl id=s_12>-s</code></a><code class=Cm>timeouts</code></dt><dd>Show the current global timeouts.</dd><dt><a class=permalink href=#s_13><code class=Fl id=s_13>-s</code></a><code class=Cm>memory</code></dt><dd>Show the current pool memory hard limits.</dd><dt><a class=permalink href=#s_14><code class=Fl id=s_14>-s</code></a><code class=Cm>Tables</code></dt><dd>Show the list of tables.</dd><dt><a class=permalink href=#s_15><code class=Fl id=s_15>-s</code></a><code class=Cm>osfp</code></dt><dd>Show the list of operating system fingerprints.</dd><dt><a class=permalink href=#s_16><code class=Fl id=s_16>-s</code></a><code class=Cm>Interfaces</code></dt><dd>Show the list of interfaces and interface drivers available to PF. When used together with <code class=Fl>-v</code>, it additionally lists which interfaces have skip rules activated. When used together with <code class=Fl>-vv</code>, interface statistics are also shown. <code class=Fl>-i</code> can be used to select an interface or a group of interfaces.</dd><dt><a class=permalink href=#s_17><code class=Fl id=s_17>-s</code></a><code class=Cm>all</code></dt><dd>Show all of the above, except for the lists of interfaces and operating system fingerprints.</dd></dl></dd><dt><a class=permalink href=#T><code class=Fl id=T>-T</code></a><var class=Ar>command</var> [<var class=Ar>address ...</var>]</dt><dd>Specify the <var class=Ar>command</var> (may be abbreviated) to apply to the table. Commands include: <p class=Pp></p><dl class="Bl-tag Bl-compact"><dt><a class=permalink href=#T_2><code class=Fl id=T_2>-T</code></a><code class=Cm>kill</code></dt><dd>Kill a table.</dd><dt><a class=permalink href=#T_3><code class=Fl id=T_3>-T</code></a><code class=Cm>flush</code></dt><dd>Flush all addresses of a table.</dd><dt><a class=permalink href=#T_4><code class=Fl id=T_4>-T</code></a><code class=Cm>add</code></dt><dd>Add one or more addresses in a table. Automatically create a nonexisting table.</dd><dt><a class=permalink href=#T_5><code class=Fl id=T_5>-T</code></a><code class=Cm>delete</code></dt><dd>Delete one or more addresses from a table.</dd><dt><a class=permalink href=#T_6><code class=Fl id=T_6>-T</code></a><code class=Cm>expire</code><var class=Ar>number</var></dt><dd>Delete addresses which had their statistics cleared more than <var class=Ar>number</var> seconds ago. For entries which have never had their statistics cleared, <var class=Ar>number</var> refers to the time they were added to the table.</dd><dt><a class=permalink href=#T_7><code class=Fl id=T_7>-T</code></a><code class=Cm>replace</code></dt><dd>Replace the addresses of the table. Automatically create a nonexisting table.</dd><dt><a class=permalink href=#T_8><code class=Fl id=T_8>-T</code></a><code class=Cm>show</code></dt><dd>Show the content (addresses) of a table.</dd><dt><a class=permalink href=#T_9><code class=Fl id=T_9>-T</code></a><code class=Cm>test</code></dt><dd>Test if the given addresses match a table.</dd><dt><a class=permalink href=#T_10><code class=Fl id=T_10>-T</code></a><code class=Cm>zero</code></dt><dd>Clear all the statistics of a table.</dd><dt><a class=permalink href=#T_11><code class=Fl id=T_11>-T</code></a><code class=Cm>load</code></dt><dd>Load only the table definitions from <a class=Xr href=pf.conf.5.html>pf.conf(5)</a>. This is used in conjunction with the <code class=Fl>-f</code> flag, as in: <div class="Bd Pp Bd-indent"><pre>
# pfctl -Tl -f pf.conf
        </pre></div></dd></dl><p class=Pp>For the <code class=Cm>add</code>, <code class=Cm>delete</code>, <code class=Cm>replace</code>, and <code class=Cm>test</code> commands, the list of addresses can be specified either directly on the command line and/or in an unformatted text file, using the <code class=Fl>-f</code> flag. Comments starting with a ‘#’ are allowed in the text file. With these commands, the <code class=Fl>-v</code> flag can also be used once or twice, in which case <code class=Nm>pfctl</code> will print the detailed result of the operation for each individual address, prefixed by one of the following letters:</p><p class=Pp></p><dl class="Bl-tag Bl-compact"><dt>A</dt><dd>The address/network has been added.</dd><dt>C</dt><dd>The address/network has been changed (negated).</dd><dt>D</dt><dd>The address/network has been deleted.</dd><dt>M</dt><dd>The address matches (<code class=Cm>test</code> operation only).</dd><dt>X</dt><dd>The address/network is duplicated and therefore ignored.</dd><dt>Y</dt><dd>The address/network cannot be added/deleted due to conflicting ‘!’ attributes.</dd><dt>Z</dt><dd>The address/network has been cleared (statistics).</dd></dl><p class=Pp>Each table can maintain a set of counters that can be retrieved using the <code class=Fl>-v</code> flag of <code class=Nm>pfctl</code>. For example, the following commands define a wide open firewall which will keep track of packets going to or coming from the <span class=Ux>OpenBSD</span> FTP server. The following commands configure the firewall and send 10 pings to the FTP server:</p><div class="Bd Pp Bd-indent"><pre>
# printf "table &lt;test&gt; counters { ftp.openbsd.org }\n \
    pass out to &lt;test&gt;\n" | pfctl -f-
# ping -qc10 ftp.openbsd.org
    </pre></div><p class=Pp>We can now use the table <code class=Cm>show</code> command to output, for each address and packet direction, the number of packets and bytes that are being passed or blocked by rules referencing the table. The time at which the current accounting started is also shown with the “Cleared” line.</p><div class="Bd Pp Bd-indent"><pre>
# pfctl -t test -vTshow
   129.128.5.191
    Cleared:     Thu Feb 13 18:55:18 2003
    In/Block:    [ Packets: 0        Bytes: 0        ]
    In/Pass:     [ Packets: 10       Bytes: 840      ]
    Out/Block:   [ Packets: 0        Bytes: 0        ]
    Out/Pass:    [ Packets: 10       Bytes: 840      ]
    </pre></div><p class=Pp>Similarly, it is possible to view global information about the tables by using the <code class=Fl>-v</code> modifier twice and the <code class=Fl>-s</code><code class=Cm>Tables</code> command. This will display the number of addresses on each table, the number of rules which reference the table, and the global packet statistics for the whole table:</p><div class="Bd Pp Bd-indent"><pre>
# pfctl -vvsTables
--a-r-C test
    Addresses:   1
    Cleared:     Thu Feb 13 18:55:18 2003
    References:  [ Anchors: 0        Rules: 1        ]
    Evaluations: [ NoMatch: 3496     Match: 1        ]
    In/Block:    [ Packets: 0        Bytes: 0        ]
    In/Pass:     [ Packets: 10       Bytes: 840      ]
    In/XPass:    [ Packets: 0        Bytes: 0        ]
    Out/Block:   [ Packets: 0        Bytes: 0        ]
    Out/Pass:    [ Packets: 10       Bytes: 840      ]
    Out/XPass:   [ Packets: 0        Bytes: 0        ]
    </pre></div><p class=Pp>As we can see here, only one packet - the initial ping request - matched the table, but all packets passing as the result of the state are correctly accounted for. Reloading the table(s) or ruleset will not affect packet accounting in any way. The two “XPass” counters are incremented instead of the “Pass” counters when a “stateful” packet is passed but does not match the table anymore. This will happen in our example if someone flushes the table while the <a class=Xr href=ping.8.html>ping(8)</a> command is running.</p><p class=Pp>When used with a single <code class=Fl>-v</code>, <code class=Nm>pfctl</code> will only display the first line containing the table flags and name. The flags are defined as follows:</p><p class=Pp></p><dl class="Bl-tag Bl-compact"><dt>c</dt><dd>For constant tables, which cannot be altered outside <a class=Xr href=pf.conf.5.html>pf.conf(5)</a>.</dd><dt>p</dt><dd>For persistent tables, which do not get automatically killed when no rules refer to them.</dd><dt>a</dt><dd>For tables which are part of the <i class=Em>active</i> tableset. Tables without this flag do not really exist, cannot contain addresses, and are only listed if the <code class=Fl>-g</code> flag is given.</dd><dt>i</dt><dd>For tables which are part of the <i class=Em>inactive</i> tableset. This flag can only be witnessed briefly during the loading of <a class=Xr href=pf.conf.5.html>pf.conf(5)</a>.</dd><dt>r</dt><dd>For tables which are referenced (used) by rules.</dd><dt>h</dt><dd>This flag is set when a table in the main ruleset is hidden by one or more tables of the same name from anchors attached below it.</dd><dt>C</dt><dd>This flag is set when per-address counters are enabled on the table.</dd></dl></dd><dt><a class=permalink href=#t><code class=Fl id=t>-t</code></a><var class=Ar>table</var></dt><dd>Specify the name of the table.</dd><dt><a class=permalink href=#v><code class=Fl id=v>-v</code></a></dt><dd>Produce more verbose output. A second use of <code class=Fl>-v</code> will produce even more verbose output including ruleset warnings. See the previous section for its effect on table commands.</dd><dt><a class=permalink href=#x><code class=Fl id=x>-x</code></a><var class=Ar>level</var></dt><dd>Set the debug <var class=Ar>level</var> (may be abbreviated) to one of the following: <p class=Pp></p><dl class="Bl-tag Bl-compact"><dt><a class=permalink href=#x_2><code class=Fl id=x_2>-x</code></a><code class=Cm>none</code></dt><dd>Do not generate debug messages.</dd><dt><a class=permalink href=#x_3><code class=Fl id=x_3>-x</code></a><code class=Cm>urgent</code></dt><dd>Generate debug messages only for serious errors.</dd><dt><a class=permalink href=#x_4><code class=Fl id=x_4>-x</code></a><code class=Cm>misc</code></dt><dd>Generate debug messages for various errors.</dd><dt><a class=permalink href=#x_5><code class=Fl id=x_5>-x</code></a><code class=Cm>loud</code></dt><dd>Generate debug messages for common conditions.</dd></dl></dd><dt><a class=permalink href=#z><code class=Fl id=z>-z</code></a></dt><dd>Clear per-rule statistics.</dd></dl></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><dl class="Bl-tag Bl-compact"><dt><span class=Pa>/etc/pf.conf</span></dt><dd>Packet filter rules file.</dd><dt><span class=Pa>/etc/pf.os</span></dt><dd>Passive operating system fingerprint database.</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=pf.4.html>pf(4)</a>, <a class=Xr href=pf.conf.5.html>pf.conf(5)</a>, <a class=Xr href=pf.os.5.html>pf.os(5)</a>, <a class=Xr href=rc.conf.5.html>rc.conf(5)</a>, <a class=Xr href=services.5.html>services(5)</a>, <a class=Xr href=sysctl.conf.5.html>sysctl.conf(5)</a>, <a class=Xr href=authpf.8.html>authpf(8)</a>, <a class=Xr href=ftp-proxy.8.html>ftp-proxy(8)</a>, <a class=Xr href=rc.8.html>rc(8)</a>, <a class=Xr href=sysctl.8.html>sysctl(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>pfctl</code> program and the <a class=Xr href=pf.4.html>pf(4)</a> filter mechanism appeared in <span class=Ux>OpenBSD 3.0</span>. They first appeared in <span class=Ux>FreeBSD 5.3</span> ported from the version in <span class=Ux>OpenBSD 3.5</span></section></div><table class=foot><tr><td class=foot-date>February 22, 2021</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>