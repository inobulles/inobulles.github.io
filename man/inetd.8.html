<!DOCTYPE html>
<html><head><meta charset=utf-8><title>inetd(8)</title><keywords content=man,inetd></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>inetd(8)</h1><table class=head><tr><td class=head-ltitle>INETD(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>INETD(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>inetd</code> — <div class=Nd>internet “super-server”</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>inetd</code></td><td>[<code class=Fl>-dlWw</code>] [<code class=Fl>-a</code><var class=Ar>address</var>] [<code class=Fl>-C</code><var class=Ar>rate</var>] [<code class=Fl>-c</code><var class=Ar>maximum</var>] [<code class=Fl>-p</code><var class=Ar>filename</var>] [<code class=Fl>-R</code><var class=Ar>rate</var>] [<code class=Fl>-s</code><var class=Ar>maximum</var>] [<var class=Ar>configuration_file</var>]</td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>inetd</code> utility should be run at boot time by <span class=Pa>/etc/rc</span> (see <a class=Xr href=rc.8.html>rc(8)</a>). It then listens for connections on certain internet sockets. When a connection is found on one of its sockets, it decides what service the socket corresponds to, and invokes a program to service the request. The server program is invoked with the service socket as its standard input, output and error descriptors. After the program is finished, <code class=Nm>inetd</code> continues to listen on the socket (except in some cases which will be described below). Essentially, <code class=Nm>inetd</code> allows running one daemon to invoke several others, reducing load on the system. <p class=Pp>The following options are available:</p><dl class=Bl-tag><dt><a class=permalink href=#a><code class=Fl id=a>-a</code></a><var class=Ar>address</var></dt><dd>Specify one specific IP address to bind to. Alternatively, a hostname can be specified, in which case the IPv4 or IPv6 address which corresponds to that hostname is used. Usually a hostname is specified when <code class=Nm>inetd</code> is run inside a <a class=Xr href=jail.8.html>jail(8)</a>, in which case the hostname corresponds to that of the <a class=Xr href=jail.8.html>jail(8)</a> environment. <p class=Pp>When the hostname specification is used and both IPv4 and IPv6 bindings are desired, one entry with the appropriate <i class=Em>protocol</i> type for each binding is required for each service in <span class=Pa>/etc/inetd.conf</span>. For example, a TCP-based service would need two entries, one using “tcp4” for the <i class=Em>protocol</i> and the other using “tcp6”. See the explanation of the <span class=Pa>/etc/inetd.conf</span><i class=Em>protocol</i> field below.</p></dd><dt><a class=permalink href=#C><code class=Fl id=C>-C</code></a><var class=Ar>rate</var></dt><dd>Specify the default maximum number of times a service can be invoked from a single IP address in one minute; the default is unlimited. May be overridden on a per-service basis with the "max-connections-per-ip-per-minute" parameter.</dd><dt><a class=permalink href=#c><code class=Fl id=c>-c</code></a><var class=Ar>maximum</var></dt><dd>Specify the default maximum number of simultaneous invocations of each service; the default is unlimited. May be overridden on a per-service basis with the "max-child" parameter.</dd><dt><a class=permalink href=#d><code class=Fl id=d>-d</code></a></dt><dd>Turn on debugging.</dd><dt><a class=permalink href=#l><code class=Fl id=l>-l</code></a></dt><dd>Turn on logging of successful connections.</dd><dt><a class=permalink href=#p><code class=Fl id=p>-p</code></a></dt><dd>Specify an alternate file in which to store the process ID.</dd><dt><a class=permalink href=#R><code class=Fl id=R>-R</code></a><var class=Ar>rate</var></dt><dd>Specify the maximum number of times a service can be invoked in one minute; the default is 256. A rate of 0 allows an unlimited number of invocations.</dd><dt><a class=permalink href=#s><code class=Fl id=s>-s</code></a><var class=Ar>maximum</var></dt><dd>Specify the default maximum number of simultaneous invocations of each service from a single IP address; the default is unlimited. May be overridden on a per-service basis with the "max-child-per-ip" parameter.</dd><dt><a class=permalink href=#W><code class=Fl id=W>-W</code></a></dt><dd>Turn on TCP Wrapping for internal services which are built in to <code class=Nm>inetd</code>.</dd><dt><a class=permalink href=#w><code class=Fl id=w>-w</code></a></dt><dd>Turn on TCP Wrapping for external services. See the <a class=Sx href=#IMPLEMENTATION_NOTES>IMPLEMENTATION NOTES</a> section for more information on TCP Wrappers support.</dd></dl><p class=Pp>Upon execution, <code class=Nm>inetd</code> reads its configuration information from a configuration file which, by default, is <span class=Pa>/etc/inetd.conf</span>. There must be an entry for each field of the configuration file, with entries for each field separated by a tab or a space. Comments are denoted by a “#” at the beginning of a line. There must be an entry for each field. The fields of the configuration file are as follows:</p><p class=Pp></p><div class="Bd Bd-indent"><pre>
service-name
socket-type
protocol
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]
user[:group][/login-class]
server-program
server-program-arguments
</pre></div><p class=Pp>To specify an ONC RPC-based service, the entry would contain these fields:</p><p class=Pp></p><div class="Bd Bd-indent"><pre>
service-name/version
socket-type
rpc/protocol
{wait|nowait}[/max-child[/max-connections-per-ip-per-minute[/max-child-per-ip]]]
user[:group][/login-class]
server-program
server-program-arguments
</pre></div><p class=Pp>There are two types of services that <code class=Nm>inetd</code> can start: standard and TCPMUX. A standard service has a well-known port assigned to it; it may be a service that implements an official Internet standard or is a <span class=Ux>BSD</span>-specific service. As described in RFC 1078, TCPMUX services are nonstandard services that do not have a well-known port assigned to them. They are invoked from <code class=Nm>inetd</code> when a program connects to the “tcpmux” well-known port and specifies the service name. This feature is useful for adding locally-developed servers. TCPMUX requests are only accepted when the multiplexor service itself is enabled, above and beyond and specific TCPMUX-based servers; see the discussion of internal services below.</p><p class=Pp>The <i class=Em>service-name</i> entry is the name of a valid service in the file <span class=Pa>/etc/services</span>, or the specification of a <span class=Ux>UNIX</span> domain socket (see below). For “internal” services (discussed below), the service name should be the official name of the service (that is, the first entry in <span class=Pa>/etc/services</span>). When used to specify an ONC RPC-based service, this field is a valid RPC service name listed in the file <span class=Pa>/etc/rpc</span>. The part on the right of the “/” is the RPC version number. This can simply be a single numeric argument or a range of versions. A range is bounded by the low version to the high version - “rusers/1-3”. For TCPMUX services, the value of the <i class=Em>service-name</i> field consists of the string “tcpmux” followed by a slash and the locally-chosen service name. The service names listed in <span class=Pa>/etc/services</span> and the name “help” are reserved. Try to choose unique names for your TCPMUX services by prefixing them with your organization's name and suffixing them with a version number.</p><p class=Pp>The <i class=Em>socket-type</i> should be one of “stream”, “dgram”, “raw”, “rdm”, or “seqpacket”, depending on whether the socket is a stream, datagram, raw, reliably delivered message, or sequenced packet socket. TCPMUX services must use “stream”.</p><p class=Pp>The <i class=Em>protocol</i> must be a valid protocol or “unix”. Examples are “tcp” or “udp”, both of which imply IPv4 for backward compatibility. The names “tcp4” and “udp4” specify IPv4 only. The names “tcp6” and “udp6” specify IPv6 only. The names “tcp46” and “udp46” specify that the entry accepts both IPv4 and IPv6 connections via a wildcard <code class=Dv>AF_INET6</code> socket. Rpc based services are specified with the “rpc/tcp” or “rpc/udp” service type. One can use specify IPv4 and/or IPv6 with the 4, 6 or 46 suffix, for example “rpc/tcp6” or “rpc/udp46”. TCPMUX services must use “tcp”, “tcp4”, “tcp6” or “tcp46”.</p><p class=Pp>The <i class=Em>wait/nowait</i> entry specifies whether the server that is invoked by <code class=Nm>inetd</code> will take over the socket associated with the service access point, and thus whether <code class=Nm>inetd</code> should wait for the server to exit before listening for new service requests. Datagram servers must use “wait”, as they are always invoked with the original datagram socket bound to the specified service address. These servers must read at least one datagram from the socket before exiting. If a datagram server connects to its peer, freeing the socket so <code class=Nm>inetd</code> can receive further messages on the socket, it is said to be a “multi-threaded” server; it should read one datagram from the socket and create a new socket connected to the peer. It should fork, and the parent should then exit to allow <code class=Nm>inetd</code> to check for new service requests to spawn new servers. Datagram servers which process all incoming datagrams on a socket and eventually time out are said to be “single-threaded”. The <a class=Xr href=comsat.8.html>comsat(8)</a> and <a class=Xr href=talkd.8.html>talkd(8)</a> utilities are examples of the latter type of datagram server. The <a class=Xr href=tftpd.8.html>tftpd(8)</a> utility is an example of a multi-threaded datagram server.</p><p class=Pp>Servers using stream sockets generally are multi-threaded and use the “nowait” entry. Connection requests for these services are accepted by <code class=Nm>inetd</code>, and the server is given only the newly-accepted socket connected to a client of the service. Most stream-based services operate in this manner. Stream-based servers that use “wait” are started with the listening service socket, and must accept at least one connection request before exiting. Such a server would normally accept and process incoming connection requests until a timeout. TCPMUX services must use “nowait”.</p><p class=Pp>The maximum number of outstanding child processes (or “threads”) for a “nowait” service may be explicitly specified by appending a “/” followed by the number to the “nowait” keyword. Normally (or if a value of zero is specified) there is no maximum. Otherwise, once the maximum is reached, further connection attempts will be queued up until an existing child process exits. This also works in the case of “wait” mode, although a value other than one (the default) might not make sense in some cases. You can also specify the maximum number of connections per minute for a given IP address by appending a “/” followed by the number to the maximum number of outstanding child processes. Once the maximum is reached, further connections from this IP address will be dropped until the end of the minute. In addition, you can specify the maximum number of simultaneous invocations of each service from a single IP address by appending a “/” followed by the number to the maximum number of outstanding child processes. Once the maximum is reached, further connections from this IP address will be dropped.</p><p class=Pp>The <i class=Em>user</i> entry should contain the user name of the user as whom the server should run. This allows for servers to be given less permission than root. The optional <i class=Em>group</i> part separated by “:” allows a group name other than the default group for this user to be specified. The optional <i class=Em>login-class</i> part separated by “/” allows specification of a login class other than the default “daemon” login class.</p><p class=Pp>The <i class=Em>server-program</i> entry should contain the pathname of the program which is to be executed by <code class=Nm>inetd</code> when a request is found on its socket. If <code class=Nm>inetd</code> provides this service internally, this entry should be “internal”.</p><p class=Pp>The <i class=Em>server-program-arguments</i> entry lists the arguments to be passed to the <i class=Em>server-program</i>, starting with argv[0], which usually is the name of the program. If the service is provided internally, the <i class=Em>service-name</i> of the service (and any arguments to it) or the word “internal” should take the place of this entry.</p><p class=Pp>Currently, the only internal service to take arguments is “auth”. Without options, the service will always return “ERROR : HIDDEN-USER”. The available arguments to this service that alter its behavior are:</p><dl class=Bl-tag><dt><a class=permalink href=#d_2><code class=Fl id=d_2>-d</code></a><var class=Ar>fallback</var></dt><dd>Provide a <var class=Ar>fallback</var> username. If the real “auth” service is enabled (with the <code class=Fl>-r</code> option discussed below), return this username instead of an error when lookups fail for either socket credentials or the username. If the real “auth” service is disabled, return this username for every request. This is primarily useful when running this service on a NAT machine.</dd><dt><a class=permalink href=#F><code class=Fl id=F>-F</code></a></dt><dd>Same as <code class=Fl>-f</code> but without the restriction that the username in <span class=Pa>.fakeid</span> must not match an existing user.</dd><dt><a class=permalink href=#f><code class=Fl id=f>-f</code></a></dt><dd>If the file <span class=Pa>.fakeid</span> exists in the home directory of the identified user, report the username found in that file instead of the real username. If the username found in <span class=Pa>.fakeid</span> is that of an existing user, then the real username is reported. If the <code class=Fl>-i</code> flag is also given then the username in <span class=Pa>.fakeid</span> is checked against existing user IDs instead.</dd><dt><a class=permalink href=#g><code class=Fl id=g>-g</code></a></dt><dd>Instead of returning the user's name to the ident requester, report a username made up of random alphanumeric characters, e.g., “c0c993”. The <code class=Fl>-g</code> flag overrides not only the user names, but also any fallback name, <span class=Pa>.fakeid</span> or <span class=Pa>.noident</span> files.</dd><dt><a class=permalink href=#i><code class=Fl id=i>-i</code></a></dt><dd>Return numeric user IDs instead of usernames.</dd><dt><a class=permalink href=#n><code class=Fl id=n>-n</code></a></dt><dd>If the file <span class=Pa>.noident</span> exists in the home directory of the identified user, return “ERROR : HIDDEN-USER”. This overrides any <span class=Pa>fakeid</span> file which might exist.</dd><dt><a class=permalink href=#o><code class=Fl id=o>-o</code></a><var class=Ar>osname</var></dt><dd>Use <var class=Ar>osname</var> instead of the name of the system as reported by <a class=Xr href=uname.3.html>uname(3)</a>.</dd><dt><a class=permalink href=#r><code class=Fl id=r>-r</code></a></dt><dd>Offer a real “auth” service, as per RFC 1413. All the remaining flags apply only in this case.</dd><dt><a class=permalink href=#t><code class=Fl id=t>-t</code></a><var class=Ar>sec</var>[<code class=Cm>.</code><var class=Ar>usec</var>]</dt><dd>Specify a timeout for the service. The default timeout is 10.0 seconds.</dd></dl><p class=Pp>The <code class=Nm>inetd</code> utility also provides several other “trivial” services internally by use of routines within itself. These services are “echo”, “discard”, “chargen” (character generator), “daytime” (human readable time), and “time” (machine readable time, in the form of the number of seconds since midnight, January 1, 1900). All of these services are available in both TCP and UDP versions; the UDP versions will refuse service if the request specifies a reply port corresponding to any internal service. (This is done as a defense against looping attacks; the remote IP address is logged.) For details of these services, consult the appropriate RFC document.</p><p class=Pp>The TCPMUX-demultiplexing service is also implemented as an internal service. For any TCPMUX-based service to function, the following line must be included in <span class=Pa>inetd.conf</span>:</p><div class="Bd Pp Bd-indent"><pre>
tcpmux	stream	tcp	nowait	root	internal
</pre></div><p class=Pp>When given the <code class=Fl>-l</code> option <code class=Nm>inetd</code> will log an entry to syslog each time a connection is accepted, noting the service selected and the IP-number of the remote requester if available. Unless otherwise specified in the configuration file, and in the absence of the <code class=Fl>-W</code> and <code class=Fl>-w</code> options, <code class=Nm>inetd</code> will log to the “daemon” facility.</p><p class=Pp>The <code class=Nm>inetd</code> utility rereads its configuration file when it receives a hangup signal, <code class=Dv>SIGHUP</code>. Services may be added, deleted or modified when the configuration file is reread. Except when started in debugging mode, or configured otherwise with the <code class=Fl>-p</code> option, <code class=Nm>inetd</code> records its process ID in the file <span class=Pa>/var/run/inetd.pid</span> to assist in reconfiguration.</p></section><section class=Sh><h2 class=Sh id=IMPLEMENTATION_NOTES><a class=permalink href=#IMPLEMENTATION_NOTES>IMPLEMENTATION NOTES</a></h2><section class=Ss><h2 class=Ss id=TCP_Wrappers><a class=permalink href=#TCP_Wrappers>TCP Wrappers</a></h2> When given the <code class=Fl>-w</code> option, <code class=Nm>inetd</code> will wrap all services specified as “stream nowait” or “dgram” except for “internal” services. If the <code class=Fl>-W</code> option is given, such “internal” services will be wrapped. If both options are given, wrapping for both internal and external services will be enabled. Either wrapping option will cause failed connections to be logged to the “auth” syslog facility. Adding the <code class=Fl>-l</code> flag to the wrapping options will include successful connections in the logging to the “auth” facility. <p class=Pp>Note that <code class=Nm>inetd</code> only wraps requests for a “wait” service while no servers are available to service requests. Once a connection to such a service has been allowed, <code class=Nm>inetd</code> has no control over subsequent connections to the service until no more servers are left listening for connection requests.</p><p class=Pp>When wrapping is enabled, the <span class=Pa>tcpd</span> daemon is not required, as that functionality is builtin. For more information on TCP Wrappers, see the relevant documentation (<a class=Xr href=hosts_access.5.html>hosts_access(5)</a>). When reading that document, keep in mind that “internal” services have no associated daemon name. Therefore, the service name as specified in <span class=Pa>inetd.conf</span> should be used as the daemon name for “internal” services.</p></section><section class=Ss><h2 class=Ss id=TCPMUX><a class=permalink href=#TCPMUX>TCPMUX</a></h2> RFC 1078 describes the TCPMUX protocol: ``A TCP client connects to a foreign host on TCP port 1. It sends the service name followed by a carriage-return line-feed &lt;CRLF&gt;. The service name is never case sensitive. The server replies with a single character indicating positive (+) or negative (-) acknowledgment, immediately followed by an optional message of explanation, terminated with a &lt;CRLF&gt;. If the reply was positive, the selected protocol begins; otherwise the connection is closed.'' The program is passed the TCP connection as file descriptors 0 and 1. <p class=Pp>If the TCPMUX service name begins with a “+”, <code class=Nm>inetd</code> returns the positive reply for the program. This allows you to invoke programs that use stdin/stdout without putting any special server code in them.</p><p class=Pp>The special service name “help” causes <code class=Nm>inetd</code> to list the TCPMUX services which are enabled in <span class=Pa>inetd.conf</span>.</p></section><section class=Ss><h2 class=Ss id=IPsec><a class=permalink href=#IPsec>IPsec</a></h2> The implementation includes a tiny hack to support IPsec policy settings for each socket. A special form of comment line, starting with “<code class=Li>#@</code>”, is interpreted as a policy specifier. Everything after the “<code class=Li>#@</code>” will be used as an IPsec policy string, as described in <a class=Xr href=ipsec_set_policy.3.html>ipsec_set_policy(3)</a>. Each policy specifier is applied to all the following lines in <span class=Pa>inetd.conf</span> until the next policy specifier. An empty policy specifier resets the IPsec policy. <p class=Pp>If an invalid IPsec policy specifier appears in <span class=Pa>inetd.conf</span>, <code class=Nm>inetd</code> will provide an error message via the <a class=Xr href=syslog.3.html>syslog(3)</a> interface and abort execution.</p></section><section class=Ss><h2 class=Ss><span class=Ux>UNIX</span> Domain Sockets</h2> In addition to running services on IP sockets, <code class=Nm>inetd</code> can also manage <span class=Ux>UNIX</span> domain sockets. To do this you specify a <i class=Em>protocol</i> of “unix” and specify the <span class=Ux>UNIX</span> domain socket as the <i class=Em>service-name</i>. The <i class=Em>service-type</i> may be “stream” or “dgram”. The specification of the socket must be an absolute path name, optionally prefixed by an owner and mode of the form <i class=Em>:user:group:mode:</i>. The specification: <p class=Pp></p><div class="Bd Bd-indent"><code class=Li>:news:daemon:220:/var/run/sock</code></div><p class=Pp>creates a socket owned by user “news” in group “daemon” with permissions allowing only that user and group to connect. The default owner is the user that <code class=Nm>inetd</code> is running as. The default mode only allows the socket's owner to connect.</p><p class=Pp><b class=Sy>WARNING</b>: while creating a <span class=Ux>UNIX</span> domain socket, <code class=Nm>inetd</code> must change the ownership and permissions on the socket. This can only be done securely if the directory in which the socket is created is writable only by root. Do <i class=Em>NOT</i> use <code class=Nm>inetd</code> to create sockets in world writable directories such as <span class=Pa>/tmp</span>; use <span class=Pa>/var/run</span> or a similar directory instead.</p><p class=Pp>Internal services may be run on <span class=Ux>UNIX</span> domain sockets, in the usual way. In this case the name of the internal service is determined using the last component of the socket's pathname. For example, specifying a socket named <span class=Pa>/var/run/chargen</span> would invoke the “chargen” service when a connection is received on that socket.</p></section></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><dl class="Bl-tag Bl-compact"><dt><span class=Pa>/etc/inetd.conf</span></dt><dd>configuration file</dd><dt><span class=Pa>/etc/netconfig</span></dt><dd>network configuration data base</dd><dt><span class=Pa>/etc/rpc</span></dt><dd>translation of service names to RPC program numbers</dd><dt><span class=Pa>/etc/services</span></dt><dd>translation of service names to port numbers</dd><dt><span class=Pa>/var/run/inetd.pid</span></dt><dd>the pid of the currently running <code class=Nm>inetd</code></dd></dl></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> Examples for a variety of services are available in <span class=Pa>/etc/inetd.conf</span>. <p class=Pp>It includes examples for <code class=Nm>bootpd</code>, <code class=Nm>comsat</code>, <code class=Nm>cvs</code>, <code class=Nm>date</code>, <code class=Nm>fingerd</code>, <code class=Nm>ftpd</code>, <code class=Nm>imapd</code>, <code class=Nm>nc</code>, <code class=Nm>nmbd</code>, <code class=Nm>nntpd</code>, <code class=Nm>rlogind</code>, <code class=Nm>rpc.rquotad</code>, <code class=Nm>rpc.rusersd</code>, <code class=Nm>rpc.rwalld</code>, <code class=Nm>rpc.statd</code>, <code class=Nm>rpc.sprayd</code>, <code class=Nm>rshd</code>, <code class=Nm>prometheus_sysctl_exporter</code>, <code class=Nm>smtpd</code>, <code class=Nm>smbd</code>, <code class=Nm>swat</code><code class=Nm>talkd</code>, <code class=Nm>telnetd</code>, <code class=Nm>tftpd</code>, <code class=Nm>uucpd</code>.</p><p class=Pp>The internal services provided by <code class=Nm>inetd</code> for daytime, time, echo, discard and chargen are also included, as well as chargen for <code class=Nm>ipsec</code> Authentication Headers</p><p class=Pp>Examples for handling auth requests via <code class=Nm>identd</code>, are similarly included.</p></section><section class=Sh><h2 class=Sh id=ERROR_MESSAGES><a class=permalink href=#ERROR_MESSAGES>ERROR MESSAGES</a></h2> The <code class=Nm>inetd</code> server logs error messages using <a class=Xr href=syslog.3.html>syslog(3)</a>. Important error messages and their explanations are: <p class=Pp></p><dl class="Bl-ohang Bl-compact"><dt><var class=Ar>service</var>/<var class=Ar>protocol</var><span class=No>server failing (looping), service terminated.</span></dt><dd>The number of requests for the specified service in the past minute exceeded the limit. The limit exists to prevent a broken program or a malicious user from swamping the system. This message may occur for several reasons: <ol class="Bl-enum Bd-indent"><li>There are many hosts requesting the service within a short time period.</li><li>A broken client program is requesting the service too frequently.</li><li>A malicious user is running a program to invoke the service in a denial-of-service attack.</li><li>The invoked service program has an error that causes clients to retry quickly.</li></ol><p class=Pp>Use the <code class=Fl>-R</code><var class=Ar>rate</var> option, as described above, to change the rate limit. Once the limit is reached, the service will be reenabled automatically in 10 minutes.</p><p class=Pp></p></dd><dt><var class=Ar>service</var>/<var class=Ar>protocol</var>: <span class=No>No such user</span><var class=Ar>user</var>, <span class=No>service ignored</span></dt><dd></dd><dt><var class=Ar>service</var>/<var class=Ar>protocol</var>: <span class=No>getpwnam</span>: <var class=Ar>user</var>: <span class=No>No such user</span></dt><dd>No entry for <var class=Ar>user</var> exists in the <a class=Xr href=passwd.5.html>passwd(5)</a> database. The first message occurs when <code class=Nm>inetd</code> (re)reads the configuration file. The second message occurs when the service is invoked. <p class=Pp></p></dd><dt><var class=Ar>service</var>: <span class=No>can't set uid</span><var class=Ar>uid</var></dt><dd></dd><dt><var class=Ar>service</var>: <span class=No>can't set gid</span><var class=Ar>gid</var></dt><dd>The user or group ID for the entry's <var class=Ar>user</var> field is invalid. <p class=Pp></p></dd><dt>setsockopt(SO_PRIVSTATE): Operation not supported</dt><dd>The <code class=Nm>inetd</code> utility attempted to renounce the privileged state associated with a socket but was unable to. <p class=Pp></p></dd><dt>unknown <var class=Ar>rpc/udp</var> or <var class=Ar>rpc/tcp</var></dt><dd>No entry was found for either <var class=Ar>udp</var> or <var class=Ar>tcp</var> in the <a class=Xr href=netconfig.5.html>netconfig(5)</a> database. <p class=Pp></p></dd><dt>unknown <var class=Ar>rpc/udp6</var> or <var class=Ar>rpc/tcp6</var></dt><dd>No entry was found for either <var class=Ar>udp6</var> or <var class=Ar>tcp6</var> in the <a class=Xr href=netconfig.5.html>netconfig(5)</a> database.</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=cvs.1.html>cvs(1)</a> (<span class=Pa>ports/devel/opencvs</span>), <a class=Xr href=date.1.html>date(1)</a>, <a class=Xr href=nc.1.html>nc(1)</a>, <a class=Xr href=ipsec_set_policy.3.html>ipsec_set_policy(3)</a>, <a class=Xr href=ipsec.4.html>ipsec(4)</a>, <a class=Xr href=hosts_access.5.html>hosts_access(5)</a>, <a class=Xr href=hosts_options.5.html>hosts_options(5)</a>, <a class=Xr href=login.conf.5.html>login.conf(5)</a>, <a class=Xr href=netconfig.5.html>netconfig(5)</a>, <a class=Xr href=passwd.5.html>passwd(5)</a>, <a class=Xr href=rpc.5.html>rpc(5)</a>, <a class=Xr href=services.5.html>services(5)</a>, <a class=Xr href=bootpd.8.html>bootpd(8)</a>, <a class=Xr href=comsat.8.html>comsat(8)</a>, <a class=Xr href=fingerd.8.html>fingerd(8)</a>, <a class=Xr href=ftpd.8.html>ftpd(8)</a>, <a class=Xr href=imapd.8.html>imapd(8)</a> (<span class=Pa>ports/mail/courier-imap</span>), <a class=Xr href=nmbd.8.html>nmbd(8)</a> (<span class=Pa>ports/net/samba412</span>), <a class=Xr href=rlogind.8.html>rlogind(8)</a>, <a class=Xr href=rpc.rquotad.8.html>rpc.rquotad(8)</a>, <a class=Xr href=rpc.rusersd.8.html>rpc.rusersd(8)</a>, <a class=Xr href=rpc.rwalld.8.html>rpc.rwalld(8)</a>, <a class=Xr href=rpc.statd.8.html>rpc.statd(8)</a>, <a class=Xr href=rshd.8.html>rshd(8)</a>, <a class=Xr href=prometheus_sysctl_exporter.8.html>prometheus_sysctl_exporter(8)</a>, <a class=Xr href=smbd.8.html>smbd(8)</a> (<span class=Pa>ports/net/samba412</span>), <a class=Xr href=talkd.8.html>talkd(8)</a>, <a class=Xr href=telnetd.8.html>telnetd(8)</a>, <a class=Xr href=tftpd.8.html>tftpd(8)</a>, <a class=Xr href=uucpd.8.html>uucpd(8)</a> (<span class=Pa>ports/net/freebsd-uucp</span>) <p class=Pp><cite class=Rs><span class=RsA>Michael C. St. Johns</span>, <span class=RsT>Identification Protocol</span>, <span class=RsO>RFC1413</span>.</cite></p></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>inetd</code> utility appeared in <span class=Ux>4.3BSD</span>. TCPMUX is based on code and documentation by Mark Lottor. Support for ONC RPC-based services is modeled after that provided by SunOS 4.1. The IPsec hack was contributed by the KAME project in 1999. The <span class=Ux>FreeBSD</span> TCP Wrappers support first appeared in <span class=Ux>FreeBSD 3.2</span>. </section></div><table class=foot><tr><td class=foot-date>December 6, 2021</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>