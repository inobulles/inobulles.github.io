<!DOCTYPE html>
<html><head><meta charset=utf-8><title>gmultipath(8)</title><keywords content=man,gmultipath></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>gmultipath(8)</h1><table class=head><tr><td class=head-ltitle>GMULTIPATH(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>GMULTIPATH(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>gmultipath</code> — <div class=Nd>disk multipath control utility</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>create</code> [<code class=Fl>-ARv</code>] <var class=Ar>name</var><var class=Ar>prov ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>label</code> [<code class=Fl>-ARv</code>] <var class=Ar>name</var><var class=Ar>prov ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>configure</code> [<code class=Fl>-APRv</code>] <var class=Ar>name</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>add</code> [<code class=Fl>-v</code>] <var class=Ar>name prov</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>remove</code> [<code class=Fl>-v</code>] <var class=Ar>name prov</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>fail</code> [<code class=Fl>-v</code>] <var class=Ar>name prov</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>restore</code> [<code class=Fl>-v</code>] <var class=Ar>name prov</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>rotate</code> [<code class=Fl>-v</code>] <var class=Ar>name</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>prefer</code> [<code class=Fl>-v</code>] <var class=Ar>name</var><var class=Ar>prov</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>getactive</code> [<code class=Fl>-v</code>] <var class=Ar>name</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>destroy</code> [<code class=Fl>-v</code>] <var class=Ar>name</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>stop</code> [<code class=Fl>-v</code>] <var class=Ar>name</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>clear</code> [<code class=Fl>-v</code>] <var class=Ar>prov ...</var></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>list</code></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>status</code></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>load</code></td></tr></table><br><table class=Nm><tr><td><code class=Nm>gmultipath</code></td><td><code class=Cm>unload</code></td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>gmultipath</code> utility is used for device multipath configuration. <p class=Pp>The multipath device can be configured using two different methods: “manual” or “automatic”. When using the “manual” method, no metadata are stored on the devices, so the multipath device has to be configured by hand every time it is needed. Additional device paths also will not be detected automatically. The “automatic” method uses on-disk metadata to detect device and all its paths. Metadata use the last sector of the underlying disk device and include device name and UUID. The UUID guarantees uniqueness in a shared storage environment but is in general too cumbersome to use. The name is what is exported via the device interface.</p><p class=Pp>The first argument to <code class=Nm>gmultipath</code> indicates an action to be performed:</p><dl class=Bl-tag><dt><a class=permalink href=#create><code class=Cm id=create>create</code></a></dt><dd>Create multipath device with “manual” method without writing any on-disk metadata. It is up to administrator, how to properly identify device paths. Kernel will only check that all given providers have same media and sector sizes. <p class=Pp><code class=Fl>-A</code> option enables Active/Active mode, <code class=Fl>-R</code> option enables Active/Read mode, otherwise Active/Passive mode is used by default.</p></dd><dt><a class=permalink href=#label><code class=Cm id=label>label</code></a></dt><dd>Create multipath device with “automatic” method. Label the first given provider with on-disk metadata using the specified <var class=Ar>name</var>. The rest of given providers will be retasted to detect these metadata. It reliably protects against specifying unrelated providers. Providers with no matching metadata detected will not be added to the device. <p class=Pp><code class=Fl>-A</code> option enables Active/Active mode, <code class=Fl>-R</code> option enables Active/Read mode, otherwise Active/Passive mode is used by default.</p></dd><dt><a class=permalink href=#configure><code class=Cm id=configure>configure</code></a></dt><dd>Configure the given multipath device. <p class=Pp><code class=Fl>-A</code> option enables Active/Active mode, <code class=Fl>-P</code> option enables Active/Passive mode, <code class=Fl>-R</code> option enables Active/Read mode.</p></dd><dt><a class=permalink href=#add><code class=Cm id=add>add</code></a></dt><dd>Add the given provider as a path to the given multipath device. Should normally be used only for devices created with “manual” method, unless you know what you are doing (you are sure that it is another device path, but tasting its metadata in regular “automatic” way is not possible).</dd><dt><a class=permalink href=#remove><code class=Cm id=remove>remove</code></a></dt><dd>Remove the given provider as a path from the given multipath device. If the last path removed, the multipath device will be destroyed.</dd><dt><a class=permalink href=#fail><code class=Cm id=fail>fail</code></a></dt><dd>Mark specified provider as a path of the specified multipath device as failed. If there are other paths present, new requests will be forwarded there.</dd><dt><a class=permalink href=#restore><code class=Cm id=restore>restore</code></a></dt><dd>Mark specified provider as a path of the specified multipath device as operational, allowing it to handle requests.</dd><dt><a class=permalink href=#rotate><code class=Cm id=rotate>rotate</code></a></dt><dd>Change the active provider/path to the next available provider in Active/Passive mode.</dd><dt><a class=permalink href=#prefer><code class=Cm id=prefer>prefer</code></a></dt><dd>Change the active provider/path to the specified provider in Active/Passive mode.</dd><dt><a class=permalink href=#getactive><code class=Cm id=getactive>getactive</code></a></dt><dd>Get the currently active provider(s)/path(s).</dd><dt><a class=permalink href=#destroy><code class=Cm id=destroy>destroy</code></a></dt><dd>Destroy the given multipath device clearing metadata.</dd><dt><a class=permalink href=#stop><code class=Cm id=stop>stop</code></a></dt><dd>Stop the given multipath device without clearing metadata.</dd><dt><a class=permalink href=#clear><code class=Cm id=clear>clear</code></a></dt><dd>Clear metadata on the given provider.</dd><dt><a class=permalink href=#list><code class=Cm id=list>list</code></a></dt><dd>See <a class=Xr href=geom.8.html>geom(8)</a>.</dd><dt><a class=permalink href=#status><code class=Cm id=status>status</code></a></dt><dd>See <a class=Xr href=geom.8.html>geom(8)</a>.</dd><dt><a class=permalink href=#load><code class=Cm id=load>load</code></a></dt><dd>See <a class=Xr href=geom.8.html>geom(8)</a>.</dd><dt><a class=permalink href=#unload><code class=Cm id=unload>unload</code></a></dt><dd>See <a class=Xr href=geom.8.html>geom(8)</a>.</dd></dl></section><section class=Sh><h2 class=Sh id=SYSCTL_VARIABLES><a class=permalink href=#SYSCTL_VARIABLES>SYSCTL VARIABLES</a></h2> The following <a class=Xr href=sysctl.8.html>sysctl(8)</a> variable can be used to control the behavior of the <code class=Nm>MULTIPATH</code> GEOM class. <dl class=Bl-tag><dt><var class=Va>kern.geom.multipath.debug</var>: <span class=No>0</span></dt><dd>Debug level of the <code class=Nm>MULTIPATH</code> GEOM class. This can be set to 0 (default) or 1 to disable or enable various forms of chattiness.</dd><dt><var class=Va>kern.geom.multipath.exclusive</var>: <span class=No>1</span></dt><dd>Open underlying providers exclusively, preventing individual paths access.</dd></dl></section><section class=Sh><h2 class=Sh id=EXIT_STATUS><a class=permalink href=#EXIT_STATUS>EXIT STATUS</a></h2> Exit status is 0 on success, and 1 if the command fails. </section><section class=Sh><h2 class=Sh id=MULTIPATH_ARCHITECTURE><a class=permalink href=#MULTIPATH_ARCHITECTURE>MULTIPATH ARCHITECTURE</a></h2> This is a multiple path architecture with no device knowledge or presumptions other than size matching built in. Therefore the user must exercise some care in selecting providers that do indeed represent multiple paths to the same underlying disk device. The reason for this is that there are several criteria across multiple underlying transport types that can <var class=Ar>indicate</var> identity, but in all respects such identity can rarely be considered <var class=Ar>definitive</var>. <p class=Pp>For example, if you use the World Wide Port Name of a Fibre Channel disk object you might believe that two disks that have the same WWPN on different paths (or even disjoint fabrics) might be considered the same disk. Nearly always this would be a safe assumption, until you realize that a WWPN, like an Ethernet MAC address, is a soft programmable entity, and that a misconfigured Director Class switch could lead you to believe incorrectly that you have found multiple paths to the same device. This is an extreme and theoretical case, but it is possible enough to indicate that the policy for deciding which of multiple pathnames refer to the same device should be left to the system operator who will use tools and knowledge of their own storage subsystem to make the correct configuration selection.</p><p class=Pp>There are Active/Passive, Active/Read and Active/Active operation modes supported. In Active/Passive mode only one path has I/O moving on it at any point in time. This I/O continues until an I/O is returned with a generic I/O error or a "Nonexistent Device" error. When this occurs, that path is marked FAIL, the next path in a list is selected as active and the failed I/O reissued. In Active/Active mode all paths not marked FAIL may handle I/O at the same time. Requests are distributed between paths to equalize load. For capable devices it allows the utilisation of the bandwidth available on all paths. In Active/Read mode all paths not marked FAIL may handle reads at the same time, but unlike in Active/Active mode only one path handles write requests at any point in time; closely following the original write request order if the layer above needs it for data consistency (not waiting for requisite write completion before sending dependent write).</p><p class=Pp>When new devices are added to the system the <code class=Nm>MULTIPATH</code> GEOM class is given an opportunity to taste these new devices. If a new device has a <code class=Nm>MULTIPATH</code> on-disk metadata label, the device is either used to create a new <code class=Nm>MULTIPATH</code> GEOM, or added to the list of paths for an existing <code class=Nm>MULTIPATH</code> GEOM.</p><p class=Pp>It is this mechanism that works reasonably with <a class=Xr href=isp.4.html>isp(4)</a> and <a class=Xr href=mpt.4.html>mpt(4)</a> based Fibre Channel disk devices. For these devices, when a device disappears (due to e.g., a cable pull or power failure to a switch), the device is proactively marked as gone and I/O to it failed. This causes the <code class=Nm>MULTIPATH</code> failure event just described.</p><p class=Pp>When Fibre Channel events inform either <a class=Xr href=isp.4.html>isp(4)</a> or <a class=Xr href=mpt.4.html>mpt(4)</a> host bus adapters that new devices may have arrived (e.g., the arrival of an RSCN event from the Fabric Domain Controller), they can cause a rescan to occur and cause the attachment and configuration of any (now) new devices to occur, causing the taste event described above.</p><p class=Pp>This means that this multipath architecture is not a one-shot path failover, but can be considered to be steady state as long as failed paths are repaired (automatically or otherwise).</p><p class=Pp>Automatic rescanning is not a requirement. Nor is Fibre Channel. The same failover mechanisms work equally well for traditional "Parallel" SCSI but may require manual intervention with <a class=Xr href=camcontrol.8.html>camcontrol(8)</a> to cause the reattachment of repaired device links.</p></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> The following example shows how to use <a class=Xr href=camcontrol.8.html>camcontrol(8)</a> to find possible multiple path devices and to create a <code class=Nm>MULTIPATH</code> GEOM class for them. <div class="Bd Pp Bd-indent"><pre>
mysys# camcontrol devlist
&lt;ECNCTX @WESTVILLE &gt;   at scbus0 target 0 lun 0 (da0,pass0)
&lt;ECNCTX @WESTVILLE &gt;   at scbus0 target 0 lun 1 (da1,pass1)
&lt;ECNCTX @WESTVILLE &gt;   at scbus1 target 0 lun 0 (da2,pass2)
&lt;ECNCTX @WESTVILLE &gt;   at scbus1 target 0 lun 1 (da3,pass3)
mysys# camcontrol inquiry da0 -S
ECNTX0LUN000000SER10ac0d01
mysys# camcontrol inquiry da2 -S
ECNTX0LUN000000SER10ac0d01
</pre></div><p class=Pp>Now that you have used the Serial Number to compare two disk paths it is not entirely unreasonable to conclude that these are multiple paths to the same device. However, only the user who is familiar with their storage is qualified to make this judgement.</p><p class=Pp>You can then use the <code class=Nm>gmultipath</code> command to label and create a <code class=Nm>MULTIPATH</code> GEOM provider named <var class=Ar>FRED</var>.</p><div class="Bd Pp Bd-indent"><pre>
gmultipath label -v FRED /dev/da0 /dev/da2
disklabel -Bw /dev/multipath/FRED auto
newfs /dev/multipath/FREDa
mount /dev/multipath/FREDa /mnt....
</pre></div><p class=Pp>The resultant console output looks something like:</p><div class="Bd Pp Bd-indent"><pre>
GEOM_MULTIPATH: da0 added to FRED
GEOM_MULTIPATH: da0 is now active path in FRED
GEOM_MULTIPATH: da2 added to FRED
</pre></div><p class=Pp>To load the <code class=Nm>gmultipath</code> module at boot time, add this entry to <span class=Pa>/boot/loader.conf</span>:</p><div class="Bd Pp Bd-indent"><pre>
geom_multipath_load="YES"
</pre></div></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=geom.4.html>geom(4)</a>, <a class=Xr href=isp.4.html>isp(4)</a>, <a class=Xr href=mpt.4.html>mpt(4)</a>, <a class=Xr href=loader.conf.5.html>loader.conf(5)</a>, <a class=Xr href=camcontrol.8.html>camcontrol(8)</a>, <a class=Xr href=geom.8.html>geom(8)</a>, <a class=Xr href=mount.8.html>mount(8)</a>, <a class=Xr href=newfs.8.html>newfs(8)</a>, <a class=Xr href=sysctl.8.html>sysctl(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>gmultipath</code> utility first appeared in <span class=Ux>FreeBSD 7.0</span></section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Matthew Jacob</span> &lt;<a class=Mt href=mailto:mjacob@FreeBSD.org>mjacob@FreeBSD.org</a>&gt; <br><span class=An>Alexander Motin</span> &lt;<a class=Mt href=mailto:mav@FreeBSD.org>mav@FreeBSD.org</a>&gt; </section></div><table class=foot><tr><td class=foot-date>March 17, 2022</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>