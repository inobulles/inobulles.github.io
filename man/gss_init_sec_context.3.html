<!DOCTYPE html>
<html><head><meta charset=utf-8><title>gss_init_sec_context(3)</title><keywords content=man,gss_init_sec_context></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>gss_init_sec_context(3)</h1><table class=head><tr><td class=head-ltitle>GSS_INIT_SEC_CONTEXT(3)</td><td class=head-vol>FreeBSD Library Functions Manual (prm)</td><td class=head-rtitle>GSS_INIT_SEC_CONTEXT(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>gss_init_sec_context</code> — <div class=Nd>Initiate a security context with a peer application</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/gssapi/gssapi.h.html>gssapi/gssapi.h</a>&gt;</code><p class=Pp><var class=Ft>OM_uint32</var><br><code class=Fn>gss_init_sec_context</code>(<var class=Fa>OM_uint32 *minor_status</var>, <var class=Fa>const gss_cred_id_t initiator_cred_handle</var>, <var class=Fa>gss_ctx_id_t *context_handle</var>, <var class=Fa>const gss_name_t target_name</var>, <var class=Fa>const gss_OID mech_type</var>, <var class=Fa>OM_uint32 req_flags</var>, <var class=Fa>OM_uint32 time_req</var>, <var class=Fa>const gss_channel_bindings_t input_chan_bindings</var>, <var class=Fa>const gss_buffer_t input_token</var>, <var class=Fa>gss_OID *actual_mech_type</var>, <var class=Fa>gss_buffer_t output_token</var>, <var class=Fa>OM_uint32 *ret_flags</var>, <var class=Fa>OM_uint32 *time_rec</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> Initiates the establishment of a security context between the application and a remote peer. Initially, the input_token parameter should be specified either as <code class=Dv>GSS_C_NO_BUFFER, or as a pointer to a</code> gss_buffer_desc object whose length field contains the value zero. The routine may return a output_token which should be transferred to the peer application, where the peer application will present it to <a class=Xr href=gss_accept_sec_context.3.html>gss_accept_sec_context(3)</a>. If no token need be sent, <code class=Fn>gss_init_sec_context</code>() will indicate this by setting the <code class=Dv>length field</code> of the output_token argument to zero. To complete the context establishment, one or more reply tokens may be required from the peer application; if so, <code class=Fn>gss_init_sec_context</code>() will return a status containing the supplementary information bit <code class=Dv>GSS_S_CONTINUE_NEEDED.</code> In this case, <code class=Fn>gss_init_sec_context</code>() should be called again when the reply token is received from the peer application, passing the reply token to <code class=Fn>gss_init_sec_context</code>() via the input_token parameters. <p class=Pp>Portable applications should be constructed to use the token length and return status to determine whether a token needs to be sent or waited for. Thus a typical portable caller should always invoke <code class=Fn>gss_init_sec_context</code>() within a loop:</p><div class="Bd Pp"><pre>
int context_established = 0;
gss_ctx_id_t context_hdl = GSS_C_NO_CONTEXT;
       ...
input_token-&gt;length = 0;

while (!context_established) {
  maj_stat = gss_init_sec_context(&amp;min_stat,
				  cred_hdl,
				  &amp;context_hdl,
				  target_name,
				  desired_mech,
				  desired_services,
				  desired_time,
				  input_bindings,
				  input_token,
				  &amp;actual_mech,
				  output_token,
				  &amp;actual_services,
				  &amp;actual_time);
  if (GSS_ERROR(maj_stat)) {
    report_error(maj_stat, min_stat);
  };

  if (output_token-&gt;length != 0) {
    send_token_to_peer(output_token);
    gss_release_buffer(&amp;min_stat, output_token)
  };
  if (GSS_ERROR(maj_stat)) {

    if (context_hdl != GSS_C_NO_CONTEXT)
      gss_delete_sec_context(&amp;min_stat,
			     &amp;context_hdl,
			     GSS_C_NO_BUFFER);
    break;
  };

  if (maj_stat &amp; GSS_S_CONTINUE_NEEDED) {
    receive_token_from_peer(input_token);
  } else {
    context_established = 1;
  };
};
</pre></div><p class=Pp>Whenever the routine returns a major status that includes the value <code class=Dv>GSS_S_CONTINUE_NEEDED, the context is not fully established and the</code> following restrictions apply to the output parameters:</p><ul class=Bl-bullet><li>The value returned via the <var class=Fa>time_rec</var> parameter is undefined Unless the accompanying <var class=Fa>ret_flags</var> parameter contains the bit <code class=Dv>GSS_C_PROT_READY_FLAG, indicating that per-message services may be</code> applied in advance of a successful completion status, the value returned via the <var class=Fa>actual_mech_type</var> parameter is undefined until the routine returns a major status value of <code class=Dv>GSS_S_COMPLETE.</code></li><li>The values of the <code class=Dv>GSS_C_DELEG_FLAG</code>, <code class=Dv>GSS_C_MUTUAL_FLAG</code>, <code class=Dv>GSS_C_REPLAY_FLAG</code>, <code class=Dv>GSS_C_SEQUENCE_FLAG</code>, <code class=Dv>GSS_C_CONF_FLAG</code>, <code class=Dv>GSS_C_INTEG_FLAG and</code><code class=Dv>GSS_C_ANON_FLAG bits returned via the</code><var class=Fa>ret_flags</var> parameter should contain the values that the implementation expects would be valid if context establishment were to succeed. In particular, if the application has requested a service such as delegation or anonymous authentication via the <var class=Fa>req_flags</var> argument, and such a service is unavailable from the underlying mechanism, <code class=Fn>gss_init_sec_context</code>() should generate a token that will not provide the service, and indicate via the <var class=Fa>ret_flags</var> argument that the service will not be supported. The application may choose to abort the context establishment by calling <a class=Xr href=gss_delete_sec_context.3.html>gss_delete_sec_context(3)</a> (if it cannot continue in the absence of the service), or it may choose to transmit the token and continue context establishment (if the service was merely desired but not mandatory).</li><li>The values of the <code class=Dv>GSS_C_PROT_READY_FLAG and</code><code class=Dv>GSS_C_TRANS_FLAG bits</code> within <var class=Fa>ret_flags</var> should indicate the actual state at the time <code class=Fn>gss_init_sec_context</code>() returns, whether or not the context is fully established.</li><li>GSS-API implementations that support per-message protection are encouraged to set the <code class=Dv>GSS_C_PROT_READY_FLAG in the final</code><var class=Fa>ret_flags</var> returned to a caller (i.e. when accompanied by a <code class=Dv>GSS_S_COMPLETE</code> status code). However, applications should not rely on this behavior as the flag was not defined in Version 1 of the GSS-API. Instead, applications should determine what per-message services are available after a successful context establishment according to the <code class=Dv>GSS_C_INTEG_FLAG and</code><code class=Dv>GSS_C_CONF_FLAG values.</code></li><li>All other bits within the <var class=Fa>ret_flags</var> argument should be set to zero.</li></ul><p class=Pp>If the initial call of <code class=Fn>gss_init_sec_context</code>() fails, the implementation should not create a context object, and should leave the value of the <var class=Fa>context_handle</var> parameter set to <code class=Dv>GSS_C_NO_CONTEXT to</code> indicate this. In the event of a failure on a subsequent call, the implementation is permitted to delete the "half-built" security context (in which case it should set the <var class=Fa>context_handle</var> parameter to <code class=Dv>GSS_C_NO_CONTEXT ), but the preferred behavior is to leave the</code> security context untouched for the application to delete (using <a class=Xr href=gss_delete_sec_context.3.html>gss_delete_sec_context(3)</a> ).</p><p class=Pp>During context establishment, the informational status bits <code class=Dv>GSS_S_OLD_TOKEN and</code><code class=Dv>GSS_S_DUPLICATE_TOKEN indicate fatal errors, and</code> GSS-API mechanisms should always return them in association with a routine error of <code class=Dv>GSS_S_FAILURE</code>. This requirement for pairing did not exist in version 1 of the GSS-API specification, so applications that wish to run over version 1 implementations must special-case these codes.</p></section><section class=Sh><h2 class=Sh id=PARAMETERS><a class=permalink href=#PARAMETERS>PARAMETERS</a></h2><dl class=Bl-tag><dt>minor_status</dt><dd>Mechanism specific status code.</dd><dt>initiator_cred_handle</dt><dd>handle for credentials claimed. Supply <code class=Dv>GSS_C_NO_CREDENTIAL to act as a default</code> initiator principal. If no default initiator is defined, the function will return <code class=Dv>GSS_S_NO_CRED.</code></dd><dt>context_handle</dt><dd>context handle for new context. Supply <code class=Dv>GSS_C_NO_CONTEXT for first call; use value</code> returned by first call in continuation calls. Resources associated with this context-handle must be released by the application after use with a call to <code class=Fn>gss_delete_sec_context</code>().</dd><dt>target_name</dt><dd>Name of target</dd><dt>mech_type</dt><dd>Object ID of desired mechanism. Supply <code class=Dv>GSS_C_NO_OID to obtain an implementation</code> specific default</dd><dt>req_flags</dt><dd>Contains various independent flags, each of which requests that the context support a specific service option. Symbolic names are provided for each flag, and the symbolic names corresponding to the required flags should be logically-ORed together to form the bit-mask value. The flags are: <dl class=Bl-tag><dt>GSS_C_DELEG_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Delegate credentials to remote peer</dd><dt>False</dt><dd>Don't delegate</dd></dl></dd><dt>GSS_C_MUTUAL_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Request that remote peer authenticate itself</dd><dt>False</dt><dd>Authenticate self to remote peer only</dd></dl></dd><dt>GSS_C_REPLAY_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Enable replay detection for messages protected with <a class=Xr href=gss_wrap.3.html>gss_wrap(3)</a> or <a class=Xr href=gss_get_mic.3.html>gss_get_mic(3)</a></dd><dt>False</dt><dd>Don't attempt to detect replayed messages</dd></dl></dd><dt>GSS_C_SEQUENCE_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Enable detection of out-of-sequence protected messages</dd><dt>False</dt><dd>Don't attempt to detect out-of-sequence messages</dd></dl></dd><dt>GSS_C_CONF_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Request that confidentiality service be made available (via <a class=Xr href=gss_wrap.3.html>gss_wrap(3)</a>)</dd><dt>False</dt><dd>No per-message confidentiality service is required.</dd></dl></dd><dt>GSS_C_INTEG_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Request that integrity service be made available (via <a class=Xr href=gss_wrap.3.html>gss_wrap(3)</a> or <a class=Xr href=gss_get_mic.3.html>gss_get_mic(3)</a>)</dd><dt>False</dt><dd>No per-message integrity service is required.</dd></dl></dd><dt>GSS_C_ANON_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Do not reveal the initiator's identity to the acceptor.</dd><dt>False</dt><dd>Authenticate normally.</dd></dl></dd></dl></dd><dt>time_req</dt><dd>Desired number of seconds for which context should remain valid. Supply 0 to request a default validity period.</dd><dt>input_chan_bindings</dt><dd>Application-specified bindings. Allows application to securely bind channel identification information to the security context. Specify <code class=Dv>GSS_C_NO_CHANNEL_BINDINGS</code> if channel bindings are not used.</dd><dt>input_token</dt><dd>Token received from peer application. Supply <code class=Dv>GSS_C_NO_BUFFER, or a pointer to</code> a buffer containing the value <code class=Dv>GSS_C_EMPTY_BUFFER</code> on initial call.</dd><dt>actual_mech_type</dt><dd>Actual mechanism used. The OID returned via this parameter will be a pointer to static storage that should be treated as read-only; In particular the application should not attempt to free it. Specify <code class=Dv>NULL if not required.</code></dd><dt>output_token</dt><dd>token to be sent to peer application. If the length field of the returned buffer is zero, no token need be sent to the peer application. Storage associated with this buffer must be freed by the application after use with a call to <a class=Xr href=gss_release_buffer.3.html>gss_release_buffer(3)</a>.</dd><dt>ret_flags</dt><dd>Contains various independent flags, each of which indicates that the context supports a specific service option. Specify <code class=Dv>NULL if not</code> required. Symbolic names are provided for each flag, and the symbolic names corresponding to the required flags should be logically-ANDed with the <var class=Fa>ret_flags</var> value to test whether a given option is supported by the context. The flags are: <dl class=Bl-tag><dt>GSS_C_DELEG_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Credentials were delegated to the remote peer</dd><dt>False</dt><dd>No credentials were delegated</dd></dl></dd><dt>GSS_C_MUTUAL_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>The remote peer has authenticated itself.</dd><dt>False</dt><dd>Remote peer has not authenticated itself.</dd></dl></dd><dt>GSS_C_REPLAY_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Replay of protected messages will be detected</dd><dt>False</dt><dd>Replayed messages will not be detected</dd></dl></dd><dt>GSS_C_SEQUENCE_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Out-of-sequence protected messages will be detected</dd><dt>False</dt><dd>Out-of-sequence messages will not be detected</dd></dl></dd><dt>GSS_C_CONF_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Confidentiality service may be invoked by calling <a class=Xr href=gss_wrap.3.html>gss_wrap(3)</a> routine</dd><dt>False</dt><dd>No confidentiality service (via <a class=Xr href=gss_wrap.3.html>gss_wrap(3)</a>) available. <a class=Xr href=gss_wrap.3.html>gss_wrap(3)</a> will provide message encapsulation, data-origin authentication and integrity services only.</dd></dl></dd><dt>GSS_C_INTEG_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Integrity service may be invoked by calling either <a class=Xr href=gss_get_mic.3.html>gss_get_mic(3)</a> or <a class=Xr href=gss_wrap.3.html>gss_wrap(3)</a> routines.</dd><dt>False</dt><dd>Per-message integrity service unavailable.</dd></dl></dd><dt>GSS_C_ANON_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>The initiator's identity has not been revealed, and will not be revealed if any emitted token is passed to the acceptor.</dd><dt>False</dt><dd>The initiator's identity has been or will be authenticated normally.</dd></dl></dd><dt>GSS_C_PROT_READY_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>Protection services (as specified by the states of the <code class=Dv>GSS_C_CONF_FLAG</code> and <code class=Dv>GSS_C_INTEG_FLAG</code>) <code class=Dv>are available for</code> use if the accompanying major status return value is either <code class=Dv>GSS_S_COMPLETE</code> or <code class=Dv>GSS_S_CONTINUE_NEEDED.</code></dd><dt>False</dt><dd>Protection services (as specified by the states of the <code class=Dv>GSS_C_CONF_FLAG</code> and <code class=Dv>GSS_C_INTEG_FLAG</code>) <code class=Dv>are available</code> only if the accompanying major status return value is <code class=Dv>GSS_S_COMPLETE.</code></dd></dl></dd><dt>GSS_C_TRANS_FLAG</dt><dd><dl class=Bl-tag><dt>True</dt><dd>The resultant security context may be transferred to other processes via a call to <code class=Fn>gss_export_sec_context</code>().</dd><dt>False</dt><dd>The security context is not transferable.</dd></dl></dd></dl><p class=Pp>All other bits should be set to zero.</p></dd><dt>time_rec</dt><dd>Number of seconds for which the context will remain valid. If the implementation does not support context expiration, the value <code class=Dv>GSS_C_INDEFINITE will be returned. Specify</code><code class=Dv>NULL if not required.</code></dd></dl></section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2><dl class=Bl-tag><dt>GSS_S_COMPLETE</dt><dd>Successful completion</dd><dt>GSS_S_CONTINUE_NEEDED</dt><dd>Indicates that a token from the peer application is required to complete the context, and that gss_init_sec_context must be called again with that token.</dd><dt>GSS_S_DEFECTIVE_TOKEN</dt><dd>Indicates that consistency checks performed on the input_token failed</dd><dt>GSS_S_DEFECTIVE_CREDENTIAL</dt><dd>Indicates that consistency checks performed on the credential failed.</dd><dt>GSS_S_NO_CRED</dt><dd>The supplied credentials were not valid for context initiation, or the credential handle did not reference any credentials.</dd><dt>GSS_S_CREDENTIALS_EXPIRED</dt><dd>The referenced credentials have expired</dd><dt>GSS_S_BAD_BINDINGS</dt><dd>The input_token contains different channel bindings to those specified via the input_chan_bindings parameter</dd><dt>GSS_S_BAD_SIG</dt><dd>The input_token contains an invalid MIC, or a MIC that could not be verified</dd><dt>GSS_S_OLD_TOKEN</dt><dd>The input_token was too old. This is a fatal error during context establishment</dd><dt>GSS_S_DUPLICATE_TOKEN</dt><dd>The input_token is valid, but is a duplicate of a token already processed. This is a fatal error during context establishment.</dd><dt>GSS_S_NO_CONTEXT</dt><dd>Indicates that the supplied context handle did not refer to a valid context</dd><dt>GSS_S_BAD_NAMETYPE</dt><dd>The provided target_name parameter contained an invalid or unsupported type of name</dd><dt>GSS_S_BAD_NAME</dt><dd>The provided target_name parameter was ill-formed.</dd><dt>GSS_S_BAD_MECH</dt><dd>The specified mechanism is not supported by the provided credential, or is unrecognized by the implementation.</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=gss_accept_sec_context.3.html>gss_accept_sec_context(3)</a>, <a class=Xr href=gss_delete_sec_context.3.html>gss_delete_sec_context(3)</a>, <a class=Xr href=gss_get_mic.3.html>gss_get_mic(3)</a>, <a class=Xr href=gss_release_buffer.3.html>gss_release_buffer(3)</a>, <a class=Xr href=gss_wrap.3.html>gss_wrap(3)</a></section><section class=Sh><h2 class=Sh id=STANDARDS><a class=permalink href=#STANDARDS>STANDARDS</a></h2><dl class=Bl-tag><dt>RFC 2743</dt><dd>Generic Security Service Application Program Interface Version 2, Update 1</dd><dt>RFC 2744</dt><dd>Generic Security Service API Version 2 : C-bindings</dd></dl></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>gss_init_sec_context</code> function first appeared in <span class=Ux>FreeBSD 7.0</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> John Wray, Iris Associates </section><section class=Sh><h2 class=Sh id=COPYRIGHT><a class=permalink href=#COPYRIGHT>COPYRIGHT</a></h2> Copyright (C) The Internet Society (2000). All Rights Reserved. <p class=Pp>This document and translations of it may be copied and furnished to others, and derivative works that comment on or otherwise explain it or assist in its implementation may be prepared, copied, published and distributed, in whole or in part, without restriction of any kind, provided that the above copyright notice and this paragraph are included on all such copies and derivative works. However, this document itself may not be modified in any way, such as by removing the copyright notice or references to the Internet Society or other Internet organizations, except as needed for the purpose of developing Internet standards in which case the procedures for copyrights defined in the Internet Standards process must be followed, or as required to translate it into languages other than English.</p><p class=Pp>The limited permissions granted above are perpetual and will not be revoked by the Internet Society or its successors or assigns.</p><p class=Pp>This document and the information contained herein is provided on an "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p></section></div><table class=foot><tr><td class=foot-date>January 26, 2010</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>