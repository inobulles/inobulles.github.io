<!DOCTYPE html>
<html><head><meta charset=utf-8><title>scsi(4)</title><keywords content=man,scsi></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>scsi(4)</h1><table class=head><tr><td class=head-ltitle>CAM(4)</td><td class=head-vol>FreeBSD Kernel Interfaces Manual</td><td class=head-rtitle>CAM(4)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>CAM</code> — <div class=Nd>Common Access Method Storage subsystem</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=Cd>device scbus</code><br><code class=Cd>device ada</code><br><code class=Cd>device cd</code><br><code class=Cd>device ch</code><br><code class=Cd>device da</code><br><code class=Cd>device pass</code><br><code class=Cd>device pt</code><br><code class=Cd>device sa</code><br><code class=Cd>options CAMDEBUG</code><br><code class=Cd>options CAM_DEBUG_BUS=-1</code><br><code class=Cd>options CAM_DEBUG_TARGET=-1</code><br><code class=Cd>options CAM_DEBUG_LUN=-1</code><br><code class=Cd>options CAM_DEBUG_COMPILE=CAM_DEBUG_INFO|CAM_DEBUG_CDB|CAM_DEBUG_PROBE</code><br><code class=Cd>options CAM_DEBUG_FLAGS=CAM_DEBUG_INFO|CAM_DEBUG_CDB</code><br><code class=Cd>options CAM_MAX_HIGHPOWER=4</code><br><code class=Cd>options SCSI_NO_SENSE_STRINGS</code><br><code class=Cd>options SCSI_NO_OP_STRINGS</code><br><code class=Cd>options SCSI_DELAY=8000</code></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>CAM</code> subsystem provides a uniform and modular system for the implementation of drivers to control various SCSI, ATA, NVMe, and MMC / SD devices, and to utilize different SCSI, ATA, NVMe, and MMC / SD host adapters through host adapter drivers. When the system probes buses, it attaches any devices it finds to the appropriate drivers. The <a class=Xr href=pass.4.html>pass(4)</a> driver, if it is configured in the kernel, will attach to all devices. </section><section class=Sh><h2 class=Sh id=KERNEL_CONFIGURATION><a class=permalink href=#KERNEL_CONFIGURATION>KERNEL CONFIGURATION</a></h2> There are a number of generic kernel configuration options for the <code class=Nm>CAM</code> subsystem: <dl class=Bl-tag><dt><a class=permalink href=#CAM_BOOT_DELAY><code class=Dv id=CAM_BOOT_DELAY>CAM_BOOT_DELAY</code></a></dt><dd>Additional time to wait after the static parts of the kernel have run to allow for discovery of additional devices which may take time to connect, such as USB attached storage.</dd><dt><a class=permalink href=#CAM_IOSCHED_DYNAMIC><code class=Dv id=CAM_IOSCHED_DYNAMIC>CAM_IOSCHED_DYNAMIC</code></a></dt><dd>Enable dynamic decisions in the I/O scheduler based on hints and the current performance of the storage devices.</dd><dt><a class=permalink href=#CAM_IO_STATS><code class=Dv id=CAM_IO_STATS>CAM_IO_STATS</code></a></dt><dd>Enable collection of statistics for periph devices.</dd><dt><a class=permalink href=#CAM_TEST_FAILURE><code class=Dv id=CAM_TEST_FAILURE>CAM_TEST_FAILURE</code></a></dt><dd>Enable ability to simulate I/O failures.</dd><dt><a class=permalink href=#CAMDEBUG><code class=Dv id=CAMDEBUG>CAMDEBUG</code></a></dt><dd>This option compiles in all the <code class=Nm>CAM</code> debugging printf code. This will not actually cause any debugging information to be printed out when included by itself. See below for details.</dd><dt><a class=permalink href="#CAM_MAX_HIGHPOWER=4"><code class=Dv id="CAM_MAX_HIGHPOWER=4">CAM_MAX_HIGHPOWER=4</code></a></dt><dd>This sets the maximum allowable number of concurrent "high power" commands. A "high power" command is a command that takes more electrical power than most to complete. An example of this is the SCSI START UNIT command. Starting a disk often takes significantly more electrical power than normal operation. This option allows the user to specify how many concurrent high power commands may be outstanding without overloading the power supply on his computer.</dd><dt><a class=permalink href=#SCSI_NO_SENSE_STRINGS><code class=Dv id=SCSI_NO_SENSE_STRINGS>SCSI_NO_SENSE_STRINGS</code></a></dt><dd>This eliminates text descriptions of each SCSI Additional Sense Code and Additional Sense Code Qualifier pair. Since this is a fairly large text database, eliminating it reduces the size of the kernel somewhat. This is primarily necessary for boot floppies and other low disk space or low memory space environments. In most cases, though, this should be enabled, since it speeds the interpretation of SCSI error messages. Do not let the "kernel bloat" zealots get to you -- leave the sense descriptions in your kernel!</dd><dt><a class=permalink href=#SCSI_NO_OP_STRINGS><code class=Dv id=SCSI_NO_OP_STRINGS>SCSI_NO_OP_STRINGS</code></a></dt><dd>This disables text descriptions of each SCSI opcode. This option, like the sense string option above, is primarily useful for environments like a boot floppy where kernel size is critical. Enabling this option for normal use is not recommended, since it slows debugging of SCSI problems.</dd><dt><a class=permalink href="#SCSI_DELAY=8000"><code class=Dv id="SCSI_DELAY=8000">SCSI_DELAY=8000</code></a></dt><dd>This is the SCSI "bus settle delay." In <code class=Nm>CAM</code>, it is specified in <i class=Em>milliseconds</i>, not seconds like the old SCSI layer used to do. When the kernel boots, it sends a bus reset to each SCSI bus to tell each device to reset itself to a default set of transfer negotiations and other settings. Most SCSI devices need some amount of time to recover from a bus reset. Newer disks may need as little as 100ms, while old, slow devices may need much longer. If the <code class=Dv>SCSI_DELAY</code> is not specified, it defaults to 2 seconds. The minimum allowable value for <code class=Dv>SCSI_DELAY</code> is "100", or 100ms. One special case is that if the <code class=Dv>SCSI_DELAY</code> is set to 0, that will be taken to mean the "lowest possible value." In that case, the <code class=Dv>SCSI_DELAY</code> will be reset to 100ms.</dd></dl><p class=Pp>All devices and buses support dynamic allocation so that an upper number of devices and controllers does not need to be configured; <code class=Cd>device da</code> will suffice for any number of disk drivers.</p><p class=Pp>The devices are either <i class=Em>wired</i> so they appear as a particular device unit or <i class=Em>counted</i> so that they appear as the next available unused unit.</p><p class=Pp>Units are wired down by setting kernel environment hints. This is usually done either interactively from the <a class=Xr href=loader.8.html>loader(8)</a>, or automatically via the <span class=Pa>/boot/device.hints</span> file. The basic syntax is:</p><div class="Bd Pp Bd-indent"><pre>
hint.device.unit.property="value"
</pre></div><p class=Pp>Individual <code class=Nm>CAM</code> bus numbers can be wired down to specific controllers with a config line similar to the following:</p><div class="Bd Pp Bd-indent"><pre>
hint.scbus.0.at="ahd1"
</pre></div><p class=Pp>This assigns <code class=Nm>CAM</code> bus number 0 to the <i class=Em>ahd1</i> driver instance. For controllers supporting more than one bus, a particular bus can be assigned as follows:</p><div class="Bd Pp Bd-indent"><pre>
hint.scbus.0.at="ahc1"
hint.scbus.0.bus="1"
</pre></div><p class=Pp>This assigns <code class=Nm>CAM</code> bus 0 to the bus 1 instance on <i class=Em>ahc1</i>. Peripheral drivers can be wired to a specific bus, target, and lun as so:</p><div class="Bd Pp Bd-indent"><pre>
hint.da.0.at="scbus0"
hint.da.0.target="0"
hint.da.0.unit="0"
</pre></div><p class=Pp>This assigns <i class=Em>da0</i> to target 0, unit (lun) 0 of scbus 0. Omitting the target or unit hints will instruct <code class=Nm>CAM</code> to treat them as wildcards and use the first respective counted instances. These examples can be combined together to allow a peripheral device to be wired to any particular controller, bus, target, and/or unit instance.</p><p class=Pp>This also works with <a class=Xr href=nvme.4.html>nvme(4)</a> drives as well.</p><div class="Bd Pp Bd-indent"><pre>
hint.nvme.4.at="pci7:0:0"
hint.scbus.10.at="nvme4"
hint.nda.10.at="scbus10"
hint.nda.10.target="1"
hint.nda.10.unit="12"
hint.nda.11.at="scbus10"
hint.nda.11.target="1"
hint.nda.11.unit="2"
</pre></div><p class=Pp>This assigns the NVMe card living at PCI bus 7 slot 0 function 1 to scbus 10. The target for <a class=Xr href=nda.4.html>nda(4)</a> devices is always 1. The unit is the namespace identifier from the drive. The namespace id 1 is exported as <i class=Em>nda10</i> and namespace id 2 is exported as <i class=Em>nda11</i>.</p><p class=Pp>For devices that provide a serial number, units may be wired to that serial number without regard where the drive is attached:</p><div class="Bd Pp Bd-indent"><pre>
hint.nda.3.sn="CY0AN07101120B12P"
hint.da.44.sn="143282400011"
hint.ada.2.sn="A065D591"
</pre></div> wires <i class=Em>nda3</i>, <i class=Em>da44</i>, and <i class=Em>ada2</i> to drives with the specified serial numbers. One need not specify an <i class=Em>at</i> line when serial numbers are used. </section><section class=Sh><h2 class=Sh id=ADAPTERS><a class=permalink href=#ADAPTERS>ADAPTERS</a></h2> The system allows common device drivers to work through many different types of adapters. The adapters take requests from the upper layers and do all IO between the SCSI, ATA, NVMe, or MMC / SD bus and the system. The maximum size of a transfer is governed by the adapter. Most adapters can transfer 64KB in a single operation, however many can transfer larger amounts. </section><section class=Sh><h2 class=Sh id=TARGET_MODE><a class=permalink href=#TARGET_MODE>TARGET MODE</a></h2> Some adapters support <i class=Em>target mode</i> in which the system is capable of operating as a device, responding to operations initiated by another system. Target mode is supported for some adapters, but is not yet complete for this version of the <code class=Nm>CAM</code> SCSI subsystem. </section><section class=Sh><h2 class=Sh id=ARCHITECTURE><a class=permalink href=#ARCHITECTURE>ARCHITECTURE</a></h2> The <code class=Nm>CAM</code> subsystem glues together the upper layers of the system to the storage devices. PERIPH devices accept storage requests from GEOM and other upper layers of the system and translates them into protocol requests. XPT (transport) dispatches these protocol requests to a SIM driver. A SIM driver takes protocol requests and translates them into hardware commands the host adapter understands to transfer the protocol requests, and data (if any) to the storage device. The CCB transports these requests around as messages. <section class=Ss><h2 class=Ss id=CAM><a class=permalink href=#CAM>CAM</a></h2> The Common Access Method was a standard defined in the 1990s to talk to disk drives. <span class=Ux>FreeBSD</span> is one of the few operating systems to fully implement this model. The interface between different parts of CAM is the CCB (or CAM Control Block). Each CCB has a standard header, which contains the type of request and dispatch information, and a command specific portion. A CAM Periph generates requests. The XPT layer dispatches these requests to the appropriate SIM. Some CCBs are sent directly to the SIM for immediate processing, while others are queued and complete when the I/O has finished. A SIM takes CCBs and translates them into hardware specific commands to push the SCSI CDB or other protocol control block to the peripheral, along with setting up the DMA for the associated data. </section><section class=Ss><h2 class=Ss id=Periph_Devices><a class=permalink href=#Periph_Devices>Periph Devices</a></h2> A periph driver knows how to translate standard requests into protocol messages that a SIM can deliver to hardware. These requests can come from any upper layer source, but primarily come in via GEOM as a bio request. They can also come in directly from character device requests for tapes and pass through commands. <p class=Pp>Disk devices, or direct access (da) in CAM, are one type of peripheral. These devices present themselves to the kernel a device ending in “da”. Each protocol has a unique device name:</p><dl class=Bl-tag><dt><a class=Xr href=da.4.html>da(4)</a></dt><dd>SCSI or SAS device, or devices that accept SCSI CDBs for I/O.</dd><dt><a class=Xr href=ada.4.html>ada(4)</a></dt><dd>ATA or SATA device</dd><dt><a class=Xr href=nda.4.html>nda(4)</a></dt><dd>NVME device</dd><dt><a class=Xr href=sdda.4.html>sdda(4)</a></dt><dd>An SD or MMC block storage device.</dd></dl><p class=Pp>Tape devices are called serial access (<a class=Xr href=sa.4.html>sa(4)</a>) in CAM. They interface to the system via a character device and provide <a class=Xr href=ioctl.2.html>ioctl(2)</a> control for tape drives.</p><p class=Pp>The <a class=Xr href=pass.4.html>pass(4)</a> device will pass through CCB requests from userland to the SIM directly. The device is used to send commands other than read, write, trim or flush to a device. The <a class=Xr href=camcontrol.8.html>camcontrol(8)</a> command uses this device.</p></section><section class=Ss><h2 class=Ss id=XPT_drivers><a class=permalink href=#XPT_drivers>XPT drivers</a></h2> The transport driver connects the periph to the SIM. It is not configured separately. It is also responsible for device discovery for those SIM drivers that do not enumerate themselves. </section><section class=Ss><h2 class=Ss id=SIM_driver><a class=permalink href=#SIM_driver>SIM driver</a></h2> SIM used to stand for SCSI Interface Module. Now it is just SIM because it understands protocols other than SCSI. There are two types of SIM drivers: virtual and physical. Physical SIMs are typically called host bus adapters (HBA), but not universally. Virtual SIM drivers are for communicating with virtual machine hosts. </section></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2> see other <code class=Nm>CAM</code> device entries. </section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2> An XPT_DEBUG CCB can be used to enable various amounts of tracing information on any specific bus/device from the list of options compiled into the kernel. There are currently seven debugging flags that may be compiled in and used: <dl class=Bl-tag><dt><a class=permalink href=#CAM_DEBUG_INFO><code class=Dv id=CAM_DEBUG_INFO>CAM_DEBUG_INFO</code></a></dt><dd>This flag enables general informational printfs for the device or devices in question.</dd><dt><a class=permalink href=#CAM_DEBUG_TRACE><code class=Dv id=CAM_DEBUG_TRACE>CAM_DEBUG_TRACE</code></a></dt><dd>This flag enables function-level command flow tracing i.e., kernel printfs will happen at the entrance and exit of various functions.</dd><dt><a class=permalink href=#CAM_DEBUG_SUBTRACE><code class=Dv id=CAM_DEBUG_SUBTRACE>CAM_DEBUG_SUBTRACE</code></a></dt><dd>This flag enables debugging output internal to various functions.</dd><dt><a class=permalink href=#CAM_DEBUG_CDB><code class=Dv id=CAM_DEBUG_CDB>CAM_DEBUG_CDB</code></a></dt><dd>This flag will cause the kernel to print out all ATA and SCSI commands sent to a particular device or devices.</dd><dt><a class=permalink href=#CAM_DEBUG_XPT><code class=Dv id=CAM_DEBUG_XPT>CAM_DEBUG_XPT</code></a></dt><dd>This flag will enable command scheduler tracing.</dd><dt><a class=permalink href=#CAM_DEBUG_PERIPH><code class=Dv id=CAM_DEBUG_PERIPH>CAM_DEBUG_PERIPH</code></a></dt><dd>This flag will enable peripheral drivers messages.</dd><dt><a class=permalink href=#CAM_DEBUG_PROBE><code class=Dv id=CAM_DEBUG_PROBE>CAM_DEBUG_PROBE</code></a></dt><dd>This flag will enable devices probe process tracing.</dd></dl><p class=Pp>Some of these flags, most notably <code class=Dv>CAM_DEBUG_TRACE</code> and <code class=Dv>CAM_DEBUG_SUBTRACE</code>, will produce kernel printfs in EXTREME numbers.</p><p class=Pp>Users can enable debugging from their kernel config file, by using the following kernel config options:</p><dl class=Bl-tag><dt><a class=permalink href=#CAMDEBUG_2><code class=Dv id=CAMDEBUG_2>CAMDEBUG</code></a></dt><dd>This builds into the kernel all possible <code class=Nm>CAM</code> debugging.</dd><dt><a class=permalink href=#CAM_DEBUG_COMPILE><code class=Dv id=CAM_DEBUG_COMPILE>CAM_DEBUG_COMPILE</code></a></dt><dd>This specifies support for which debugging flags described above should be built into the kernel. Flags may be ORed together if the user wishes to see printfs for multiple debugging levels.</dd><dt><a class=permalink href=#CAM_DEBUG_FLAGS><code class=Dv id=CAM_DEBUG_FLAGS>CAM_DEBUG_FLAGS</code></a></dt><dd>This sets the various debugging flags from a kernel config file.</dd><dt><a class=permalink href=#CAM_DEBUG_BUS><code class=Dv id=CAM_DEBUG_BUS>CAM_DEBUG_BUS</code></a></dt><dd>Specify a bus to debug. To debug all buses, set this to -1.</dd><dt><a class=permalink href=#CAM_DEBUG_TARGET><code class=Dv id=CAM_DEBUG_TARGET>CAM_DEBUG_TARGET</code></a></dt><dd>Specify a target to debug. To debug all targets, set this to -1.</dd><dt><a class=permalink href=#CAM_DEBUG_LUN><code class=Dv id=CAM_DEBUG_LUN>CAM_DEBUG_LUN</code></a></dt><dd>Specify a lun to debug. To debug all luns, set this to -1.</dd></dl><p class=Pp>Users may also enable debugging on the fly by using the <a class=Xr href=camcontrol.8.html>camcontrol(8)</a> utility, if wanted options built into the kernel. See <a class=Xr href=camcontrol.8.html>camcontrol(8)</a> for details.</p></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><dl class=Bl-tag><dt><b class=Sy>Commands:</b></dt><dd><a class=Xr href=camcontrol.8.html>camcontrol(8)</a>, <a class=Xr href=camdd.8.html>camdd(8)</a></dd><dt><b class=Sy>Libraries:</b></dt><dd><a class=Xr href=cam.3.html>cam(3)</a></dd><dt><b class=Sy>Periph Drivers:</b></dt><dd><a class=Xr href=ada.4.html>ada(4)</a>, <a class=Xr href=da.4.html>da(4)</a>, <a class=Xr href=nda.4.html>nda(4)</a>, <a class=Xr href=pass.4.html>pass(4)</a>, <a class=Xr href=sa.4.html>sa(4)</a></dd><dt><b class=Sy>SIM Devices:</b></dt><dd><a class=Xr href=aac.4.html>aac(4)</a>, <a class=Xr href=aacraid.4.html>aacraid(4)</a>, <a class=Xr href=ahc.4.html>ahc(4)</a>, <a class=Xr href=ahci.4.html>ahci(4)</a>, <a class=Xr href=ata.4.html>ata(4)</a>, <a class=Xr href=aw_mmc.4.html>aw_mmc(4)</a>, <a class=Xr href=ciss.4.html>ciss(4)</a>, <a class=Xr href=hv_storvsc.4.html>hv_storvsc(4)</a>, <a class=Xr href=isci.4.html>isci(4)</a>, <a class=Xr href=iscsi.4.html>iscsi(4)</a>, <a class=Xr href=isp.4.html>isp(4)</a>, <a class=Xr href=mpr.4.html>mpr(4)</a>, <a class=Xr href=mps.4.html>mps(4)</a>, <a class=Xr href=mpt.4.html>mpt(4)</a>, <a class=Xr href=mrsas.4.html>mrsas(4)</a>, <a class=Xr href=mvs.4.html>mvs(4)</a>, <a class=Xr href=nvme.4.html>nvme(4)</a>, <a class=Xr href=pms.4.html>pms(4)</a>, <a class=Xr href=pvscsi.4.html>pvscsi(4)</a>, <a class=Xr href=sdhci.4.html>sdhci(4)</a>, <a class=Xr href=smartpqi.4.html>smartpqi(4)</a>, <a class=Xr href=sym.4.html>sym(4)</a>, <a class=Xr href=tws.4.html>tws(4)</a>, <a class=Xr href=umass.4.html>umass(4)</a>, <a class=Xr href=virtio_scsi.4.html>virtio_scsi(4)</a></dd><dt><b class=Sy>Deprecated or Poorly Supported SIM Devices:</b></dt><dd><a class=Xr href=ahd.4.html>ahd(4)</a>, <a class=Xr href=amr.4.html>amr(4)</a>, <a class=Xr href=arcmsr.4.html>arcmsr(4)</a>, <a class=Xr href=esp.4.html>esp(4)</a>, <a class=Xr href=hpt27xx.4.html>hpt27xx(4)</a>, <a class=Xr href=hptiop.4.html>hptiop(4)</a>, <a class=Xr href=hptmv.4.html>hptmv(4)</a>, <a class=Xr href=hptnr.4.html>hptnr(4)</a>, <a class=Xr href=iir.4.html>iir(4)</a><a class=Xr href=mfi.4.html>mfi(4)</a>, <a class=Xr href=sbp.4.html>sbp(4)</a>, <a class=Xr href=twa.4.html>twa(4)</a></dd></dl></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>CAM</code> SCSI subsystem first appeared in <span class=Ux>FreeBSD 3.0</span>. The <code class=Nm>CAM</code> ATA support was added in <span class=Ux>FreeBSD 8.0</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> The <code class=Nm>CAM</code> SCSI subsystem was written by <span class=An>Justin Gibbs</span> and <span class=An>Kenneth Merry</span>. The <code class=Nm>CAM</code> ATA support was added by <span class=An>Alexander Motin</span> &lt;<a class=Mt href=mailto:mav@FreeBSD.org>mav@FreeBSD.org</a>&gt;. The <code class=Nm>CAM</code> NVMe support was added by <span class=An>Warner Losh</span> &lt;<a class=Mt href=mailto:imp@FreeBSD.org>imp@FreeBSD.org</a>&gt;. </section></div><table class=foot><tr><td class=foot-date>November 3, 2021</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>