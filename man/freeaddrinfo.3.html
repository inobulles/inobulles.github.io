<!DOCTYPE html>
<html><head><meta charset=utf-8><title>freeaddrinfo(3)</title><keywords content=man,freeaddrinfo></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>freeaddrinfo(3)</h1><table class=head><tr><td class=head-ltitle>GETADDRINFO(3)</td><td class=head-vol>FreeBSD Library Functions Manual</td><td class=head-rtitle>GETADDRINFO(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>getaddrinfo</code>, <code class=Nm>freeaddrinfo</code> — <div class=Nd>socket address structure to host and service name</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/sys/types.h.html>sys/types.h</a>&gt;</code><br><code class=In>#include &lt;<a class=In href=../src/sys/socket.h.html>sys/socket.h</a>&gt;</code><br><code class=In>#include &lt;<a class=In href=../src/netdb.h.html>netdb.h</a>&gt;</code><p class=Pp><var class=Ft>int</var><br><code class=Fn>getaddrinfo</code>(<var class=Fa>const char *hostname</var>, <var class=Fa>const char *servname</var>, <var class=Fa>const struct addrinfo *hints</var>, <var class=Fa>struct addrinfo **res</var>);</p><p class=Pp><var class=Ft>void</var><br><code class=Fn>freeaddrinfo</code>(<var class=Fa style="white-space: nowrap;">struct addrinfo *ai</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Fn>getaddrinfo</code>() function is used to get a list of addresses and port numbers for host <var class=Fa>hostname</var> and service <var class=Fa>servname</var>. It is a replacement for and provides more flexibility than the <a class=Xr href=gethostbyname.3.html>gethostbyname(3)</a> and <a class=Xr href=getservbyname.3.html>getservbyname(3)</a> functions. <p class=Pp>The <var class=Fa>hostname</var> and <var class=Fa>servname</var> arguments are either pointers to NUL-terminated strings or the null pointer. An acceptable value for <var class=Fa>hostname</var> is either a valid host name or a numeric host address string consisting of a dotted decimal IPv4 address, an IPv6 address, or a UNIX-domain address. The <var class=Fa>servname</var> is either a decimal port number or a service name listed in <a class=Xr href=services.5.html>services(5)</a>. At least one of <var class=Fa>hostname</var> and <var class=Fa>servname</var> must be non-null.</p><p class=Pp><var class=Fa>hints</var> is an optional pointer to a <code class=Li>struct addrinfo</code>, as defined by ⟨<span class=Pa>netdb.h</span>⟩:</p><div class="Bd Pp"><pre>
struct addrinfo {
        int     ai_flags;       /* AI_PASSIVE, AI_CANONNAME, .. */
        int     ai_family;      /* AF_xxx */
        int     ai_socktype;    /* SOCK_xxx */
        int     ai_protocol;    /* 0 or IPPROTO_xxx for IPv4 and IPv6 */
        socklen_t ai_addrlen;   /* length of ai_addr */
        char    *ai_canonname;  /* canonical name for hostname */
        struct  sockaddr *ai_addr;      /* binary address */
        struct  addrinfo *ai_next;      /* next structure in linked list */
};
</pre></div><p class=Pp>This structure can be used to provide hints concerning the type of socket that the caller supports or wishes to use. The caller can supply the following structure elements in <var class=Fa>hints</var>:</p><dl class=Bl-tag><dt><var class=Fa>ai_family</var></dt><dd>The address family that should be used. When <var class=Fa>ai_family</var> is set to <code class=Dv>AF_UNSPEC</code>, it means the caller will accept any address family supported by the operating system.</dd><dt><var class=Fa>ai_socktype</var></dt><dd>Denotes the type of socket that is wanted: <code class=Dv>SOCK_STREAM</code>, <code class=Dv>SOCK_DGRAM</code>, <code class=Dv>SOCK_SEQPACKET</code>, or <code class=Dv>SOCK_RAW</code>. When <var class=Fa>ai_socktype</var> is zero the caller will accept any socket type.</dd><dt><var class=Fa>ai_protocol</var></dt><dd>Indicates which transport protocol is desired, <code class=Dv>IPPROTO_UDP</code>, <code class=Dv>IPPROTO_TCP</code>, <code class=Dv>IPPROTO_SCTP</code>, or <code class=Dv>IPPROTO_UDPLITE</code>. If <var class=Fa>ai_protocol</var> is zero the caller will accept any protocol.</dd><dt><var class=Fa>ai_flags</var></dt><dd>The <var class=Fa>ai_flags</var> field to which the <var class=Fa>hints</var> parameter points shall be set to zero or be the bitwise-inclusive OR of one or more of the values <code class=Dv>AI_ADDRCONFIG</code>, <code class=Dv>AI_ALL</code>, <code class=Dv>AI_CANONNAME</code>, <code class=Dv>AI_NUMERICHOST</code>, <code class=Dv>AI_NUMERICSERV</code>, <code class=Dv>AI_PASSIVE</code> and <code class=Dv>AI_V4MAPPED</code>. For a UNIX-domain address, <var class=Fa>ai_flags</var> is ignored. <dl class=Bl-tag><dt><a class=permalink href=#AI_ADDRCONFIG><code class=Dv id=AI_ADDRCONFIG>AI_ADDRCONFIG</code></a></dt><dd>If the <code class=Dv>AI_ADDRCONFIG</code> bit is set, IPv4 addresses shall be returned only if an IPv4 address is configured on the local system, and IPv6 addresses shall be returned only if an IPv6 address is configured on the local system.</dd><dt><a class=permalink href=#AI_ALL><code class=Dv id=AI_ALL>AI_ALL</code></a></dt><dd>If the <code class=Dv>AI_ALL</code> flag is used with the <code class=Dv>AI_V4MAPPED</code> flag, then <code class=Fn>getaddrinfo</code>() shall return all matching IPv6 and IPv4 addresses. <p class=Pp>For example, when using the DNS, queries are made for both AAAA records and A records, and <code class=Fn>getaddrinfo</code>() returns the combined results of both queries. Any IPv4 addresses found are returned as IPv4-mapped IPv6 addresses.</p><p class=Pp>The <code class=Dv>AI_ALL</code> flag without the <code class=Dv>AI_V4MAPPED</code> flag is ignored.</p></dd><dt><a class=permalink href=#AI_CANONNAME><code class=Dv id=AI_CANONNAME>AI_CANONNAME</code></a></dt><dd>If the <code class=Dv>AI_CANONNAME</code> bit is set, a successful call to <code class=Fn>getaddrinfo</code>() will return a NUL-terminated string containing the canonical name of the specified hostname in the <var class=Fa>ai_canonname</var> element of the first <code class=Li>addrinfo</code> structure returned.</dd><dt><a class=permalink href=#AI_NUMERICHOST><code class=Dv id=AI_NUMERICHOST>AI_NUMERICHOST</code></a></dt><dd>If the <code class=Dv>AI_NUMERICHOST</code> bit is set, it indicates that <var class=Fa>hostname</var> should be treated as a numeric string defining an IPv4 or IPv6 address and no name resolution should be attempted.</dd><dt><a class=permalink href=#AI_NUMERICSERV><code class=Dv id=AI_NUMERICSERV>AI_NUMERICSERV</code></a></dt><dd>If the <code class=Dv>AI_NUMERICSERV</code> bit is set, then a non-null <var class=Fa>servname</var> string supplied shall be a numeric port string. Otherwise, an <code class=Dv>EAI_NONAME</code> error shall be returned. This bit shall prevent any type of name resolution service (for example, NIS+) from being invoked.</dd><dt><a class=permalink href=#AI_PASSIVE><code class=Dv id=AI_PASSIVE>AI_PASSIVE</code></a></dt><dd>If the <code class=Dv>AI_PASSIVE</code> bit is set it indicates that the returned socket address structure is intended for use in a call to <a class=Xr href=bind.2.html>bind(2)</a>. In this case, if the <var class=Fa>hostname</var> argument is the null pointer, then the IP address portion of the socket address structure will be set to <code class=Dv>INADDR_ANY</code> for an IPv4 address or <code class=Dv>IN6ADDR_ANY_INIT</code> for an IPv6 address. <p class=Pp>If the <code class=Dv>AI_PASSIVE</code> bit is not set, the returned socket address structure will be ready for use in a call to <a class=Xr href=connect.2.html>connect(2)</a> for a connection-oriented protocol or <a class=Xr href=connect.2.html>connect(2)</a>, <a class=Xr href=sendto.2.html>sendto(2)</a>, or <a class=Xr href=sendmsg.2.html>sendmsg(2)</a> if a connectionless protocol was chosen. The IP address portion of the socket address structure will be set to the loopback address if <var class=Fa>hostname</var> is the null pointer and <code class=Dv>AI_PASSIVE</code> is not set.</p></dd><dt><a class=permalink href=#AI_V4MAPPED><code class=Dv id=AI_V4MAPPED>AI_V4MAPPED</code></a></dt><dd>If the <code class=Dv>AI_V4MAPPED</code> flag is specified along with an ai_family of <code class=Dv>AF_INET6</code>, then <code class=Fn>getaddrinfo</code>() shall return IPv4-mapped IPv6 addresses on finding no matching IPv6 addresses ( <var class=Fa>ai_addrlen</var> shall be 16). <p class=Pp>For example, when using the DNS, if no AAAA records are found then a query is made for A records and any found are returned as IPv4-mapped IPv6 addresses.</p><p class=Pp>The <code class=Dv>AI_V4MAPPED</code> flag shall be ignored unless <var class=Fa>ai_family</var> equals <code class=Dv>AF_INET6</code>.</p></dd></dl></dd></dl><p class=Pp>All other elements of the <code class=Li>addrinfo</code> structure passed via <var class=Fa>hints</var> must be zero or the null pointer.</p><p class=Pp>If <var class=Fa>hints</var> is the null pointer, <code class=Fn>getaddrinfo</code>() behaves as if the caller provided a <code class=Li>struct addrinfo</code> with <var class=Fa>ai_family</var> set to <code class=Dv>AF_UNSPEC</code> and all other elements set to zero or <code class=Dv>NULL</code>.</p><p class=Pp>After a successful call to <code class=Fn>getaddrinfo</code>(), <var class=Fa>*res</var> is a pointer to a linked list of one or more <code class=Li>addrinfo</code> structures. The list can be traversed by following the <var class=Fa>ai_next</var> pointer in each <code class=Li>addrinfo</code> structure until a null pointer is encountered. Each returned <code class=Li>addrinfo</code> structure contains three members that are suitable for a call to <a class=Xr href=socket.2.html>socket(2)</a>: <var class=Fa>ai_family</var>, <var class=Fa>ai_socktype</var>, and <var class=Fa>ai_protocol</var>. For each <code class=Li>addrinfo</code> structure in the list, the <var class=Fa>ai_addr</var> member points to a filled-in socket address structure of length <var class=Fa>ai_addrlen</var>.</p><p class=Pp>This implementation of <code class=Fn>getaddrinfo</code>() allows numeric IPv6 address notation with scope identifier, as documented in chapter 11 of RFC 4007. By appending the percent character and scope identifier to addresses, one can fill the <code class=Li>sin6_scope_id</code> field for addresses. This would make management of scoped addresses easier and allows cut-and-paste input of scoped addresses.</p><p class=Pp>At this moment the code supports only link-local addresses with the format. The scope identifier is hardcoded to the name of the hardware interface associated with the link (such as <code class=Li>ne0</code>). An example is “<code class=Li>fe80::1%ne0</code>”, which means “<code class=Li>fe80::1</code> on the link associated with the <code class=Li>ne0</code> interface”.</p><p class=Pp>The current implementation assumes a one-to-one relationship between the interface and link, which is not necessarily true from the specification.</p><p class=Pp>All of the information returned by <code class=Fn>getaddrinfo</code>() is dynamically allocated: the <code class=Li>addrinfo</code> structures themselves as well as the socket address structures and the canonical host name strings included in the <code class=Li>addrinfo</code> structures.</p><p class=Pp>Memory allocated for the dynamically allocated structures created by a successful call to <code class=Fn>getaddrinfo</code>() is released by the <code class=Fn>freeaddrinfo</code>() function. The <var class=Fa>ai</var> pointer should be a <code class=Li>addrinfo</code> structure created by a call to <code class=Fn>getaddrinfo</code>().</p></section><section class=Sh><h2 class=Sh id=IMPLEMENTATION_NOTES><a class=permalink href=#IMPLEMENTATION_NOTES>IMPLEMENTATION NOTES</a></h2> The behavior of <code class=Li>freeadrinfo(NULL)</code> is left unspecified by both <span class=St>Version 4 of the Single UNIX Specification (“SUSv4”)</span> and <code class=Dv>RFC 3493</code>. The current implementation ignores a <code class=Dv>NULL</code> argument for compatibility with programs that rely on the implementation details of other operating systems. </section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2><code class=Fn>getaddrinfo</code>() returns zero on success or one of the error codes listed in <a class=Xr href=gai_strerror.3.html>gai_strerror(3)</a> if an error occurs. </section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> The following code tries to connect to “<code class=Li>www.kame.net</code>” service “<code class=Li>http</code>” via a stream socket. It loops through all the addresses available, regardless of address family. If the destination resolves to an IPv4 address, it will use an <code class=Dv>AF_INET</code> socket. Similarly, if it resolves to IPv6, an <code class=Dv>AF_INET6</code> socket is used. Observe that there is no hardcoded reference to a particular address family. The code works even if <code class=Fn>getaddrinfo</code>() returns addresses that are not IPv4/v6. <div class="Bd Pp Bd-indent"><pre>
struct addrinfo hints, *res, *res0;
int error;
int s;
const char *cause = NULL;

memset(&amp;hints, 0, sizeof(hints));
hints.ai_family = AF_UNSPEC;
hints.ai_socktype = SOCK_STREAM;
error = getaddrinfo("www.kame.net", "http", &amp;hints, &amp;res0);
if (error) {
	errx(1, "%s", gai_strerror(error));
	/* NOTREACHED */
}
s = -1;
for (res = res0; res; res = res-&gt;ai_next) {
	s = socket(res-&gt;ai_family, res-&gt;ai_socktype,
	    res-&gt;ai_protocol);
	if (s &lt; 0) {
		cause = "socket";
		continue;
	}

	if (connect(s, res-&gt;ai_addr, res-&gt;ai_addrlen) &lt; 0) {
		cause = "connect";
		close(s);
		s = -1;
		continue;
	}

	break;	/* okay we got one */
}
if (s &lt; 0) {
	err(1, "%s", cause);
	/* NOTREACHED */
}
freeaddrinfo(res0);
</pre></div><p class=Pp>The following example tries to open a wildcard listening socket onto service “<code class=Li>http</code>”, for all the address families available.</p><div class="Bd Pp Bd-indent"><pre>
struct addrinfo hints, *res, *res0;
int error;
int s[MAXSOCK];
int nsock;
const char *cause = NULL;

memset(&amp;hints, 0, sizeof(hints));
hints.ai_family = AF_UNSPEC;
hints.ai_socktype = SOCK_STREAM;
hints.ai_flags = AI_PASSIVE;
error = getaddrinfo(NULL, "http", &amp;hints, &amp;res0);
if (error) {
	errx(1, "%s", gai_strerror(error));
	/* NOTREACHED */
}
nsock = 0;
for (res = res0; res &amp;&amp; nsock &lt; MAXSOCK; res = res-&gt;ai_next) {
	s[nsock] = socket(res-&gt;ai_family, res-&gt;ai_socktype,
	    res-&gt;ai_protocol);
	if (s[nsock] &lt; 0) {
		cause = "socket";
		continue;
	}

	if (bind(s[nsock], res-&gt;ai_addr, res-&gt;ai_addrlen) &lt; 0) {
		cause = "bind";
		close(s[nsock]);
		continue;
	}
	(void) listen(s[nsock], 5);

	nsock++;
}
if (nsock == 0) {
	err(1, "%s", cause);
	/* NOTREACHED */
}
freeaddrinfo(res0);
</pre></div></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=bind.2.html>bind(2)</a>, <a class=Xr href=connect.2.html>connect(2)</a>, <a class=Xr href=send.2.html>send(2)</a>, <a class=Xr href=socket.2.html>socket(2)</a>, <a class=Xr href=gai_strerror.3.html>gai_strerror(3)</a>, <a class=Xr href=gethostbyname.3.html>gethostbyname(3)</a>, <a class=Xr href=getnameinfo.3.html>getnameinfo(3)</a>, <a class=Xr href=getservbyname.3.html>getservbyname(3)</a>, <a class=Xr href=resolver.3.html>resolver(3)</a>, <a class=Xr href=inet.4.html>inet(4)</a>, <a class=Xr href=inet6.4.html>inet6(4)</a>, <a class=Xr href=unix.4.html>unix(4)</a>, <a class=Xr href=hosts.5.html>hosts(5)</a>, <a class=Xr href=resolv.conf.5.html>resolv.conf(5)</a>, <a class=Xr href=services.5.html>services(5)</a>, <a class=Xr href=hostname.7.html>hostname(7)</a>, <a class=Xr href=named.8.html>named(8)</a><p class=Pp><cite class=Rs><span class=RsA>R. Gilligan</span>, <span class=RsA>S. Thomson</span>, <span class=RsA>J. Bound</span>, <span class=RsA>J. McCann</span>, and <span class=RsA>W. Stevens</span>, <span class=RsT>Basic Socket Interface Extensions for IPv6</span>, <span class=RsR>RFC 3493</span>, <span class=RsD>February 2003</span>.</cite></p><p class=Pp><cite class=Rs><span class=RsA>S. Deering</span>, <span class=RsA>B. Haberman</span>, <span class=RsA>T. Jinmei</span>, <span class=RsA>E. Nordmark</span>, and <span class=RsA>B. Zill</span>, <span class=RsT>IPv6 Scoped Address Architecture</span>, <span class=RsR>RFC 4007</span>, <span class=RsD>March 2005</span>.</cite></p><p class=Pp><cite class=Rs><span class=RsA>Craig Metz</span>, <span class=RsT>Protocol Independence Using the Sockets API</span>, <i class=RsB>Proceedings of the freenix track: 2000 USENIX annual technical conference</i>, <span class=RsD>June 2000</span>.</cite></p></section><section class=Sh><h2 class=Sh id=STANDARDS><a class=permalink href=#STANDARDS>STANDARDS</a></h2> The <code class=Fn>getaddrinfo</code>() function is defined by the <span class=St>IEEE Std 1003.1-2004 (“POSIX.1”)</span> specification and documented in <code class=Dv>RFC 3493</code>, “Basic Socket Interface Extensions for IPv6”. </section></div><table class=foot><tr><td class=foot-date>February 10, 2019</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>