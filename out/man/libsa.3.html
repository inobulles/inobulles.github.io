<!DOCTYPE html>
<html><head><meta charset=utf-8><title>libsa(3)</title><keywords content=man,libsa></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>libsa(3)</h1><table class=head><tr><td class=head-ltitle>LIBSA(3)</td><td class=head-vol>FreeBSD Library Functions Manual</td><td class=head-rtitle>LIBSA(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>libsa</code> — <div class=Nd>support library for standalone executables</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/stand.h.html>stand.h</a>&gt;</code></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>libsa</code> library provides a set of supporting functions for standalone applications, mimicking where possible the standard <span class=Ux>BSD</span> programming environment. The following sections group these functions by kind. Unless specifically described here, see the corresponding section 3 manpages for the given functions. </section><section class=Sh><h2 class=Sh id=STRING_FUNCTIONS><a class=permalink href=#STRING_FUNCTIONS>STRING FUNCTIONS</a></h2> String functions are available as documented in <a class=Xr href=string.3.html>string(3)</a> and <a class=Xr href=bstring.3.html>bstring(3)</a>. </section><section class=Sh><h2 class=Sh id=MEMORY_ALLOCATION><a class=permalink href=#MEMORY_ALLOCATION>MEMORY ALLOCATION</a></h2><dl class=Bl-hang><dt><var class=Ft>void *</var><code class=Fn>malloc</code>(<var class=Fa>size_t size</var>)</dt><dd><p class=Pp>Allocate <var class=Fa>size</var> bytes of memory from the heap using a best-fit algorithm.</p></dd><dt><var class=Ft>void</var><code class=Fn>free</code>(<var class=Fa>void *ptr</var>)</dt><dd><p class=Pp>Free the allocated object at <var class=Fa>ptr</var>.</p></dd><dt><var class=Ft>void</var><code class=Fn>setheap</code>(<var class=Fa>void *start</var>, <var class=Fa>void *limit</var>)</dt><dd><p class=Pp>Initialise the heap. This function must be called before calling <code class=Fn>alloc</code>() for the first time. The region between <var class=Fa>start</var> and <var class=Fa>limit</var> will be used for the heap; attempting to allocate beyond this will result in a panic.</p></dd><dt><var class=Ft>char *</var><code class=Fn>sbrk</code>(<var class=Fa>int junk</var>)</dt><dd><p class=Pp>Provides the behaviour of <code class=Fn>sbrk</code>(<var class=Fa>0</var>), i.e., returns the highest point that the heap has reached. This value can be used during testing to determine the actual heap usage. The <var class=Fa>junk</var> argument is ignored.</p></dd></dl></section><section class=Sh><h2 class=Sh id=ENVIRONMENT><a class=permalink href=#ENVIRONMENT>ENVIRONMENT</a></h2> A set of functions are provided for manipulating a flat variable space similar to the traditional shell-supported environment. Major enhancements are support for set/unset hook functions. <dl class=Bl-hang><dt><var class=Ft>char *</var><code class=Fn>getenv</code>(<var class=Fa>const char *name</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>setenv</code>(<var class=Fa>const char *name</var>, <var class=Fa>const char *value</var>, <var class=Fa>int overwrite</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>putenv</code>(<var class=Fa>char *string</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>unsetenv</code>(<var class=Fa>const char *name</var>)</dt><dd><p class=Pp>These functions behave similarly to their standard library counterparts.</p></dd><dt><var class=Ft>struct env_var *</var><code class=Fn>env_getenv</code>(<var class=Fa>const char *name</var>)</dt><dd><p class=Pp>Looks up a variable in the environment and returns its entire data structure.</p></dd><dt><var class=Ft>int</var><code class=Fn>env_setenv</code>(<var class=Fa>const char *name</var>, <var class=Fa>int flags</var>, <var class=Fa>const void *value</var>, <var class=Fa>ev_sethook_t sethook</var>, <var class=Fa>ev_unsethook_t unsethook</var>)</dt><dd><p class=Pp>Creates a new or sets an existing environment variable called <var class=Fa>name</var>. If creating a new variable, the <var class=Fa>sethook</var> and <var class=Fa>unsethook</var> arguments may be specified.</p><p class=Pp>The set hook is invoked whenever an attempt is made to set the variable, unless the EV_NOHOOK flag is set. Typically a set hook will validate the <var class=Fa>value</var> argument, and then call <code class=Fn>env_setenv</code>() again with EV_NOHOOK set to actually save the value. The predefined function <code class=Fn>env_noset</code>() may be specified to refuse all attempts to set a variable.</p><p class=Pp>The unset hook is invoked when an attempt is made to unset a variable. If it returns zero, the variable will be unset. The predefined function <var class=Fa>env_nounset</var> may be used to prevent a variable being unset.</p></dd></dl></section><section class=Sh><h2 class=Sh id=STANDARD_LIBRARY_SUPPORT><a class=permalink href=#STANDARD_LIBRARY_SUPPORT>STANDARD LIBRARY SUPPORT</a></h2><dl class=Bl-hang><dt><var class=Ft>int</var><code class=Fn>abs</code>(<var class=Fa>int i</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>getopt</code>(<var class=Fa>int argc</var>, <var class=Fa>char * const *argv</var>, <var class=Fa>const char *optstring</var>)</dt><dd></dd><dt><var class=Ft>long</var><code class=Fn>strtol</code>(<var class=Fa>const char *nptr</var>, <var class=Fa>char **endptr</var>, <var class=Fa>int base</var>)</dt><dd></dd><dt><var class=Ft>long long</var><code class=Fn>strtoll</code>(<var class=Fa>const char *nptr</var>, <var class=Fa>char **endptr</var>, <var class=Fa>int base</var>)</dt><dd></dd><dt><var class=Ft>long</var><code class=Fn>strtoul</code>(<var class=Fa>const char *nptr</var>, <var class=Fa>char **endptr</var>, <var class=Fa>int base</var>)</dt><dd></dd><dt><var class=Ft>long long</var><code class=Fn>strtoull</code>(<var class=Fa>const char *nptr</var>, <var class=Fa>char **endptr</var>, <var class=Fa>int base</var>)</dt><dd></dd><dt><var class=Ft>void</var><code class=Fn>srandom</code>(<var class=Fa>unsigned int seed</var>)</dt><dd></dd><dt><var class=Ft>long</var><code class=Fn>random</code>(<var class=Fa>void</var>)</dt><dd></dd><dt><var class=Ft>char *</var><code class=Fn>strerror</code>(<var class=Fa>int error</var>)</dt><dd><p class=Pp>Returns error messages for the subset of errno values supported by <code class=Nm>libsa</code>.</p></dd><dt><code class=Fn>assert</code>(<var class=Fa>expression</var>)</dt><dd><p class=Pp>Requires <code class=In>&lt;<a class=In href=../src/assert.h.html>assert.h</a>&gt;</code>.</p></dd><dt><var class=Ft>int</var><code class=Fn>setjmp</code>(<var class=Fa>jmp_buf env</var>)</dt><dd></dd><dt><var class=Ft>void</var><code class=Fn>longjmp</code>(<var class=Fa>jmp_buf env</var>, <var class=Fa>int val</var>)</dt><dd><p class=Pp>Defined as <code class=Fn>_setjmp</code>() and <code class=Fn>_longjmp</code>() respectively as there is no signal state to manipulate. Requires <code class=In>&lt;<a class=In href=../src/setjmp.h.html>setjmp.h</a>&gt;</code>.</p></dd></dl></section><section class=Sh><h2 class=Sh id=CHARACTER_I/O><a class=permalink href=#CHARACTER_I/O>CHARACTER I/O</a></h2><dl class=Bl-hang><dt><var class=Ft>void</var><code class=Fn>gets</code>(<var class=Fa>char *buf</var>)</dt><dd><p class=Pp>Read characters from the console into <var class=Fa>buf</var>. All of the standard cautions apply to this function.</p></dd><dt><var class=Ft>void</var><code class=Fn>ngets</code>(<var class=Fa>char *buf</var>, <var class=Fa>int size</var>)</dt><dd><p class=Pp>Read at most <var class=Fa>size</var> - 1 characters from the console into <var class=Fa>buf</var>. If <var class=Fa>size</var> is less than 1, the function's behaviour is as for <code class=Fn>gets</code>().</p></dd><dt><var class=Ft>int</var><code class=Fn>fgetstr</code>(<var class=Fa>char *buf</var>, <var class=Fa>int size</var>, <var class=Fa>int fd</var>)</dt><dd><p class=Pp>Read a line of at most <var class=Fa>size</var> characters into <var class=Fa>buf</var>. Line terminating characters are stripped, and the buffer is always <code class=Dv>NUL</code> terminated. Returns the number of characters in <var class=Fa>buf</var> if successful, or -1 if a read error occurs.</p></dd><dt><var class=Ft>int</var><code class=Fn>printf</code>(<var class=Fa>const char *fmt</var>, <var class=Fa>...</var>)</dt><dd></dd><dt><var class=Ft>void</var><code class=Fn>vprintf</code>(<var class=Fa>const char *fmt</var>, <var class=Fa>va_list ap</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>sprintf</code>(<var class=Fa>char *buf</var>, <var class=Fa>const char *fmt</var>, <var class=Fa>...</var>)</dt><dd></dd><dt><var class=Ft>void</var><code class=Fn>vsprintf</code>(<var class=Fa>char *buf</var>, <var class=Fa>const char *fmt</var>, <var class=Fa>va_list ap</var>)</dt><dd><p class=Pp>The *printf functions implement a subset of the standard <code class=Fn>printf</code>() family functionality and some extensions. The following standard conversions are supported: c,d,n,o,p,s,u,x. The following modifiers are supported: +,-,#,*,0,field width,precision,l.</p><p class=Pp>The <code class=Li>b</code> conversion is provided to decode error registers. Its usage is:</p><div class="Bd Pp Bd-indent">printf( “reg=%b\n”, regval, “&lt;base&gt;&lt;arg&gt;*” );</div><p class=Pp>where &lt;base&gt; is the output expressed as a control character, e.g. \10 gives octal, \20 gives hex. Each &lt;arg&gt; is a sequence of characters, the first of which gives the bit number to be inspected (origin 1) and the next characters (up to a character less than 32) give the text to be displayed if the bit is set. Thus</p><div class="Bd Pp Bd-indent">printf( “reg=%b\n”, 3, “\10\2BITTWO\1BITONE” );</div><p class=Pp>would give the output</p><div class="Bd Pp Bd-indent">reg=3&lt;BITTWO,BITONE&gt;</div><p class=Pp>The <code class=Li>D</code> conversion provides a hexdump facility, e.g.</p><div class="Bd Pp Bd-indent">printf( “%6D”, ptr, “:” ); gives “XX:XX:XX:XX:XX:XX”</div><div class="Bd Pp Bd-indent">printf( “%*D”, len, ptr, “ ” ); gives “XX XX XX ...”</div></dd></dl></section><section class=Sh><h2 class=Sh id=CHARACTER_TESTS_AND_CONVERSIONS><a class=permalink href=#CHARACTER_TESTS_AND_CONVERSIONS>CHARACTER TESTS AND CONVERSIONS</a></h2><dl class=Bl-hang><dt><var class=Ft>int</var><code class=Fn>isupper</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>islower</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>isspace</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>isdigit</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>isxdigit</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>isascii</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>isalpha</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>isalnum</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>iscntrl</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>isgraph</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>ispunct</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>toupper</code>(<var class=Fa>int c</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>tolower</code>(<var class=Fa>int c</var>)</dt><dd></dd></dl></section><section class=Sh><h2 class=Sh id=FILE_I/O><a class=permalink href=#FILE_I/O>FILE I/O</a></h2><dl class=Bl-hang><dt><var class=Ft>int</var><code class=Fn>open</code>(<var class=Fa>const char *path</var>, <var class=Fa>int flags</var>)</dt><dd><p class=Pp>Similar to the behaviour as specified in <a class=Xr href=open.2.html>open(2)</a>, except that file creation is not supported, so the mode parameter is not required. The <var class=Fa>flags</var> argument may be one of O_RDONLY, O_WRONLY and O_RDWR. Only UFS currently supports writing.</p></dd><dt><var class=Ft>int</var><code class=Fn>close</code>(<var class=Fa>int fd</var>)</dt><dd></dd><dt><var class=Ft>void</var><code class=Fn>closeall</code>(<var class=Fa>void</var>)</dt><dd><p class=Pp>Close all open files.</p></dd><dt><var class=Ft>ssize_t</var><code class=Fn>read</code>(<var class=Fa>int fd</var>, <var class=Fa>void *buf</var>, <var class=Fa>size_t len</var>)</dt><dd></dd><dt><var class=Ft>ssize_t</var><code class=Fn>write</code>(<var class=Fa>int fd</var>, <var class=Fa>void *buf</var>, <var class=Fa>size_t len</var>)</dt><dd><p class=Pp>(No file systems currently support writing.)</p></dd><dt><var class=Ft>off_t</var><code class=Fn>lseek</code>(<var class=Fa>int fd</var>, <var class=Fa>off_t offset</var>, <var class=Fa>int whence</var>)</dt><dd><p class=Pp>Files being automatically uncompressed during reading cannot seek backwards from the current point.</p></dd><dt><var class=Ft>int</var><code class=Fn>stat</code>(<var class=Fa>const char *path</var>, <var class=Fa>struct stat *sb</var>)</dt><dd></dd><dt><var class=Ft>int</var><code class=Fn>fstat</code>(<var class=Fa>int fd</var>, <var class=Fa>struct stat *sb</var>)</dt><dd><p class=Pp>The <code class=Fn>stat</code>() and <code class=Fn>fstat</code>() functions only fill out the following fields in the <var class=Fa>sb</var> structure: st_mode,st_nlink,st_uid,st_gid,st_size. The <code class=Nm>tftp</code> file system cannot provide meaningful values for this call, and the <code class=Nm>cd9660</code> file system always reports files having uid/gid of zero.</p></dd></dl></section><section class=Sh><h2 class=Sh id=PAGER><a class=permalink href=#PAGER>PAGER</a></h2> The <code class=Nm>libsa</code> library supplies a simple internal pager to ease reading the output of large commands. <dl class=Bl-hang><dt><var class=Ft>void</var><code class=Fn>pager_open</code>()</dt><dd><p class=Pp>Initialises the pager and tells it that the next line output will be the top of the display. The environment variable LINES is consulted to determine the number of lines to be displayed before pausing.</p></dd><dt><var class=Ft>void</var><code class=Fn>pager_close</code>(<var class=Fa>void</var>)</dt><dd><p class=Pp>Closes the pager.</p></dd><dt><var class=Ft>int</var><code class=Fn>pager_output</code>(<var class=Fa>const char *lines</var>)</dt><dd><p class=Pp>Sends the lines in the <code class=Dv>NUL</code>-terminated buffer at <var class=Fa>lines</var> to the pager. Newline characters are counted in order to determine the number of lines being output (wrapped lines are not accounted for). The <code class=Fn>pager_output</code>() function will return zero when all of the lines have been output, or nonzero if the display was paused and the user elected to quit.</p></dd><dt><var class=Ft>int</var><code class=Fn>pager_file</code>(<var class=Fa>const char *fname</var>)</dt><dd><p class=Pp>Attempts to open and display the file <var class=Fa>fname</var>. Returns -1 on error, 0 at EOF, or 1 if the user elects to quit while reading.</p></dd></dl></section><section class=Sh><h2 class=Sh id=MISC><a class=permalink href=#MISC>MISC</a></h2><dl class=Bl-hang><dt><var class=Ft>void</var><code class=Fn>twiddle</code>(<var class=Fa>void</var>)</dt><dd><p class=Pp>Successive calls emit the characters in the sequence |,/,-,\ followed by a backspace in order to provide reassurance to the user.</p></dd></dl></section><section class=Sh><h2 class=Sh id=REQUIRED_LOW_LEVEL_SUPPORT><a class=permalink href=#REQUIRED_LOW_LEVEL_SUPPORT>REQUIRED LOW-LEVEL SUPPORT</a></h2> The following resources are consumed by <code class=Nm>libsa</code> - stack, heap, console and devices. <p class=Pp>The stack must be established before <code class=Nm>libsa</code> functions can be invoked. Stack requirements vary depending on the functions and file systems used by the consumer and the support layer functions detailed below.</p><p class=Pp>The heap must be established before calling <code class=Fn>alloc</code>() or <code class=Fn>open</code>() by calling <code class=Fn>setheap</code>(). Heap usage will vary depending on the number of simultaneously open files, as well as client behaviour. Automatic decompression will allocate more than 64K of data per open file.</p><p class=Pp>Console access is performed via the <code class=Fn>getchar</code>(), <code class=Fn>putchar</code>() and <code class=Fn>ischar</code>() functions detailed below.</p><p class=Pp>Device access is initiated via <code class=Fn>devopen</code>() and is performed through the <code class=Fn>dv_strategy</code>(), <code class=Fn>dv_ioctl</code>() and <code class=Fn>dv_close</code>() functions in the device switch structure that <code class=Fn>devopen</code>() returns.</p><p class=Pp>The consumer must provide the following support functions:</p><dl class=Bl-hang><dt><var class=Ft>int</var><code class=Fn>getchar</code>(<var class=Fa>void</var>)</dt><dd><p class=Pp>Return a character from the console, used by <code class=Fn>gets</code>(), <code class=Fn>ngets</code>() and pager functions.</p></dd><dt><var class=Ft>int</var><code class=Fn>ischar</code>(<var class=Fa>void</var>)</dt><dd><p class=Pp>Returns nonzero if a character is waiting from the console.</p></dd><dt><var class=Ft>void</var><code class=Fn>putchar</code>(<var class=Fa>int</var>)</dt><dd><p class=Pp>Write a character to the console, used by <code class=Fn>gets</code>(), <code class=Fn>ngets</code>(), <code class=Fn>*printf</code>(), <code class=Fn>panic</code>() and <code class=Fn>twiddle</code>() and thus by many other functions for debugging and informational output.</p></dd><dt><var class=Ft>int</var><code class=Fn>devopen</code>(<var class=Fa>struct open_file *of</var>, <var class=Fa>const char *name</var>, <var class=Fa>const char **file</var>)</dt><dd><p class=Pp>Open the appropriate device for the file named in <var class=Fa>name</var>, returning in <var class=Fa>file</var> a pointer to the remaining body of <var class=Fa>name</var> which does not refer to the device. The <var class=Va>f_dev</var> field in <var class=Fa>of</var> will be set to point to the <var class=Vt>devsw</var> structure for the opened device if successful. Device identifiers must always precede the path component, but may otherwise be arbitrarily formatted. Used by <code class=Fn>open</code>() and thus for all device-related I/O.</p></dd><dt><var class=Ft>int</var><code class=Fn>devclose</code>(<var class=Fa>struct open_file *of</var>)</dt><dd><p class=Pp>Close the device allocated for <var class=Fa>of</var>. The device driver itself will already have been called for the close; this call should clean up any allocation made by devopen only.</p></dd><dt><var class=Ft>void</var><code class=Fn>abort</code>()</dt><dd><p class=Pp>Calls <code class=Fn>panic</code>() with a fixed string.</p></dd><dt><var class=Ft>void</var><code class=Fn>panic</code>(<var class=Fa>const char *msg</var>, <var class=Fa>...</var>)</dt><dd><p class=Pp>Signal a fatal and unrecoverable error condition. The <var class=Fa>msg ...</var> arguments are as for <code class=Fn>printf</code>().</p></dd></dl></section><section class=Sh><h2 class=Sh id=INTERNAL_FILE_SYSTEMS><a class=permalink href=#INTERNAL_FILE_SYSTEMS>INTERNAL FILE SYSTEMS</a></h2> Internal file systems are enabled by the consumer exporting the array <var class=Vt>struct fs_ops *file_system[]</var>, which should be initialised with pointers to <var class=Vt>struct fs_ops</var> structures. The following file system handlers are supplied by <code class=Nm>libsa</code>, the consumer may supply other file systems of their own: <dl class=Bl-hang><dt><var class=Va>ufs_fsops</var></dt><dd>The <span class=Ux>BSD</span> UFS.</dd><dt><var class=Va>ext2fs_fsops</var></dt><dd>Linux ext2fs file system.</dd><dt><var class=Va>tftp_fsops</var></dt><dd>File access via TFTP.</dd><dt><var class=Va>nfs_fsops</var></dt><dd>File access via NFS.</dd><dt><var class=Va>cd9660_fsops</var></dt><dd>ISO 9660 (CD-ROM) file system.</dd><dt><var class=Va>gzipfs_fsops</var></dt><dd>Stacked file system supporting gzipped files. When trying the gzipfs file system, <code class=Nm>libsa</code> appends <code class=Li>.gz</code> to the end of the filename, and then tries to locate the file using the other file systems. Placement of this file system in the <var class=Va>file_system[]</var> array determines whether gzipped files will be opened in preference to non-gzipped files. It is only possible to seek a gzipped file forwards, and <code class=Fn>stat</code>() and <code class=Fn>fstat</code>() on gzipped files will report an invalid length.</dd><dt><var class=Va>bzipfs_fsops</var></dt><dd>The same as <var class=Va>gzipfs_fsops</var>, but for <a class=Xr href=bzip2.1.html>bzip2(1)</a>-compressed files.</dd></dl><p class=Pp>The array of <var class=Vt>struct fs_ops</var> pointers should be terminated with a NULL.</p></section><section class=Sh><h2 class=Sh id=DEVICES><a class=permalink href=#DEVICES>DEVICES</a></h2> Devices are exported by the supporting code via the array <var class=Vt>struct devsw *devsw[]</var> which is a NULL terminated array of pointers to device switch structures. </section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>libsa</code> library contains contributions from many sources, including: <ul class="Bl-bullet Bl-compact"><li><code class=Nm>libsa</code> from <span class=Ux>NetBSD</span></li><li><code class=Nm>libc</code> and <code class=Nm>libkern</code> from <span class=Ux>FreeBSD 3.0</span>.</li><li><code class=Nm>zalloc</code> from <span class=An>Matthew Dillon</span> &lt;<a class=Mt href=mailto:dillon@backplane.com>dillon@backplane.com</a>&gt;</li></ul><p class=Pp>The reorganisation and port to <span class=Ux>FreeBSD 3.0</span>, the environment functions and this manpage were written by <span class=An>Mike Smith</span> &lt;<a class=Mt href=mailto:msmith@FreeBSD.org>msmith@FreeBSD.org</a>&gt;.</p></section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> The lack of detailed memory usage data is unhelpful. </section></div><table class=foot><tr><td class=foot-date>February 22, 2018</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>