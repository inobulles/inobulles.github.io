<!DOCTYPE html>
<html><head><meta charset=utf-8><title>k_pioctl(3)</title><keywords content=man,k_pioctl></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>k_pioctl(3)</h1><table class=head><tr><td class=head-ltitle>KAFS(3)</td><td class=head-vol>FreeBSD Library Functions Manual</td><td class=head-rtitle>KAFS(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>k_hasafs</code>, <code class=Nm>k_hasafs_recheck</code>, <code class=Nm>k_pioctl</code>, <code class=Nm>k_unlog</code>, <code class=Nm>k_setpag</code>, <code class=Nm>k_afs_cell_of_file</code>, <code class=Nm>kafs_set_verbose</code>, <code class=Nm>kafs_settoken_rxkad</code>, <code class=Nm>kafs_settoken</code>, <code class=Nm>krb_afslog</code>, <code class=Nm>krb_afslog_uid</code>, <code class=Nm>kafs_settoken5</code>, <code class=Nm>krb5_afslog</code>, <code class=Nm>krb5_afslog_uid</code> — <div class=Nd>AFS library</div></section><section class=Sh><h2 class=Sh id=LIBRARY><a class=permalink href=#LIBRARY>LIBRARY</a></h2> AFS cache manager access library (libkafs5, -lkafs5) </section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/kafs.h.html>kafs.h</a>&gt;</code><p class=Pp><var class=Ft>int</var><br><code class=Fn>k_afs_cell_of_file</code>(<var class=Fa style="white-space: nowrap;">const char *path</var>, <var class=Fa style="white-space: nowrap;">char *cell</var>, <var class=Fa style="white-space: nowrap;">int len</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>k_hasafs</code>(<var class=Fa style="white-space: nowrap;">void</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>k_hasafs_recheck</code>(<var class=Fa style="white-space: nowrap;">void</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>k_pioctl</code>(<var class=Fa style="white-space: nowrap;">char *a_path</var>, <var class=Fa style="white-space: nowrap;">int o_opcode</var>, <var class=Fa style="white-space: nowrap;">struct ViceIoctl *a_paramsP</var>, <var class=Fa style="white-space: nowrap;">int a_followSymlinks</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>k_setpag</code>(<var class=Fa style="white-space: nowrap;">void</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>k_unlog</code>(<var class=Fa style="white-space: nowrap;">void</var>);</p><p class=Pp><var class=Ft>void</var><br><code class=Fn>kafs_set_verbose</code>(<var class=Fa style="white-space: nowrap;">void (*func)(void *, const char *, int)</var>, <var class=Fa style="white-space: nowrap;">void *</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>kafs_settoken_rxkad</code>(<var class=Fa style="white-space: nowrap;">const char *cell</var>, <var class=Fa style="white-space: nowrap;">struct ClearToken *token</var>, <var class=Fa style="white-space: nowrap;">void *ticket</var>, <var class=Fa style="white-space: nowrap;">size_t ticket_len</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>kafs_settoken</code>(<var class=Fa style="white-space: nowrap;">const char *cell</var>, <var class=Fa style="white-space: nowrap;">uid_t uid</var>, <var class=Fa style="white-space: nowrap;">CREDENTIALS *c</var>);</p><p class=Pp><code class=Fn>krb_afslog</code>(<var class=Fa style="white-space: nowrap;">char *cell</var>, <var class=Fa style="white-space: nowrap;">char *realm</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>krb_afslog_uid</code>(<var class=Fa style="white-space: nowrap;">char *cell</var>, <var class=Fa style="white-space: nowrap;">char *realm</var>, <var class=Fa style="white-space: nowrap;">uid_t uid</var>);</p><p class=Pp><var class=Ft>krb5_error_code</var><br><code class=Fn>krb5_afslog_uid</code>(<var class=Fa style="white-space: nowrap;">krb5_context context</var>, <var class=Fa style="white-space: nowrap;">krb5_ccache id</var>, <var class=Fa style="white-space: nowrap;">const char *cell</var>, <var class=Fa style="white-space: nowrap;">krb5_const_realm realm</var>, <var class=Fa style="white-space: nowrap;">uid_t uid</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>kafs_settoken5</code>(<var class=Fa style="white-space: nowrap;">const char *cell</var>, <var class=Fa style="white-space: nowrap;">uid_t uid</var>, <var class=Fa style="white-space: nowrap;">krb5_creds *c</var>);</p><p class=Pp><var class=Ft>krb5_error_code</var><br><code class=Fn>krb5_afslog</code>(<var class=Fa style="white-space: nowrap;">krb5_context context</var>, <var class=Fa style="white-space: nowrap;">krb5_ccache id</var>, <var class=Fa style="white-space: nowrap;">const char *cell</var>, <var class=Fa style="white-space: nowrap;">krb5_const_realm realm</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2><code class=Fn>k_hasafs</code>() initializes some library internal structures, and tests for the presence of AFS in the kernel, none of the other functions should be called before <code class=Fn>k_hasafs</code>() is called, or if it fails. <p class=Pp><code class=Fn>k_hasafs_recheck</code>() forces a recheck if a AFS client has started since last time <code class=Fn>k_hasafs</code>() or <code class=Fn>k_hasafs_recheck</code>() was called.</p><p class=Pp><code class=Fn>kafs_set_verbose</code>() set a log function that will be called each time the kafs library does something important so that the application using libkafs can output verbose logging. Calling the function <var class=Fa>kafs_set_verbose</var> with the function argument set to <code class=Dv>NULL</code> will stop libkafs from calling the logging function (if set).</p><p class=Pp><code class=Fn>kafs_settoken_rxkad</code>() set <code class=Li>rxkad</code> with the <var class=Fa>token</var> and <var class=Fa>ticket</var> (that have the length <var class=Fa>ticket_len</var>) for a given <var class=Fa>cell</var>.</p><p class=Pp><code class=Fn>kafs_settoken</code>() and <code class=Fn>kafs_settoken5</code>() work the same way as <code class=Fn>kafs_settoken_rxkad</code>() but internally converts the Kerberos 4 or 5 credential to a afs cleartoken and ticket.</p><p class=Pp><code class=Fn>krb_afslog</code>(), and <code class=Fn>krb_afslog_uid</code>() obtains new tokens (and possibly tickets) for the specified <var class=Fa>cell</var> and <var class=Fa>realm</var>. If <var class=Fa>cell</var> is <code class=Dv>NULL</code>, the local cell is used. If <var class=Fa>realm</var> is <code class=Dv>NULL</code>, the function tries to guess what realm to use. Unless you have some good knowledge of what cell or realm to use, you should pass <code class=Dv>NULL</code>. <code class=Fn>krb_afslog</code>() will use the real user-id for the <code class=Dv>ViceId</code> field in the token, <code class=Fn>krb_afslog_uid</code>() will use <var class=Fa>uid</var>.</p><p class=Pp><code class=Fn>krb5_afslog</code>(), and <code class=Fn>krb5_afslog_uid</code>() are the Kerberos 5 equivalents of <code class=Fn>krb_afslog</code>(), and <code class=Fn>krb_afslog_uid</code>().</p><p class=Pp><code class=Fn>krb5_afslog</code>(), <code class=Fn>kafs_settoken5</code>() can be configured to behave differently via a <code class=Nm>krb5_appdefault</code> option <code class=Li>afs-use-524</code> in <span class=Pa>krb5.conf</span>. Possible values for <code class=Li>afs-use-524</code> are:</p><dl class=Bl-tag><dt>yes</dt><dd>use the 524 server in the realm to convert the ticket</dd><dt>no</dt><dd>use the Kerberos 5 ticket directly, can be used with if the afs cell support 2b token.</dd><dt>local, 2b</dt><dd>convert the Kerberos 5 credential to a 2b token locally (the same work as a 2b 524 server should have done).</dd></dl><p class=Pp>Example:</p><div class="Bd Pp"><pre>
[appdefaults]
	SU.SE = { afs-use-524 = local }
	PDC.KTH.SE = { afs-use-524 = yes }
	afs-use-524 = yes
</pre></div><p class=Pp>libkafs will use the <code class=Li>libkafs</code> as application name when running the <code class=Nm>krb5_appdefault</code> function call.</p><p class=Pp>The (uppercased) cell name is used as the realm to the <code class=Nm>krb5_appdefault function.</code></p><p class=Pp><code class=Fn>k_afs_cell_of_file</code>() will in <var class=Fa>cell</var> return the cell of a specified file, no more than <var class=Fa>len</var> characters is put in <var class=Fa>cell</var>.</p><p class=Pp><code class=Fn>k_pioctl</code>() does a <code class=Fn>pioctl</code>() system call with the specified arguments. This function is equivalent to <code class=Fn>lpioctl</code>().</p><p class=Pp><code class=Fn>k_setpag</code>() initializes a new PAG.</p><p class=Pp><code class=Fn>k_unlog</code>() removes destroys all tokens in the current PAG.</p></section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2><code class=Fn>k_hasafs</code>() returns 1 if AFS is present in the kernel, 0 otherwise. <code class=Fn>krb_afslog</code>() and <code class=Fn>krb_afslog_uid</code>() returns 0 on success, or a Kerberos error number on failure. <code class=Fn>k_afs_cell_of_file</code>(), <code class=Fn>k_pioctl</code>(), <code class=Fn>k_setpag</code>(), and <code class=Fn>k_unlog</code>() all return the value of the underlaying system call, 0 on success. </section><section class=Sh><h2 class=Sh id=ENVIRONMENT><a class=permalink href=#ENVIRONMENT>ENVIRONMENT</a></h2> The following environment variable affect the mode of operation of <code class=Nm>kafs</code>: <dl class=Bl-tag><dt><a class=permalink href=#AFS_SYSCALL><code class=Ev id=AFS_SYSCALL>AFS_SYSCALL</code></a></dt><dd>Normally, <code class=Nm>kafs</code> will try to figure out the correct system call(s) that are used by AFS by itself. If it does not manage to do that, or does it incorrectly, you can set this variable to the system call number or list of system call numbers that should be used.</dd></dl></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> The following code from <code class=Nm>login</code> will obtain a new PAG and tokens for the local cell and the cell of the users home directory. <div class="Bd Pp"><pre>
if (k_hasafs()) {
	char cell[64];
	k_setpag();
	if(k_afs_cell_of_file(pwd-&gt;pw_dir, cell, sizeof(cell)) == 0)
		krb_afslog(cell, NULL);
	krb_afslog(NULL, NULL);
}
</pre></div></section><section class=Sh><h2 class=Sh id=ERRORS><a class=permalink href=#ERRORS>ERRORS</a></h2> If any of these functions (apart from <code class=Fn>k_hasafs</code>()) is called without AFS being present in the kernel, the process will usually (depending on the operating system) receive a SIGSYS signal. </section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=krb5_appdefault.3.html>krb5_appdefault(3)</a>, <a class=Xr href=krb5.conf.5.html>krb5.conf(5)</a><p class=Pp><cite class=Rs><span class=RsA>Transarc Corporation</span>, <span class=RsT>File Server/Cache Manager Interface</span>, <i class=RsJ>AFS-3 Programmer's Reference</i>, <span class=RsD>1991</span>.</cite></p></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2> libkafs will search for <span class=Pa>ThisCell and</span><span class=Pa>TheseCells</span> in the following locations: <span class=Pa>/usr/vice/etc</span>, <span class=Pa>/etc/openafs</span>, <span class=Pa>/var/db/openafs/etc</span>, <span class=Pa>/usr/arla/etc</span>, <span class=Pa>/etc/arla</span>, and <span class=Pa>/etc/afs</span></section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2><code class=Ev>AFS_SYSCALL</code> has no effect under AIX. </section></div><table class=foot><tr><td class=foot-date>May 1, 2006</td><td class=foot-os>HEIMDAL</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>