<!DOCTYPE html>
<html><head><meta charset=utf-8><title>hx509_query_match_eku(3)</title><keywords content=man,hx509_query_match_eku></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>hx509_query_match_eku(3)</h1><table class=head><tr><td class=head-ltitle>hx509 certificate functions(3)</td><td class=head-vol>Heimdalx509library</td><td class=head-rtitle>hx509 certificate functions(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2> hx509 certificate functions - <section class=Ss><h2 class=Ss id=Functions><a class=permalink href=#Functions>Functions</a></h2><br> int <b>hx509_cert_init</b> (hx509_context context, const Certificate *c, hx509_cert *cert) <br> int <b>hx509_cert_init_data</b> (hx509_context context, const void *ptr, size_t len, hx509_cert *cert) <br> void <b>hx509_cert_free</b> (hx509_cert cert) <br> hx509_cert <b>hx509_cert_ref</b> (hx509_cert cert) <br> void <b>hx509_verify_ctx_f_allow_default_trustanchors</b> (hx509_verify_ctx ctx, int boolean) <br> int <b>hx509_cert_find_subjectAltName_otherName</b> (hx509_context context, hx509_cert cert, const heim_oid *oid, hx509_octet_string_list *list) <br> int <b>hx509_cert_cmp</b> (hx509_cert p, hx509_cert q) <br> int <b>hx509_cert_get_issuer</b> (hx509_cert p, hx509_name *name) <br> int <b>hx509_cert_get_subject</b> (hx509_cert p, hx509_name *name) <br> int <b>hx509_cert_get_base_subject</b> (hx509_context context, hx509_cert c, hx509_name *name) <br> int <b>hx509_cert_get_serialnumber</b> (hx509_cert p, heim_integer *i) <br> time_t <b>hx509_cert_get_notBefore</b> (hx509_cert p) <br> time_t <b>hx509_cert_get_notAfter</b> (hx509_cert p) <br> int <b>hx509_cert_get_SPKI</b> (hx509_context context, hx509_cert p, SubjectPublicKeyInfo *spki) <br> int <b>hx509_cert_get_SPKI_AlgorithmIdentifier</b> (hx509_context context, hx509_cert p, AlgorithmIdentifier *alg) <br> int <b>hx509_cert_get_issuer_unique_id</b> (hx509_context context, hx509_cert p, heim_bit_string *issuer) <br> int <b>hx509_cert_get_subject_unique_id</b> (hx509_context context, hx509_cert p, heim_bit_string *subject) <br> int <b>hx509_verify_hostname</b> (hx509_context context, const hx509_cert cert, int flags, hx509_hostname_type type, const char *hostname, const struct sockaddr *sa, int sa_size) <br> hx509_cert_attribute <b>hx509_cert_get_attribute</b> (hx509_cert cert, const heim_oid *oid) <br> int <b>hx509_cert_set_friendly_name</b> (hx509_cert cert, const char *name) <br> const char * <b>hx509_cert_get_friendly_name</b> (hx509_cert cert) <br> int <b>hx509_query_alloc</b> (hx509_context context, hx509_query **q) <br> void <b>hx509_query_match_option</b> (hx509_query *q, hx509_query_option option) <br> int <b>hx509_query_match_issuer_serial</b> (hx509_query *q, const Name *issuer, const heim_integer *serialNumber) <br> int <b>hx509_query_match_friendly_name</b> (hx509_query *q, const char *name) <br> int <b>hx509_query_match_eku</b> (hx509_query *q, const heim_oid *eku) <br> int <b>hx509_query_match_cmp_func</b> (hx509_query *q, int(*func)(hx509_context, hx509_cert, void *), void *ctx) <br> void <b>hx509_query_free</b> (hx509_context context, hx509_query *q) <br> void <b>hx509_query_statistic_file</b> (hx509_context context, const char *fn) <br> void <b>hx509_query_unparse_stats</b> (hx509_context context, int printtype, FILE *out) <br> int <b>hx509_cert_check_eku</b> (hx509_context context, hx509_cert cert, const heim_oid *eku, int allow_any_eku) <br> int <b>hx509_cert_binary</b> (hx509_context context, hx509_cert c, heim_octet_string *os) <br> int <b>hx509_print_cert</b> (hx509_context context, hx509_cert cert, FILE *out) <br><br></section></section><section class=Sh><h2 class=Sh id=Detailed_Description><a class=permalink href=#Detailed_Description>Detailed Description</a></h2> See the <b>The basic certificate</b> for description and examples. </section><section class=Sh><h2 class=Sh id=Function_Documentation><a class=permalink href=#Function_Documentation>Function Documentation</a></h2><section class=Ss><h2 class=Ss id=int_hx509_cert_binary_(hx509_context_context,_hx509_cert_c,_heim_octet_string_*_os)><a class=permalink href=#int_hx509_cert_binary_(hx509_context_context,_hx509_cert_c,_heim_octet_string_*_os)>int hx509_cert_binary (hx509_context context, hx509_cert c, heim_octet_string * os)</a></h2> Encodes the hx509 certificate as a DER encode binary. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>c</i> the certificate to encode. <br><i>os</i> the encode certificate, set to NULL, 0 on case of error. Free the os-&gt;data with <b>hx509_xfree()</b>.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_check_eku_(hx509_context_context,_hx509_cert_cert,_const_heim_oid_*_eku,_int_allow_any_eku)><a class=permalink href=#int_hx509_cert_check_eku_(hx509_context_context,_hx509_cert_cert,_const_heim_oid_*_eku,_int_allow_any_eku)>int hx509_cert_check_eku (hx509_context context, hx509_cert cert, const heim_oid * eku, int allow_any_eku)</a></h2> Check the extended key usage on the hx509 certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>cert</i> A hx509 context. <br><i>eku</i> the EKU to check for <br><i>allow_any_eku</i> if the any EKU is set, allow that to be a substitute.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_cmp_(hx509_cert_p,_hx509_cert_q)><a class=permalink href=#int_hx509_cert_cmp_(hx509_cert_p,_hx509_cert_q)>int hx509_cert_cmp (hx509_cert p, hx509_cert q)</a></h2> Compare to hx509 certificate object, useful for sorting. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>p</i> a hx509 certificate object. <br><i>q</i> a hx509 certificate object.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>0 the objects are the same, returns &gt; 0 is p is 'larger' then q, &lt; 0 if p is 'smaller' then q.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_find_subjectAltName_otherName_(hx509_context_context,_hx509_cert_cert,_const_heim_oid_*_oid,_hx509_octet_string_list_*_list)><a class=permalink href=#int_hx509_cert_find_subjectAltName_otherName_(hx509_context_context,_hx509_cert_cert,_const_heim_oid_*_oid,_hx509_octet_string_list_*_list)>int hx509_cert_find_subjectAltName_otherName (hx509_context context, hx509_cert cert, const heim_oid * oid, hx509_octet_string_list * list)</a></h2> Return a list of subjectAltNames specified by oid in the certificate. On error the <p class=Pp>The returned list of octet string should be freed with <b>hx509_free_octet_string_list()</b>.</p><p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>cert</i> a hx509 certificate object. <br><i>oid</i> an oid to for SubjectAltName. <br><i>list</i> list of matching SubjectAltName.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=void_hx509_cert_free_(hx509_cert_cert)><a class=permalink href=#void_hx509_cert_free_(hx509_cert_cert)>void hx509_cert_free (hx509_cert cert)</a></h2> Free reference to the hx509 certificate object, if the refcounter reaches 0, the object if freed. Its allowed to pass in NULL. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>cert</i> the cert to free.</div></section><section class=Ss><h2 class=Ss id=hx509_cert_attribute_hx509_cert_get_attribute_(hx509_cert_cert,_const_heim_oid_*_oid)><a class=permalink href=#hx509_cert_attribute_hx509_cert_get_attribute_(hx509_cert_cert,_const_heim_oid_*_oid)>hx509_cert_attribute hx509_cert_get_attribute (hx509_cert cert, const heim_oid * oid)</a></h2> Get an external attribute for the certificate, examples are friendly name and id. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>cert</i> hx509 certificate object to search <br><i>oid</i> an oid to search for.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>an hx509_cert_attribute, only valid as long as the certificate is referenced.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_get_base_subject_(hx509_context_context,_hx509_cert_c,_hx509_name_*_name)><a class=permalink href=#int_hx509_cert_get_base_subject_(hx509_context_context,_hx509_cert_c,_hx509_name_*_name)>int hx509_cert_get_base_subject (hx509_context context, hx509_cert c, hx509_name * name)</a></h2> Return the name of the base subject of the hx509 certificate. If the certiicate is a verified proxy certificate, the this function return the base certificate (root of the proxy chain). If the proxy certificate is not verified with the base certificate HX509_PROXY_CERTIFICATE_NOT_CANONICALIZED is returned. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> a hx509 context. <br><i>c</i> a hx509 certificate object. <br><i>name</i> a pointer to a hx509 name, should be freed by <b>hx509_name_free()</b>. See also <b>hx509_cert_get_subject()</b>.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=const_char*_hx509_cert_get_friendly_name_(hx509_cert_cert)><a class=permalink href=#const_char*_hx509_cert_get_friendly_name_(hx509_cert_cert)>const char* hx509_cert_get_friendly_name (hx509_cert cert)</a></h2> Get friendly name of the certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>cert</i> cert to get the friendly name from.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>an friendly name or NULL if there is. The friendly name is only valid as long as the certificate is referenced.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_get_issuer_(hx509_cert_p,_hx509_name_*_name)><a class=permalink href=#int_hx509_cert_get_issuer_(hx509_cert_p,_hx509_name_*_name)>int hx509_cert_get_issuer (hx509_cert p, hx509_name * name)</a></h2> Return the name of the issuer of the hx509 certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>p</i> a hx509 certificate object. <br><i>name</i> a pointer to a hx509 name, should be freed by <b>hx509_name_free()</b>.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_get_issuer_unique_id_(hx509_context_context,_hx509_cert_p,_heim_bit_string_*_issuer)><a class=permalink href=#int_hx509_cert_get_issuer_unique_id_(hx509_context_context,_hx509_cert_p,_heim_bit_string_*_issuer)>int hx509_cert_get_issuer_unique_id (hx509_context context, hx509_cert p, heim_bit_string * issuer)</a></h2> Get a copy of the Issuer Unique ID <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> a hx509_context <br><i>p</i> a hx509 certificate <br><i>issuer</i> the issuer id returned, free with der_free_bit_string()</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>. The error code HX509_EXTENSION_NOT_FOUND is returned if the certificate doesn't have a issuerUniqueID</div></section><section class=Ss><h2 class=Ss id=time_t_hx509_cert_get_notAfter_(hx509_cert_p)><a class=permalink href=#time_t_hx509_cert_get_notAfter_(hx509_cert_p)>time_t hx509_cert_get_notAfter (hx509_cert p)</a></h2> Get notAfter time of the certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>p</i> a hx509 certificate object.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>return not after time.</div></section><section class=Ss><h2 class=Ss id=time_t_hx509_cert_get_notBefore_(hx509_cert_p)><a class=permalink href=#time_t_hx509_cert_get_notBefore_(hx509_cert_p)>time_t hx509_cert_get_notBefore (hx509_cert p)</a></h2> Get notBefore time of the certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>p</i> a hx509 certificate object.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>return not before time</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_get_serialnumber_(hx509_cert_p,_heim_integer_*_i)><a class=permalink href=#int_hx509_cert_get_serialnumber_(hx509_cert_p,_heim_integer_*_i)>int hx509_cert_get_serialnumber (hx509_cert p, heim_integer * i)</a></h2> Get serial number of the certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>p</i> a hx509 certificate object. <br><i>i</i> serial number, should be freed ith der_free_heim_integer().</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_get_SPKI_(hx509_context_context,_hx509_cert_p,_SubjectPublicKeyInfo_*_spki)><a class=permalink href=#int_hx509_cert_get_SPKI_(hx509_context_context,_hx509_cert_p,_SubjectPublicKeyInfo_*_spki)>int hx509_cert_get_SPKI (hx509_context context, hx509_cert p, SubjectPublicKeyInfo * spki)</a></h2> Get the SubjectPublicKeyInfo structure from the hx509 certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> a hx509 context. <br><i>p</i> a hx509 certificate object. <br><i>spki</i> SubjectPublicKeyInfo, should be freed with free_SubjectPublicKeyInfo().</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_get_SPKI_AlgorithmIdentifier_(hx509_context_context,_hx509_cert_p,_AlgorithmIdentifier_*_alg)><a class=permalink href=#int_hx509_cert_get_SPKI_AlgorithmIdentifier_(hx509_context_context,_hx509_cert_p,_AlgorithmIdentifier_*_alg)>int hx509_cert_get_SPKI_AlgorithmIdentifier (hx509_context context, hx509_cert p, AlgorithmIdentifier * alg)</a></h2> Get the AlgorithmIdentifier from the hx509 certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> a hx509 context. <br><i>p</i> a hx509 certificate object. <br><i>alg</i> AlgorithmIdentifier, should be freed with free_AlgorithmIdentifier(). The algorithmidentifier is typicly rsaEncryption, or id-ecPublicKey, or some other public key mechanism.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_get_subject_(hx509_cert_p,_hx509_name_*_name)><a class=permalink href=#int_hx509_cert_get_subject_(hx509_cert_p,_hx509_name_*_name)>int hx509_cert_get_subject (hx509_cert p, hx509_name * name)</a></h2> Return the name of the subject of the hx509 certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>p</i> a hx509 certificate object. <br><i>name</i> a pointer to a hx509 name, should be freed by <b>hx509_name_free()</b>. See also <b>hx509_cert_get_base_subject()</b>.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_get_subject_unique_id_(hx509_context_context,_hx509_cert_p,_heim_bit_string_*_subject)><a class=permalink href=#int_hx509_cert_get_subject_unique_id_(hx509_context_context,_hx509_cert_p,_heim_bit_string_*_subject)>int hx509_cert_get_subject_unique_id (hx509_context context, hx509_cert p, heim_bit_string * subject)</a></h2> Get a copy of the Subect Unique ID <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> a hx509_context <br><i>p</i> a hx509 certificate <br><i>subject</i> the subject id returned, free with der_free_bit_string()</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>. The error code HX509_EXTENSION_NOT_FOUND is returned if the certificate doesn't have a subjectUniqueID</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_init_(hx509_context_context,_const_Certificate_*_c,_hx509_cert_*_cert)><a class=permalink href=#int_hx509_cert_init_(hx509_context_context,_const_Certificate_*_c,_hx509_cert_*_cert)>int hx509_cert_init (hx509_context context, const Certificate * c, hx509_cert * cert)</a></h2> Allocate and init an hx509 certificate object from the decoded certificate `c´. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>c</i><br><i>cert</i></div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>Returns an hx509 error code.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_init_data_(hx509_context_context,_const_void_*_ptr,_size_t_len,_hx509_cert_*_cert)><a class=permalink href=#int_hx509_cert_init_data_(hx509_context_context,_const_void_*_ptr,_size_t_len,_hx509_cert_*_cert)>int hx509_cert_init_data (hx509_context context, const void * ptr, size_t len, hx509_cert * cert)</a></h2> Just like <b>hx509_cert_init()</b>, but instead of a decode certificate takes an pointer and length to a memory region that contains a DER/BER encoded certificate. <p class=Pp>If the memory region doesn't contain just the certificate and nothing more the function will fail with HX509_EXTRA_DATA_AFTER_STRUCTURE.</p><p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>ptr</i> pointer to memory region containing encoded certificate. <br><i>len</i> length of memory region. <br><i>cert</i> a return pointer to a hx509 certificate object, will contain NULL on error.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=hx509_cert_hx509_cert_ref_(hx509_cert_cert)><a class=permalink href=#hx509_cert_hx509_cert_ref_(hx509_cert_cert)>hx509_cert hx509_cert_ref (hx509_cert cert)</a></h2> Add a reference to a hx509 certificate object. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>cert</i> a pointer to an hx509 certificate object.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>the same object as is passed in.</div></section><section class=Ss><h2 class=Ss id=int_hx509_cert_set_friendly_name_(hx509_cert_cert,_const_char_*_name)><a class=permalink href=#int_hx509_cert_set_friendly_name_(hx509_cert_cert,_const_char_*_name)>int hx509_cert_set_friendly_name (hx509_cert cert, const char * name)</a></h2> Set the friendly name on the certificate. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>cert</i> The certificate to set the friendly name on <br><i>name</i> Friendly name.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_print_cert_(hx509_context_context,_hx509_cert_cert,_FILE_*_out)><a class=permalink href=#int_hx509_print_cert_(hx509_context_context,_hx509_cert_cert,_FILE_*_out)>int hx509_print_cert (hx509_context context, hx509_cert cert, FILE * out)</a></h2> Print a simple representation of a certificate <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context, can be NULL <br><i>cert</i> certificate to print <br><i>out</i> the stdio output stream, if NULL, stdout is used</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code</div></section><section class=Ss><h2 class=Ss id=int_hx509_query_alloc_(hx509_context_context,_hx509_query_**_q)><a class=permalink href=#int_hx509_query_alloc_(hx509_context_context,_hx509_query_**_q)>int hx509_query_alloc (hx509_context context, hx509_query ** q)</a></h2> Allocate an query controller. Free using <b>hx509_query_free()</b>. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>q</i> return pointer to a hx509_query.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=void_hx509_query_free_(hx509_context_context,_hx509_query_*_q)><a class=permalink href=#void_hx509_query_free_(hx509_context_context,_hx509_query_*_q)>void hx509_query_free (hx509_context context, hx509_query * q)</a></h2> Free the query controller. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>q</i> a pointer to the query controller.</div></section><section class=Ss><h2 class=Ss id=int_hx509_query_match_cmp_func_(hx509_query_*_q,_int(*)(hx509_context,_hx509_cert,_void_*)_func,_void_*_ctx)><a class=permalink href=#int_hx509_query_match_cmp_func_(hx509_query_*_q,_int(*)(hx509_context,_hx509_cert,_void_*)_func,_void_*_ctx)>int hx509_query_match_cmp_func (hx509_query * q, int(*)(hx509_context, hx509_cert, void *) func, void * ctx)</a></h2> Set the query controller to match using a specific match function. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>q</i> a hx509 query controller. <br><i>func</i> function to use for matching, if the argument is NULL, the match function is removed. <br><i>ctx</i> context passed to the function.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_query_match_eku_(hx509_query_*_q,_const_heim_oid_*_eku)><a class=permalink href=#int_hx509_query_match_eku_(hx509_query_*_q,_const_heim_oid_*_eku)>int hx509_query_match_eku (hx509_query * q, const heim_oid * eku)</a></h2> Set the query controller to require an one specific EKU (extended key usage). Any previous EKU matching is overwitten. If NULL is passed in as the eku, the EKU requirement is reset. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>q</i> a hx509 query controller. <br><i>eku</i> an EKU to match on.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_query_match_friendly_name_(hx509_query_*_q,_const_char_*_name)><a class=permalink href=#int_hx509_query_match_friendly_name_(hx509_query_*_q,_const_char_*_name)>int hx509_query_match_friendly_name (hx509_query * q, const char * name)</a></h2> Set the query controller to match on a friendly name <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>q</i> a hx509 query controller. <br><i>name</i> a friendly name to match on</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_query_match_issuer_serial_(hx509_query_*_q,_const_Name_*_issuer,_const_heim_integer_*_serialNumber)><a class=permalink href=#int_hx509_query_match_issuer_serial_(hx509_query_*_q,_const_Name_*_issuer,_const_heim_integer_*_serialNumber)>int hx509_query_match_issuer_serial (hx509_query * q, const Name * issuer, const heim_integer * serialNumber)</a></h2> Set the issuer and serial number of match in the query controller. The function make copies of the isser and serial number. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>q</i> a hx509 query controller <br><i>issuer</i> issuer to search for <br><i>serialNumber</i> the serialNumber of the issuer.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=void_hx509_query_match_option_(hx509_query_*_q,_hx509_query_option_option)><a class=permalink href=#void_hx509_query_match_option_(hx509_query_*_q,_hx509_query_option_option)>void hx509_query_match_option (hx509_query * q, hx509_query_option option)</a></h2> Set match options for the hx509 query controller. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>q</i> query controller. <br><i>option</i> options to control the query controller.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=void_hx509_query_statistic_file_(hx509_context_context,_const_char_*_fn)><a class=permalink href=#void_hx509_query_statistic_file_(hx509_context_context,_const_char_*_fn)>void hx509_query_statistic_file (hx509_context context, const char * fn)</a></h2> Set a statistic file for the query statistics. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>fn</i> statistics file name</div></section><section class=Ss><h2 class=Ss id=void_hx509_query_unparse_stats_(hx509_context_context,_int_printtype,_FILE_*_out)><a class=permalink href=#void_hx509_query_unparse_stats_(hx509_context_context,_int_printtype,_FILE_*_out)>void hx509_query_unparse_stats (hx509_context context, int printtype, FILE * out)</a></h2> Unparse the statistics file and print the result on a FILE descriptor. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>printtype</i> tyep to print <br><i>out</i> the FILE to write the data on.</div></section><section class=Ss><h2 class=Ss id=void_hx509_verify_ctx_f_allow_default_trustanchors_(hx509_verify_ctx_ctx,_int_boolean)><a class=permalink href=#void_hx509_verify_ctx_f_allow_default_trustanchors_(hx509_verify_ctx_ctx,_int_boolean)>void hx509_verify_ctx_f_allow_default_trustanchors (hx509_verify_ctx ctx, int boolean)</a></h2> Allow using the operating system builtin trust anchors if no other trust anchors are configured. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>ctx</i> a verification context <br><i>boolean</i> if non zero, useing the operating systems builtin trust anchors.</div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section><section class=Ss><h2 class=Ss id=int_hx509_verify_hostname_(hx509_context_context,_const_hx509_cert_cert,_int_flags,_hx509_hostname_type_type,_const_char_*_hostname,_const_struct_sockaddr_*_sa,_int_sa_size)><a class=permalink href=#int_hx509_verify_hostname_(hx509_context_context,_const_hx509_cert_cert,_int_flags,_hx509_hostname_type_type,_const_char_*_hostname,_const_struct_sockaddr_*_sa,_int_sa_size)>int hx509_verify_hostname (hx509_context context, const hx509_cert cert, int flags, hx509_hostname_type type, const char * hostname, const struct sockaddr * sa, int sa_size)</a></h2> Verify that the certificate is allowed to be used for the hostname and address. <p class=Pp><b>Parameters:</b></p><div class=Bd-indent><i>context</i> A hx509 context. <br><i>cert</i> the certificate to match with <br><i>flags</i> Flags to modify the behavior: <dl class=Bl-tag><dt>•</dt><dd>HX509_VHN_F_ALLOW_NO_MATCH no match is ok</dd></dl><p class=Pp><i>type</i> type of hostname:</p><ul class=Bl-bullet><li>HX509_HN_HOSTNAME for plain hostname.</li><li>HX509_HN_DNSSRV for DNS SRV names.</li></ul><p class=Pp><i>hostname</i> the hostname to check <br><i>sa</i> address of the host <br><i>sa_size</i> length of address</p></div><p class=Pp><b>Returns:</b></p><div class=Bd-indent>An hx509 error code, see <b>hx509_get_error_string()</b>.</div></section></section></div><table class=foot><tr><td class=foot-date>11 Jan 2012</td><td class=foot-os>Version 1.5.2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>