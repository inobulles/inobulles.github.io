<!DOCTYPE html>
<html><head><meta charset=utf-8><title>mount_unionfs(8)</title><keywords content=man,mount_unionfs></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>mount_unionfs(8)</h1><table class=head><tr><td class=head-ltitle>MOUNT_UNIONFS(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>MOUNT_UNIONFS(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>mount_unionfs</code> — <div class=Nd>mount union file systems</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>mount_unionfs</code></td><td>[<code class=Fl>-b</code>] [<code class=Fl>-o</code><var class=Ar>options</var>] <var class=Ar>directory</var><var class=Ar>uniondir</var></td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>mount_unionfs</code> utility attaches <var class=Ar>directory</var> above <var class=Ar>uniondir</var> in such a way that the contents of both directory trees remain visible. By default, <var class=Ar>directory</var> becomes the <i class=Em>upper</i> layer and <var class=Ar>uniondir</var> becomes the <i class=Em>lower</i> layer. <p class=Pp>The options are as follows:</p><dl class=Bl-tag><dt><a class=permalink href=#b><code class=Fl id=b>-b</code></a></dt><dd>Deprecated. Use <code class=Fl>-o</code><code class=Cm>below</code> instead.</dd><dt><a class=permalink href=#o><code class=Fl id=o>-o</code></a></dt><dd>Options are specified with the <code class=Fl>-o</code> flag followed by an option. The following options are available: <dl class=Bl-tag><dt><a class=permalink href=#below><code class=Cm id=below>below</code></a></dt><dd>Inverts the default position, so that <var class=Ar>directory</var> becomes the lower layer and <var class=Ar>uniondir</var> becomes the upper layer. However, <var class=Ar>uniondir</var> remains the mount point.</dd><dt><a class=permalink href=#copymode><code class=Cm id=copymode>copymode</code></a><span class=No>=</span><code class=Cm>traditional</code> | <a class=permalink href=#transparent><code class=Cm id=transparent>transparent</code></a> | <a class=permalink href=#masquerade><code class=Cm id=masquerade>masquerade</code></a></dt><dd>Specifies the way to create a file or a directory in the upper layer automatically when needed. The <code class=Cm>traditional</code> mode uses the same way as the old unionfs for backward compatibility, and <code class=Cm>transparent</code> duplicates the file and directory mode bits and the ownership in the lower layer to the created file in the upper layer. For behavior of the <code class=Cm>masquerade</code> mode, see <a class=Sx href=#MASQUERADE_MODE>MASQUERADE MODE</a> below.</dd><dt><a class=permalink href=#whiteout><code class=Cm id=whiteout>whiteout</code></a><span class=No>=</span><code class=Cm>always</code> | <a class=permalink href=#whenneeded><code class=Cm id=whenneeded>whenneeded</code></a></dt><dd>Specifies whether whiteouts should always be made in the upper layer when removing a file or directory or only when it already exists in the lower layer.</dd><dt><a class=permalink href=#udir><code class=Cm id=udir>udir</code></a>=<var class=Ar>mode</var></dt><dd>Specifies directory mode bits in octal for <code class=Cm>masquerade</code> mode.</dd><dt><a class=permalink href=#ufile><code class=Cm id=ufile>ufile</code></a>=<var class=Ar>mode</var></dt><dd>Specifies file mode bits in octal for <code class=Cm>masquerade</code> mode.</dd><dt><a class=permalink href=#gid><code class=Cm id=gid>gid</code></a>=<var class=Ar>gid</var></dt><dd>Specifies group for <code class=Cm>masquerade</code> mode.</dd><dt><a class=permalink href=#uid><code class=Cm id=uid>uid</code></a>=<var class=Ar>uid</var></dt><dd>Specifies user for <code class=Cm>masquerade</code> mode.</dd></dl></dd></dl><p class=Pp>To enforce file system security, the user mounting a file system must be superuser or else have write permission on the mounted-on directory. In addition, the <var class=Va>vfs.usermount</var><a class=Xr href=sysctl.8.html>sysctl(8)</a> variable must be set to 1 to permit file system mounting by ordinary users. However, note that <code class=Cm>transparent</code> and <code class=Cm>masquerade</code> modes require <var class=Va>vfs.usermount</var> to be set to 0 because this functionality can only be used by superusers.</p><p class=Pp>Filenames are looked up in the upper layer and then in the lower layer. If a directory is found in the lower layer, and there is no entry in the upper layer, then a <i class=Em>shadow</i> directory will be created in the upper layer. The ownership and the mode bits are set depending on the <code class=Cm>copymode</code> option. In <code class=Cm>traditional</code> mode, it will be owned by the user who originally did the union mount, with mode 0777 (“<code class=Li>rwxrwxrwx</code>”) modified by the umask in effect at that time.</p><p class=Pp>If a file exists in the upper layer then there is no way to access a file with the same name in the lower layer. If necessary, a combination of loopback and union mounts can be made which will still allow the lower files to be accessed by a different pathname.</p><p class=Pp>Except in the case of a directory, access to an object is granted via the normal file system access checks. For directories, the current user must have access to both the upper and lower directories (should they both exist).</p><p class=Pp>Requests to create or modify objects in <var class=Ar>uniondir</var> are passed to the upper layer with the exception of a few special cases. An attempt to open for writing a file which exists in the lower layer causes a copy of the <i class=Em>entire</i> file to be made to the upper layer, and then for the upper layer copy to be opened. Similarly, an attempt to truncate a lower layer file to zero length causes an empty file to be created in the upper layer. Any other operation which would ultimately require modification to the lower layer fails with <code class=Er>EROFS</code>.</p><p class=Pp>The union file system manipulates the namespace, rather than individual file systems. The union operation applies recursively down the directory tree now rooted at <var class=Ar>uniondir</var>. Thus any file systems which are mounted under <var class=Ar>uniondir</var> will take part in the union operation. This differs from the <code class=Cm>union</code> option to <a class=Xr href=mount.8.html>mount(8)</a> which only applies the union operation to the mount point itself, and then only for lookups.</p></section><section class=Sh><h2 class=Sh id=MASQUERADE_MODE><a class=permalink href=#MASQUERADE_MODE>MASQUERADE MODE</a></h2> When a file (or a directory) is created in the upper layer, the <code class=Cm>masquerade</code> mode sets it the fixed access mode bits given in <code class=Cm>ufile</code> (for files) or <code class=Cm>udir</code> (for directories) option and the owner given in <code class=Cm>udir</code> and <code class=Cm>gid</code> options, instead of ones in the lower layer. Note that in the <code class=Cm>masquerade</code> mode and when owner of the file or directory matches one specified in <code class=Cm>uid</code> option, only mode bits for the owner will be modified. More specifically, the file mode bits in the upper layer will be (mode in the lower layer) OR (mode given in <code class=Cm>ufile</code> AND 0700), and the ownership will be the same as one in the lower layer. <p class=Pp>The default values for <code class=Cm>ufile</code>, <code class=Cm>udir</code>, <code class=Cm>uid</code>, and <code class=Cm>gid</code> are as follow:</p><p class=Pp></p><ul class="Bl-bullet Bl-compact"><li>If none of <code class=Cm>ufile</code> and <code class=Cm>udir</code> were specified, access mode bits in the mount point will be used.</li><li>If none of <code class=Cm>uid</code> and <code class=Cm>gid</code> were specified, ownership in the mount point will be used.</li><li>If one of <code class=Cm>udir</code> or <code class=Cm>ufile</code> is not specified, the value of the other option will be used.</li><li>If one of <code class=Cm>uid</code> or <code class=Cm>gid</code> is not specified, the value of the other option will be used.</li></ul></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> The commands <div class="Bd Pp Bd-indent"><pre>
mount -t cd9660 -o ro /dev/cd0 /usr/src
mount -t unionfs -o noatime /var/obj /usr/src
</pre></div><p class=Pp>mount the CD-ROM drive <span class=Pa>/dev/cd0</span> on <span class=Pa>/usr/src</span> and then attaches <span class=Pa>/var/obj</span> on top. For most purposes the effect of this is to make the source tree appear writable even though it is stored on a CD-ROM. The <code class=Fl>-o</code><code class=Cm>noatime</code> option is useful to avoid unnecessary copying from the lower to the upper layer.</p><p class=Pp>The commands</p><div class="Bd Pp Bd-indent"><pre>
mount -t cd9660 -o ro /dev/cd0 /usr/src
chown 2020 /usr/src
mount -t unionfs -o noatime -o copymode=masquerade -o uid=builder \
    -o udir=755 -o ufile=644 /var/obj /usr/src
</pre></div><p class=Pp>also mount the CD-ROM drive <span class=Pa>/dev/cd0</span> on <span class=Pa>/usr/src</span> and then attaches <span class=Pa>/var/obj</span> on top. Furthermore, the owner of all files and directories in <span class=Pa>/usr/src</span> is a regular user with UID 2020 when seen from the upper layer. Note that for the access mode bits, ones in the lower layer (on the CD-ROM, in this example) are still used without change. Thus, write privilege to the upper layer can be controlled independently from access mode bits and ownership in the lower layer. If a user does not have read privilege from the lower layer, one cannot still read even when the upper layer is mounted by using <code class=Cm>masquerade</code> mode.</p><p class=Pp>The command</p><div class="Bd Pp Bd-indent"><pre>
mount -t unionfs -o noatime -o below /sys $HOME/sys
</pre></div><p class=Pp>attaches the system source tree below the <span class=Pa>sys</span> directory in the user's home directory. This allows individual users to make private changes to the source, and build new kernels, without those changes becoming visible to other users. Note that the files in the lower layer remain accessible via <span class=Pa>/sys</span>.</p></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=intro.2.html>intro(2)</a>, <a class=Xr href=mount.2.html>mount(2)</a>, <a class=Xr href=unmount.2.html>unmount(2)</a>, <a class=Xr href=fstab.5.html>fstab(5)</a>, <a class=Xr href=mount.8.html>mount(8)</a>, <a class=Xr href=mount_nullfs.8.html>mount_nullfs(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>mount_null</code> utility first appeared in <span class=Ux>4.4BSD</span>. It was renamed to <code class=Nm>mount_unionfs</code> in <span class=Ux>FreeBSD 5.0</span>. <p class=Pp>The <code class=Fl>-r</code> option for hiding the lower layer completely was removed in <span class=Ux>FreeBSD 7.0</span> because this is identical to using <a class=Xr href=mount_nullfs.8.html>mount_nullfs(8)</a>.</p></section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> In <span class=Ux>FreeBSD 7.0</span>, <span class=An>Masanori OZAWA</span> &lt;<a class=Mt href=mailto:ozawa@ongs.co.jp>ozawa@ongs.co.jp</a>&gt; reimplemented handling of locking, whiteout, and file mode bits, and <span class=An>Hiroki Sato</span> &lt;<a class=Mt href=mailto:hrs@FreeBSD.org>hrs@FreeBSD.org</a>&gt; wrote about the changes in this manual page. </section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> THIS FILE SYSTEM TYPE IS NOT YET FULLY SUPPORTED (READ: IT DOESN'T WORK) AND USING IT MAY, IN FACT, DESTROY DATA ON YOUR SYSTEM. USE AT YOUR OWN RISK. BEWARE OF DOG. SLIPPERY WHEN WET. BATTERIES NOT INCLUDED. <p class=Pp>This code also needs an owner in order to be less dangerous - serious hackers can apply by sending mail to &lt;<a class=Mt href=mailto:freebsd-fs@FreeBSD.org>freebsd-fs@FreeBSD.org</a>&gt; and announcing their intent to take it over.</p><p class=Pp>Without whiteout support from the file system backing the upper layer, there is no way that delete and rename operations on lower layer objects can be done. <code class=Er>EOPNOTSUPP</code> is returned for this kind of operations as generated by VOP_WHITEOUT() along with any others which would make modifications to the lower layer, such as <a class=Xr href=chmod.1.html>chmod(1)</a>.</p><p class=Pp>Running <a class=Xr href=find.1.html>find(1)</a> over a union tree has the side-effect of creating a tree of shadow directories in the upper layer.</p><p class=Pp>The current implementation does not support copying extended attributes for <a class=Xr href=acl.9.html>acl(9)</a>, <a class=Xr href=mac.9.html>mac(9)</a>, or so on to the upper layer. Note that this may be a security issue.</p><p class=Pp>A shadow directory, which is one automatically created in the upper layer when it exists in the lower layer and does not exist in the upper layer, is always created with the superuser privilege. However, a file copied from the lower layer in the same way is created by the user who accessed it. Because of this, if the user is not the superuser, even in <code class=Cm>transparent</code> mode the access mode bits in the copied file in the upper layer will not always be the same as ones in the lower layer. This behavior should be fixed.</p></section></div><table class=foot><tr><td class=foot-date>October 3, 2016</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>