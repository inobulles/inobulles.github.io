<!DOCTYPE html>
<html><head><meta charset=utf-8><title>libmagic(3)</title><keywords content=man,libmagic></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>libmagic(3)</h1><table class=head><tr><td class=head-ltitle>LIBMAGIC(3)</td><td class=head-vol>FreeBSD Library Functions Manual</td><td class=head-rtitle>LIBMAGIC(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>magic_open</code>, <code class=Nm>magic_close</code>, <code class=Nm>magic_error</code>, <code class=Nm>magic_errno</code>, <code class=Nm>magic_descriptor</code>, <code class=Nm>magic_buffer</code>, <code class=Nm>magic_getflags</code>, <code class=Nm>magic_setflags</code>, <code class=Nm>magic_check</code>, <code class=Nm>magic_compile</code>, <code class=Nm>magic_list</code>, <code class=Nm>magic_load</code>, <code class=Nm>magic_load_buffers</code>, <code class=Nm>magic_setparam</code>, <code class=Nm>magic_getparam</code>, <code class=Nm>magic_version</code> — <div class=Nd>Magic number recognition library</div></section><section class=Sh><h2 class=Sh id=LIBRARY><a class=permalink href=#LIBRARY>LIBRARY</a></h2><span class=Lb>Magic Number Recognition Library (libmagic, -lmagic)</span></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/magic.h.html>magic.h</a>&gt;</code><p class=Pp><var class=Ft>magic_t</var><br><code class=Fn>magic_open</code>(<var class=Fa style="white-space: nowrap;">int flags</var>);</p><p class=Pp><var class=Ft>void</var><br><code class=Fn>magic_close</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>);</p><p class=Pp><var class=Ft>const char *</var><br><code class=Fn>magic_error</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_errno</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>);</p><p class=Pp><var class=Ft>const char *</var><br><code class=Fn>magic_descriptor</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">int fd</var>);</p><p class=Pp><var class=Ft>const char *</var><br><code class=Fn>magic_file</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">const char *filename</var>);</p><p class=Pp><var class=Ft>const char *</var><br><code class=Fn>magic_buffer</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">const void *buffer</var>, <var class=Fa style="white-space: nowrap;">size_t length</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_getflags</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_setflags</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">int flags</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_check</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">const char *filename</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_compile</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">const char *filename</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_list</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">const char *filename</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_load</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">const char *filename</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_load_buffers</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">void **buffers</var>, <var class=Fa style="white-space: nowrap;">size_t *sizes</var>, <var class=Fa style="white-space: nowrap;">size_t nbuffers</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_getparam</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">int param</var>, <var class=Fa style="white-space: nowrap;">void *value</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_setparam</code>(<var class=Fa style="white-space: nowrap;">magic_t cookie</var>, <var class=Fa style="white-space: nowrap;">int param</var>, <var class=Fa style="white-space: nowrap;">const void *value</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>magic_version</code>(<var class=Fa style="white-space: nowrap;">void</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> These functions operate on the magic database file which is described in <a class=Xr href=magic.5.html>magic(5)</a>. <p class=Pp>The function <code class=Fn>magic_open</code>() creates a magic cookie pointer and returns it. It returns <code class=Dv>NULL</code> if there was an error allocating the magic cookie. The <var class=Ar>flags</var> argument specifies how the other magic functions should behave:</p><dl class=Bl-tag><dt><a class=permalink href=#MAGIC_NONE><code class=Dv id=MAGIC_NONE>MAGIC_NONE</code></a></dt><dd>No special handling.</dd><dt><a class=permalink href=#MAGIC_DEBUG><code class=Dv id=MAGIC_DEBUG>MAGIC_DEBUG</code></a></dt><dd>Print debugging messages to stderr.</dd><dt><a class=permalink href=#MAGIC_SYMLINK><code class=Dv id=MAGIC_SYMLINK>MAGIC_SYMLINK</code></a></dt><dd>If the file queried is a symlink, follow it.</dd><dt><a class=permalink href=#MAGIC_COMPRESS><code class=Dv id=MAGIC_COMPRESS>MAGIC_COMPRESS</code></a></dt><dd>If the file is compressed, unpack it and look at the contents.</dd><dt><a class=permalink href=#MAGIC_DEVICES><code class=Dv id=MAGIC_DEVICES>MAGIC_DEVICES</code></a></dt><dd>If the file is a block or character special device, then open the device and try to look in its contents.</dd><dt><a class=permalink href=#MAGIC_MIME_TYPE><code class=Dv id=MAGIC_MIME_TYPE>MAGIC_MIME_TYPE</code></a></dt><dd>Return a MIME type string, instead of a textual description.</dd><dt><a class=permalink href=#MAGIC_MIME_ENCODING><code class=Dv id=MAGIC_MIME_ENCODING>MAGIC_MIME_ENCODING</code></a></dt><dd>Return a MIME encoding, instead of a textual description.</dd><dt><a class=permalink href=#MAGIC_MIME><code class=Dv id=MAGIC_MIME>MAGIC_MIME</code></a></dt><dd>A shorthand for MAGIC_MIME_TYPE | MAGIC_MIME_ENCODING.</dd><dt><a class=permalink href=#MAGIC_CONTINUE><code class=Dv id=MAGIC_CONTINUE>MAGIC_CONTINUE</code></a></dt><dd>Return all matches, not just the first.</dd><dt><a class=permalink href=#MAGIC_CHECK><code class=Dv id=MAGIC_CHECK>MAGIC_CHECK</code></a></dt><dd>Check the magic database for consistency and print warnings to stderr.</dd><dt><a class=permalink href=#MAGIC_PRESERVE_ATIME><code class=Dv id=MAGIC_PRESERVE_ATIME>MAGIC_PRESERVE_ATIME</code></a></dt><dd>On systems that support <a class=Xr href=utime.3.html>utime(3)</a> or <a class=Xr href=utimes.2.html>utimes(2)</a>, attempt to preserve the access time of files analysed.</dd><dt><a class=permalink href=#MAGIC_RAW><code class=Dv id=MAGIC_RAW>MAGIC_RAW</code></a></dt><dd>Don't translate unprintable characters to a \ooo octal representation.</dd><dt><a class=permalink href=#MAGIC_ERROR><code class=Dv id=MAGIC_ERROR>MAGIC_ERROR</code></a></dt><dd>Treat operating system errors while trying to open files and follow symlinks as real errors, instead of printing them in the magic buffer.</dd><dt><a class=permalink href=#MAGIC_APPLE><code class=Dv id=MAGIC_APPLE>MAGIC_APPLE</code></a></dt><dd>Return the Apple creator and type.</dd><dt><a class=permalink href=#MAGIC_EXTENSION><code class=Dv id=MAGIC_EXTENSION>MAGIC_EXTENSION</code></a></dt><dd>Return a slash-separated list of extensions for this file type.</dd><dt><a class=permalink href=#MAGIC_COMPRESS_TRANSP><code class=Dv id=MAGIC_COMPRESS_TRANSP>MAGIC_COMPRESS_TRANSP</code></a></dt><dd>Don't report on compression, only report about the uncompressed data.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_APPTYPE><code class=Dv id=MAGIC_NO_CHECK_APPTYPE>MAGIC_NO_CHECK_APPTYPE</code></a></dt><dd>Don't check for <code class=Dv>EMX</code> application type (only on EMX).</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_CDF><code class=Dv id=MAGIC_NO_CHECK_CDF>MAGIC_NO_CHECK_CDF</code></a></dt><dd>Don't get extra information on MS Composite Document Files.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_COMPRESS><code class=Dv id=MAGIC_NO_CHECK_COMPRESS>MAGIC_NO_CHECK_COMPRESS</code></a></dt><dd>Don't look inside compressed files.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_ELF><code class=Dv id=MAGIC_NO_CHECK_ELF>MAGIC_NO_CHECK_ELF</code></a></dt><dd>Don't print ELF details.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_ENCODING><code class=Dv id=MAGIC_NO_CHECK_ENCODING>MAGIC_NO_CHECK_ENCODING</code></a></dt><dd>Don't check text encodings.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_SOFT><code class=Dv id=MAGIC_NO_CHECK_SOFT>MAGIC_NO_CHECK_SOFT</code></a></dt><dd>Don't consult magic files.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_TAR><code class=Dv id=MAGIC_NO_CHECK_TAR>MAGIC_NO_CHECK_TAR</code></a></dt><dd>Don't examine tar files.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_TEXT><code class=Dv id=MAGIC_NO_CHECK_TEXT>MAGIC_NO_CHECK_TEXT</code></a></dt><dd>Don't check for various types of text files.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_TOKENS><code class=Dv id=MAGIC_NO_CHECK_TOKENS>MAGIC_NO_CHECK_TOKENS</code></a></dt><dd>Don't look for known tokens inside ascii files.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_JSON><code class=Dv id=MAGIC_NO_CHECK_JSON>MAGIC_NO_CHECK_JSON</code></a></dt><dd>Don't examine JSON files.</dd><dt><a class=permalink href=#MAGIC_NO_CHECK_CSV><code class=Dv id=MAGIC_NO_CHECK_CSV>MAGIC_NO_CHECK_CSV</code></a></dt><dd>Don't examine CSV files.</dd></dl><p class=Pp>The <code class=Fn>magic_close</code>() function closes the <a class=Xr href=magic.5.html>magic(5)</a> database and deallocates any resources used.</p><p class=Pp>The <code class=Fn>magic_error</code>() function returns a textual explanation of the last error, or <code class=Dv>NULL</code> if there was no error.</p><p class=Pp>The <code class=Fn>magic_errno</code>() function returns the last operating system error number (<a class=Xr href=errno.2.html>errno(2)</a>) that was encountered by a system call.</p><p class=Pp>The <code class=Fn>magic_file</code>() function returns a textual description of the contents of the <var class=Ar>filename</var> argument, or <code class=Dv>NULL</code> if an error occurred. If the <var class=Ar>filename</var> is <code class=Dv>NULL</code>, then stdin is used.</p><p class=Pp>The <code class=Fn>magic_descriptor</code>() function returns a textual description of the contents of the <var class=Ar>fd</var> argument, or <code class=Dv>NULL</code> if an error occurred.</p><p class=Pp>The <code class=Fn>magic_buffer</code>() function returns a textual description of the contents of the <var class=Ar>buffer</var> argument with <var class=Ar>length</var> bytes size.</p><p class=Pp>The <code class=Fn>magic_getflags</code>() functions returns a value representing current <var class=Ar>flags</var> set.</p><p class=Pp>The <code class=Fn>magic_setflags</code>() function sets the <var class=Ar>flags</var> described above. Note that using both MIME flags together can also return extra information on the charset.</p><p class=Pp>The <code class=Fn>magic_check</code>() function can be used to check the validity of entries in the colon separated database files passed in as <var class=Ar>filename</var>, or <code class=Dv>NULL</code> for the default database. It returns 0 on success and -1 on failure.</p><p class=Pp>The <code class=Fn>magic_compile</code>() function can be used to compile the colon separated list of database files passed in as <var class=Ar>filename</var>, or <code class=Dv>NULL</code> for the default database. It returns 0 on success and -1 on failure. The compiled files created are named from the <a class=Xr href=basename.1.html>basename(1)</a> of each file argument with “.mgc” appended to it.</p><p class=Pp>The <code class=Fn>magic_list</code>() function dumps all magic entries in a human readable format, dumping first the entries that are matched against binary files and then the ones that match text files. It takes and optional <var class=Fa>filename</var> argument which is a colon separated list of database files, or <code class=Dv>NULL</code> for the default database.</p><p class=Pp>The <code class=Fn>magic_load</code>() function must be used to load the colon separated list of database files passed in as <var class=Ar>filename</var>, or <code class=Dv>NULL</code> for the default database file before any magic queries can performed.</p><p class=Pp>The default database file is named by the MAGIC environment variable. If that variable is not set, the default database file name is /usr/share/misc/magic. <code class=Fn>magic_load</code>() adds “.mgc” to the database filename as appropriate.</p><p class=Pp>The <code class=Fn>magic_load_buffers</code>() function takes an array of size <var class=Fa>nbuffers</var> of <var class=Fa>buffers</var> with a respective size for each in the array of <var class=Fa>sizes</var> loaded with the contents of the magic databases from the filesystem. This function can be used in environment where the magic library does not have direct access to the filesystem, but can access the magic database via shared memory or other IPC means.</p><p class=Pp>The <code class=Fn>magic_getparam</code>() and <code class=Fn>magic_setparam</code>() allow getting and setting various limits related to the magic library.</p><table class="Bl-column Bd-indent"><tr><td><b class=Sy>Parameter</b></td><td><b class=Sy>Type</b></td><td><b class=Sy>Default</b></td></tr><tr><td><a class=permalink href=#MAGIC_PARAM_INDIR_MAX><code class=Li id=MAGIC_PARAM_INDIR_MAX>MAGIC_PARAM_INDIR_MAX</code></a></td><td>size_t</td><td>15</td></tr><tr><td><a class=permalink href=#MAGIC_PARAM_NAME_MAX><code class=Li id=MAGIC_PARAM_NAME_MAX>MAGIC_PARAM_NAME_MAX</code></a></td><td>size_t</td><td>30</td></tr><tr><td><a class=permalink href=#MAGIC_PARAM_ELF_NOTES_MAX><code class=Li id=MAGIC_PARAM_ELF_NOTES_MAX>MAGIC_PARAM_ELF_NOTES_MAX</code></a></td><td>size_t</td><td>256</td></tr><tr><td><a class=permalink href=#MAGIC_PARAM_ELF_PHNUM_MAX><code class=Li id=MAGIC_PARAM_ELF_PHNUM_MAX>MAGIC_PARAM_ELF_PHNUM_MAX</code></a></td><td>size_t</td><td>128</td></tr><tr><td><a class=permalink href=#MAGIC_PARAM_ELF_SHNUM_MAX><code class=Li id=MAGIC_PARAM_ELF_SHNUM_MAX>MAGIC_PARAM_ELF_SHNUM_MAX</code></a></td><td>size_t</td><td>32768</td></tr><tr><td><a class=permalink href=#MAGIC_PARAM_REGEX_MAX><code class=Li id=MAGIC_PARAM_REGEX_MAX>MAGIC_PARAM_REGEX_MAX</code></a></td><td>size_t</td><td>8192</td></tr><tr><td><a class=permalink href=#MAGIC_PARAM_BYTES_MAX><code class=Li id=MAGIC_PARAM_BYTES_MAX>MAGIC_PARAM_BYTES_MAX</code></a></td><td>size_t</td><td>1048576</td></tr></table><p class=Pp>The <code class=Dv>MAGIC_PARAM_INDIR_RECURSION</code> parameter controls how many levels of recursion will be followed for indirect magic entries.</p><p class=Pp>The <code class=Dv>MAGIC_PARAM_NAME_RECURSION</code> parameter controls how many levels of recursion will be followed for for name/use calls.</p><p class=Pp>The <code class=Dv>MAGIC_PARAM_NAME_MAX</code> parameter controls the maximum number of calls for name/use.</p><p class=Pp>The <code class=Dv>MAGIC_PARAM_NOTES_MAX</code> parameter controls how many ELF notes will be processed.</p><p class=Pp>The <code class=Dv>MAGIC_PARAM_PHNUM_MAX</code> parameter controls how many ELF program sections will be processed.</p><p class=Pp>The <code class=Dv>MAGIC_PARAM_SHNUM_MAX</code> parameter controls how many ELF sections will be processed.</p><p class=Pp>The <code class=Fn>magic_version</code>() command returns the version number of this library which is compiled into the shared library using the constant <code class=Dv>MAGIC_VERSION</code> from <code class=In>&lt;<a class=In href=../src/magic.h.html>magic.h</a>&gt;</code>. This can be used by client programs to verify that the version they compile against is the same as the version that they run against.</p></section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2> The function <code class=Fn>magic_open</code>() returns a magic cookie on success and <code class=Dv>NULL</code> on failure setting errno to an appropriate value. It will set errno to <code class=Er>EINVAL</code> if an unsupported value for flags was given. The <code class=Fn>magic_list</code>(), <code class=Fn>magic_load</code>(), <code class=Fn>magic_compile</code>(), and <code class=Fn>magic_check</code>() functions return 0 on success and -1 on failure. The <code class=Fn>magic_buffer</code>(), <code class=Fn>magic_getpath</code>(), and <code class=Fn>magic_file</code>(), functions return a string on success and <code class=Dv>NULL</code> on failure. The <code class=Fn>magic_error</code>() function returns a textual description of the errors of the above functions, or <code class=Dv>NULL</code> if there was no error. The <code class=Fn>magic_version</code>() always returns the version number of the library. Finally, <code class=Fn>magic_setflags</code>() returns -1 on systems that don't support <a class=Xr href=utime.3.html>utime(3)</a>, or <a class=Xr href=utimes.2.html>utimes(2)</a> when <code class=Dv>MAGIC_PRESERVE_ATIME</code> is set. </section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><dl class="Bl-tag Bl-compact"><dt><span class=Pa>/usr/share/misc/magic</span></dt><dd>The non-compiled default magic database.</dd><dt><span class=Pa>/usr/share/misc/magic.mgc</span></dt><dd>The compiled default magic database.</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=file.1.html>file(1)</a>, <a class=Xr href=magic.5.html>magic(5)</a></section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> The results from <code class=Fn>magic_buffer</code>() and <code class=Fn>magic_file</code>() where the buffer and the file contain the same data can produce different results, because in the <code class=Fn>magic_file</code>() case, the program can <a class=Xr href=lseek.2.html>lseek(2)</a> and <a class=Xr href=stat.2.html>stat(2)</a> the file descriptor. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Måns Rullgård</span> Initial libmagic implementation, and configuration. <br><span class=An>Christos Zoulas</span> API cleanup, error code and allocation handling. </section></div><table class=foot><tr><td class=foot-date>June 8, 2019</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>