<!DOCTYPE html>
<html><head><meta charset=utf-8><title>NgSendData(3)</title><keywords content=man,NgSendData></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>NgSendData(3)</h1><table class=head><tr><td class=head-ltitle>NETGRAPH(3)</td><td class=head-vol>FreeBSD Library Functions Manual</td><td class=head-rtitle>NETGRAPH(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>NgMkSockNode</code>, <code class=Nm>NgNameNode</code>, <code class=Nm>NgSendMsg</code>, <code class=Nm>NgSendAsciiMsg</code>, <code class=Nm>NgSendReplyMsg</code>, <code class=Nm>NgRecvMsg</code>, <code class=Nm>NgAllocRecvMsg</code>, <code class=Nm>NgRecvAsciiMsg</code>, <code class=Nm>NgAllocRecvAsciiMsg</code>, <code class=Nm>NgSendData</code>, <code class=Nm>NgRecvData</code>, <code class=Nm>NgAllocRecvData</code>, <code class=Nm>NgSetDebug</code>, <code class=Nm>NgSetErrLog</code> — <div class=Nd>netgraph user library</div></section><section class=Sh><h2 class=Sh id=LIBRARY><a class=permalink href=#LIBRARY>LIBRARY</a></h2><span class=Lb>Netgraph User Library (libnetgraph, -lnetgraph)</span></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/netgraph/netgraph.h.html>netgraph/netgraph.h</a>&gt;</code><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgMkSockNode</code>(<var class=Fa style="white-space: nowrap;">const char *name</var>, <var class=Fa style="white-space: nowrap;">int *csp</var>, <var class=Fa style="white-space: nowrap;">int *dsp</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgNameNode</code>(<var class=Fa style="white-space: nowrap;">int cs</var>, <var class=Fa style="white-space: nowrap;">const char *path</var>, <var class=Fa style="white-space: nowrap;">const char *fmt</var>, <var class=Fa style="white-space: nowrap;">...</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgSendMsg</code>(<var class=Fa>int cs</var>, <var class=Fa>const char *path</var>, <var class=Fa>int cookie</var>, <var class=Fa>int cmd</var>, <var class=Fa>const void *arg</var>, <var class=Fa>size_t arglen</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgSendAsciiMsg</code>(<var class=Fa style="white-space: nowrap;">int cs</var>, <var class=Fa style="white-space: nowrap;">const char *path</var>, <var class=Fa style="white-space: nowrap;">const char *fmt</var>, <var class=Fa style="white-space: nowrap;">...</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgSendReplyMsg</code>(<var class=Fa>int cs</var>, <var class=Fa>const char *path</var>, <var class=Fa>struct ng_mesg *msg</var>, <var class=Fa>const void *arg</var>, <var class=Fa>size_t arglen</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgRecvMsg</code>(<var class=Fa style="white-space: nowrap;">int cs</var>, <var class=Fa style="white-space: nowrap;">struct ng_mesg *rep</var>, <var class=Fa style="white-space: nowrap;">size_t replen</var>, <var class=Fa style="white-space: nowrap;">char *path</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgAllocRecvMsg</code>(<var class=Fa style="white-space: nowrap;">int cs</var>, <var class=Fa style="white-space: nowrap;">struct ng_mesg **rep</var>, <var class=Fa style="white-space: nowrap;">char *path</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgRecvAsciiMsg</code>(<var class=Fa style="white-space: nowrap;">int cs</var>, <var class=Fa style="white-space: nowrap;">struct ng_mesg *rep</var>, <var class=Fa style="white-space: nowrap;">size_t replen</var>, <var class=Fa style="white-space: nowrap;">char *path</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgAllocRecvAsciiMsg</code>(<var class=Fa style="white-space: nowrap;">int cs</var>, <var class=Fa style="white-space: nowrap;">struct ng_mesg **rep</var>, <var class=Fa style="white-space: nowrap;">char *path</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgSendData</code>(<var class=Fa style="white-space: nowrap;">int ds</var>, <var class=Fa style="white-space: nowrap;">const char *hook</var>, <var class=Fa style="white-space: nowrap;">const u_char *buf</var>, <var class=Fa style="white-space: nowrap;">size_t len</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgRecvData</code>(<var class=Fa style="white-space: nowrap;">int ds</var>, <var class=Fa style="white-space: nowrap;">u_char *buf</var>, <var class=Fa style="white-space: nowrap;">size_t len</var>, <var class=Fa style="white-space: nowrap;">char *hook</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgAllocRecvData</code>(<var class=Fa style="white-space: nowrap;">int ds</var>, <var class=Fa style="white-space: nowrap;">u_char **buf</var>, <var class=Fa style="white-space: nowrap;">char *hook</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>NgSetDebug</code>(<var class=Fa style="white-space: nowrap;">int level</var>);</p><p class=Pp><var class=Ft>void</var><br><code class=Fn>NgSetErrLog</code>(<var class=Fa>void (*log)(const char *fmt, ...)</var>, <var class=Fa>void (*logx)(const char *fmt, ...)</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> These functions facilitate user-mode program participation in the kernel <a class=Xr href=netgraph.4.html>netgraph(4)</a> graph-based networking system, by utilizing the netgraph <var class=Vt>socket</var> node type (see <a class=Xr href=ng_socket.4.html>ng_socket(4)</a>). <p class=Pp>The <code class=Fn>NgMkSockNode</code>() function should be called first, to create a new <var class=Vt>socket</var> type netgraph node with associated control and data sockets. If <var class=Fa>name</var> is <span class=No>non-</span><code class=Dv>NULL</code>, the node will have that global name assigned to it. The <var class=Fa>csp</var> and <var class=Fa>dsp</var> arguments will be set to the newly opened control and data sockets associated with the node; either <var class=Fa>csp</var> or <var class=Fa>dsp</var> may be <code class=Dv>NULL</code> if only one socket is desired. The <code class=Fn>NgMkSockNode</code>() function loads the <var class=Vt>socket</var> node type KLD if it is not already loaded.</p><p class=Pp>The <code class=Fn>NgNameNode</code>() function assigns a global name to the node addressed by <var class=Fa>path</var>.</p><p class=Pp>The <code class=Fn>NgSendMsg</code>() function sends a binary control message from the <var class=Vt>socket</var> node associated with control socket <var class=Fa>cs</var> to the node addressed by <var class=Fa>path</var>. The <var class=Fa>cookie</var> indicates how to interpret <var class=Fa>cmd</var>, which indicates a specific command. Extra argument data (if any) is specified by <var class=Fa>arg</var> and <var class=Fa>arglen</var>. The <var class=Fa>cookie</var>, <var class=Fa>cmd</var>, and argument data are defined by the header file corresponding to the type of the node being addressed. The unique, non-negative token value chosen for use in the message header is returned. This value is typically used to associate replies.</p><p class=Pp>Use <code class=Fn>NgSendReplyMsg</code>() to send reply to a previously received control message. The original message header should be pointed to by <var class=Fa>msg</var>.</p><p class=Pp>The <code class=Fn>NgSendAsciiMsg</code>() function performs the same function as <code class=Fn>NgSendMsg</code>(), but adds support for ASCII encoding of control messages. The <code class=Fn>NgSendAsciiMsg</code>() function formats its input a la <a class=Xr href=printf.3.html>printf(3)</a> and then sends the resulting ASCII string to the node in a <code class=Dv>NGM_ASCII2BINARY</code> control message. The node returns a binary version of the message, which is then sent back to the node just as with <code class=Fn>NgSendMsg</code>(). As with <code class=Fn>NgSendMsg</code>(), the message token value is returned. Note that ASCII conversion may not be supported by all node types.</p><p class=Pp>The <code class=Fn>NgRecvMsg</code>() function reads the next control message received by the node associated with control socket <var class=Fa>cs</var>. The message and any extra argument data must fit in <var class=Fa>replen</var> bytes. If <var class=Fa>path</var> is <span class=No>non-</span><code class=Dv>NULL</code>, it must point to a buffer of at least <code class=Dv>NG_PATHSIZ</code> bytes, which will be filled in (and <code class=Dv>NUL</code> terminated) with the path to the node from which the message was received.</p><p class=Pp>The length of the control message is returned. A return value of zero indicates that the socket was closed.</p><p class=Pp>The <code class=Fn>NgAllocRecvMsg</code>() function works exactly like <code class=Fn>NgRecvMsg</code>(), except that the buffer for a message is dynamically allocated to guarantee that a message is not truncated. The size of the buffer is equal to the socket's receive buffer size. The caller is responsible for freeing the buffer when it is no longer required.</p><p class=Pp>The <code class=Fn>NgRecvAsciiMsg</code>() function works exactly like <code class=Fn>NgRecvMsg</code>(), except that after the message is received, any binary arguments are converted to ASCII by sending a <code class=Dv>NGM_BINARY2ASCII</code> request back to the originating node. The result is the same as <code class=Fn>NgRecvMsg</code>(), with the exception that the reply arguments field will contain a <code class=Dv>NUL</code>-terminated ASCII version of the arguments (and the reply header argument length field will be adjusted).</p><p class=Pp>The <code class=Fn>NgAllocRecvAsciiMsg</code>() function works exactly like <code class=Fn>NgRecvAsciiMsg</code>(), except that the buffer for a message is dynamically allocated to guarantee that a message is not truncated. The size of the buffer is equal to the socket's receive buffer size. The caller is responsible for freeing the buffer when it is no longer required.</p><p class=Pp>The <code class=Fn>NgSendData</code>() function writes a data packet out on the specified hook of the node corresponding to data socket <var class=Fa>ds</var>. The node must already be connected to some other node via that hook.</p><p class=Pp>The <code class=Fn>NgRecvData</code>() function reads the next data packet (of up to <var class=Fa>len</var> bytes) received by the node corresponding to data socket <var class=Fa>ds</var> and stores it in <var class=Fa>buf</var>, which must be large enough to hold the entire packet. If <var class=Fa>hook</var> is <span class=No>non-</span><code class=Dv>NULL</code>, it must point to a buffer of at least <code class=Dv>NG_HOOKSIZ</code> bytes, which will be filled in (and <code class=Dv>NUL</code> terminated) with the name of the hook on which the data was received.</p><p class=Pp>The length of the packet is returned. A return value of zero indicates that the socket was closed.</p><p class=Pp>The <code class=Fn>NgAllocRecvData</code>() function works exactly like <code class=Fn>NgRecvData</code>(), except that the buffer for a data packet is dynamically allocated to guarantee that a data packet is not truncated. The size of the buffer is equal to the socket's receive buffer size. The caller is responsible for freeing the buffer when it is no longer required.</p><p class=Pp>The <code class=Fn>NgSetDebug</code>() and <code class=Fn>NgSetErrLog</code>() functions are used for debugging. The <code class=Fn>NgSetDebug</code>() function sets the debug level (if non-negative), and returns the old setting. Higher debug levels result in more verbosity. The default is zero. All debug and error messages are logged via the functions specified in the most recent call to <code class=Fn>NgSetErrLog</code>(). The default logging functions are <a class=Xr href=vwarn.3.html>vwarn(3)</a> and <a class=Xr href=vwarnx.3.html>vwarnx(3)</a>.</p><p class=Pp>At debug level 3, the library attempts to display control message arguments in ASCII format; however, this results in additional messages being sent which may interfere with debugging. At even higher levels, even these additional messages will be displayed, etc.</p><p class=Pp>Note that <a class=Xr href=select.2.html>select(2)</a> can be used on the data and the control sockets to detect the presence of incoming data and control messages, respectively. Data and control packets are always written and read atomically, i.e., in one whole piece.</p><p class=Pp>User mode programs must be linked with the <code class=Fl>-l</code><code class=Li>netgraph</code> flag to link in this library.</p></section><section class=Sh><h2 class=Sh id=INITIALIZATION><a class=permalink href=#INITIALIZATION>INITIALIZATION</a></h2> To enable netgraph in your kernel, either your kernel must be compiled with <code class=Cd>options NETGRAPH</code> in the kernel configuration file, or else the <a class=Xr href=netgraph.4.html>netgraph(4)</a> and <a class=Xr href=ng_socket.4.html>ng_socket(4)</a> KLD modules must have been loaded via <a class=Xr href=kldload.8.html>kldload(8)</a>. </section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2> The <code class=Fn>NgSetDebug</code>() function returns the previous debug setting. <p class=Pp>The <code class=Fn>NgSetErrLog</code>() function has no return value.</p><p class=Pp>All other functions return -1 if there was an error and set <var class=Va>errno</var> accordingly.</p><p class=Pp>A return value of zero from <code class=Fn>NgRecvMsg</code>() or <code class=Fn>NgRecvData</code>() indicates that the netgraph socket has been closed.</p><p class=Pp>For <code class=Fn>NgSendAsciiMsg</code>() and <code class=Fn>NgRecvAsciiMsg</code>(), the following additional errors are possible:</p><dl class=Bl-tag><dt>[<code class=Er>ENOSYS</code>]</dt><dd>The node type does not know how to encode or decode the control message.</dd><dt>[<code class=Er>ERANGE</code>]</dt><dd>The encoded or decoded arguments were too long for the supplied buffer.</dd><dt>[<code class=Er>ENOENT</code>]</dt><dd>An unknown structure field was seen in an ASCII control message.</dd><dt>[<code class=Er>EALREADY</code>]</dt><dd>The same structure field was specified twice in an ASCII control message.</dd><dt>[<code class=Er>EINVAL</code>]</dt><dd>ASCII control message parse error or illegal value.</dd><dt>[<code class=Er>E2BIG</code>]</dt><dd>ASCII control message array or fixed width string buffer overflow.</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=select.2.html>select(2)</a>, <a class=Xr href=socket.2.html>socket(2)</a>, <a class=Xr href=warnx.3.html>warnx(3)</a>, <a class=Xr href=kld.4.html>kld(4)</a>, <a class=Xr href=netgraph.4.html>netgraph(4)</a>, <a class=Xr href=ng_socket.4.html>ng_socket(4)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>netgraph</code> system was designed and first implemented at Whistle Communications, Inc. in a version of <span class=Ux>FreeBSD 2.2</span> customized for the Whistle InterJet. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Archie Cobbs</span> &lt;<a class=Mt href=mailto:archie@FreeBSD.org>archie@FreeBSD.org</a>&gt; </section></div><table class=foot><tr><td class=foot-date>November 25, 2013</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>