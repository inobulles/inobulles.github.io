<!DOCTYPE html>
<html><head><meta charset=utf-8><title>ng_ppp(4)</title><keywords content=man,ng_ppp></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>ng_ppp(4)</h1><table class=head><tr><td class=head-ltitle>NG_PPP(4)</td><td class=head-vol>FreeBSD Kernel Interfaces Manual</td><td class=head-rtitle>NG_PPP(4)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>ng_ppp</code> — <div class=Nd>PPP protocol netgraph node type</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/sys/types.h.html>sys/types.h</a>&gt;</code><br><code class=In>#include &lt;<a class=In href=../src/netgraph/ng_ppp.h.html>netgraph/ng_ppp.h</a>&gt;</code></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>ppp</code> node type performs multiplexing for the PPP protocol. It handles only packets that contain data, and forwards protocol negotiation and control packets to a separate controlling entity (e.g., a user-land daemon). This approach combines the fast dispatch of kernel implementations with the configuration flexibility of a user-land implementations. The PPP node type directly supports multi-link PPP, Van Jacobson compression, PPP compression, PPP encryption, and the IP, IPX, and AppleTalk protocols. A single PPP node corresponds to one PPP multi-link bundle. <p class=Pp>There is a separate hook for each PPP link in the bundle, plus several hooks corresponding to the directly supported protocols. For compression and encryption, separate attached nodes are required to do the actual work. The node type used will of course depend on the algorithm negotiated. There is also a <code class=Dv>bypass</code> hook which is used to handle any protocol not directly supported by the node. This includes all of the control protocols: LCP, IPCP, CCP, etc. Typically this node is connected to a user-land daemon via a <a class=Xr href=ng_socket.4.html>ng_socket(4)</a> type node.</p></section><section class=Sh><h2 class=Sh id=ENABLING_FUNCTIONALITY><a class=permalink href=#ENABLING_FUNCTIONALITY>ENABLING FUNCTIONALITY</a></h2> In general, the PPP node enables a specific link or functionality when (a) a <code class=Dv>NGM_PPP_SET_CONFIG</code> message has been received which enables it, and (b) the corresponding hook(s) are connected. This allows the controlling entity to use either method (a) or (b) (or both) to control the node's behavior. When a link is connected but disabled, traffic can still flow on the link via the <code class=Dv>bypass</code> hook (see below). </section><section class=Sh><h2 class=Sh id=LINK_HOOKS><a class=permalink href=#LINK_HOOKS>LINK HOOKS</a></h2> During normal operation, the individual PPP links are connected to hooks <code class=Dv>link0</code>, <code class=Dv>link1</code>, etc. Up to <code class=Dv>NG_PPP_MAX_LINKS</code> links are supported. These device-independent hooks transmit and receive full PPP frames, which include the PPP protocol, address, control, and information fields, but no checksum or other link-specific fields. <p class=Pp>On outgoing frames, when protocol compression has been enabled and the protocol number is suitable for compression, the protocol field will be compressed (i.e., sent as one byte instead of two). Either compressed or uncompressed protocol fields are accepted on incoming frames. Similarly, if address and control field compression has been enabled for the link, the address and control fields will be omitted (except for LCP frames as required by the standards). Incoming frames have the address and control fields stripped automatically if present.</p><p class=Pp>Since all negotiation is handled outside the PPP node, the links should not be connected and enabled until the corresponding link has reached the network phase (i.e., LCP negotiation and authentication have completed successfully) and the PPP node has been informed of the link parameters via the <code class=Dv>NGM_PPP_LINK_CONFIG</code> message.</p><p class=Pp>When a link is connected but disabled, all received frames are forwarded directly out the <code class=Dv>bypass</code> hook, and conversely, frames may be transmitted via the <code class=Dv>bypass</code> hook as well. This mode is appropriate for the link authentication phase. As soon as the link is enabled, the PPP node will begin processing frames received on the link.</p></section><section class=Sh><h2 class=Sh id=COMPRESSION_AND_ENCRYPTION><a class=permalink href=#COMPRESSION_AND_ENCRYPTION>COMPRESSION AND ENCRYPTION</a></h2> Compression is supported via two hooks, <code class=Dv>compress</code> and <code class=Dv>decompress</code>. Compression and decompression can be enabled by toggling the <var class=Vt>enableCompression</var> and <var class=Vt>enableDecompression</var> fields of the node configuration structure. (See below.) If <var class=Vt>enableCompression</var> is set to <code class=Dv>NG_PPP_COMPRESS_SIMPLE</code>, then all outgoing frames are sent to the <code class=Dv>compress</code> hook and all packets received on this hook are expected to be compressed, so the COMPD tag is put on them unconditionally. If <var class=Vt>enableCompression</var> is set to <code class=Dv>NG_PPP_COMPRESS_FULL</code>, then packets received on the <code class=Dv>compress</code> hook are resent as is. The compressor node should put the tag, if the packet was compressed. If <var class=Vt>enableDecompression</var> is set to <code class=Dv>NG_PPP_DECOMPRESS_SIMPLE</code>, then the node will sent to the <code class=Dv>decompress</code> hook only those frames, that are marked with the COMPD tag. If <var class=Vt>enableDecompression</var> is set to <code class=Dv>NG_PPP_DECOMPRESS_FULL</code>, then the node will sent all incoming packets to the <code class=Dv>decompress</code> hook. Compression and decompression can be completely disabled by setting the <var class=Vt>enableCompression</var> and <var class=Vt>enableDecompression</var> fields to the <code class=Dv>NG_PPP_COMPRESS_NONE</code> and <code class=Dv>NG_PPP_DECOMPRESS_NONE</code>, respectively. <p class=Pp>Encryption works exactly analogously via the <code class=Dv>encrypt</code> and <code class=Dv>decrypt</code> nodes. Data is always compressed before being encrypted, and decrypted before being decompressed.</p><p class=Pp>Only bundle-level compression and encryption is directly supported; link-level compression and encryption can be handled transparently by downstream nodes.</p></section><section class=Sh><h2 class=Sh id=VAN_JACOBSON_COMPRESSION><a class=permalink href=#VAN_JACOBSON_COMPRESSION>VAN JACOBSON COMPRESSION</a></h2> When all of the <code class=Dv>vjc_ip</code>, <code class=Dv>vjc_vjcomp</code>, <code class=Dv>vjc_vjuncomp</code>, and <code class=Dv>vjc_vjip</code> hooks are connected, and the corresponding configuration flag is enabled, Van Jacobson compression and/or decompression will become active. Normally these hooks connect to the corresponding hooks of a single <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a> node. The PPP node is compatible with the “pass through” modes of the <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a> node type. </section><section class=Sh><h2 class=Sh id=BYPASS_HOOK><a class=permalink href=#BYPASS_HOOK>BYPASS HOOK</a></h2> When a frame is received on a link with an unsupported protocol, or a protocol which is disabled or for which the corresponding hook is unconnected, the PPP node forwards the frame out the <code class=Dv>bypass</code> hook, prepended with a four byte prefix. This first two bytes of the prefix indicate the link number on which the frame was received (in network order). For such frames received over the bundle (i.e., encapsulated in the multi-link protocol), the special link number <code class=Dv>NG_PPP_BUNDLE_LINKNUM</code> is used. After the two byte link number is the two byte PPP protocol number (also in network order). The PPP protocol number is two bytes long even if the original frame was protocol compressed. <p class=Pp>Conversely, any data written to the <code class=Dv>bypass</code> hook is assumed to be in this same format. The four byte header is stripped off, the PPP protocol number is prepended (possibly compressed), and the frame is delivered over the desired link. If the link number is <code class=Dv>NG_PPP_BUNDLE_LINKNUM</code> the frame will be delivered over the multi-link bundle; or, if multi-link is disabled, over the (single) PPP link.</p><p class=Pp>Typically when the controlling entity receives an unexpected packet on the <code class=Dv>bypass</code> hook it responds either by dropping the frame (if it is not ready for the protocol) or with an LCP protocol reject (if it does not recognize or expect the protocol).</p></section><section class=Sh><h2 class=Sh id=MULTILINK_OPERATION><a class=permalink href=#MULTILINK_OPERATION>MULTILINK OPERATION</a></h2> To enable multi-link PPP, the corresponding configuration flag must be set and at least one link connected. The PPP node will not allow more than one link to be connected if multi-link is not enabled, nor will it allow certain multi-link settings to be changed while multi-link operation is active (e.g., short sequence number header format). <p class=Pp>Since packets are sent as fragments across multiple individual links, it is important that when a link goes down the PPP node is notified immediately, either by disconnecting the corresponding hook or disabling the link via the <code class=Dv>NGM_PPP_SET_CONFIG</code> control message.</p><p class=Pp>Each link has configuration parameters for latency (specified in milliseconds) and bandwidth (specified in tens of bytes per second). The PPP node can be configured for <i class=Em>round-robin</i> or <i class=Em>optimized</i> packet delivery.</p><p class=Pp>When configured for round-robin delivery, the latency and bandwidth values are ignored and the PPP node simply sends each frame as a single fragment, alternating frames across all the links in the bundle. This scheme has the advantage that even if one link fails silently, some packets will still get through. It has the disadvantage of sub-optimal overall bundle latency, which is important for interactive response time, and sub-optimal overall bundle bandwidth when links with different bandwidths exist in the same bundle.</p><p class=Pp>When configured for optimal delivery, the PPP node distributes the packet across the links in a way that minimizes the time it takes for the completed packet to be received by the far end. This involves taking into account each link's latency, bandwidth, and current queue length. Therefore these numbers should be configured as accurately as possible. The algorithm does require some computation, so may not be appropriate for very slow machines and/or very fast links.</p><p class=Pp>As a special case, if all links have identical latency and bandwidth, then the above algorithm is disabled (because it is unnecessary) and the PPP node simply fragments frames into equal sized portions across all of the links.</p></section><section class=Sh><h2 class=Sh id=HOOKS><a class=permalink href=#HOOKS>HOOKS</a></h2> This node type supports the following hooks: <dl class=Bl-tag><dt><var class=Va>link&lt;N&gt;</var></dt><dd>Individual PPP link number <code class=Dv>&lt;N&gt;</code></dd><dt><var class=Va>compress</var></dt><dd>Connection to compression engine</dd><dt><var class=Va>decompress</var></dt><dd>Connection to decompression engine</dd><dt><var class=Va>encrypt</var></dt><dd>Connection to encryption engine</dd><dt><var class=Va>decrypt</var></dt><dd>Connection to decryption engine</dd><dt><var class=Va>vjc_ip</var></dt><dd>Connection to <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a><code class=Dv>ip</code> hook</dd><dt><var class=Va>vjc_vjcomp</var></dt><dd>Connection to <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a><code class=Dv>vjcomp</code> hook</dd><dt><var class=Va>vjc_vjuncomp</var></dt><dd>Connection to <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a><code class=Dv>vjuncomp</code> hook</dd><dt><var class=Va>vjc_vjip</var></dt><dd>Connection to <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a><code class=Dv>vjip</code> hook</dd><dt><var class=Va>inet</var></dt><dd>IP packet data</dd><dt><var class=Va>ipv6</var></dt><dd>IPv6 packet data</dd><dt><var class=Va>atalk</var></dt><dd>AppleTalk packet data</dd><dt><var class=Va>ipx</var></dt><dd>IPX packet data</dd><dt><var class=Va>bypass</var></dt><dd>Bypass hook; frames have a four byte header consisting of a link number and a PPP protocol number.</dd></dl></section><section class=Sh><h2 class=Sh id=CONTROL_MESSAGES><a class=permalink href=#CONTROL_MESSAGES>CONTROL MESSAGES</a></h2> This node type supports the generic control messages, plus the following: <dl class=Bl-tag><dt><a class=permalink href=#NGM_PPP_SET_CONFIG><code class=Dv id=NGM_PPP_SET_CONFIG>NGM_PPP_SET_CONFIG</code></a> (<code class=Ic>setconfig</code>)</dt><dd>This command configures all aspects of the node. This includes enabling multi-link PPP, encryption, compression, Van Jacobson compression, and IP, IPv6, AppleTalk, and IPX packet delivery. It includes per-link configuration, including enabling the link, setting latency and bandwidth parameters, and enabling protocol field compression. Note that no link or functionality is active until the corresponding hook is also connected. This command takes a <code class=Dv>struct ng_ppp_node_conf</code> as an argument: <div class="Bd Pp Bd-indent"><pre>
/* Per-link config structure */
struct ng_ppp_link_conf {
  u_char    enableLink;     /* enable this link */
  u_char    enableProtoComp;/* enable protocol field compression */
  u_char    enableACFComp;  /* enable addr/ctrl field compression */
  uint16_t  mru;            /* peer MRU */
  uint32_t  latency;        /* link latency (in milliseconds) */
  uint32_t  bandwidth;      /* link bandwidth (in bytes/sec/10) */
};

/* Bundle config structure */
struct ng_ppp_bund_conf {
  uint16_t  mrru;                   /* multilink peer MRRU */
  u_char    enableMultilink;        /* enable multilink */
  u_char    recvShortSeq;           /* recv multilink short seq # */
  u_char    xmitShortSeq;           /* xmit multilink short seq # */
  u_char    enableRoundRobin;       /* xmit whole packets */
  u_char    enableIP;               /* enable IP data flow */
  u_char    enableIPv6;             /* enable IPv6 data flow */
  u_char    enableAtalk;            /* enable AppleTalk data flow */
  u_char    enableIPX;              /* enable IPX data flow */
  u_char    enableCompression;      /* enable PPP compression */
  u_char    enableDecompression;    /* enable PPP decompression */
  u_char    enableEncryption;       /* enable PPP encryption */
  u_char    enableDecryption;       /* enable PPP decryption */
  u_char    enableVJCompression;    /* enable VJ compression */
  u_char    enableVJDecompression;  /* enable VJ decompression */
};

struct ng_ppp_node_conf {
  struct ng_ppp_bund_conf   bund;
  struct ng_ppp_link_conf   links[NG_PPP_MAX_LINKS];
};
    </pre></div></dd><dt><a class=permalink href=#NGM_PPP_GET_CONFIG><code class=Dv id=NGM_PPP_GET_CONFIG>NGM_PPP_GET_CONFIG</code></a> (<code class=Ic>getconfig</code>)</dt><dd>Returns the current configuration as a <code class=Dv>struct ng_ppp_node_conf</code>.</dd><dt><a class=permalink href=#NGM_PPP_GET_LINK_STATS><code class=Dv id=NGM_PPP_GET_LINK_STATS>NGM_PPP_GET_LINK_STATS</code></a> (<code class=Ic>getstats</code>)</dt><dd>This command takes a two byte link number as an argument and returns a <code class=Dv>struct ng_ppp_link_stat</code> containing statistics for the corresponding link. Here <code class=Dv>NG_PPP_BUNDLE_LINKNUM</code> is a valid link number corresponding to the multi-link bundle.</dd><dt><a class=permalink href=#NGM_PPP_GET_LINK_STATS64><code class=Dv id=NGM_PPP_GET_LINK_STATS64>NGM_PPP_GET_LINK_STATS64</code></a> (<code class=Ic>getstats64</code>)</dt><dd>Same as NGM_PPP_GET_LINK_STATS but returns <code class=Dv>struct ng_ppp_link_stat64</code> containing 64bit counters.</dd><dt><a class=permalink href=#NGM_PPP_CLR_LINK_STATS><code class=Dv id=NGM_PPP_CLR_LINK_STATS>NGM_PPP_CLR_LINK_STATS</code></a> (<code class=Ic>clrstats</code>)</dt><dd>This command takes a two byte link number as an argument and clears the statistics for that link.</dd><dt><a class=permalink href=#NGM_PPP_GETCLR_LINK_STATS><code class=Dv id=NGM_PPP_GETCLR_LINK_STATS>NGM_PPP_GETCLR_LINK_STATS</code></a> (<code class=Ic>getclrstats</code>)</dt><dd>Same as <code class=Dv>NGM_PPP_GET_LINK_STATS</code>, but also atomically clears the statistics as well.</dd><dt><a class=permalink href=#NGM_PPP_GETCLR_LINK_STATS64><code class=Dv id=NGM_PPP_GETCLR_LINK_STATS64>NGM_PPP_GETCLR_LINK_STATS64</code></a> (<code class=Ic>getclrstats64</code>)</dt><dd>Same as NGM_PPP_GETCLR_LINK_STATS but returns <code class=Dv>struct ng_ppp_link_stat64</code> containing 64bit counters.</dd></dl><p class=Pp>This node type also accepts the control messages accepted by the <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a> node type. When received, these messages are simply forwarded to the adjacent <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a> node, if any. This is particularly useful when the individual PPP links are able to generate <code class=Dv>NGM_VJC_RECV_ERROR</code> messages (see <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a> for a description).</p></section><section class=Sh><h2 class=Sh id=SHUTDOWN><a class=permalink href=#SHUTDOWN>SHUTDOWN</a></h2> This node shuts down upon receipt of a <code class=Dv>NGM_SHUTDOWN</code> control message, or when all hooks have been disconnected. </section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=netgraph.4.html>netgraph(4)</a>, <a class=Xr href=ng_async.4.html>ng_async(4)</a>, <a class=Xr href=ng_iface.4.html>ng_iface(4)</a>, <a class=Xr href=ng_mppc.4.html>ng_mppc(4)</a>, <a class=Xr href=ng_pppoe.4.html>ng_pppoe(4)</a>, <a class=Xr href=ng_vjc.4.html>ng_vjc(4)</a>, <a class=Xr href=ngctl.8.html>ngctl(8)</a><p class=Pp><cite class=Rs><span class=RsA>W. Simpson</span>, <span class=RsT>The Point-to-Point Protocol (PPP)</span>, <span class=RsO>RFC 1661</span>.</cite></p><p class=Pp><cite class=Rs><span class=RsA>K. Sklower</span>, <span class=RsA>B. Lloyd</span>, <span class=RsA>G. McGregor</span>, <span class=RsA>D. Carr</span>, and <span class=RsA>T. Coradetti</span>, <span class=RsT>The PPP Multilink Protocol (MP)</span>, <span class=RsO>RFC 1990</span>.</cite></p></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>ng_ppp</code> node type was implemented in <span class=Ux>FreeBSD 4.0</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Archie Cobbs</span> &lt;<a class=Mt href=mailto:archie@FreeBSD.org>archie@FreeBSD.org</a>&gt; </section></div><table class=foot><tr><td class=foot-date>November 13, 2012</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>