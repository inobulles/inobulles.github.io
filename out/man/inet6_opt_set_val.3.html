<!DOCTYPE html>
<html><head><meta charset=utf-8><title>inet6_opt_set_val(3)</title><keywords content=man,inet6_opt_set_val></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>inet6_opt_set_val(3)</h1><table class=head><tr><td class=head-ltitle>INET6_OPT_INIT(3)</td><td class=head-vol>FreeBSD Library Functions Manual</td><td class=head-rtitle>INET6_OPT_INIT(3)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>inet6_opt_init</code>, <code class=Nm>inet6_opt_append</code>, <code class=Nm>inet6_opt_finish</code>, <code class=Nm>inet6_opt_set_val</code>, <code class=Nm>inet6_opt_next</code>, <code class=Nm>inet6_opt_find</code>, <code class=Nm>inet6_opt_get_val</code> — <div class=Nd>IPv6 Hop-by-Hop and Destination Options manipulation</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/netinet/in.h.html>netinet/in.h</a>&gt;</code><p class=Pp><var class=Ft>int</var><br><code class=Fn>inet6_opt_init</code>(<var class=Fa style="white-space: nowrap;">void *extbuf</var>, <var class=Fa style="white-space: nowrap;">socklen_t extlen</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>inet6_opt_append</code>(<var class=Fa style="white-space: nowrap;">void *extbuf</var>, <var class=Fa style="white-space: nowrap;">socklen_t extlen</var>, <var class=Fa style="white-space: nowrap;">int offset</var>, <var class=Fa style="white-space: nowrap;">u_int8_t type</var>, <var class=Fa style="white-space: nowrap;">socklen_t len</var>, <var class=Fa style="white-space: nowrap;">u_int8_t align</var>, <var class=Fa style="white-space: nowrap;">void **databufp</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>inet6_opt_finish</code>(<var class=Fa style="white-space: nowrap;">void *extbuf</var>, <var class=Fa style="white-space: nowrap;">socklen_t extlen</var>, <var class=Fa style="white-space: nowrap;">int offset</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>inet6_opt_set_val</code>(<var class=Fa style="white-space: nowrap;">void *databuf</var>, <var class=Fa style="white-space: nowrap;">int offset</var>, <var class=Fa style="white-space: nowrap;">void *val</var>, <var class=Fa style="white-space: nowrap;">socklen_t vallen</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>inet6_opt_next</code>(<var class=Fa style="white-space: nowrap;">void *extbuf</var>, <var class=Fa style="white-space: nowrap;">socklen_t extlen</var>, <var class=Fa style="white-space: nowrap;">int offset</var>, <var class=Fa style="white-space: nowrap;">u_int8_t *typep</var>, <var class=Fa style="white-space: nowrap;">socklen_t *lenp</var>, <var class=Fa style="white-space: nowrap;">void **databufp</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>inet6_opt_find</code>(<var class=Fa style="white-space: nowrap;">void *extbuf</var>, <var class=Fa style="white-space: nowrap;">socklen_t extlen</var>, <var class=Fa style="white-space: nowrap;">int offset</var>, <var class=Fa style="white-space: nowrap;">u_int8_t type</var>, <var class=Fa style="white-space: nowrap;">socklen_t *lenp</var>, <var class=Fa style="white-space: nowrap;">void **databufp</var>);</p><p class=Pp><var class=Ft>int</var><br><code class=Fn>inet6_opt_get_val</code>(<var class=Fa style="white-space: nowrap;">void *databuf</var>, <var class=Fa style="white-space: nowrap;">int offset</var>, <var class=Fa style="white-space: nowrap;">void *val</var>, <var class=Fa style="white-space: nowrap;">socklen_t vallen</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> Building and parsing the Hop-by-Hop and Destination options is complicated. The advanced sockets API defines a set of functions to help applications create and manipulate Hop-by-Hop and Destination options. This man page describes the functions specified in IETF Draft RFC3542. These functions use the formatting rules specified in Appendix B in RFC2460, i.e., that the largest field is placed last in the option. The function prototypes for these functions are all contained in the <code class=In>&lt;<a class=In href=../src/netinet/in.h.html>netinet/in.h</a>&gt;</code> header file. <section class=Ss><h2 class=Ss id=inet6_opt_init><a class=permalink href=#inet6_opt_init>inet6_opt_init</a></h2> The <code class=Fn>inet6_opt_init</code>() function returns the number of bytes needed for an empty extension header, one without any options. If the <var class=Fa>extbuf</var> argument points to a valid section of memory then the <code class=Fn>inet6_opt_init</code>() function also initializes the extension header's length field. When attempting to initialize an extension buffer passed in the <var class=Fa>extbuf</var> argument, <var class=Fa>extlen</var> must be a positive multiple of 8 or else the function fails and returns -1 to the caller. </section><section class=Ss><h2 class=Ss id=inet6_opt_append><a class=permalink href=#inet6_opt_append>inet6_opt_append</a></h2> The <code class=Fn>inet6_opt_append</code>() function can perform two different jobs. When a valid <var class=Fa>extbuf</var> argument is supplied it appends an option to the extension buffer and returns the updated total length as well as a pointer to the newly created option in <var class=Fa>databufp</var>. If the value of <var class=Fa>extbuf</var> is <code class=Dv>NULL</code> then the <code class=Fn>inet6_opt_append</code>() function only reports what the total length would be if the option were actually appended. The <var class=Fa>len</var> and <var class=Fa>align</var> arguments specify the length of the option and the required data alignment which must be used when appending the option. The <var class=Fa>offset</var> argument should be the length returned by the <code class=Fn>inet6_opt_init</code>() function or a previous call to <code class=Fn>inet6_opt_append</code>(). <p class=Pp>The <var class=Fa>type</var> argument is the 8-bit option type.</p><p class=Pp>After <code class=Fn>inet6_opt_append</code>() has been called, the application can use the buffer pointed to by <var class=Fa>databufp</var> directly, or use <code class=Fn>inet6_opt_set_val</code>() to specify the data to be contained in the option.</p><p class=Pp>Option types of <code class=Li>0</code> and <code class=Li>1</code> are reserved for the <code class=Li>Pad1</code> and <code class=Li>PadN</code> options. All other values from 2 through 255 may be used by applications.</p><p class=Pp>The length of the option data is contained in an 8-bit value and so may contain any value from 0 through 255.</p><p class=Pp>The <var class=Fa>align</var> parameter must have a value of 1, 2, 4, or 8 and cannot exceed the value of <var class=Fa>len</var>. The alignment values represent no alignment, 16 bit, 32 bit and 64 bit alignments, respectively.</p></section><section class=Ss><h2 class=Ss id=inet6_opt_finish><a class=permalink href=#inet6_opt_finish>inet6_opt_finish</a></h2> The <code class=Fn>inet6_opt_finish</code>() function calculates the final padding necessary to make the extension header a multiple of 8 bytes, as required by the IPv6 extension header specification, and returns the extension header's updated total length. The <var class=Fa>offset</var> argument should be the length returned by <code class=Fn>inet6_opt_init</code>() or <code class=Fn>inet6_opt_append</code>(). When <var class=Fa>extbuf</var> is not <code class=Dv>NULL</code> the function also sets up the appropriate padding bytes by inserting a Pad1 or PadN option of the proper length. <p class=Pp>If the extension header is too small to contain the proper padding then an error of -1 is returned to the caller.</p></section><section class=Ss><h2 class=Ss id=inet6_opt_set_val><a class=permalink href=#inet6_opt_set_val>inet6_opt_set_val</a></h2> The <code class=Fn>inet6_opt_set_val</code>() function inserts data items of various sizes into the data portion of the option. The <var class=Fa>databuf</var> argument is a pointer to memory that was returned by the <code class=Fn>inet6_opt_append</code>() call and the <var class=Fa>offset</var> argument specifies where the option should be placed in the data buffer. The <var class=Fa>val</var> argument points to an area of memory containing the data to be inserted into the extension header, and the <var class=Fa>vallen</var> argument indicates how much data to copy. <p class=Pp>The caller should ensure that each field is aligned on its natural boundaries as described in Appendix B of RFC2460.</p><p class=Pp>The function returns the offset for the next field which is calculated as <var class=Fa>offset</var> + <var class=Fa>vallen</var> and is used when composing options with multiple fields.</p></section><section class=Ss><h2 class=Ss id=inet6_opt_next><a class=permalink href=#inet6_opt_next>inet6_opt_next</a></h2> The <code class=Fn>inet6_opt_next</code>() function parses received extension headers. The <var class=Fa>extbuf</var> and <var class=Fa>extlen</var> arguments specify the location and length of the extension header being parsed. The <var class=Fa>offset</var> argument should either be zero, for the first option, or the length value returned by a previous call to <code class=Fn>inet6_opt_next</code>() or <code class=Fn>inet6_opt_find</code>(). The return value specifies the position where to continue scanning the extension buffer. The option is returned in the arguments <var class=Fa>typep</var>, <var class=Fa>lenp</var>, and <var class=Fa>databufp</var>, which point to the 8-bit option type, the 8-bit option length and the option data, respectively. This function does not return any PAD1 or PADN options. When an error occurs or there are no more options, the return value is -1. </section><section class=Ss><h2 class=Ss id=inet6_opt_find><a class=permalink href=#inet6_opt_find>inet6_opt_find</a></h2> The <code class=Fn>inet6_opt_find</code>() function searches the extension buffer for a particular option type, passed in through the <var class=Fa>type</var> argument. If the option is found then the <var class=Fa>lenp</var> and <var class=Fa>databufp</var> arguments are updated to point to the option's length and data, respectively. The <var class=Fa>extbuf</var> and <var class=Fa>extlen</var> arguments must point to a valid extension buffer and give its length. The <var class=Fa>offset</var> argument can be used to search from a location anywhere in the extension header. </section><section class=Ss><h2 class=Ss id=inet6_opt_get_val><a class=permalink href=#inet6_opt_get_val>inet6_opt_get_val</a></h2> The <code class=Fn>inet6_opt_get_val</code>() function extracts data items of various sizes in the data portion of the option. The <var class=Fa>databuf</var> is a pointer returned by the <code class=Fn>inet6_opt_next</code>() or <code class=Fn>inet6_opt_find</code>() functions. The <var class=Fa>val</var> argument points where the data will be extracted. The <var class=Fa>offset</var> argument specifies from where in the data portion of the option the value should be extracted; the first byte of option data is specified by an offset of zero. <p class=Pp>It is expected that each field is aligned on its natural boundaries as described in Appendix B of RFC2460.</p><p class=Pp>The function returns the offset for the next field by calculating <var class=Fa>offset</var> + <var class=Fa>vallen</var> which can be used when extracting option content with multiple fields. Robust receivers must verify alignment before calling this function.</p></section></section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2> All the functions return -1 on an error. </section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> RFC3542 gives comprehensive examples in Section 23. <p class=Pp>KAME also provides examples in the <span class=Pa>advapitest</span> directory of its kit.</p></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><p class=Pp><cite class=Rs><span class=RsA>W. Stevens</span>, <span class=RsA>M. Thomas</span>, <span class=RsA>E. Nordmark</span>, and <span class=RsA>T. Jinmei</span>, <span class=RsT>Advanced Sockets API for IPv6</span>, <span class=RsN>RFC3542</span>, <span class=RsD>October 2002</span>.</cite></p><p class=Pp><cite class=Rs><span class=RsA>S. Deering</span> and <span class=RsA>R. Hinden</span>, <span class=RsT>Internet Protocol, Version 6 (IPv6) Specification</span>, <span class=RsN>RFC2460</span>, <span class=RsD>December 1998</span>.</cite></p></section><section class=Sh><h2 class=Sh id=STANDARDS><a class=permalink href=#STANDARDS>STANDARDS</a></h2> The functions are documented in “Advanced Sockets API for IPv6” (RFC3542). </section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The implementation first appeared in KAME advanced networking kit. </section></div><table class=foot><tr><td class=foot-date>December 23, 2004</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>