<!DOCTYPE html>
<html><head><meta charset=utf-8><title>ena(4)</title><keywords content=man,ena></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>ena(4)</h1><table class=head><tr><td class=head-ltitle>ENA(4)</td><td class=head-vol>FreeBSD Kernel Interfaces Manual</td><td class=head-rtitle>ENA(4)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>ena</code> — <div class=Nd>FreeBSD kernel driver for Elastic Network Adapter (ENA) family</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2> To compile this driver into the kernel, place the following line in the kernel configuration file: <div class="Bd Pp Bd-indent"><code class=Cd>device ena</code></div><p class=Pp>Alternatively, to load the driver as a module at boot time, place the following line in <a class=Xr href=loader.conf.5.html>loader.conf(5)</a>:</p><div class="Bd Pp Bd-indent"><pre>
if_ena_load="YES"
</pre></div></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The ENA is a networking interface designed to make good use of modern CPU features and system architectures. <p class=Pp>The ENA device exposes a lightweight management interface with a minimal set of memory mapped registers and extendable command set through an Admin Queue.</p><p class=Pp>The driver supports a range of ENA devices, is link-speed independent (i.e., the same driver is used for 10GbE, 25GbE, 40GbE, etc.), and has a negotiated and extendable feature set.</p><p class=Pp>Some ENA devices support SR-IOV. This driver is used for both the SR-IOV Physical Function (PF) and Virtual Function (VF) devices.</p><p class=Pp>The ENA devices enable high speed and low overhead network traffic processing by providing multiple Tx/Rx queue pairs (the maximum number is advertised by the device via the Admin Queue), a dedicated MSI-X interrupt vector per Tx/Rx queue pair, and CPU cacheline optimized data placement.</p><p class=Pp>When RSS is enabled, each Tx/Rx queue pair is bound to a corresponding CPU core and its NUMA domain. The order of those bindings is based on the RSS bucket mapping. For builds with RSS support disabled, the CPU and NUMA management is left to the kernel. Receive-side scaling (RSS) is supported for multi-core scaling.</p><p class=Pp>The <code class=Nm>ena</code> driver and its corresponding devices implement health monitoring mechanisms such as watchdog, enabling the device and driver to recover in a manner transparent to the application, as well as debug logs.</p><p class=Pp>Some of the ENA devices support a working mode called Low-latency Queue (LLQ), which saves several more microseconds.</p><p class=Pp>Support for the <a class=Xr href=netmap.4.html>netmap(4)</a> framework is provided by the <code class=Nm>ena</code> driver. Kernel must be built with the DEV_NETMAP option to be able to use this feature.</p></section><section class=Sh><h2 class=Sh id=HARDWARE><a class=permalink href=#HARDWARE>HARDWARE</a></h2> Supported PCI vendor ID/device IDs: <p class=Pp></p><ul class="Bl-bullet Bl-compact"><li>1d0f:0ec2 - ENA PF</li><li>1d0f:1ec2 - ENA PF with LLQ support</li><li>1d0f:ec20 - ENA VF</li><li>1d0f:ec21 - ENA VF with LLQ support</li></ul></section><section class=Sh><h2 class=Sh id=LOADER_TUNABLES><a class=permalink href=#LOADER_TUNABLES>LOADER TUNABLES</a></h2> The <code class=Nm>ena</code> driver's behavior can be changed using run-time or boot-time sysctl arguments. The boot-time arguments can be set at the <a class=Xr href=loader.8.html>loader(8)</a> prompt before booting the kernel, or stored in the <a class=Xr href=loader.conf.5.html>loader.conf(5)</a>. The run-time arguments can be set using the <a class=Xr href=sysctl.8.html>sysctl(8)</a> command. <p class=Pp>Boot-time tunables:</p><dl class=Bl-tag><dt><var class=Va>hw.ena.enable_9k_mbufs</var></dt><dd>Use 9k mbufs for the Rx descriptors. The default is 0. If the node value is set to 1, 9k mbufs will be used for the Rx buffers. If set to 0, page size mbufs will be used instead. <p class=Pp>Using 9k buffers for Rx can improve Rx throughput, but in low memory conditions it might increase allocation time, as the system has to look for 3 contiguous pages. This can further lead to OS instability, together with ENA driver reset and NVMe timeouts. If network performance is critical and memory capacity is sufficient, the 9k mbufs can be used.</p></dd><dt><var class=Va>hw.ena.force_large_llq_headers</var></dt><dd>Force the driver to use large LLQ headers (224 bytes). The default is 0. If the node value is set to 0, the regular size LLQ header will be used, which is 96B. In some cases, the packet header can be bigger than this (for example - IPv6 with multiple extensions). In such a situation, the large LLQ headers should be used by setting this node value to 1. This will take effect only if the device supports both LLQ and large LLQ headers. Otherwise, it will fallback to the no LLQ mode or regular header size. <p class=Pp>Increasing LLQ header size reduces the size of the Tx queue by half, so it may affect the number of dropped Tx packets.</p></dd></dl><p class=Pp>Run-time tunables:</p><dl class=Bl-tag><dt><var class=Va>hw.ena.log_level</var></dt><dd>Controls extra logging verbosity of the driver. The default is 2. The higher the logging level, the more logs will be printed out. 0 means all extra logs are disabled and only error logs will be printed out. Default value (2) reports errors, warnings and is verbose about driver operation. <p class=Pp>The possible flags are:</p><p class=Pp></p><ul class="Bl-bullet Bl-compact"><li>0 - ENA_ERR - Enable driver error messages and ena_com error logs.</li><li>1 - ENA_WARN - Enable logs for non-critical errors.</li><li>2 - ENA_INFO - Make the driver more verbose about its actions.</li><li>3 - ENA_DBG - Enable debug logs.</li></ul><p class=Pp>NOTE: In order to enable logging on the Tx/Rx data path, driver must be compiled with ENA_LOG_IO_ENABLE compilation flag.</p><p class=Pp>Example: To enable logs for errors and warnings, the following command should be used:</p><div class="Bd Pp Bd-indent"><pre>
sysctl hw.ena.log_level=1
    </pre></div></dd><dt><var class=Va>dev.ena.X.io_queues_nb</var></dt><dd>Number of the currently allocated and used IO queues. The default is max_num_io_queues. Controls the number of IO queue pairs (Tx/Rx). As this call has to reallocate the queues, it will reset the interface and restart all the queues - this means that everything, which was currently held in the queue, will be lost, leading to potential packet drops. <p class=Pp>This call can fail if the system isn't able to provide the driver with enough resources. In that situation, the driver will try to revert the previous number of the IO queues. If this also fails, the device reset will be triggered.</p><p class=Pp>Example: To use only 2 Tx and Rx queues for the device ena1, the following command should be used:</p><div class="Bd Pp Bd-indent"><pre>
sysctl dev.ena.1.io_queues_nb=2
    </pre></div></dd><dt><var class=Va>dev.ena.X.rx_queue_size</var></dt><dd>Size of the Rx queue. The default is 1024. Controls the number of IO descriptors for each Rx queue. The user may want to increase the Rx queue size if they observe a high number of Rx drops in the driver's statistics. For performance reasons, the Rx queue size must be a power of 2. <p class=Pp>This call can fail if the system isn't able to provide the driver with enough resources. In that situation, the driver will try to revert to the previous number of the descriptors. If this also fails, the device reset will be triggered.</p><p class=Pp>Example: To increase Rx ring size to 8K descriptors for the device ena0, the following command should be used:</p><div class="Bd Pp Bd-indent"><pre>
sysctl dev.ena.0.rx_queue_size=8192
    </pre></div></dd><dt><var class=Va>dev.ena.X.buf_ring_size</var></dt><dd>Size of the Tx buffer ring (drbr). The default is 4096. Input must be a power of 2. Controls the number of mbufs that can be held in the Tx buffer ring. The drbr is used as a multiple-producer, single-consumer lockless ring for buffering extra mbufs coming from the stack in case the Tx procedure is busy sending the packets, or the Tx ring is full. Increasing the size of the buffer ring may reduce the number of Tx packets being dropped in case of a big Tx burst, which cannot be handled by the IO queue immediately. Each Tx queue has its own drbr. <p class=Pp>It is recommended to keep the drbr with at least the default value, but in case the system lacks the resources, it can be reduced. This call can fail if the system is not able to provide the driver with enough resources. In that situation, the driver will try to revert to the previous number of the drbr and trigger the device reset.</p><p class=Pp>Example: To set drbr size for interface ena0 to 2048, the following command should be used:</p><div class="Bd Pp Bd-indent"><pre>
sysctl dev.ena.0.buf_ring_size=2048
    </pre></div></dd><dt><var class=Va>dev.ena.X.eni_metrics.sample_interval</var></dt><dd>Interval in seconds for updating ENI metrics. The default is 0. Determines how often (if ever) the ENI metrics should be updated. The ENI metrics are being updated asynchronously in a timer service in order to avoid admin queue overload by sysctl node reading. The value in this node controls the interval between issuing admin commands to the device, which will update the ENI metrics values. <p class=Pp>If some application is periodically monitoring the eni_metrics, then the ENI metrics interval can be adjusted accordingly. Value 0 turns off the update completely. Value 1 is the minimum interval and is equal to 1 second. The maximum allowed update interval is 1 hour.</p><p class=Pp>Example: To update ENI metrics for the device ena1 every 10 seconds, the following command should be used:</p><div class="Bd Pp Bd-indent"><pre>
sysctl dev.ena.1.eni_metrics.sample_interval=10
    </pre></div></dd><dt><var class=Va>dev.ena.X.rss.indir_table_size</var></dt><dd>RSS indirection table size. The default is 128. Returns the number of entries in the RSS indirection table. <p class=Pp>Example: To read the RSS indirection table size, the following command should be used:</p><div class="Bd Pp Bd-indent"><pre>
sysctl dev.ena.0.rss.indir_table_size
    </pre></div></dd><dt><var class=Va>dev.ena.X.rss.indir_table</var></dt><dd>RSS indirection table mapping. The default is x:y key-pairs of indir_table_size length. Updates selected indices of the RSS indirection table. <p class=Pp>The entry string consists of one or more x:y keypairs, where x stands for the table index and y for its new value. Table indices that don't need to be updated can be omitted from the string and will retain their existing values.</p><p class=Pp>If an index is entered more than once, the last value is used.</p><p class=Pp>Example: To update two selected indices in the RSS indirection table, e.g. setting index 0 to queue 5 and then index 5 to queue 0, the following command should be used:</p><div class="Bd Pp Bd-indent"><pre>
sysctl dev.ena.0.rss.indir_table="0:5 5:0"
    </pre></div></dd><dt><var class=Va>dev.ena.X.rss.key</var></dt><dd>RSS hash key. The default is 40 bytes long randomly generated hash key. Controls the RSS Toeplitz hash algorithm key value. <p class=Pp>Only available when driver compiled without the kernel side RSS support.</p><p class=Pp>Example: To change the RSS hash key value to</p><p class=Pp>0x6d, 0x5a, 0x56, 0xda, 0x25, 0x5b, 0x0e, 0xc2, <br> 0x41, 0x67, 0x25, 0x3d, 0x43, 0xa3, 0x8f, 0xb0, <br> 0xd0, 0xca, 0x2b, 0xcb, 0xae, 0x7b, 0x30, 0xb4, <br> 0x77, 0xcb, 0x2d, 0xa3, 0x80, 0x30, 0xf2, 0x0c, <br> 0x6a, 0x42, 0xb7, 0x3b, 0xbe, 0xac, 0x01, 0xfa</p><p class=Pp>the following command should be used:</p><div class="Bd Pp Bd-indent"><pre>
sysctl dev.ena.0.rss.key=6d5a56da255b0ec24167253d43a38fb0d0ca2bcbae7b30b477cb2da38030f20c6a42b73bbeac01fa
    </pre></div></dd></dl></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2><section class=Ss><h2 class=Ss id=Device_initialization_phase><a class=permalink href=#Device_initialization_phase>Device initialization phase</a></h2><dl class=Bl-diag><dt>ena%d: failed to init mmio read less</dt><dd><p class=Pp>Error occurred during initialization of the mmio register read request.</p></dd><dt>ena%d: Can not reset device</dt><dd><p class=Pp>Device could not be reset. <br> Device may not be responding or is already during reset.</p></dd><dt>ena%d: device version is too low</dt><dd><p class=Pp>Version of the controller is too old and it is not supported by the driver.</p></dd><dt>ena%d: Invalid dma width value %d</dt><dd><p class=Pp>The controller is unable to request dma transaction width. <br> Device stopped responding or it demanded invalid value.</p></dd><dt>ena%d: Can not initialize ena admin queue with device</dt><dd><p class=Pp>Initialization of the Admin Queue failed. <br> Device may not be responding or there was a problem with initialization of the resources.</p></dd><dt>ena%d: Cannot get attribute for ena device rc: %d</dt><dd><p class=Pp>Failed to get attributes of the device from the controller.</p></dd><dt>ena%d: Cannot configure aenq groups rc: %d</dt><dd><p class=Pp>Errors occurred when trying to configure AENQ groups.</p></dd></dl></section><section class=Ss><h2 class=Ss id=Driver_initialization/shutdown_phase><a class=permalink href=#Driver_initialization/shutdown_phase>Driver initialization/shutdown phase</a></h2><dl class=Bl-diag><dt>ena%d: PCI resource allocation failed!</dt><dd></dd><dt>ena%d: failed to pmap registers bar</dt><dd></dd><dt>ena%d: can not allocate ifnet structure</dt><dd></dd><dt>ena%d: Error with network interface setup</dt><dd></dd><dt>ena%d: Failed to enable and set the admin interrupts</dt><dd></dd><dt>ena%d: Error, MSI-X is already enabled</dt><dd></dd><dt>ena%d: Failed to enable MSIX, vectors %d rc %d</dt><dd></dd><dt>ena%d: Not enough number of MSI-X allocated: %d</dt><dd></dd><dt>ena%d: Error with MSI-X enablement</dt><dd></dd><dt>ena%d: could not allocate irq vector: %d</dt><dd></dd><dt>ena%d: unable to allocate bus resource: registers!</dt><dd></dd><dt>ena%d: unable to allocate bus resource: msix!</dt><dd><p class=Pp>Resource allocation failed when initializing the device. <br> Driver will not be attached.</p></dd><dt>ena%d: ENA device init failed (err: %d)</dt><dd></dd><dt>ena%d: Cannot initialize device</dt><dd><p class=Pp>Device initialization failed. <br> Driver will not be attached.</p></dd><dt>ena%d: failed to register interrupt handler for irq %ju: %d</dt><dd><p class=Pp>Error occurred when trying to register Admin Queue interrupt handler.</p></dd><dt>ena%d: Cannot setup mgmnt queue intr</dt><dd><p class=Pp>Error occurred during configuration of the Admin Queue interrupts.</p></dd><dt>ena%d: Enable MSI-X failed</dt><dd><p class=Pp>Configuration of the MSI-X for Admin Queue failed. <br> There could be lack of resources or interrupts could not have been configured. <br> Driver will not be attached.</p></dd><dt>ena%d: VLAN is in use, detach first</dt><dd><p class=Pp>VLANs are being used when trying to detach the driver. <br> VLANs must be detached first and then detach routine have to be called again.</p></dd><dt>ena%d: Unmapped RX DMA tag associations</dt><dd></dd><dt>ena%d: Unmapped TX DMA tag associations</dt><dd><p class=Pp>Error occurred when trying to destroy RX/TX DMA tag.</p></dd><dt>ena%d: Cannot init indirect table</dt><dd></dd><dt>ena%d: Cannot fill indirect table</dt><dd></dd><dt>ena%d: Cannot fill hash function</dt><dd></dd><dt>ena%d: Cannot fill hash control</dt><dd></dd><dt>ena%d: WARNING: RSS was not properly initialized, it will affect bandwidth</dt><dd><p class=Pp>Error occurred during initialization of one of RSS resources. <br> The device will work with reduced performance because all RX packets will be passed to queue 0 and there will be no hash information.</p></dd><dt>ena%d: LLQ is not supported. Fallback to host mode policy.</dt><dd></dd><dt>ena%d: Failed to configure the device mode. Fallback to host mode policy.</dt><dd></dd><dt>ena%d: unable to allocate LLQ bar resource. Fallback to host mode policy.</dt><dd><p class=Pp>Error occurred during Low-latency Queue mode setup. <br> The device will work, but without the LLQ performance gain.</p></dd><dt>ena%d: failed to enable write combining.</dt><dd><p class=Pp>Error occurred while setting the Write Combining mode, required for the LLQ.</p></dd><dt>ena%d: failed to tear down irq: %d</dt><dd></dd><dt>ena%d: dev has no parent while releasing res for irq: %d</dt><dd>Release of the interrupts failed.</dd></dl></section><section class=Ss><h2 class=Ss id=Additional_diagnostic><a class=permalink href=#Additional_diagnostic>Additional diagnostic</a></h2><dl class=Bl-diag><dt>ena%d: Invalid MTU setting. new_mtu: %d max_mtu: %d min mtu: %d</dt><dd><p class=Pp>Requested MTU value is not supported and will not be set.</p></dd><dt>ena%d: Failed to set MTU to %d</dt><dd><p class=Pp>This message appears when either MTU change feature is not supported, or device communication error has occurred.</p></dd><dt>ena%d: Keep alive watchdog timeout.</dt><dd><p class=Pp>Device stopped responding and will be reset.</p></dd><dt>ena%d: Found a Tx that wasn't completed on time, qid %d, index %d.</dt><dd><p class=Pp>Packet was pushed to the NIC but not sent within given time limit. <br> It may be caused by hang of the IO queue.</p></dd><dt>ena%d: The number of lost tx completion is above the threshold (%d &gt; %d). Reset the device</dt><dd><p class=Pp>If too many Tx weren't completed on time the device is going to be reset. <br> It may be caused by hanged queue or device.</p></dd><dt>ena%d: Trigger reset is on</dt><dd><p class=Pp>Device will be reset. <br> Reset is triggered either by watchdog or if too many TX packets were not completed on time.</p></dd><dt>ena%d: device reset scheduled but trigger_reset is off</dt><dd><p class=Pp>Reset task has been triggered, but the driver did not request it. <br> Device reset will not be performed.</p></dd><dt>ena%d: Device reset failed</dt><dd><p class=Pp>Error occurred while trying to reset the device.</p></dd><dt>ena%d: Cannot initialize device</dt><dd></dd><dt>ena%d: Error, mac address are different</dt><dd></dd><dt>ena%d: Error, device max mtu is smaller than ifp MTU</dt><dd></dd><dt>ena%d: Validation of device parameters failed</dt><dd></dd><dt>ena%d: Enable MSI-X failed</dt><dd></dd><dt>ena%d: Failed to create I/O queues</dt><dd></dd><dt>ena%d: Reset attempt failed. Can not reset the device</dt><dd><p class=Pp>Error occurred while trying to restore the device after reset.</p></dd><dt>ena%d: Device reset completed successfully, Driver info: %s</dt><dd><p class=Pp>Device has been correctly restored after reset and is ready to use.</p></dd><dt>ena%d: Allocation for Tx Queue %u failed</dt><dd></dd><dt>ena%d: Allocation for Rx Queue %u failed</dt><dd></dd><dt>ena%d: Unable to create Rx DMA map for buffer %d</dt><dd></dd><dt>ena%d: Failed to create io TX queue #%d rc: %d</dt><dd></dd><dt>ena%d: Failed to get TX queue handlers. TX queue num %d rc: %d</dt><dd></dd><dt>ena%d: Failed to create io RX queue[%d] rc: %d</dt><dd></dd><dt>ena%d: Failed to get RX queue handlers. RX queue num %d rc: %d</dt><dd></dd><dt>ena%d: could not allocate irq vector: %d</dt><dd></dd><dt>ena%d: failed to register interrupt handler for irq %ju: %d</dt><dd><p class=Pp>IO resources initialization failed. <br> Interface will not be brought up.</p></dd><dt>ena%d: LRO[%d] Initialization failed!</dt><dd><p class=Pp>Initialization of the LRO for the RX ring failed.</p></dd><dt>ena%d: failed to alloc buffer for rx queue</dt><dd></dd><dt>ena%d: failed to add buffer for rx queue %d</dt><dd></dd><dt>ena%d: refilled rx qid %d with only %d mbufs (from %d)</dt><dd><p class=Pp>Allocation of resources used on RX path failed. <br> If happened during initialization of the IO queue, the interface will not be brought up.</p></dd><dt>ena%d: NULL mbuf in rx_info</dt><dd><p class=Pp>Error occurred while assembling mbuf from descriptors.</p></dd><dt>ena%d: tx_info doesn't have valid mbuf</dt><dd></dd><dt>ena%d: Invalid req_id: %hu</dt><dd></dd><dt>ena%d: failed to prepare tx bufs</dt><dd><p class=Pp>Error occurred while preparing a packet for transmission.</p></dd><dt>ena%d: ioctl promisc/allmulti</dt><dd><p class=Pp>IOCTL request for the device to work in promiscuous/allmulti mode. <br> See <a class=Xr href=ifconfig.8.html>ifconfig(8)</a> for more details.</p></dd></dl></section></section><section class=Sh><h2 class=Sh id=SUPPORT><a class=permalink href=#SUPPORT>SUPPORT</a></h2> If an issue is identified with the released source code with a supported adapter, please email the specific information related to the issue to &lt;<a class=Mt href=mailto:mk@semihalf.com>mk@semihalf.com</a>&gt;, &lt;<a class=Mt href=mailto:dgr@semihalf.com>dgr@semihalf.com</a>&gt; and &lt;<a class=Mt href=mailto:mw@semihalf.com>mw@semihalf.com</a>&gt;. </section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=netmap.4.html>netmap(4)</a>, <a class=Xr href=vlan.4.html>vlan(4)</a>, <a class=Xr href=ifconfig.8.html>ifconfig(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>ena</code> driver first appeared in <span class=Ux>FreeBSD 11.1</span>. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2> The <code class=Nm>ena</code> driver was written by <span class=An>Semihalf</span>. </section></div><table class=foot><tr><td class=foot-date>June 4, 2021</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>