<!DOCTYPE html>
<html><head><meta charset=utf-8><title>pmcstat(8)</title><keywords content=man,pmcstat></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>pmcstat(8)</h1><table class=head><tr><td class=head-ltitle>PMCSTAT(8)</td><td class=head-vol>FreeBSD System Manager's Manual</td><td class=head-rtitle>PMCSTAT(8)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>pmcstat</code> — <div class=Nd>performance measurement with performance monitoring hardware</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><table class=Nm><tr><td><code class=Nm>pmcstat</code></td><td>[<code class=Fl>-A</code>] [<code class=Fl>-C</code>] [<code class=Fl>-D</code><var class=Ar>pathname</var>] [<code class=Fl>-E</code>] [<code class=Fl>-F</code><var class=Ar>pathname</var>] [<code class=Fl>-G</code><var class=Ar>pathname</var>] [<code class=Fl>-I</code>] [<code class=Fl>-L</code>] [<code class=Fl>-M</code><var class=Ar>mapfilename</var>] [<code class=Fl>-N</code>] [<code class=Fl>-O</code><var class=Ar>logfilename</var>] [<code class=Fl>-P</code><var class=Ar>event-spec</var>] [<code class=Fl>-R</code><var class=Ar>logfilename</var>] [<code class=Fl>-S</code><var class=Ar>event-spec</var>] [<code class=Fl>-T</code>] [<code class=Fl>-U</code>] [<code class=Fl>-W</code>] [<code class=Fl>-a</code><var class=Ar>pathname</var>] [<code class=Fl>-c</code><var class=Ar>cpu-spec</var>] [<code class=Fl>-d</code>] [<code class=Fl>-e</code>] [<code class=Fl>-f</code><var class=Ar>pluginopt</var>] [<code class=Fl>-g</code>] [<code class=Fl>-i</code><var class=Ar>lwp</var>] [<code class=Fl>-k</code><var class=Ar>kerneldir</var>] [<code class=Fl>-l</code><var class=Ar>secs</var>] [<code class=Fl>-m</code><var class=Ar>pathname</var>] [<code class=Fl>-n</code><var class=Ar>rate</var>] [<code class=Fl>-o</code><var class=Ar>outputfile</var>] [<code class=Fl>-p</code><var class=Ar>event-spec</var>] [<code class=Fl>-q</code>] [<code class=Fl>-r</code><var class=Ar>fsroot</var>] [<code class=Fl>-s</code><var class=Ar>event-spec</var>] [<code class=Fl>-t</code><var class=Ar>process-spec</var>] [<code class=Fl>-u</code><var class=Ar>event-spec</var>] [<code class=Fl>-v</code>] [<code class=Fl>-w</code><var class=Ar>secs</var>] [<code class=Fl>-z</code><var class=Ar>graphdepth</var>] [<var class=Ar>command</var> [<var class=Ar>args</var>]]</td></tr></table></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>pmcstat</code> utility measures system performance using the facilities provided by <a class=Xr href=hwpmc.4.html>hwpmc(4)</a>. <p class=Pp>The <code class=Nm>pmcstat</code> utility can measure both hardware events seen by the system as a whole, and those seen when a specified set of processes are executing on the system's CPUs. If a specific set of processes is being targeted (for example, if the <code class=Fl>-t</code><var class=Ar>process-spec</var> option is specified, or if a command line is specified using <var class=Ar>command</var>), then measurement occurs till <var class=Ar>command</var> exits, or till all target processes specified by the <code class=Fl>-t</code><var class=Ar>process-spec</var> options exit, or till the <code class=Nm>pmcstat</code> utility is interrupted by the user. If a specific set of processes is not targeted for measurement, then <code class=Nm>pmcstat</code> will perform system-wide measurements till interrupted by the user.</p><p class=Pp>A given invocation of <code class=Nm>pmcstat</code> can mix allocations of system-mode and process-mode PMCs, of both counting and sampling flavors. The values of all counting PMCs are printed in human readable form at regular intervals by <code class=Nm>pmcstat</code>. The output of sampling PMCs may be configured to go to a log file for subsequent offline analysis, or, at the expense of greater overhead, may be configured to be printed in text form on the fly.</p><p class=Pp>Hardware events to measure are specified to <code class=Nm>pmcstat</code> using event specifier strings <var class=Ar>event-spec</var>. The syntax of these event specifiers is machine dependent and is documented in <a class=Xr href=pmc.3.html>pmc(3)</a>.</p><p class=Pp>A process-mode PMC may be configured to be inheritable by the target process' current and future children.</p></section><section class=Sh><h2 class=Sh id=OPTIONS><a class=permalink href=#OPTIONS>OPTIONS</a></h2> The following options are available: <dl class=Bl-tag><dt><a class=permalink href=#A><code class=Fl id=A>-A</code></a></dt><dd>Skip symbol lookup and display address instead.</dd><dt><a class=permalink href=#C><code class=Fl id=C>-C</code></a></dt><dd>Toggle between showing cumulative or incremental counts for subsequent counting mode PMCs specified on the command line. The default is to show incremental counts.</dd><dt><a class=permalink href=#D><code class=Fl id=D>-D</code></a><var class=Ar>pathname</var></dt><dd>Create files with per-program samples in the directory named by <var class=Ar>pathname</var>. The default is to create these files in the current directory.</dd><dt><a class=permalink href=#E><code class=Fl id=E>-E</code></a></dt><dd>Toggle showing per-process counts at the time a tracked process exits for subsequent process-mode PMCs specified on the command line. This option is useful for mapping the performance characteristics of a complex pipeline of processes when used in conjunction with the <code class=Fl>-d</code> option. The default is to not to enable per-process tracking.</dd><dt><a class=permalink href=#F><code class=Fl id=F>-F</code></a><var class=Ar>pathname</var></dt><dd>Print calltree (Kcachegrind) information to file <var class=Ar>pathname</var>. If argument <var class=Ar>pathname</var> is a “<code class=Li>-</code>” this information is sent to the output file specified by the <code class=Fl>-o</code> option.</dd><dt><a class=permalink href=#G><code class=Fl id=G>-G</code></a><var class=Ar>pathname</var></dt><dd>Print callchain information to file <var class=Ar>pathname</var>. If argument <var class=Ar>pathname</var> is a “<code class=Li>-</code>” this information is sent to the output file specified by the <code class=Fl>-o</code> option.</dd><dt><a class=permalink href=#I><code class=Fl id=I>-I</code></a></dt><dd>Show the offset of the instruction pointer into the symbol.</dd><dt><a class=permalink href=#L><code class=Fl id=L>-L</code></a></dt><dd>List all event names.</dd><dt><a class=permalink href=#M><code class=Fl id=M>-M</code></a><var class=Ar>mapfilename</var></dt><dd>Write the mapping between executable objects encountered in the event log and the abbreviated pathnames used for <a class=Xr href=gprof.1.html>gprof(1)</a> profiles to file <var class=Ar>mapfilename</var>. If this option is not specified, mapping information is not written. Argument <var class=Ar>mapfilename</var> may be a “<code class=Li>-</code>” in which case this mapping information is sent to the output file configured by the <code class=Fl>-o</code> option.</dd><dt><a class=permalink href=#N><code class=Fl id=N>-N</code></a></dt><dd>Toggle capturing callchain information for subsequent sampling PMCs. The default is for sampling PMCs to capture callchain information.</dd><dt><a class=permalink href=#O><code class=Fl id=O>-O</code></a><var class=Ar>logfilename</var></dt><dd>Send logging output to file <var class=Ar>logfilename</var>. If <var class=Ar>logfilename</var> is of the form <var class=Ar>hostname</var>:<var class=Ar>port</var>, where <var class=Ar>hostname</var> does not start with a ‘<code class=Li>.</code>’ or a ‘<code class=Li>/</code>’, then <code class=Nm>pmcstat</code> will open a network socket to host <var class=Ar>hostname</var> on port <var class=Ar>port</var>. <p class=Pp>If the <code class=Fl>-O</code> option is not specified and one of the logging options is requested, then <code class=Nm>pmcstat</code> will print a textual form of the logged events to the configured output file.</p></dd><dt><a class=permalink href=#P><code class=Fl id=P>-P</code></a><var class=Ar>event-spec</var></dt><dd>Allocate a process mode sampling PMC measuring hardware events specified in <var class=Ar>event-spec</var>.</dd><dt><a class=permalink href=#R><code class=Fl id=R>-R</code></a><var class=Ar>logfilename</var></dt><dd>Perform offline analysis using sampling data in file <var class=Ar>logfilename</var>.</dd><dt><a class=permalink href=#S><code class=Fl id=S>-S</code></a><var class=Ar>event-spec</var></dt><dd>Allocate a system mode sampling PMC measuring hardware events specified in <var class=Ar>event-spec</var>.</dd><dt><a class=permalink href=#T><code class=Fl id=T>-T</code></a></dt><dd>Use a <a class=Xr href=top.1.html>top(1)</a>-like mode for sampling PMCs. The following hotkeys can be used: <p class=Pp></p><div class=Bd-indent><dl class="Bl-tag Bl-compact"><dt><a class=permalink href=#A_2><code class=Ic id=A_2>A</code></a></dt><dd>Toggle symbol resolution</dd><dt><a class=permalink href=#Ctrl_+_a><code class=Ic id=Ctrl_+_a>Ctrl+a</code></a></dt><dd> Switch to accumulative mode</dd><dt><a class=permalink href=#Ctrl_+_d><code class=Ic id=Ctrl_+_d>Ctrl+d</code></a></dt><dd> Switch to delta mode</dd><dt><a class=permalink href=#f><code class=Ic id=f>f</code></a></dt><dd>Represent the “f” cost under threshold as a dot (calltree only)</dd><dt><a class=permalink href=#I_2><code class=Ic id=I_2>I</code></a></dt><dd>Toggle showing offsets into symbols</dd><dt><a class=permalink href=#m><code class=Ic id=m>m</code></a></dt><dd>Merge PMCs</dd><dt><a class=permalink href=#n><code class=Ic id=n>n</code></a></dt><dd>Change view</dd><dt><a class=permalink href=#p><code class=Ic id=p>p</code></a></dt><dd>Show next PMC</dd><dt><a class=permalink href=#q><code class=Ic id=q>q</code></a></dt><dd>Quit</dd><dt><a class=permalink href=#Space><code class=Ic id=Space>Space</code></a></dt><dd>Pause</dd></dl></div></dd><dt><a class=permalink href=#U><code class=Fl id=U>-U</code></a></dt><dd>Toggle capturing user-space call traces while in kernel mode. The default is for sampling PMCs to capture user-space callchain information while in user-space mode, and kernel callchain information while in kernel mode.</dd><dt><a class=permalink href=#W><code class=Fl id=W>-W</code></a></dt><dd>Toggle logging the incremental counts seen by the threads of a tracked process each time they are scheduled on a CPU. This is an experimental feature intended to help analyse the dynamic behaviour of processes in the system. It may incur substantial overhead if enabled. The default is for this feature to be disabled.</dd><dt><a class=permalink href=#a><code class=Fl id=a>-a</code></a><var class=Ar>pathname</var></dt><dd>Perform a symbol and file:line lookup for each address in each callgraph and save the output to <var class=Ar>pathname</var>. Unlike <code class=Fl>-m</code> that only resolves the first symbol in the graph, this resolves every node in the callgraph, or prints out addresses if no lookup information is available. This option requires the <code class=Fl>-R</code> option to read in samples that were previously collected and saved with the <code class=Fl>-O</code> option.</dd><dt><a class=permalink href=#c><code class=Fl id=c>-c</code></a><var class=Ar>cpu-spec</var></dt><dd>Set the cpus for subsequent system mode PMCs specified on the command line to <var class=Ar>cpu-spec</var>. Argument <var class=Ar>cpu-spec</var> is a comma separated list of CPU numbers, or the literal ‘*’ denoting all available CPUs. The default is to allocate system mode PMCs on all available CPUs.</dd><dt><a class=permalink href=#d><code class=Fl id=d>-d</code></a></dt><dd>Toggle between process mode PMCs measuring events for the target process' current and future children or only measuring events for the target process. The default is to measure events for the target process alone. (it has to be passed in the command line prior to <code class=Fl>-p</code>, <code class=Fl>-s</code>, <code class=Fl>-P</code>, or <code class=Fl>-S</code>).</dd><dt><a class=permalink href=#e><code class=Fl id=e>-e</code></a></dt><dd>Specify that the gprof profile files will use a wide history counter. These files are produced in a format compatible with <a class=Xr href=gprof.1.html>gprof(1)</a>. However, other tools that cannot fully parse a BSD-style gmon header might be unable to correctly parse these files.</dd><dt><a class=permalink href=#f_2><code class=Fl id=f_2>-f</code></a><var class=Ar>pluginopt</var></dt><dd>Pass option string to the active plugin. <br> threshold=&lt;float&gt; do not display cost under specified value (Top). <br> skiplink=0|1 replace node with cost under threshold by a dot (Top).</dd><dt><a class=permalink href=#g><code class=Fl id=g>-g</code></a></dt><dd>Produce profiles in a format compatible with <a class=Xr href=gprof.1.html>gprof(1)</a>. A separate profile file is generated for each executable object encountered. Profile files are placed in sub-directories named by their PMC event name.</dd><dt><a class=permalink href=#i><code class=Fl id=i>-i</code></a><var class=Ar>lwp</var></dt><dd>Filter on thread ID <var class=Ar>lwp</var>, which you can get from <a class=Xr href=ps.1.html>ps(1)</a><code class=Fl>-o</code><code class=Li>lwp</code>.</dd><dt><a class=permalink href=#k><code class=Fl id=k>-k</code></a><var class=Ar>kerneldir</var></dt><dd>Set the pathname of the kernel directory to argument <var class=Ar>kerneldir</var>. This directory specifies where <code class=Nm>pmcstat</code> should look for the kernel and its modules. The default is to use the path of the running kernel obtained from the <var class=Va>kern.bootfile</var> sysctl. Modules will also be searched for in /boot/modules if not found in <var class=Ar>kerneldir</var>.</dd><dt><a class=permalink href=#l><code class=Fl id=l>-l</code></a><var class=Ar>secs</var></dt><dd>Set system-wide performance measurement duration for <var class=Ar>secs</var> seconds. The argument <var class=Ar>secs</var> may be a fractional value.</dd><dt><a class=permalink href=#m_2><code class=Fl id=m_2>-m</code></a><var class=Ar>pathname</var></dt><dd>Print the sampled PCs with the name, the start and ending addresses of the function within they live. The <var class=Ar>pathname</var> argument is mandatory and indicates where the information will be stored. If argument <var class=Ar>pathname</var> is a “<code class=Li>-</code>” this information is sent to the output file specified by the <code class=Fl>-o</code> option. This option requires the <code class=Fl>-R</code> option to read in samples that were previously collected and saved with the <code class=Fl>-O</code> option.</dd><dt><a class=permalink href=#n_2><code class=Fl id=n_2>-n</code></a><var class=Ar>rate</var></dt><dd>Set the default sampling rate for subsequent sampling mode PMCs specified on the command line. The default is to configure PMCs to sample the CPU's instruction pointer every 65536 events.</dd><dt><a class=permalink href=#o><code class=Fl id=o>-o</code></a><var class=Ar>outputfile</var></dt><dd>Send counter readings and textual representations of logged data to file <var class=Ar>outputfile</var>. The default is to send output to <span class=Pa>stderr</span> when collecting live data and to <span class=Pa>stdout</span> when processing a pre-existing logfile.</dd><dt><a class=permalink href=#p_2><code class=Fl id=p_2>-p</code></a><var class=Ar>event-spec</var></dt><dd>Allocate a process mode counting PMC measuring hardware events specified in <var class=Ar>event-spec</var>.</dd><dt><a class=permalink href=#q_2><code class=Fl id=q_2>-q</code></a></dt><dd>Decrease verbosity.</dd><dt><a class=permalink href=#r><code class=Fl id=r>-r</code></a><var class=Ar>fsroot</var></dt><dd>Set the top of the filesystem hierarchy under which executables are located to argument <var class=Ar>fsroot</var>. The default is <span class=Pa>/</span>.</dd><dt><a class=permalink href=#s><code class=Fl id=s>-s</code></a><var class=Ar>event-spec</var></dt><dd>Allocate a system mode counting PMC measuring hardware events specified in <var class=Ar>event-spec</var>.</dd><dt><a class=permalink href=#t><code class=Fl id=t>-t</code></a><var class=Ar>process-spec</var></dt><dd>Attach process mode PMCs to the processes named by argument <var class=Ar>process-spec</var>. Argument <var class=Ar>process-spec</var> may be a non-negative integer denoting a specific process id, or a regular expression for selecting processes based on their command names.</dd><dt><a class=permalink href=#u><code class=Fl id=u>-u</code></a><var class=Ar>event-spec</var></dt><dd>Provide short description of event.</dd><dt><a class=permalink href=#v><code class=Fl id=v>-v</code></a></dt><dd>Increase verbosity.</dd><dt><a class=permalink href=#w><code class=Fl id=w>-w</code></a><var class=Ar>secs</var></dt><dd>Print the values of all counting mode PMCs or sampling mode PMCs for top mode every <var class=Ar>secs</var> seconds. The argument <var class=Ar>secs</var> may be a fractional value. The default interval is 5 seconds.</dd><dt><a class=permalink href=#z><code class=Fl id=z>-z</code></a><var class=Ar>graphdepth</var></dt><dd>When printing system-wide callgraphs, limit callgraphs to the depth specified by argument <var class=Ar>graphdepth</var>.</dd></dl><p class=Pp>If <var class=Ar>command</var> is specified, it is executed using <a class=Xr href=execvp.3.html>execvp(3)</a>.</p></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> To perform system-wide statistical sampling on an AMD Athlon CPU with samples taken every 32768 instruction retirals and data being sampled to file <span class=Pa>sample.stat</span>, use: <div class="Bd Bd-indent"><code class=Li>pmcstat -O sample.stat -n 32768 -S k7-retired-instructions</code></div><p class=Pp>To execute <code class=Nm>firefox</code> and measure the number of data cache misses suffered by it and its children every 12 seconds on an AMD Athlon, use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -d -w 12 -p k7-dc-misses firefox</code></div><p class=Pp>To measure instructions retired for all processes named “emacs” use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -t '^emacs$' -p instructions</code></div><p class=Pp>To measure instructions retired for processes named “emacs” for a period of 10 seconds use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -t '^emacs$' -p instructions sleep 10</code></div><p class=Pp>To count instruction tlb-misses on CPUs 0 and 2 on a Intel Pentium Pro/Pentium III SMP system use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -c 0,2 -s p6-itlb-miss</code></div><p class=Pp>To collect profiling information for a specific process with pid 1234 based on instruction cache misses seen by it use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -P ic-misses -t 1234 -O /tmp/sample.out</code></div><p class=Pp>To perform system-wide sampling on all configured processors based on processor instructions retired use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -S instructions -O /tmp/sample.out</code></div> If callgraph capture is not desired use: <div class="Bd Bd-indent"><code class=Li>pmcstat -N -S instructions -O /tmp/sample.out</code></div><p class=Pp>To send the generated event log to a remote machine use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -S instructions -O remotehost:port</code></div> On the remote machine, the sample log can be collected using <a class=Xr href=nc.1.html>nc(1)</a>: <div class="Bd Bd-indent"><code class=Li>nc -l remotehost port &gt; /tmp/sample.out</code></div><p class=Pp>To generate <a class=Xr href=gprof.1.html>gprof(1)</a> compatible profiles from a sample file use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -R /tmp/sample.out -g</code></div><p class=Pp>To print a system-wide profile with callgraphs to file <span class=Pa>foo.graph</span> use:</p><div class="Bd Bd-indent"><code class=Li>pmcstat -R /tmp/sample.out -G foo.graph</code></div></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2> If option <code class=Fl>-v</code> is specified, <code class=Nm>pmcstat</code> may issue the following diagnostic messages: <dl class=Bl-diag><dt>#callchain/dubious-frames</dt><dd>The number of callchain records that had an “impossible” value for a return address.</dd><dt>#exec handling errors</dt><dd>The number of <a class=Xr href=exec.2.html>exec(2)</a> events in the log file that named executables that could not be analyzed.</dd><dt>#exec/elf</dt><dd>The number of <a class=Xr href=exec.2.html>exec(2)</a> events that named ELF executables.</dd><dt>#exec/unknown</dt><dd>The number of <a class=Xr href=exec.2.html>exec(2)</a> events that named executables with unrecognized formats.</dd><dt>#samples/total</dt><dd>The total number of samples in the log file.</dd><dt>#samples/unclaimed</dt><dd>The number of samples that could not be correlated to a known executable object (i.e., to an executable, shared library, the kernel or the runtime loader).</dd><dt>#samples/unknown-object</dt><dd>The number of samples that were associated with an executable with an unrecognized object format.</dd></dl><p class=Pp><br> The <code class=Nm>pmcstat</code> utility exits 0 on success, and &gt;0 if an error occurs.</p></section><section class=Sh><h2 class=Sh id=COMPATIBILITY><a class=permalink href=#COMPATIBILITY>COMPATIBILITY</a></h2> Due to the limitations of the <span class=Pa>gmon.out</span> file format, <a class=Xr href=gprof.1.html>gprof(1)</a> compatible profiles generated by the <code class=Fl>-g</code> option do not contain information about calls that cross executable boundaries. The generated <span class=Pa>gmon.out</span> files are also only meaningful for native executables. </section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=gprof.1.html>gprof(1)</a>, <a class=Xr href=nc.1.html>nc(1)</a>, <a class=Xr href=execvp.3.html>execvp(3)</a>, <a class=Xr href=pmc.3.html>pmc(3)</a>, <a class=Xr href=pmclog.3.html>pmclog(3)</a>, <a class=Xr href=hwpmc.4.html>hwpmc(4)</a>, <a class=Xr href=pmccontrol.8.html>pmccontrol(8)</a>, <a class=Xr href=sysctl.8.html>sysctl(8)</a></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>pmcstat</code> utility first appeared in <span class=Ux>FreeBSD 6.0</span>. It is currently under development. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Joseph Koshy</span> &lt;<a class=Mt href=mailto:jkoshy@FreeBSD.org>jkoshy@FreeBSD.org</a>&gt; </section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> The <code class=Nm>pmcstat</code> utility cannot yet analyse <a class=Xr href=hwpmc.4.html>hwpmc(4)</a> logs generated by non-native architectures. </section></div><table class=foot><tr><td class=foot-date>August 17, 2020</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>