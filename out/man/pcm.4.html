<!DOCTYPE html>
<html><head><meta charset=utf-8><title>pcm(4)</title><keywords content=man,pcm></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>pcm(4)</h1><table class=head><tr><td class=head-ltitle>SOUND(4)</td><td class=head-vol>FreeBSD Kernel Interfaces Manual</td><td class=head-rtitle>SOUND(4)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>sound</code>, <code class=Nm>pcm</code>, <code class=Nm>snd</code> — <div class=Nd><span class=Ux>FreeBSD</span> PCM audio device infrastructure</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2> To compile this driver into the kernel, place the following line in your kernel configuration file: <div class="Bd Pp Bd-indent"><code class=Cd>device sound</code></div></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The <code class=Nm>sound</code> driver is the main component of the <span class=Ux>FreeBSD</span> sound system. It works in conjunction with a bridge device driver on supported devices and provides PCM audio record and playback once it attaches. Each bridge device driver supports a specific set of audio chipsets and needs to be enabled together with the <code class=Nm>sound</code> driver. PCI and ISA PnP audio devices identify themselves so users are usually not required to add anything to <span class=Pa>/boot/device.hints</span>. <p class=Pp>Some of the main features of the <code class=Nm>sound</code> driver are: multichannel audio, per-application volume control, dynamic mixing through virtual sound channels, true full duplex operation, bit perfect audio, rate conversion and low latency modes.</p><p class=Pp>The <code class=Nm>sound</code> driver is enabled by default, along with several bridge device drivers. Those not enabled by default can be loaded during runtime with <a class=Xr href=kldload.8.html>kldload(8)</a> or during boot via <a class=Xr href=loader.conf.5.html>loader.conf(5)</a>. The following bridge device drivers are available:</p><p class=Pp></p><ul class="Bl-bullet Bl-compact"><li><a class=Xr href=snd_ai2s.4.html>snd_ai2s(4)</a> (enabled by default on powerpc)</li><li><a class=Xr href=snd_als4000.4.html>snd_als4000(4)</a></li><li><a class=Xr href=snd_atiixp.4.html>snd_atiixp(4)</a></li><li><a class=Xr href=snd_cmi.4.html>snd_cmi(4)</a> (enabled by default on amd64, i386)</li><li><a class=Xr href=snd_cs4281.4.html>snd_cs4281(4)</a></li><li><a class=Xr href=snd_csa.4.html>snd_csa(4)</a> (enabled by default on amd64, i386)</li><li><a class=Xr href=snd_davbus.4.html>snd_davbus(4)</a> (enabled by default on powerpc)</li><li><a class=Xr href=snd_emu10k1.4.html>snd_emu10k1(4)</a></li><li><a class=Xr href=snd_emu10kx.4.html>snd_emu10kx(4)</a> (enabled by default on amd64, i386)</li><li><a class=Xr href=snd_envy24.4.html>snd_envy24(4)</a></li><li><a class=Xr href=snd_envy24ht.4.html>snd_envy24ht(4)</a></li><li><a class=Xr href=snd_es137x.4.html>snd_es137x(4)</a> (enabled by default on amd64, i386)</li><li><a class=Xr href=snd_fm801.4.html>snd_fm801(4)</a></li><li><a class=Xr href=snd_hda.4.html>snd_hda(4)</a> (enabled by default on amd64, i386)</li><li><a class=Xr href=snd_hdspe.4.html>snd_hdspe(4)</a></li><li><a class=Xr href=snd_ich.4.html>snd_ich(4)</a> (enabled by default on amd64, i386)</li><li><a class=Xr href=snd_maestro3.4.html>snd_maestro3(4)</a></li><li><a class=Xr href=snd_neomagic.4.html>snd_neomagic(4)</a></li><li><a class=Xr href=snd_solo.4.html>snd_solo(4)</a></li><li><a class=Xr href=snd_spicds.4.html>snd_spicds(4)</a></li><li><a class=Xr href=snd_uaudio.4.html>snd_uaudio(4)</a> (enabled by default on amd64, i386, powerpc)</li><li><a class=Xr href=snd_via8233.4.html>snd_via8233(4)</a> (enabled by default on amd64, i386)</li><li><a class=Xr href=snd_via82c686.4.html>snd_via82c686(4)</a></li><li><a class=Xr href=snd_vibes.4.html>snd_vibes(4)</a></li></ul><p class=Pp>Refer to the manual page for each bridge device driver for driver specific settings and information.</p><section class=Ss><h2 class=Ss id=Legacy_Hardware><a class=permalink href=#Legacy_Hardware>Legacy Hardware</a></h2> For old legacy ISA cards, the driver looks for MSS cards at addresses <code class=Dv>0x530</code> and <code class=Dv>0x604</code>. These values can be overridden in <span class=Pa>/boot/device.hints</span>. Non-PnP sound cards require the following lines in <a class=Xr href=device.hints.5.html>device.hints(5)</a>: <div class="Bd Pp Bd-indent"><pre>
hint.pcm.0.at="isa"
hint.pcm.0.irq="5"
hint.pcm.0.drq="1"
hint.pcm.0.flags="0x0"
</pre></div><p class=Pp>Apart from the usual parameters, the flags field is used to specify the secondary DMA channel (generally used for capture in full duplex cards). Flags are set to 0 for cards not using a secondary DMA channel, or to 0x10 + C to specify channel C.</p></section><section class=Ss><h2 class=Ss id=Boot_Variables><a class=permalink href=#Boot_Variables>Boot Variables</a></h2> In general, the module <span class=Pa>snd_foo</span> corresponds to <code class=Cd>device snd_foo</code> and can be loaded by the boot <a class=Xr href=loader.8.html>loader(8)</a> via <a class=Xr href=loader.conf.5.html>loader.conf(5)</a> or from the command line using the <a class=Xr href=kldload.8.html>kldload(8)</a> utility. Options which can be specified in <span class=Pa>/boot/loader.conf</span> include: <div class=Bd-indent><dl class=Bl-tag><dt><var class=Va>snd_driver_load</var></dt><dd>(“<code class=Li>NO</code>”) If set to “<code class=Li>YES</code>”, this option loads all available drivers.</dd><dt><var class=Va>snd_hda_load</var></dt><dd>(“<code class=Li>NO</code>”) If set to “<code class=Li>YES</code>”, only the Intel High Definition Audio bridge device driver and dependent modules will be loaded.</dd><dt><var class=Va>snd_foo_load</var></dt><dd>(“<code class=Li>NO</code>”) If set to “<code class=Li>YES</code>”, load driver for card/chipset foo.</dd></dl></div><p class=Pp>To define default values for the different mixer channels, set the channel to the preferred value using hints, e.g.: <var class=Va>hint.pcm.0.line</var>=“<code class=Li>0</code>”. This will mute the input channel per default.</p></section><section class=Ss><h2 class=Ss id=Multichannel_Audio><a class=permalink href=#Multichannel_Audio>Multichannel Audio</a></h2> Multichannel audio, popularly referred to as “surround sound” is supported and enabled by default. The FreeBSD multichannel matrix processor supports up to 18 interleaved channels, but the limit is currently set to 8 channels (as commonly used for 7.1 surround sound). The internal matrix mapping can handle reduction, expansion or re-routing of channels. This provides a base interface for related multichannel <code class=Fn>ioctl</code>() support. Multichannel audio works both with and without VCHANs. <p class=Pp>Most bridge device drivers are still missing multichannel matrixing support, but in most cases this should be trivial to implement. Use the <var class=Va>dev.pcm.%d.[play|rec].vchanformat</var><a class=Xr href=sysctl.8.html>sysctl(8)</a> to adjust the number of channels used. The current multichannel interleaved structure and arrangement was implemented by inspecting various popular UNIX applications. There were no single standard, so much care has been taken to try to satisfy each possible scenario, despite the fact that each application has its own conflicting standard.</p></section><section class=Ss><h2 class=Ss id=EQ><a class=permalink href=#EQ>EQ</a></h2> The Parametric Software Equalizer (EQ) enables the use of “tone” controls (bass and treble). Commonly used for ear-candy or frequency compensation due to the vast difference in hardware quality. EQ is disabled by default, but can be enabled with the <var class=Va>hint.pcm.%d.eq</var> tunable. </section><section class=Ss><h2 class=Ss id=VCHANs><a class=permalink href=#VCHANs>VCHANs</a></h2> Each device can optionally support more playback and recording channels than physical hardware provides by using “virtual channels” or VCHANs. VCHAN options can be configured via the <a class=Xr href=sysctl.8.html>sysctl(8)</a> interface but can only be manipulated while the device is inactive. </section><section class=Ss><h2 class=Ss id=VPC><a class=permalink href=#VPC>VPC</a></h2> FreeBSD supports independent and individual volume controls for each active application, without touching the master <code class=Nm>sound</code> volume. This is sometimes referred to as Volume Per Channel (VPC). The VPC feature is enabled by default. </section><section class=Ss><h2 class=Ss id=Loader_Tunables><a class=permalink href=#Loader_Tunables>Loader Tunables</a></h2> The following loader tunables are used to set driver configuration at the <a class=Xr href=loader.8.html>loader(8)</a> prompt before booting the kernel, or they can be stored in <span class=Pa>/boot/loader.conf</span> in order to automatically set them before booting the kernel. It is also possible to use <a class=Xr href=kenv.1.html>kenv(1)</a> to change these tunables before loading the <code class=Nm>sound</code> driver. The following tunables can not be changed during runtime using <a class=Xr href=sysctl.8.html>sysctl(8)</a>. <dl class=Bl-tag><dt><var class=Va>hint.pcm.%d.eq</var></dt><dd>Set to 1 or 0 to explicitly enable (1) or disable (0) the equalizer. Requires a driver reload if changed. Enabling this will make bass and treble controls appear in mixer applications. This tunable is undefined by default. Equalizing is disabled by default.</dd><dt><var class=Va>hint.pcm.%d.vpc</var></dt><dd>Set to 1 or 0 to explicitly enable (1) or disable (0) the VPC feature. This tunable is undefined by default. VPC is however enabled by default.</dd></dl></section><section class=Ss><h2 class=Ss id=Runtime_Configuration><a class=permalink href=#Runtime_Configuration>Runtime Configuration</a></h2> There are a number of <a class=Xr href=sysctl.8.html>sysctl(8)</a> variables available which can be modified during runtime. These values can also be stored in <span class=Pa>/etc/sysctl.conf</span> in order to automatically set them during the boot process. <var class=Va>hw.snd.*</var> are global settings and <var class=Va>dev.pcm.*</var> are device specific. <dl class=Bl-tag><dt><var class=Va>hw.snd.compat_linux_mmap</var></dt><dd>Linux <a class=Xr href=mmap.2.html>mmap(2)</a> compatibility. The following values are supported (default is 0): <dl class=Bl-tag><dt>-1</dt><dd>Force disabling/denying PROT_EXEC <a class=Xr href=mmap.2.html>mmap(2)</a> requests.</dd><dt>0</dt><dd>Auto detect proc/ABI type, allow <a class=Xr href=mmap.2.html>mmap(2)</a> for Linux applications, and deny for everything else.</dd><dt>1</dt><dd>Always allow PROT_EXEC page mappings.</dd></dl></dd><dt><var class=Va>hw.snd.default_auto</var></dt><dd>Automatically assign the default sound unit. The following values are supported (default is 1): <dl class=Bl-tag><dt>0</dt><dd>Do not assign the default sound unit automatically.</dd><dt>1</dt><dd>Use the best available sound device based on playing and recording capabilities of the device.</dd><dt>2</dt><dd>Use the most recently attached device.</dd></dl></dd><dt><var class=Va>hw.snd.default_unit</var></dt><dd>Default sound card for systems with multiple sound cards. When using <a class=Xr href=devfs.5.html>devfs(5)</a>, the default device for <span class=Pa>/dev/dsp</span>. Equivalent to a symlink from <span class=Pa>/dev/dsp</span> to <span class=Pa>/dev/dsp</span><var class=Va>${hw.snd.default_unit}</var>.</dd><dt><var class=Va>hw.snd.feeder_eq_exact_rate</var></dt><dd>Only certain rates are allowed for precise processing. The default behavior is however to allow sloppy processing for all rates, even the unsupported ones. Enable to toggle this requirement and only allow processing for supported rates.</dd><dt><var class=Va>hw.snd.feeder_rate_max</var></dt><dd>Maximum allowable sample rate.</dd><dt><var class=Va>hw.snd.feeder_rate_min</var></dt><dd>Minimum allowable sample rate.</dd><dt><var class=Va>hw.snd.feeder_rate_polyphase_max</var></dt><dd>Adjust to set the maximum number of allowed polyphase entries during the process of building resampling filters. Disabling polyphase resampling has the benefit of reducing memory usage, at the expense of slower and lower quality conversion. Only applicable when the SINC interpolator is used. Default value is 183040. Set to 0 to disable polyphase resampling.</dd><dt><var class=Va>hw.snd.feeder_rate_quality</var></dt><dd>Sample rate converter quality. Default value is 1, linear interpolation. Available options include: <dl class=Bl-tag><dt>0</dt><dd>Zero Order Hold, ZOH. Very fast, but with poor quality.</dd><dt>1</dt><dd>Linear interpolation. Fast, quality is subject to personal preference. Technically the quality is poor however, due to the lack of anti-aliasing filtering.</dd><dt>2</dt><dd>Bandlimited SINC interpolator. Implements polyphase banking to boost the conversion speed, at the cost of memory usage, with multiple high quality polynomial interpolators to improve the conversion accuracy. 100% fixed point, 64bit accumulator with 32bit coefficients and high precision sample buffering. Quality values are 100dB stopband, 8 taps and 85% bandwidth.</dd><dt>3</dt><dd>Continuation of the bandlimited SINC interpolator, with 100dB stopband, 36 taps and 90% bandwidth as quality values.</dd><dt>4</dt><dd>Continuation of the bandlimited SINC interprolator, with 100dB stopband, 164 taps and 97% bandwidth as quality values.</dd></dl></dd><dt><var class=Va>hw.snd.feeder_rate_round</var></dt><dd>Sample rate rounding threshold, to avoid large prime division at the cost of accuracy. All requested sample rates will be rounded to the nearest threshold value. Possible values range between 0 (disabled) and 500. Default is 25.</dd><dt><var class=Va>hw.snd.latency</var></dt><dd>Configure the buffering latency. Only affects applications that do not explicitly request blocksize / fragments. This tunable provides finer granularity than the <var class=Va>hw.snd.latency_profile</var> tunable. Possible values range between 0 (lowest latency) and 10 (highest latency).</dd><dt><var class=Va>hw.snd.latency_profile</var></dt><dd>Define sets of buffering latency conversion tables for the <var class=Va>hw.snd.latency</var> tunable. A value of 0 will use a low and aggressive latency profile which can result in possible underruns if the application cannot keep up with a rapid irq rate, especially during high workload. The default value is 1, which is considered a moderate/safe latency profile.</dd><dt><var class=Va>hw.snd.maxautovchans</var></dt><dd>Global VCHAN setting that only affects devices with at least one playback or recording channel available. The sound system will dynamically create up to this many VCHANs. Set to “0” if no VCHANs are desired. Maximum value is 256.</dd><dt><var class=Va>hw.snd.report_soft_formats</var></dt><dd>Controls the internal format conversion if it is available transparently to the application software. When disabled or not available, the application will only be able to select formats the device natively supports.</dd><dt><var class=Va>hw.snd.report_soft_matrix</var></dt><dd>Enable seamless channel matrixing even if the hardware does not support it. Makes it possible to play multichannel streams even with a simple stereo sound card.</dd><dt><var class=Va>hw.snd.verbose</var></dt><dd>Level of verbosity for the <span class=Pa>/dev/sndstat</span> device. Higher values include more output and the highest level, four, should be used when reporting problems. Other options include: <dl class=Bl-tag><dt>0</dt><dd>Installed devices and their allocated bus resources.</dd><dt>1</dt><dd>The number of playback, record, virtual channels, and flags per device.</dd><dt>2</dt><dd>Channel information per device including the channel's current format, speed, and pseudo device statistics such as buffer overruns and buffer underruns.</dd><dt>3</dt><dd>File names and versions of the currently loaded sound modules.</dd><dt>4</dt><dd>Various messages intended for debugging.</dd></dl></dd><dt><var class=Va>hw.snd.vpc_0db</var></dt><dd>Default value for <code class=Nm>sound</code> volume. Increase to give more room for attenuation control. Decrease for more amplification, with the possible cost of sound clipping.</dd><dt><var class=Va>hw.snd.vpc_autoreset</var></dt><dd>When a channel is closed the channel volume will be reset to 0db. This means that any changes to the volume will be lost. Enabling this will preserve the volume, at the cost of possible confusion when applications tries to re-open the same device.</dd><dt><var class=Va>hw.snd.vpc_mixer_bypass</var></dt><dd>The recommended way to use the VPC feature is to teach applications to use the correct <code class=Fn>ioctl</code>(): <code class=Dv>SNDCTL_DSP_GETPLAYVOL, SNDCTL_DSP_SETPLAYVOL,</code><code class=Dv>SNDCTL_DSP_SETRECVOL, SNDCTL_DSP_SETRECVOL.</code> This is however not always possible. Enable this to allow applications to use their own existing mixer logic to control their own channel volume.</dd><dt><var class=Va>hw.snd.vpc_reset</var></dt><dd>Enable to restore all channel volumes back to the default value of 0db.</dd><dt><var class=Va>dev.pcm.%d.bitperfect</var></dt><dd>Enable or disable bitperfect mode. When enabled, channels will skip all dsp processing, such as channel matrixing, rate converting and equalizing. The pure <code class=Nm>sound</code> stream will be fed directly to the hardware. If VCHANs are enabled, the bitperfect mode will use the VCHAN format/rate as the definitive format/rate target. The recommended way to use bitperfect mode is to disable VCHANs and enable this sysctl. Default is disabled.</dd><dt><var class=Va>dev.pcm.%d.[play|rec].vchans</var></dt><dd>The current number of VCHANs allocated per device. This can be set to preallocate a certain number of VCHANs. Setting this value to “0” will disable VCHANs for this device.</dd><dt><var class=Va>dev.pcm.%d.[play|rec].vchanformat</var></dt><dd>Format for VCHAN mixing. All playback paths will be converted to this format before the mixing process begins. By default only 2 channels are enabled. Available options include: <dl class=Bl-tag><dt>s16le:1.0</dt><dd>Mono.</dd><dt>s16le:2.0</dt><dd>Stereo, 2 channels (left, right).</dd><dt>s16le:2.1</dt><dd>3 channels (left, right, LFE).</dd><dt>s16le:3.0</dt><dd>3 channels (left, right, rear center).</dd><dt>s16le:4.0</dt><dd>Quadraphonic, 4 channels (front/rear left and right).</dd><dt>s16le:4.1</dt><dd>5 channels (4.0 + LFE).</dd><dt>s16le:5.0</dt><dd>5 channels (4.0 + center).</dd><dt>s16le:5.1</dt><dd>6 channels (4.0 + center + LFE).</dd><dt>s16le:6.0</dt><dd>6 channels (4.0 + front/rear center).</dd><dt>s16le:6.1</dt><dd>7 channels (6.0 + LFE).</dd><dt>s16le:7.1</dt><dd>8 channels (4.0 + center + LFE + left and right side).</dd></dl></dd><dt><var class=Va>dev.pcm.%d.[play|rec].vchanmode</var></dt><dd>VCHAN format/rate selection. Available options include: <dl class=Bl-tag><dt>fixed</dt><dd>Channel mixing is done using fixed format/rate. Advanced operations such as digital passthrough will not work. Can be considered as a “legacy” mode. This is the default mode for hardware channels which lack support for digital formats.</dd><dt>passthrough</dt><dd>Channel mixing is done using fixed format/rate, but advanced operations such as digital passthrough also work. All channels will produce sound as usual until a digital format playback is requested. When this happens all other channels will be muted and the latest incoming digital format will be allowed to pass through undisturbed. Multiple concurrent digital streams are supported, but the latest stream will take precedence and mute all other streams.</dd><dt>adaptive</dt><dd>Works like the “passthrough” mode, but is a bit smarter, especially for multiple <code class=Nm>sound</code> channels with different format/rate. When a new channel is about to start, the entire list of virtual channels will be scanned, and the channel with the best format/rate (usually the highest/biggest) will be selected. This ensures that mixing quality depends on the best channel. The downside is that the hardware DMA mode needs to be restarted, which may cause annoying pops or clicks.</dd></dl></dd><dt><var class=Va>dev.pcm.%d.[play|rec].vchanrate</var></dt><dd>Sample rate speed for VCHAN mixing. All playback paths will be converted to this sample rate before the mixing process begins.</dd><dt><var class=Va>dev.pcm.%d.polling</var></dt><dd>Experimental polling mode support where the driver operates by querying the device state on each tick using a <a class=Xr href=callout.9.html>callout(9)</a> mechanism. Disabled by default and currently only available for a few device drivers.</dd></dl></section><section class=Ss><h2 class=Ss id=Recording_Channels><a class=permalink href=#Recording_Channels>Recording Channels</a></h2> On devices that have more than one recording source (ie: mic and line), there is a corresponding <span class=Pa>/dev/dsp%d.r%d</span> device. The <a class=Xr href=mixer.8.html>mixer(8)</a> utility can be used to start and stop recording from an specific device. </section><section class=Ss><h2 class=Ss id=Statistics><a class=permalink href=#Statistics>Statistics</a></h2> Channel statistics are only kept while the device is open. So with situations involving overruns and underruns, consider the output while the errant application is open and running. </section><section class=Ss><h2 class=Ss id=IOCTL_Support><a class=permalink href=#IOCTL_Support>IOCTL Support</a></h2> The driver supports most of the OSS <code class=Fn>ioctl</code>() functions, and most applications work unmodified. A few differences exist, while memory mapped playback is supported natively and in Linux emulation, memory mapped recording is not due to VM system design. As a consequence, some applications may need to be recompiled with a slightly modified audio module. See <code class=In>&lt;<a class=In href=../src/sys/soundcard.h.html>sys/soundcard.h</a>&gt;</code> for a complete list of the supported <code class=Fn>ioctl</code>() functions. </section></section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2> The <code class=Nm>sound</code> drivers may create the following device nodes: <p class=Pp></p><dl class="Bl-tag Bl-compact"><dt><span class=Pa>/dev/audio%d.%d</span></dt><dd>Sparc-compatible audio device.</dd><dt><span class=Pa>/dev/dsp%d.%d</span></dt><dd>Digitized voice device.</dd><dt><span class=Pa>/dev/dspW%d.%d</span></dt><dd>Like <span class=Pa>/dev/dsp</span>, but 16 bits per sample.</dd><dt><span class=Pa>/dev/dsp%d.p%d</span></dt><dd>Playback channel.</dd><dt><span class=Pa>/dev/dsp%d.r%d</span></dt><dd>Record channel.</dd><dt><span class=Pa>/dev/dsp%d.vp%d</span></dt><dd>Virtual playback channel.</dd><dt><span class=Pa>/dev/dsp%d.vr%d</span></dt><dd>Virtual recording channel.</dd><dt><span class=Pa>/dev/sndstat</span></dt><dd>Current <code class=Nm>sound</code> status, including all channels and drivers.</dd></dl><p class=Pp>The first number in the device node represents the unit number of the <code class=Nm>sound</code> device. All <code class=Nm>sound</code> devices are listed in <span class=Pa>/dev/sndstat</span>. Additional messages are sometimes recorded when the device is probed and attached, these messages can be viewed with the <a class=Xr href=dmesg.8.html>dmesg(8)</a> utility.</p><p class=Pp>The above device nodes are only created on demand through the dynamic <a class=Xr href=devfs.5.html>devfs(5)</a> clone handler. Users are strongly discouraged to access them directly. For specific sound card access, please instead use <span class=Pa>/dev/dsp</span> or <span class=Pa>/dev/dsp%d</span>.</p></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> Use the sound metadriver to load all <code class=Nm>sound</code> bridge device drivers at once (for example if it is unclear which the correct driver to use is): <p class=Pp></p><div class="Bd Bd-indent"><code class=Li>kldload snd_driver</code></div><p class=Pp>Load a specific bridge device driver, in this case the Intel High Definition Audio driver:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>kldload snd_hda</code></div><p class=Pp>Check the status of all detected <code class=Nm>sound</code> devices:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>cat /dev/sndstat</code></div><p class=Pp>Change the default sound device, in this case to the second device. This is handy if there are multiple <code class=Nm>sound</code> devices available:</p><p class=Pp></p><div class="Bd Bd-indent"><code class=Li>sysctl hw.snd.default_unit=1</code></div></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2><dl class=Bl-diag><dt>pcm%d:play:%d:dsp%d.p%d: play interrupt timeout, channel dead</dt><dd>The hardware does not generate interrupts to serve incoming (play) or outgoing (record) data.</dd><dt>unsupported subdevice XX</dt><dd>A device node is not created properly.</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=snd_ai2s.4.html>snd_ai2s(4)</a>, <a class=Xr href=snd_als4000.4.html>snd_als4000(4)</a>, <a class=Xr href=snd_atiixp.4.html>snd_atiixp(4)</a>, <a class=Xr href=snd_cmi.4.html>snd_cmi(4)</a>, <a class=Xr href=snd_cs4281.4.html>snd_cs4281(4)</a>, <a class=Xr href=snd_csa.4.html>snd_csa(4)</a>, <a class=Xr href=snd_davbus.4.html>snd_davbus(4)</a>, <a class=Xr href=snd_emu10k1.4.html>snd_emu10k1(4)</a>, <a class=Xr href=snd_emu10kx.4.html>snd_emu10kx(4)</a>, <a class=Xr href=snd_envy24.4.html>snd_envy24(4)</a>, <a class=Xr href=snd_envy24ht.4.html>snd_envy24ht(4)</a>, <a class=Xr href=snd_es137x.4.html>snd_es137x(4)</a>, <a class=Xr href=snd_fm801.4.html>snd_fm801(4)</a>, <a class=Xr href=snd_hda.4.html>snd_hda(4)</a>, <a class=Xr href=snd_hdspe.4.html>snd_hdspe(4)</a>, <a class=Xr href=snd_ich.4.html>snd_ich(4)</a>, <a class=Xr href=snd_maestro3.4.html>snd_maestro3(4)</a>, <a class=Xr href=snd_neomagic.4.html>snd_neomagic(4)</a>, <a class=Xr href=snd_solo.4.html>snd_solo(4)</a>, <a class=Xr href=snd_spicds.4.html>snd_spicds(4)</a>, <a class=Xr href=snd_t4dwave.4.html>snd_t4dwave(4)</a>, <a class=Xr href=snd_uaudio.4.html>snd_uaudio(4)</a>, <a class=Xr href=snd_via8233.4.html>snd_via8233(4)</a>, <a class=Xr href=snd_via82c686.4.html>snd_via82c686(4)</a>, <a class=Xr href=snd_vibes.4.html>snd_vibes(4)</a>, <a class=Xr href=devfs.5.html>devfs(5)</a>, <a class=Xr href=device.hints.5.html>device.hints(5)</a>, <a class=Xr href=loader.conf.5.html>loader.conf(5)</a>, <a class=Xr href=dmesg.8.html>dmesg(8)</a>, <a class=Xr href=kldload.8.html>kldload(8)</a>, <a class=Xr href=mixer.8.html>mixer(8)</a>, <a class=Xr href=sysctl.8.html>sysctl(8)</a><p class=Pp><cite class=Rs><span class=RsT>Cookbook formulae for audio EQ biquad filter coefficients (Audio-EQ-Cookbook.txt), by Robert Bristow-Johnson</span>, <a class=RsU href=https://www.musicdsp.org/en/latest/Filters/197-rbj-audio-eq-cookbook.html>https://www.musicdsp.org/en/latest/Filters/197-rbj-audio-eq-cookbook.html</a>.</cite></p><p class=Pp><cite class=Rs><span class=RsT>Julius O'Smith's Digital Audio Resampling</span>, <a href=http://ccrma.stanford.edu/~jos/resample/ class=RsU>http://ccrma.stanford.edu/~jos/resample/</a>.</cite></p><p class=Pp><cite class=Rs><span class=RsT>Polynomial Interpolators for High-Quality Resampling of Oversampled Audio, by Olli Niemitalo</span>, <a class=RsU href=http://yehar.com/blog/wp-content/uploads/2009/08/deip.pdf>http://yehar.com/blog/wp-content/uploads/2009/08/deip.pdf</a>.</cite></p><p class=Pp><cite class=Rs><span class=RsT>The OSS API</span>, <a class=RsU href=http://www.opensound.com/pguide/oss.pdf>http://www.opensound.com/pguide/oss.pdf</a>.</cite></p></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <code class=Nm>sound</code> device driver first appeared in <span class=Ux>FreeBSD 2.2.6</span> as <code class=Nm>pcm</code>, written by <span class=An>Luigi Rizzo</span>. It was later rewritten in <span class=Ux>FreeBSD 4.0</span> by <span class=An>Cameron Grant</span>. The API evolved from the VOXWARE standard which later became OSS standard. </section><section class=Sh><h2 class=Sh id=AUTHORS><a class=permalink href=#AUTHORS>AUTHORS</a></h2><span class=An>Luigi Rizzo</span> &lt;<a class=Mt href=mailto:luigi@iet.unipi.it>luigi@iet.unipi.it</a>&gt; initially wrote the <code class=Nm>pcm</code> device driver and this manual page. <span class=An>Cameron Grant</span> &lt;<a class=Mt href=mailto:gandalf@vilnya.demon.co.uk>gandalf@vilnya.demon.co.uk</a>&gt; later revised the device driver for <span class=Ux>FreeBSD 4.0</span>. <span class=An>Seigo Tanimura</span> &lt;<a class=Mt href=mailto:tanimura@r.dl.itc.u-tokyo.ac.jp>tanimura@r.dl.itc.u-tokyo.ac.jp</a>&gt; revised this manual page. It was then rewritten for <span class=Ux>FreeBSD 5.2</span>. </section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> Some features of your sound card (e.g., global volume control) might not be supported on all devices. </section></div><table class=foot><tr><td class=foot-date>December 26, 2020</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>