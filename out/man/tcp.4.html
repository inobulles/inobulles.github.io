<!DOCTYPE html>
<html><head><meta charset=utf-8><title>tcp(4)</title><keywords content=man,tcp></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>tcp(4)</h1><table class=head><tr><td class=head-ltitle>TCP(4)</td><td class=head-vol>FreeBSD Kernel Interfaces Manual</td><td class=head-rtitle>TCP(4)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2><code class=Nm>tcp</code> — <div class=Nd>Internet Transmission Control Protocol</div></section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><code class=In>#include &lt;<a class=In href=../src/sys/types.h.html>sys/types.h</a>&gt;</code><br><code class=In>#include &lt;<a class=In href=../src/sys/socket.h.html>sys/socket.h</a>&gt;</code><br><code class=In>#include &lt;<a class=In href=../src/netinet/in.h.html>netinet/in.h</a>&gt;</code><br><code class=In>#include &lt;<a class=In href=../src/netinet/tcp.h.html>netinet/tcp.h</a>&gt;</code><p class=Pp><var class=Ft>int</var><br><code class=Fn>socket</code>(<var class=Fa style="white-space: nowrap;">AF_INET</var>, <var class=Fa style="white-space: nowrap;">SOCK_STREAM</var>, <var class=Fa style="white-space: nowrap;">0</var>);</p></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> The TCP protocol provides reliable, flow-controlled, two-way transmission of data. It is a byte-stream protocol used to support the <code class=Dv>SOCK_STREAM</code> abstraction. TCP uses the standard Internet address format and, in addition, provides a per-host collection of “port addresses”. Thus, each address is composed of an Internet address specifying the host and network, with a specific TCP port on the host identifying the peer entity. <p class=Pp>Sockets utilizing the TCP protocol are either “active” or “passive”. Active sockets initiate connections to passive sockets. By default, TCP sockets are created active; to create a passive socket, the <a class=Xr href=listen.2.html>listen(2)</a> system call must be used after binding the socket with the <a class=Xr href=bind.2.html>bind(2)</a> system call. Only passive sockets may use the <a class=Xr href=accept.2.html>accept(2)</a> call to accept incoming connections. Only active sockets may use the <a class=Xr href=connect.2.html>connect(2)</a> call to initiate connections.</p><p class=Pp>Passive sockets may “underspecify” their location to match incoming connection requests from multiple networks. This technique, termed “wildcard addressing”, allows a single server to provide service to clients on multiple networks. To create a socket which listens on all networks, the Internet address <code class=Dv>INADDR_ANY</code> must be bound. The TCP port may still be specified at this time; if the port is not specified, the system will assign one. Once a connection has been established, the socket's address is fixed by the peer entity's location. The address assigned to the socket is the address associated with the network interface through which packets are being transmitted and received. Normally, this address corresponds to the peer entity's network.</p><p class=Pp>TCP supports a number of socket options which can be set with <a class=Xr href=setsockopt.2.html>setsockopt(2)</a> and tested with <a class=Xr href=getsockopt.2.html>getsockopt(2)</a>:</p><dl class=Bl-tag><dt><a class=permalink href=#TCP_INFO><code class=Dv id=TCP_INFO>TCP_INFO</code></a></dt><dd>Information about a socket's underlying TCP session may be retrieved by passing the read-only option <code class=Dv>TCP_INFO</code> to <a class=Xr href=getsockopt.2.html>getsockopt(2)</a>. It accepts a single argument: a pointer to an instance of <var class=Vt>struct tcp_info</var>. <p class=Pp>This API is subject to change; consult the source to determine which fields are currently filled out by this option. <span class=Ux>FreeBSD</span> specific additions include send window size, receive window size, and bandwidth-controlled window space.</p></dd><dt><a class=permalink href=#TCP_CCALGOOPT><code class=Dv id=TCP_CCALGOOPT>TCP_CCALGOOPT</code></a></dt><dd>Set or query congestion control algorithm specific parameters. See <a class=Xr href=mod_cc.4.html>mod_cc(4)</a> for details.</dd><dt><a class=permalink href=#TCP_CONGESTION><code class=Dv id=TCP_CONGESTION>TCP_CONGESTION</code></a></dt><dd>Select or query the congestion control algorithm that TCP will use for the connection. See <a class=Xr href=mod_cc.4.html>mod_cc(4)</a> for details.</dd><dt><a class=permalink href=#TCP_FASTOPEN><code class=Dv id=TCP_FASTOPEN>TCP_FASTOPEN</code></a></dt><dd>Enable or disable TCP Fast Open (TFO). To use this option, the kernel must be built with the <code class=Dv>TCP_RFC7413</code> option. <p class=Pp>This option can be set on the socket either before or after the <a class=Xr href=listen.2.html>listen(2)</a> is invoked. Clearing this option on a listen socket after it has been set has no effect on existing TFO connections or TFO connections in progress; it only prevents new TFO connections from being established.</p><p class=Pp>For passively-created sockets, the <code class=Dv>TCP_FASTOPEN</code> socket option can be queried to determine whether the connection was established using TFO. Note that connections that are established via a TFO SYN, but that fall back to using a non-TFO SYN|ACK will have the <code class=Dv>TCP_FASTOPEN</code> socket option set.</p><p class=Pp>In addition to the facilities defined in RFC7413, this implementation supports a pre-shared key (PSK) mode of operation in which the TFO server requires the client to be in posession of a shared secret in order for the client to be able to successfully open TFO connections with the server. This is useful, for example, in environments where TFO servers are exposed to both internal and external clients and only wish to allow TFO connections from internal clients.</p><p class=Pp>In the PSK mode of operation, the server generates and sends TFO cookies to requesting clients as usual. However, when validating cookies received in TFO SYNs from clients, the server requires the client-supplied cookie to equal</p><div class="Bd Pp"><pre>
SipHash24(key=<i>16-byte-psk</i>, msg=<i>cookie-sent-to-client</i>)
    </pre></div><p class=Pp>Multiple concurrent valid pre-shared keys are supported so that time-based rolling PSK invalidation policies can be implemented in the system. The default number of concurrent pre-shared keys is 2.</p><p class=Pp>This can be adjusted with the <code class=Dv>TCP_RFC7413_MAX_PSKS</code> kernel option.</p></dd><dt><a class=permalink href=#TCP_FUNCTION_BLK><code class=Dv id=TCP_FUNCTION_BLK>TCP_FUNCTION_BLK</code></a></dt><dd>Select or query the set of functions that TCP will use for this connection. This allows a user to select an alternate TCP stack. The alternate TCP stack must already be loaded in the kernel. To list the available TCP stacks, see <var class=Va>functions_available</var> in the <a class=Sx href=#MIB_(sysctl)_Variables>MIB (sysctl) Variables</a> section further down. To list the default TCP stack, see <var class=Va>functions_default</var> in the <a class=Sx href=#MIB_(sysctl)_Variables>MIB (sysctl) Variables</a> section.</dd><dt><a class=permalink href=#TCP_KEEPINIT><code class=Dv id=TCP_KEEPINIT>TCP_KEEPINIT</code></a></dt><dd>This <a class=Xr href=setsockopt.2.html>setsockopt(2)</a> option accepts a per-socket timeout argument of <var class=Vt>u_int</var> in seconds, for new, non-established TCP connections. For the global default in milliseconds see <var class=Va>keepinit</var> in the <a class=Sx href=#MIB_(sysctl)_Variables>MIB (sysctl) Variables</a> section further down.</dd><dt><a class=permalink href=#TCP_KEEPIDLE><code class=Dv id=TCP_KEEPIDLE>TCP_KEEPIDLE</code></a></dt><dd>This <a class=Xr href=setsockopt.2.html>setsockopt(2)</a> option accepts an argument of <var class=Vt>u_int</var> for the amount of time, in seconds, that the connection must be idle before keepalive probes (if enabled) are sent for the connection of this socket. If set on a listening socket, the value is inherited by the newly created socket upon <a class=Xr href=accept.2.html>accept(2)</a>. For the global default in milliseconds see <var class=Va>keepidle</var> in the <a class=Sx href=#MIB_(sysctl)_Variables>MIB (sysctl) Variables</a> section further down.</dd><dt><a class=permalink href=#TCP_KEEPINTVL><code class=Dv id=TCP_KEEPINTVL>TCP_KEEPINTVL</code></a></dt><dd>This <a class=Xr href=setsockopt.2.html>setsockopt(2)</a> option accepts an argument of <var class=Vt>u_int</var> to set the per-socket interval, in seconds, between keepalive probes sent to a peer. If set on a listening socket, the value is inherited by the newly created socket upon <a class=Xr href=accept.2.html>accept(2)</a>. For the global default in milliseconds see <var class=Va>keepintvl</var> in the <a class=Sx href=#MIB_(sysctl)_Variables>MIB (sysctl) Variables</a> section further down.</dd><dt><a class=permalink href=#TCP_KEEPCNT><code class=Dv id=TCP_KEEPCNT>TCP_KEEPCNT</code></a></dt><dd>This <a class=Xr href=setsockopt.2.html>setsockopt(2)</a> option accepts an argument of <var class=Vt>u_int</var> and allows a per-socket tuning of the number of probes sent, with no response, before the connection will be dropped. If set on a listening socket, the value is inherited by the newly created socket upon <a class=Xr href=accept.2.html>accept(2)</a>. For the global default see the <var class=Va>keepcnt</var> in the <a class=Sx href=#MIB_(sysctl)_Variables>MIB (sysctl) Variables</a> section further down.</dd><dt><a class=permalink href=#TCP_NODELAY><code class=Dv id=TCP_NODELAY>TCP_NODELAY</code></a></dt><dd>Under most circumstances, TCP sends data when it is presented; when outstanding data has not yet been acknowledged, it gathers small amounts of output to be sent in a single packet once an acknowledgement is received. For a small number of clients, such as window systems that send a stream of mouse events which receive no replies, this packetization may cause significant delays. The boolean option <code class=Dv>TCP_NODELAY</code> defeats this algorithm.</dd><dt><a class=permalink href=#TCP_MAXSEG><code class=Dv id=TCP_MAXSEG>TCP_MAXSEG</code></a></dt><dd>By default, a sender- and <span class=No>receiver-</span>TCP will negotiate among themselves to determine the maximum segment size to be used for each connection. The <code class=Dv>TCP_MAXSEG</code> option allows the user to determine the result of this negotiation, and to reduce it if desired.</dd><dt><a class=permalink href=#TCP_NOOPT><code class=Dv id=TCP_NOOPT>TCP_NOOPT</code></a></dt><dd>TCP usually sends a number of options in each packet, corresponding to various TCP extensions which are provided in this implementation. The boolean option <code class=Dv>TCP_NOOPT</code> is provided to disable TCP option use on a per-connection basis.</dd><dt><a class=permalink href=#TCP_NOPUSH><code class=Dv id=TCP_NOPUSH>TCP_NOPUSH</code></a></dt><dd>By convention, the <span class=No>sender-</span>TCP will set the “push” bit, and begin transmission immediately (if permitted) at the end of every user call to <a class=Xr href=write.2.html>write(2)</a> or <a class=Xr href=writev.2.html>writev(2)</a>. When this option is set to a non-zero value, TCP will delay sending any data at all until either the socket is closed, or the internal send buffer is filled.</dd><dt><a class=permalink href=#TCP_MD5SIG><code class=Dv id=TCP_MD5SIG>TCP_MD5SIG</code></a></dt><dd>This option enables the use of MD5 digests (also known as TCP-MD5) on writes to the specified socket. Outgoing traffic is digested; digests on incoming traffic are verified. When this option is enabled on a socket, all inbound and outgoing TCP segments must be signed with MD5 digests. <p class=Pp>One common use for this in a <span class=Ux>FreeBSD</span> router deployment is to enable based routers to interwork with Cisco equipment at peering points. Support for this feature conforms to RFC 2385.</p><p class=Pp>In order for this option to function correctly, it is necessary for the administrator to add a tcp-md5 key entry to the system's security associations database (SADB) using the <a class=Xr href=setkey.8.html>setkey(8)</a> utility. This entry can only be specified on a per-host basis at this time.</p><p class=Pp>If an SADB entry cannot be found for the destination, the system does not send any outgoing segments and drops any inbound segments. However, during connection negotiation, a non-signed segment will be accepted if an SADB entry does not exist between hosts. When a non-signed segment is accepted, the established connection is not protected with MD5 digests.</p></dd><dt><a class=permalink href=#TCP_STATS><code class=Dv id=TCP_STATS>TCP_STATS</code></a></dt><dd>Manage collection of connection level statistics using the <a class=Xr href=stats.3.html>stats(3)</a> framework. <p class=Pp>Each dropped segment is taken into account in the TCP protocol statistics.</p></dd><dt><a class=permalink href=#TCP_TXTLS_ENABLE><code class=Dv id=TCP_TXTLS_ENABLE>TCP_TXTLS_ENABLE</code></a></dt><dd>Enable in-kernel Transport Layer Security (TLS) for data written to this socket. See <a class=Xr href=ktls.4.html>ktls(4)</a> for more details.</dd><dt><a class=permalink href=#TCP_TXTLS_MODE><code class=Dv id=TCP_TXTLS_MODE>TCP_TXTLS_MODE</code></a></dt><dd>The integer argument can be used to get or set the current TLS transmit mode of a socket. See <a class=Xr href=ktls.4.html>ktls(4)</a> for more details.</dd><dt><a class=permalink href=#TCP_RXTLS_ENABLE><code class=Dv id=TCP_RXTLS_ENABLE>TCP_RXTLS_ENABLE</code></a></dt><dd>Enable in-kernel TLS for data read from this socket. See <a class=Xr href=ktls.4.html>ktls(4)</a> for more details.</dd><dt><a class=permalink href=#TCP_REUSPORT_LB_NUMA><code class=Dv id=TCP_REUSPORT_LB_NUMA>TCP_REUSPORT_LB_NUMA</code></a></dt><dd>Changes NUMA affinity filtering for an established TCP listen socket. This option takes a single integer argument which specifies the NUMA domain to filter on for this listen socket. The argument can also have the follwing special values: <dl class=Bl-tag><dt><a class=permalink href=#TCP_REUSPORT_LB_NUMA_NODOM><code class=Dv id=TCP_REUSPORT_LB_NUMA_NODOM>TCP_REUSPORT_LB_NUMA_NODOM</code></a></dt><dd>Remove NUMA filtering for this listen socket.</dd><dt><a class=permalink href=#TCP_REUSPORT_LB_NUMA_CURDOM><code class=Dv id=TCP_REUSPORT_LB_NUMA_CURDOM>TCP_REUSPORT_LB_NUMA_CURDOM</code></a></dt><dd>Filter traffic associated with the domain where the calling thread is currently executing. This is typically used after a process or thread inherits a listen socket from its parent, and sets its CPU affinity to a particular core.</dd></dl></dd><dt><a class=permalink href=#TCP_REMOTE_UDP_ENCAPS_PORT><code class=Dv id=TCP_REMOTE_UDP_ENCAPS_PORT>TCP_REMOTE_UDP_ENCAPS_PORT</code></a></dt><dd>Set and get the remote UDP encapsulation port. It can only be set on a closed TCP socket.</dd></dl><p class=Pp>The option level for the <a class=Xr href=setsockopt.2.html>setsockopt(2)</a> call is the protocol number for TCP, available from <a class=Xr href=getprotobyname.3.html>getprotobyname(3)</a>, or <code class=Dv>IPPROTO_TCP</code>. All options are declared in <code class=In>&lt;<a class=In href=../src/netinet/tcp.h.html>netinet/tcp.h</a>&gt;</code>.</p><p class=Pp>Options at the IP transport level may be used with TCP; see <a class=Xr href=ip.4.html>ip(4)</a>. Incoming connection requests that are source-routed are noted, and the reverse source route is used in responding.</p><p class=Pp>The default congestion control algorithm for TCP is <a class=Xr href=cc_newreno.4.html>cc_newreno(4)</a>. Other congestion control algorithms can be made available using the <a class=Xr href=mod_cc.4.html>mod_cc(4)</a> framework.</p><section class=Ss><h2 class=Ss id=MIB_(sysctl)_Variables><a class=permalink href=#MIB_(sysctl)_Variables>MIB (sysctl) Variables</a></h2> The TCP protocol implements a number of variables in the <var class=Va>net.inet.tcp</var> branch of the <a class=Xr href=sysctl.3.html>sysctl(3)</a> MIB, which can also be read or modified with <a class=Xr href=sysctl.8.html>sysctl(8)</a>. <dl class=Bl-tag><dt><var class=Va>always_keepalive</var></dt><dd>Assume that <code class=Dv>SO_KEEPALIVE</code> is set on all TCP connections, the kernel will periodically send a packet to the remote host to verify the connection is still up.</dd><dt><var class=Va>blackhole</var></dt><dd>If enabled, disable sending of RST when a connection is attempted to a port where there is no socket accepting connections. See <a class=Xr href=blackhole.4.html>blackhole(4)</a>.</dd><dt><var class=Va>blackhole_local</var></dt><dd>See <a class=Xr href=blackhole.4.html>blackhole(4)</a>.</dd><dt><var class=Va>cc</var></dt><dd>A number of variables for congestion control are under the <var class=Va>net.inet.tcp.cc</var> node. See <a class=Xr href=mod_cc.4.html>mod_cc(4)</a>.</dd><dt><var class=Va>cc.newreno</var></dt><dd>Variables for NewReno congestion control are under the <var class=Va>net.inet.tcp.cc.newreno</var> node. See <a class=Xr href=cc_newreno.4.html>cc_newreno(4)</a>.</dd><dt><var class=Va>delacktime</var></dt><dd>Maximum amount of time, in milliseconds, before a delayed ACK is sent.</dd><dt><var class=Va>delayed_ack</var></dt><dd>Delay ACK to try and piggyback it onto a data packet or another ACK.</dd><dt><var class=Va>do_lrd</var></dt><dd>Enable Lost Retransmission Detection for SACK-enabled sessions, disabled by default. Under severe congestion, a retransmission can be lost which then leads to a mandatory Retransmission Timeout (RTO), followed by slow-start. LRD will try to resend the repeatedly lost packet, preventing the time-consuming RTO and performance reducing slow-start.</dd><dt><var class=Va>do_prr</var></dt><dd>Perform SACK loss recovery using the Proportional Rate Reduction (PRR) algorithm described in RFC6937. This improves the effectiveness of retransmissions particular in environments with ACK thinning or burst loss events, as chances to run out of the ACK clock are reduced, preventing lengthy and performance reducing RTO based loss recovery (default is true).</dd><dt><var class=Va>do_prr_conservative</var></dt><dd>While doing Proportional Rate Reduction, remain strictly in a packet conserving mode, sending only one new packet for each ACK received. Helpful when a misconfigured token bucket traffic policer causes persistent high losses leading to RTO, but reduces PRR effectiveness in more common settings (default is false).</dd><dt><var class=Va>do_tcpdrain</var></dt><dd>Flush packets in the TCP reassembly queue if the system is low on mbufs.</dd><dt><var class=Va>drop_synfin</var></dt><dd>Drop TCP packets with both SYN and FIN set.</dd><dt><var class=Va>ecn.enable</var></dt><dd>Enable support for TCP Explicit Congestion Notification (ECN). ECN allows a TCP sender to reduce the transmission rate in order to avoid packet drops. <dl class="Bl-tag Bl-compact"><dt>0</dt><dd>Disable ECN.</dd><dt>1</dt><dd>Allow incoming connections to request ECN. Outgoing connections will request ECN.</dd><dt>2</dt><dd>Allow incoming connections to request ECN. Outgoing connections will not request ECN. (default)</dd><dt>3</dt><dd>Negotiate on incoming connection for Accurate ECN, ECN, or no ECN. Outgoing connections will request Accurate ECN and fall back to ECN depending on the capabilities of the server.</dd><dt>4</dt><dd>Negotiate on incoming connection for Accurate ECN, ECN, or no ECN. Outgoing connections will not request ECN.</dd></dl></dd><dt><var class=Va>ecn.maxretries</var></dt><dd>Number of retries (SYN or SYN/ACK retransmits) before disabling ECN on a specific connection. This is needed to help with connection establishment when a broken firewall is in the network path.</dd><dt><var class=Va>fast_finwait2_recycle</var></dt><dd>Recycle TCP <code class=Dv>FIN_WAIT_2</code> connections faster when the socket is marked as <code class=Dv>SBS_CANTRCVMORE</code> (no user process has the socket open, data received on the socket cannot be read). The timeout used here is <var class=Va>finwait2_timeout</var>.</dd><dt><var class=Va>fastopen.acceptany</var></dt><dd>When non-zero, all client-supplied TFO cookies will be considered to be valid. The default is 0.</dd><dt><var class=Va>fastopen.autokey</var></dt><dd>When this and <var class=Va>net.inet.tcp.fastopen.server_enable</var> are non-zero, a new key will be automatically generated after this specified seconds. The default is 120.</dd><dt><var class=Va>fastopen.ccache_bucket_limit</var></dt><dd>The maximum number of entries in a client cookie cache bucket. The default value can be tuned with the <code class=Dv>TCP_FASTOPEN_CCACHE_BUCKET_LIMIT_DEFAULT</code> kernel option or by setting <var class=Va>net.inet.tcp.fastopen_ccache_bucket_limit</var> in the <a class=Xr href=loader.8.html>loader(8)</a>.</dd><dt><var class=Va>fastopen.ccache_buckets</var></dt><dd>The number of client cookie cache buckets. Read-only. The value can be tuned with the <code class=Dv>TCP_FASTOPEN_CCACHE_BUCKETS_DEFAULT</code> kernel option or by setting <var class=Va>fastopen.ccache_buckets</var> in the <a class=Xr href=loader.8.html>loader(8)</a>.</dd><dt><var class=Va>fastopen.ccache_list</var></dt><dd>Print the client cookie cache. Read-only.</dd><dt><var class=Va>fastopen.client_enable</var></dt><dd>When zero, no new active (i.e., client) TFO connections can be created. On the transition from enabled to disabled, the client cookie cache is cleared and disabled. The transition from enabled to disabled does not affect any active TFO connections in progress; it only prevents new ones from being established. The default is 0.</dd><dt><var class=Va>fastopen.keylen</var></dt><dd>The key length in bytes. Read-only.</dd><dt><var class=Va>fastopen.maxkeys</var></dt><dd>The maximum number of keys supported. Read-only,</dd><dt><var class=Va>fastopen.maxpsks</var></dt><dd>The maximum number of pre-shared keys supported. Read-only.</dd><dt><var class=Va>fastopen.numkeys</var></dt><dd>The current number of keys installed. Read-only.</dd><dt><var class=Va>fastopen.numpsks</var></dt><dd>The current number of pre-shared keys installed. Read-only.</dd><dt><var class=Va>fastopen.path_disable_time</var></dt><dd>When a failure occurs while trying to create a new active (i.e., client) TFO connection, new active connections on the same path, as determined by the tuple {client_ip, server_ip, server_port}, will be forced to be non-TFO for this many seconds. Note that the path disable mechanism relies on state stored in client cookie cache entries, so it is possible for the disable time for a given path to be reduced if the corresponding client cookie cache entry is reused due to resource pressure before the disable period has elapsed. The default is <code class=Dv>TCP_FASTOPEN_PATH_DISABLE_TIME_DEFAULT</code>.</dd><dt><var class=Va>fastopen.psk_enable</var></dt><dd>When non-zero, pre-shared key (PSK) mode is enabled for all TFO servers. On the transition from enabled to disabled, all installed pre-shared keys are removed. The default is 0.</dd><dt><var class=Va>fastopen.server_enable</var></dt><dd>When zero, no new passive (i.e., server) TFO connections can be created. On the transition from enabled to disabled, all installed keys and pre-shared keys are removed. On the transition from disabled to enabled, if <var class=Va>fastopen.autokey</var> is non-zero and there are no keys installed, a new key will be generated immediately. The transition from enabled to disabled does not affect any passive TFO connections in progress; it only prevents new ones from being established. The default is 0.</dd><dt><var class=Va>fastopen.setkey</var></dt><dd>Install a new key by writing <var class=Va>net.inet.tcp.fastopen.keylen</var> bytes to this sysctl.</dd><dt><var class=Va>fastopen.setpsk</var></dt><dd>Install a new pre-shared key by writing <var class=Va>net.inet.tcp.fastopen.keylen</var> bytes to this sysctl.</dd><dt><var class=Va>finwait2_timeout</var></dt><dd>Timeout to use for fast recycling of TCP <code class=Dv>FIN_WAIT_2</code> connections (<var class=Va>fast_finwait2_recycle</var>). Defaults to 60 seconds.</dd><dt><var class=Va>functions_available</var></dt><dd>List of available TCP function blocks (TCP stacks).</dd><dt><var class=Va>functions_default</var></dt><dd>The default TCP function block (TCP stack).</dd><dt><var class=Va>functions_inherit_listen_socket_stack</var></dt><dd>Determines whether to inherit listen socket's TCP stack or use the current system default TCP stack, as defined by <var class=Va>functions_default</var>. Default is true.</dd><dt><var class=Va>hostcache</var></dt><dd>The TCP host cache is used to cache connection details and metrics to improve future performance of connections between the same hosts. At the completion of a TCP connection, a host will cache information for the connection for some defined period of time. There are a number of <var class=Va>hostcache</var> variables under this node. See <var class=Va>hostcache.enable</var>.</dd><dt><var class=Va>hostcache.bucketlimit</var></dt><dd>The maximum number of entries for the same hash. Defaults to 30.</dd><dt><var class=Va>hostcache.cachelimit</var></dt><dd>Overall entry limit for hostcache. Defaults to <var class=Va>hashsize</var> * <var class=Va>bucketlimit</var>.</dd><dt><var class=Va>hostcache.count</var></dt><dd>The current number of entries in the host cache.</dd><dt><var class=Va>hostcache.enable</var></dt><dd>Enable/disable the host cache: <dl class="Bl-tag Bl-compact"><dt>0</dt><dd>Disable the host cache.</dd><dt>1</dt><dd>Enable the host cache. (default)</dd></dl></dd><dt><var class=Va>hostcache.expire</var></dt><dd>Time in seconds, how long a entry should be kept in the host cache since last accessed. Defaults to 3600 (1 hour).</dd><dt><var class=Va>hostcache.hashsize</var></dt><dd>Size of TCP hostcache hashtable. This number has to be a power of two, or will be rejected. Defaults to 512.</dd><dt><var class=Va>hostcache.histo</var></dt><dd>Provide a Histogram of the hostcache hash utilization.</dd><dt><var class=Va>hostcache.list</var></dt><dd>Provide a complete list of all current entries in the host cache.</dd><dt><var class=Va>hostcache.prune</var></dt><dd>Time in seconds between pruning expired host cache entries. Defaults to 300 (5 minutes).</dd><dt><var class=Va>hostcache.purge</var></dt><dd>Expire all entires on next pruning of host cache entries. Any non-zero setting will be reset to zero, once the purge is running. <dl class="Bl-tag Bl-compact"><dt>0</dt><dd>Do not purge all entries when pruning the host cache (default).</dd><dt>1</dt><dd>Purge all entries when doing the next pruning.</dd><dt>2</dt><dd>Purge all entries and also reseed the hash salt.</dd></dl></dd><dt><var class=Va>hostcache.purgenow</var></dt><dd>Immediately purge all entries once set to any value. Setting this to 2 will also reseed the hash salt.</dd><dt><var class=Va>icmp_may_rst</var></dt><dd>Certain ICMP unreachable messages may abort connections in SYN-SENT state.</dd><dt><var class=Va>initcwnd_segments</var></dt><dd>Enable the ability to specify initial congestion window in number of segments. The default value is 10 as suggested by RFC 6928. Changing the value on the fly would not affect connections using congestion window from the hostcache. Caution: This regulates the burst of packets allowed to be sent in the first RTT. The value should be relative to the link capacity. Start with small values for lower-capacity links. Large bursts can cause buffer overruns and packet drops if routers have small buffers or the link is experiencing congestion.</dd><dt><var class=Va>insecure_rst</var></dt><dd>Use criteria defined in RFC793 instead of RFC5961 for accepting RST segments. Default is false.</dd><dt><var class=Va>insecure_syn</var></dt><dd>Use criteria defined in RFC793 instead of RFC5961 for accepting SYN segments. Default is false.</dd><dt><var class=Va>isn_reseed_interval</var></dt><dd>The interval (in seconds) specifying how often the secret data used in RFC 1948 initial sequence number calculations should be reseeded. By default, this variable is set to zero, indicating that no reseeding will occur. Reseeding should not be necessary, and will break <code class=Dv>TIME_WAIT</code> recycling for a few minutes.</dd><dt><var class=Va>keepcnt</var></dt><dd>Number of keepalive probes sent, with no response, before a connection is dropped. The default is 8 packets.</dd><dt><var class=Va>keepidle</var></dt><dd>Amount of time, in milliseconds, that the connection must be idle before sending keepalive probes (if enabled). The default is 7200000 msec (7.2M msec, 2 hours).</dd><dt><var class=Va>keepinit</var></dt><dd>Timeout, in milliseconds, for new, non-established TCP connections. The default is 75000 msec (75K msec, 75 sec).</dd><dt><var class=Va>keepintvl</var></dt><dd>The interval, in milliseconds, between keepalive probes sent to remote machines, when no response is received on a <var class=Va>keepidle</var> probe. The default is 75000 msec (75K msec, 75 sec).</dd><dt><var class=Va>log_in_vain</var></dt><dd>Log any connection attempts to ports where there is no socket accepting connections. The value of 1 limits the logging to SYN (connection establishment) packets only. A value of 2 results in any TCP packets to closed ports being logged. Any value not listed above disables the logging (default is 0, i.e., the logging is disabled).</dd><dt><var class=Va>maxtcptw</var></dt><dd>When a TCP connection enters the <code class=Dv>TIME_WAIT</code> state, its associated socket structure is freed, since it is of negligible size and use, and a new structure is allocated to contain a minimal amount of information necessary for sustaining a connection in this state, called the compressed TCP <code class=Dv>TIME_WAIT</code> state. Since this structure is smaller than a socket structure, it can save a significant amount of system memory. The <var class=Va>net.inet.tcp.maxtcptw</var> MIB variable controls the maximum number of these structures allocated. By default, it is initialized to <var class=Va>kern.ipc.maxsockets</var> / 5.</dd><dt><var class=Va>minmss</var></dt><dd>Minimum TCP Maximum Segment Size; used to prevent a denial of service attack from an unreasonably low MSS.</dd><dt><var class=Va>msl</var></dt><dd>The Maximum Segment Lifetime, in milliseconds, for a packet.</dd><dt><var class=Va>mssdflt</var></dt><dd>The default value used for the TCP Maximum Segment Size (“MSS”) for IPv4 when no advice to the contrary is received from MSS negotiation.</dd><dt><var class=Va>newcwd</var></dt><dd>Enable the New Congestion Window Validation mechanism as described in RFC 7661. This gently reduces the congestion window during periods, where TCP is application limited and the network bandwidth is not utilized completely. That prevents self-inflicted packet losses once the application starts to transmit data at a higher speed.</dd><dt><var class=Va>nolocaltimewait</var></dt><dd>Suppress creation of compressed TCP <code class=Dv>TIME_WAIT</code> states for connections in which both endpoints are local.</dd><dt><var class=Va>path_mtu_discovery</var></dt><dd>Enable Path MTU Discovery.</dd><dt><var class=Va>pcbcount</var></dt><dd>Number of active process control blocks (read-only).</dd><dt><var class=Va>perconn_stats_enable</var></dt><dd>Controls the default collection of statistics for all connections using the <a class=Xr href=stats.3.html>stats(3)</a> framework. 0 disables, 1 enables, 2 enables random sampling across log id connection groups with all connections in a group receiving the same setting.</dd><dt><var class=Va>perconn_stats_sample_rates</var></dt><dd>A CSV list of template_spec=percent key-value pairs which controls the per template sampling rates when <a class=Xr href=stats.3.html>stats(3)</a> sampling is enabled.</dd><dt><var class=Va>persmax</var></dt><dd>Maximum persistence interval, msec.</dd><dt><var class=Va>persmin</var></dt><dd>Minimum persistence interval, msec.</dd><dt><var class=Va>pmtud_blackhole_detection</var></dt><dd>Enable automatic path MTU blackhole detection. In case of retransmits of MSS sized segments, the OS will lower the MSS to check if it's an MTU problem. If the current MSS is greater than the configured value to try (<var class=Va>net.inet.tcp.pmtud_blackhole_mss</var> and <var class=Va>net.inet.tcp.v6pmtud_blackhole_mss</var>), it will be set to this value, otherwise, the MSS will be set to the default values (<var class=Va>net.inet.tcp.mssdflt</var> and <var class=Va>net.inet.tcp.v6mssdflt</var>). Settings: <dl class="Bl-tag Bl-compact"><dt>0</dt><dd>Disable path MTU blackhole detection.</dd><dt>1</dt><dd>Enable path MTU blackhole detection for IPv4 and IPv6.</dd><dt>2</dt><dd>Enable path MTU blackhole detection only for IPv4.</dd><dt>3</dt><dd>Enable path MTU blackhole detection only for IPv6.</dd></dl></dd><dt><var class=Va>pmtud_blackhole_mss</var></dt><dd>MSS to try for IPv4 if PMTU blackhole detection is turned on.</dd><dt><var class=Va>reass.cursegments</var></dt><dd>The current total number of segments present in all reassembly queues.</dd><dt><var class=Va>reass.maxqueuelen</var></dt><dd>The maximum number of segments allowed in each reassembly queue. By default, the system chooses a limit based on each TCP connection's receive buffer size and maximum segment size (MSS). The actual limit applied to a session's reassembly queue will be the lower of the system-calculated automatic limit and the user-specified <var class=Va>reass.maxqueuelen</var> limit.</dd><dt><var class=Va>reass.maxsegments</var></dt><dd>The maximum limit on the total number of segments across all reassembly queues. The limit can be adjusted as a tunable.</dd><dt><var class=Va>recvbuf_auto</var></dt><dd>Enable automatic receive buffer sizing as a connection progresses.</dd><dt><var class=Va>recvbuf_max</var></dt><dd>Maximum size of automatic receive buffer.</dd><dt><var class=Va>recvspace</var></dt><dd>Initial TCP receive window (buffer size).</dd><dt><var class=Va>require_unique_port</var></dt><dd>Require unique ephemeral port for outgoing connections; otherwise, the 4-tuple of local and remote ports and addresses must be unique. Requiring a unique port limits the number of outgoing connections.</dd><dt><var class=Va>rexmit_drop_options</var></dt><dd>Drop TCP options from third and later retransmitted SYN segments of a connection.</dd><dt><var class=Va>rexmit_initial</var>, <var class=Va>rexmit_min</var>, <var class=Va>rexmit_slop</var></dt><dd>Adjust the retransmit timer calculation for TCP. The slop is typically added to the raw calculation to take into account occasional variances that the SRTT (smoothed round-trip time) is unable to accommodate, while the minimum specifies an absolute minimum. While a number of TCP RFCs suggest a 1 second minimum, these RFCs tend to focus on streaming behavior, and fail to deal with the fact that a 1 second minimum has severe detrimental effects over lossy interactive connections, such as a 802.11b wireless link, and over very fast but lossy connections for those cases not covered by the fast retransmit code. For this reason, we use 200ms of slop and a near-0 minimum, which gives us an effective minimum of 200ms (similar to Linux). The initial value is used before an RTT measurement has been performed.</dd><dt><var class=Va>rfc1323</var></dt><dd>Implement the window scaling and timestamp options of RFC 1323/RFC 7323 (default is true).</dd><dt><var class=Va>rfc3042</var></dt><dd>Enable the Limited Transmit algorithm as described in RFC 3042. It helps avoid timeouts on lossy links and also when the congestion window is small, as happens on short transfers.</dd><dt><var class=Va>rfc3390</var></dt><dd>Enable support for RFC 3390, which allows for a variable-sized starting congestion window on new connections, depending on the maximum segment size. This helps throughput in general, but particularly affects short transfers and high-bandwidth large propagation-delay connections.</dd><dt><var class=Va>rfc6675_pipe</var></dt><dd>Deprecated and superseded by <var class=Va>sack.revised</var></dd><dt><var class=Va>sack.enable</var></dt><dd>Enable support for RFC 2018, TCP Selective Acknowledgment option, which allows the receiver to inform the sender about all successfully arrived segments, allowing the sender to retransmit the missing segments only.</dd><dt><var class=Va>sack.globalholes</var></dt><dd>Global number of TCP SACK holes currently allocated.</dd><dt><var class=Va>sack.globalmaxholes</var></dt><dd>Maximum number of SACK holes per system, across all connections. Defaults to 65536.</dd><dt><var class=Va>sack.maxholes</var></dt><dd>Maximum number of SACK holes per connection. Defaults to 128.</dd><dt><var class=Va>sack.revised</var></dt><dd>Enables three updated mechanisms from RFC6675 (default is true). Calculate the bytes in flight using the algorithm described in RFC 6675, and is also an improvement when Proportional Rate Reduction is enabled. Next, Rescue Retransmission helps timely loss recovery, when the trailing segments of a transmission are lost, while no additional data is ready to be sent. In case a partial ACK without a SACK block is received during SACK loss recovery, the trailing segment is immediately resent, rather than waiting for a Retransmission timeout. Finally, SACK loss recovery is also engaged, once two segments plus one byte are SACKed - even if no traditional duplicate ACKs were observed.</dd><dt><var class=Va>sendbuf_auto</var></dt><dd>Enable automatic send buffer sizing.</dd><dt><var class=Va>sendbuf_auto_lowat</var></dt><dd>Modify threshold for auto send buffer growth to account for <code class=Dv>SO_SNDLOWAT</code>.</dd><dt><var class=Va>sendbuf_inc</var></dt><dd>Incrementor step size of automatic send buffer.</dd><dt><var class=Va>sendbuf_max</var></dt><dd>Maximum size of automatic send buffer.</dd><dt><var class=Va>sendspace</var></dt><dd>Initial TCP send window (buffer size).</dd><dt><var class=Va>syncache</var></dt><dd>Variables under the <var class=Va>net.inet.tcp.syncache</var> node are documented in <a class=Xr href=syncache.4.html>syncache(4)</a>.</dd><dt><var class=Va>syncookies</var></dt><dd>Determines whether or not SYN cookies should be generated for outbound SYN-ACK packets. SYN cookies are a great help during SYN flood attacks, and are enabled by default. (See <a class=Xr href=syncookies.4.html>syncookies(4)</a>.)</dd><dt><var class=Va>syncookies_only</var></dt><dd>See <a class=Xr href=syncookies.4.html>syncookies(4)</a>.</dd><dt><var class=Va>tcbhashsize</var></dt><dd>Size of the TCP control-block hash table (read-only). This is tuned using the kernel option <code class=Dv>TCBHASHSIZE</code> or by setting <var class=Va>net.inet.tcp.tcbhashsize</var> in the <a class=Xr href=loader.8.html>loader(8)</a>.</dd><dt><var class=Va>tolerate_missing_ts</var></dt><dd>Tolerate the missing of timestamps (RFC 1323/RFC 7323) for TCP segments belonging to TCP connections for which support of TCP timestamps has been negotiated. As of June 2021, several TCP stacks are known to violate RFC 7323, including modern widely deployed ones. Therefore the default is 1, i.e., the missing of timestamps is tolerated.</dd><dt><var class=Va>ts_offset_per_conn</var></dt><dd>When initializing the TCP timestamps, use a per connection offset instead of a per host pair offset. Default is to use per connection offsets as recommended in RFC 7323.</dd><dt><var class=Va>tso</var></dt><dd>Enable TCP Segmentation Offload.</dd><dt><var class=Va>udp_tunneling_overhead</var></dt><dd>The overhead taken into account when using UDP encapsulation. Since MSS clamping by middleboxes will most likely not work, values larger than 8 (the size of the UDP header) are also supported. Supported values are between 8 and 1024. The default is 8.</dd><dt><var class=Va>udp_tunneling_port</var></dt><dd>The local UDP encapsulation port. A value of 0 indicates that UDP encapsulation is disabled. The default is 0.</dd><dt><var class=Va>v6mssdflt</var></dt><dd>The default value used for the TCP Maximum Segment Size (“MSS”) for IPv6 when no advice to the contrary is received from MSS negotiation.</dd><dt><var class=Va>v6pmtud_blackhole_mss</var></dt><dd>MSS to try for IPv6 if PMTU blackhole detection is turned on. See <var class=Va>pmtud_blackhole_detection</var>.</dd></dl></section></section><section class=Sh><h2 class=Sh id=ERRORS><a class=permalink href=#ERRORS>ERRORS</a></h2> A socket operation may fail with one of the following errors returned: <dl class=Bl-tag><dt>[<a class=permalink href=#EISCONN><code class=Er id=EISCONN>EISCONN</code></a>]</dt><dd>when trying to establish a connection on a socket which already has one;</dd><dt>[<code class=Er>ENOBUFS</code>] or [<code class=Er>ENOMEM</code>]</dt><dd>when the system runs out of memory for an internal data structure;</dd><dt>[<a class=permalink href=#ETIMEDOUT><code class=Er id=ETIMEDOUT>ETIMEDOUT</code></a>]</dt><dd>when a connection was dropped due to excessive retransmissions;</dd><dt>[<a class=permalink href=#ECONNRESET><code class=Er id=ECONNRESET>ECONNRESET</code></a>]</dt><dd>when the remote peer forces the connection to be closed;</dd><dt>[<a class=permalink href=#ECONNREFUSED><code class=Er id=ECONNREFUSED>ECONNREFUSED</code></a>]</dt><dd>when the remote peer actively refuses connection establishment (usually because no process is listening to the port);</dd><dt>[<a class=permalink href=#EADDRINUSE><code class=Er id=EADDRINUSE>EADDRINUSE</code></a>]</dt><dd>when an attempt is made to create a socket with a port which has already been allocated;</dd><dt>[<a class=permalink href=#EADDRNOTAVAIL><code class=Er id=EADDRNOTAVAIL>EADDRNOTAVAIL</code></a>]</dt><dd>when an attempt is made to create a socket with a network address for which no network interface exists;</dd><dt>[<a class=permalink href=#EAFNOSUPPORT><code class=Er id=EAFNOSUPPORT>EAFNOSUPPORT</code></a>]</dt><dd>when an attempt is made to bind or connect a socket to a multicast address.</dd><dt>[<a class=permalink href=#EINVAL><code class=Er id=EINVAL>EINVAL</code></a>]</dt><dd>when trying to change TCP function blocks at an invalid point in the session;</dd><dt>[<a class=permalink href=#ENOENT><code class=Er id=ENOENT>ENOENT</code></a>]</dt><dd>when trying to use a TCP function block that is not available;</dd></dl></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><a class=Xr href=getsockopt.2.html>getsockopt(2)</a>, <a class=Xr href=socket.2.html>socket(2)</a>, <a class=Xr href=stats.3.html>stats(3)</a>, <a class=Xr href=sysctl.3.html>sysctl(3)</a>, <a class=Xr href=blackhole.4.html>blackhole(4)</a>, <a class=Xr href=inet.4.html>inet(4)</a>, <a class=Xr href=intro.4.html>intro(4)</a>, <a class=Xr href=ip.4.html>ip(4)</a>, <a class=Xr href=ktls.4.html>ktls(4)</a>, <a class=Xr href=mod_cc.4.html>mod_cc(4)</a>, <a class=Xr href=siftr.4.html>siftr(4)</a>, <a class=Xr href=syncache.4.html>syncache(4)</a>, <a class=Xr href=tcp_bbr.4.html>tcp_bbr(4)</a>, <a class=Xr href=setkey.8.html>setkey(8)</a>, <a class=Xr href=sysctl.8.html>sysctl(8)</a>, <a class=Xr href=tcp_functions.9.html>tcp_functions(9)</a><p class=Pp><cite class=Rs><span class=RsA>V. Jacobson</span>, <span class=RsA>B. Braden</span>, and <span class=RsA>D. Borman</span>, <span class=RsT>TCP Extensions for High Performance</span>, <span class=RsO>RFC 1323</span>.</cite></p><p class=Pp><cite class=Rs><span class=RsA>D. Borman</span>, <span class=RsA>B. Braden</span>, <span class=RsA>V. Jacobson</span>, and <span class=RsA>R. Scheffenegger</span>, <span class=RsT>TCP Extensions for High Performance</span>, <span class=RsO>RFC 7323</span>.</cite></p><p class=Pp><cite class=Rs><span class=RsA>A. Heffernan</span>, <span class=RsT>Protection of BGP Sessions via the TCP MD5 Signature Option</span>, <span class=RsO>RFC 2385</span>.</cite></p><p class=Pp><cite class=Rs><span class=RsA>K. Ramakrishnan</span>, <span class=RsA>S. Floyd</span>, and <span class=RsA>D. Black</span>, <span class=RsT>The Addition of Explicit Congestion Notification (ECN) to IP</span>, <span class=RsO>RFC 3168</span>.</cite></p></section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The TCP protocol appeared in <span class=Ux>4.2BSD</span>. The RFC 1323 extensions for window scaling and timestamps were added in <span class=Ux>4.4BSD</span>. The <code class=Dv>TCP_INFO</code> option was introduced in Linux 2.6 and is <i class=Em>subject to change</i>. </section></div><table class=foot><tr><td class=foot-date>August 1, 2022</td><td class=foot-os>FreeBSD 13.1-RELEASE-p2</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>