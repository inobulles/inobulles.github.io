<!DOCTYPE html>
<html><head><meta charset=utf-8><title>hosts_access(5)</title><keywords content=man,hosts_access></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>hosts_access(5)</h1><table class=head><tr><td class=head-ltitle>HOSTS_ACCESS(5)</td><td class=head-vol>FreeBSD File Formats Manual</td><td class=head-rtitle>HOSTS_ACCESS(5)</td></tr></table><div class=manual-text><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2> hosts_access - format of host access control files </section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> This manual page describes a simple access control language that is based on client (host name/address, user name), and server (process name, host name/address) patterns. Examples are given at the end. The impatient reader is encouraged to skip to the EXAMPLES section for a quick introduction. <p class=Pp>An extended version of the access control language is described in the <i>hosts_options</i>(5) document. The extensions are turned on at program build time by building with -DPROCESS_OPTIONS.</p><p class=Pp>In the following text, <i>daemon</i> is the the process name of a network daemon process, and <i>client</i> is the name and/or address of a host requesting service. Network daemon process names are specified in the inetd configuration file.</p></section><section class=Sh><h2 class=Sh id=ACCESS_CONTROL_FILES><a class=permalink href=#ACCESS_CONTROL_FILES>ACCESS CONTROL FILES</a></h2> The access control software consults two files. The search stops at the first match: <ul class=Bl-bullet><li>Access will be granted when a (daemon,client) pair matches an entry in the <i>/etc/hosts.allow</i> file.</li><li>Otherwise, access will be denied when a (daemon,client) pair matches an entry in the <i>/etc/hosts.deny</i> file.</li><li>Otherwise, access will be granted.</li></ul><p class=Pp>A non-existing access control file is treated as if it were an empty file. Thus, access control can be turned off by providing no access control files.</p></section><section class=Sh><h2 class=Sh id=ACCESS_CONTROL_RULES><a class=permalink href=#ACCESS_CONTROL_RULES>ACCESS CONTROL RULES</a></h2> Each access control file consists of zero or more lines of text. These lines are processed in order of appearance. The search terminates when a match is found. <ul class=Bl-bullet><li>A newline character is ignored when it is preceded by a backslash character. This permits you to break up long lines so that they are easier to edit.</li><li>Blank lines or lines that begin with a `#´ character are ignored. This permits you to insert comments and whitespace so that the tables are easier to read.</li><li>All other lines should satisfy the following format, things between [] being optional: <p class=Pp>daemon_list : client_list [ : shell_command ]</p></li></ul><p class=Pp><i>daemon_list</i> is a list of one or more daemon process names (argv[0] values) or wildcards (see below).</p><p class=Pp><i>client_list</i> is a list of one or more host names, host addresses, patterns or wildcards (see below) that will be matched against the client host name or address.</p><p class=Pp>The more complex forms <i>daemon@host</i> and <i>user@host</i> are explained in the sections on server endpoint patterns and on client username lookups, respectively.</p><p class=Pp>List elements should be separated by blanks and/or commas.</p><p class=Pp>With the exception of NIS (YP) netgroup lookups, all access control checks are case insensitive.</p></section><section class=Sh><h2 class=Sh id=PATTERNS><a class=permalink href=#PATTERNS>PATTERNS</a></h2> The access control language implements the following patterns: <ul class=Bl-bullet><li>A string that begins with a `.´ character. A host name is matched if the last components of its name match the specified pattern. For example, the pattern `.tue.nl´ matches the host name `wzv.win.tue.nl´.</li><li>A string that ends with a `.´ character. A host address is matched if its first numeric fields match the given string. For example, the pattern `131.155.´ matches the address of (almost) every host on the Eindhoven University network (131.155.x.x).</li><li>A string that begins with an `@´ character is treated as an NIS (formerly YP) netgroup name. A host name is matched if it is a host member of the specified netgroup. Netgroup matches are not supported for daemon process names or for client user names.</li><li>An expression of the form `n.n.n.n/m.m.m.m´ is interpreted as a `net/mask´ pair. A host address is matched if `net´ is equal to the bitwise AND of the address and the `mask´. For example, the net/mask pattern `131.155.72.0/255.255.254.0´ matches every address in the range `131.155.72.0´ through `131.155.73.255´.</li><li>An expression of the form `[n:n:n:n:n:n:n:n]/m´ is interpreted as a `[net]/prefixlen´ pair. A IPv6 host address is matched if `prefixlen´ bits of `net´ is equal to the `prefixlen´ bits of the address. For example, the [net]/prefixlen pattern `[3ffe:505:2:1::]/64´ matches every address in the range `3ffe:505:2:1::´ through `3ffe:505:2:1:ffff:ffff:ffff:ffff´.</li><li>A string that begins with a `/´ character is treated as a file name. A host name or address is matched if it matches any host name or address pattern listed in the named file. The file format is zero or more lines with zero or more host name or address patterns separated by whitespace. A file name pattern can be used anywhere a host name or address pattern can be used.</li></ul></section><section class=Sh><h2 class=Sh id=WILDCARDS><a class=permalink href=#WILDCARDS>WILDCARDS</a></h2> The access control language supports explicit wildcards: <dl class=Bl-tag><dt>ALL</dt><dd>The universal wildcard, always matches.</dd><dt>LOCAL</dt><dd>Matches any host whose name does not contain a dot character.</dd><dt>UNKNOWN</dt><dd>Matches any user whose name is unknown, and matches any host whose name <i>or</i> address are unknown. This pattern should be used with care: host names may be unavailable due to temporary name server problems. A network address will be unavailable when the software cannot figure out what type of network it is talking to.</dd><dt>KNOWN</dt><dd>Matches any user whose name is known, and matches any host whose name <i>and</i> address are known. This pattern should be used with care: host names may be unavailable due to temporary name server problems. A network address will be unavailable when the software cannot figure out what type of network it is talking to.</dd><dt>PARANOID</dt><dd>Matches any host whose name does not match its address. When tcpd is built with -DPARANOID (default mode), it drops requests from such clients even before looking at the access control tables. Build without -DPARANOID when you want more control over such requests.</dd></dl></section><section class=Sh><h2 class=Sh id=OPERATORS><a class=permalink href=#OPERATORS>OPERATORS</a></h2><dl class=Bl-tag><dt>EXCEPT</dt><dd>Intended use is of the form: `list_1 EXCEPT list_2´; this construct matches anything that matches <i>list_1</i> unless it matches <i>list_2</i>. The EXCEPT operator can be used in daemon_lists and in client_lists. The EXCEPT operator can be nested: if the control language would permit the use of parentheses, `a EXCEPT b EXCEPT c´ would parse as `(a EXCEPT (b EXCEPT c))´. <br></dd></dl></section><section class=Sh><h2 class=Sh id=SHELL_COMMANDS><a class=permalink href=#SHELL_COMMANDS>SHELL COMMANDS</a></h2> If the first-matched access control rule contains a shell command, that command is subjected to %&lt;letter&gt; substitutions (see next section). The result is executed by a <i>/bin/sh</i> child process with standard input, output and error connected to <i>/dev/null</i>. Specify an `&amp;´ at the end of the command if you do not want to wait until it has completed. <p class=Pp>Shell commands should not rely on the PATH setting of the inetd. Instead, they should use absolute path names, or they should begin with an explicit PATH=whatever statement.</p><p class=Pp>The <i>hosts_options</i>(5) document describes an alternative language that uses the shell command field in a different and incompatible way.</p></section><section class=Sh><h2 class=Sh id=__EXPANSIONS><a class=permalink href=#__EXPANSIONS>% EXPANSIONS</a></h2> The following expansions are available within shell commands: <dl class=Bl-tag><dt>%a (%A)</dt><dd>The client (server) host address.</dd><dt>%c</dt><dd>Client information: user@host, user@address, a host name, or just an address, depending on how much information is available.</dd><dt>%d</dt><dd>The daemon process name (argv[0] value).</dd><dt>%h (%H)</dt><dd>The client (server) host name or address, if the host name is unavailable.</dd><dt>%n (%N)</dt><dd>The client (server) host name (or "unknown" or "paranoid").</dd><dt>%p</dt><dd>The daemon process id.</dd><dt>%s</dt><dd>Server information: daemon@host, daemon@address, or just a daemon name, depending on how much information is available.</dd><dt>%u</dt><dd>The client user name (or "unknown").</dd><dt>%%</dt><dd>Expands to a single `%´ character.</dd></dl><p class=Pp>Characters in % expansions that may confuse the shell are replaced by underscores.</p></section><section class=Sh><h2 class=Sh id=SERVER_ENDPOINT_PATTERNS><a class=permalink href=#SERVER_ENDPOINT_PATTERNS>SERVER ENDPOINT PATTERNS</a></h2> In order to distinguish clients by the network address that they connect to, use patterns of the form: <p class=Pp>process_name@host_pattern : client_list ...</p><p class=Pp>Patterns like these can be used when the machine has different internet addresses with different internet hostnames. Service providers can use this facility to offer FTP, GOPHER or WWW archives with internet names that may even belong to different organizations. See also the `twist' option in the hosts_options(5) document. Some systems (Solaris, FreeBSD) can have more than one internet address on one physical interface; with other systems you may have to resort to SLIP or PPP pseudo interfaces that live in a dedicated network address space.</p><p class=Pp>The host_pattern obeys the same syntax rules as host names and addresses in client_list context. Usually, server endpoint information is available only with connection-oriented services.</p></section><section class=Sh><h2 class=Sh id=CLIENT_USERNAME_LOOKUP><a class=permalink href=#CLIENT_USERNAME_LOOKUP>CLIENT USERNAME LOOKUP</a></h2> When the client host supports the RFC 931 protocol or one of its descendants (TAP, IDENT, RFC 1413) the wrapper programs can retrieve additional information about the owner of a connection. Client username information, when available, is logged together with the client host name, and can be used to match patterns like: <p class=Pp>daemon_list : ... user_pattern@host_pattern ...</p><p class=Pp>The daemon wrappers can be configured at compile time to perform rule-driven username lookups (default) or to always interrogate the client host. In the case of rule-driven username lookups, the above rule would cause username lookup only when both the <i>daemon_list</i> and the <i>host_pattern</i> match.</p><p class=Pp>A user pattern has the same syntax as a daemon process pattern, so the same wildcards apply (netgroup membership is not supported). One should not get carried away with username lookups, though.</p><ul class=Bl-bullet><li>The client username information cannot be trusted when it is needed most, i.e. when the client system has been compromised. In general, ALL and (UN)KNOWN are the only user name patterns that make sense.</li><li>Username lookups are possible only with TCP-based services, and only when the client host runs a suitable daemon; in all other cases the result is "unknown".</li><li>A well-known UNIX kernel bug may cause loss of service when username lookups are blocked by a firewall. The wrapper README document describes a procedure to find out if your kernel has this bug.</li><li>Username lookups may cause noticeable delays for non-UNIX users. The default timeout for username lookups is 10 seconds: too short to cope with slow networks, but long enough to irritate PC users.</li></ul><p class=Pp>Selective username lookups can alleviate the last problem. For example, a rule like:</p><p class=Pp>daemon_list : @pcnetgroup ALL@ALL</p><p class=Pp>would match members of the pc netgroup without doing username lookups, but would perform username lookups with all other systems.</p></section><section class=Sh><h2 class=Sh id=DETECTING_ADDRESS_SPOOFING_ATTACKS><a class=permalink href=#DETECTING_ADDRESS_SPOOFING_ATTACKS>DETECTING ADDRESS SPOOFING ATTACKS</a></h2> A flaw in the sequence number generator of many TCP/IP implementations allows intruders to easily impersonate trusted hosts and to break in via, for example, the remote shell service. The IDENT (RFC931 etc.) service can be used to detect such and other host address spoofing attacks. <p class=Pp>Before accepting a client request, the wrappers can use the IDENT service to find out that the client did not send the request at all. When the client host provides IDENT service, a negative IDENT lookup result (the client matches `UNKNOWN@host') is strong evidence of a host spoofing attack.</p><p class=Pp>A positive IDENT lookup result (the client matches `KNOWN@host') is less trustworthy. It is possible for an intruder to spoof both the client connection and the IDENT lookup, although doing so is much harder than spoofing just a client connection. It may also be that the client´s IDENT server is lying.</p><p class=Pp>Note: IDENT lookups don´t work with UDP services.</p></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> The language is flexible enough that different types of access control policy can be expressed with a minimum of fuss. Although the language uses two access control tables, the most common policies can be implemented with one of the tables being trivial or even empty. <p class=Pp>When reading the examples below it is important to realize that the allow table is scanned before the deny table, that the search terminates when a match is found, and that access is granted when no match is found at all.</p><p class=Pp>The examples use host and domain names. They can be improved by including address and/or network/netmask information, to reduce the impact of temporary name server lookup failures.</p></section><section class=Sh><h2 class=Sh id=MOSTLY_CLOSED><a class=permalink href=#MOSTLY_CLOSED>MOSTLY CLOSED</a></h2> In this case, access is denied by default. Only explicitly authorized hosts are permitted access. <p class=Pp>The default policy (no access) is implemented with a trivial deny file:</p><p class=Pp>/etc/hosts.deny: <br> ALL: ALL</p><p class=Pp>This denies all service to all hosts, unless they are permitted access by entries in the allow file.</p><p class=Pp>The explicitly authorized hosts are listed in the allow file. For example:</p><p class=Pp>/etc/hosts.allow: <br> ALL: LOCAL @some_netgroup <br> ALL: .foobar.edu EXCEPT terminalserver.foobar.edu</p><p class=Pp>The first rule permits access from hosts in the local domain (no `.´ in the host name) and from members of the <i>some_netgroup</i> netgroup. The second rule permits access from all hosts in the <i>foobar.edu</i> domain (notice the leading dot), with the exception of <i>terminalserver.foobar.edu</i>.</p></section><section class=Sh><h2 class=Sh id=MOSTLY_OPEN><a class=permalink href=#MOSTLY_OPEN>MOSTLY OPEN</a></h2> Here, access is granted by default; only explicitly specified hosts are refused service. <p class=Pp>The default policy (access granted) makes the allow file redundant so that it can be omitted. The explicitly non-authorized hosts are listed in the deny file. For example:</p><p class=Pp>/etc/hosts.deny: <br> ALL: some.host.name, .some.domain <br> ALL EXCEPT in.fingerd: other.host.name, .other.domain</p><p class=Pp>The first rule denies some hosts and domains all services; the second rule still permits finger requests from other hosts and domains.</p></section><section class=Sh><h2 class=Sh id=BOOBY_TRAPS><a class=permalink href=#BOOBY_TRAPS>BOOBY TRAPS</a></h2> The next example permits tftp requests from hosts in the local domain (notice the leading dot). Requests from any other hosts are denied. Instead of the requested file, a finger probe is sent to the offending host. The result is mailed to the superuser. <p class=Pp>/etc/hosts.allow: <br></p><pre>
in.tftpd: LOCAL, .my.domain
</pre><pre>
/etc/hosts.deny:
<br>

<br>
in.tftpd: ALL: (/some/where/safe_finger -l @%h | \
	/usr/ucb/mail -s %d-%h root) &amp;
</pre><p class=Pp>The safe_finger command is intended for use in back-fingering and should be installed in a suitable place. It limits possible damage from data sent by the remote finger server. It gives better protection than the standard finger command.</p><p class=Pp>The expansion of the %h (client host) and %d (service name) sequences is described in the section on shell commands.</p><p class=Pp>Warning: do not booby-trap your finger daemon, unless you are prepared for infinite finger loops.</p><p class=Pp>On network firewall systems this trick can be carried even further. The typical network firewall only provides a limited set of services to the outer world. All other services can be "bugged" just like the above tftp example. The result is an excellent early-warning system. <br></p></section><section class=Sh><h2 class=Sh id=DIAGNOSTICS><a class=permalink href=#DIAGNOSTICS>DIAGNOSTICS</a></h2> An error is reported when a syntax error is found in a host access control rule; when the length of an access control rule exceeds the capacity of an internal buffer; when an access control rule is not terminated by a newline character; when the result of %&lt;letter&gt; expansion would overflow an internal buffer; when a system call fails that shouldn´t. All problems are reported via the syslog daemon. </section><section class=Sh><h2 class=Sh id=IMPLEMENTATION_NOTES><a class=permalink href=#IMPLEMENTATION_NOTES>IMPLEMENTATION NOTES</a></h2> Some operating systems are distributed with TCP Wrappers as part of the base system. It is common for such systems to build wrapping functionality into networking utilities. Notably, some systems offer an <i>inetd</i>(8) which does not require the use of the <i>tcpd</i>(8). Check your system's documentation for details. </section><section class=Sh><h2 class=Sh id=FILES><a class=permalink href=#FILES>FILES</a></h2><pre>
/etc/hosts.allow, (daemon,client) pairs that are granted access.
/etc/hosts.deny, (daemon,client) pairs that are denied access.
</pre></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><pre>
tcpd(8) tcp/ip daemon wrapper program.
tcpdchk(8), tcpdmatch(8), test programs.
</pre></section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> If a name server lookup times out, the host name will not be available to the access control software, even though the host is registered. <p class=Pp>Domain name server lookups are case insensitive; NIS (formerly YP) netgroup lookups are case sensitive.</p></section><section class=Sh><h2 class=Sh id=AUTHOR><a class=permalink href=#AUTHOR>AUTHOR</a></h2><pre>
Wietse Venema (wietse@wzv.win.tue.nl)
Department of Mathematics and Computing Science
Eindhoven University of Technology
Den Dolech 2, P.O. Box 513, 
5600 MB Eindhoven, The Netherlands
</pre></section></div><table class=foot><tr><td class=foot-date></td><td class=foot-os></td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>