<!DOCTYPE html>
<html><head><meta charset=utf-8><title>X509_VERIFY_PARAM_add1_host(3)</title><keywords content=man,X509_VERIFY_PARAM_add1_host></keywords><style>:root { --monitor-bleed: rgba(183, 0, 255, 0.46); --gradient: -webkit-linear-gradient(50deg, rgb(126, 119, 255), rgb(255, 34, 137)); --background-colour: #fff; --title-colour: #000; --text-colour: #000; --article-colour: #fff; --accent-colour: #4385f5; --muted-colour: #555; --shadow-colour: rgba(183, 0, 255, 0.487); --border-radius: 12px; --blur-radius: 0px; --navbar-colour: #fffc; --navbar-shadow: rgba(183, 0, 255, 0.1) 0 8px 32px; --code-background: #ddd; } .dark { visibility: hidden; } @media (prefers-color-scheme: light) { } @media (prefers-color-scheme: dark) { :root { --monitor-bleed: rgba(183, 0, 255, 0.172); --gradient: -webkit-linear-gradient(50deg, rgb(255, 79, 79), rgb(255, 52, 221)); --background-colour: #000; --title-colour: #fff; --text-colour: #ddd; --article-colour: #00000033; --accent-colour: #98beff; --muted-colour: #999; --shadow-colour: #ff00cc29; --blur-radius: 96px; --navbar-colour: #000a; --navbar-shadow: rgba(183, 0, 255, 0.05) 0 8px 32px; --code-background: #111; } .dark { visibility: visible; } .light { visibility: hidden; } } html, body { overflow-x: hidden; } body { background-image: url(bg.svg); background-size: cover; margin: 0; background-color: var(--background-colour); color: var(--text-colour); font-size: 22px; font-display: optional; font-family: "Montserrat", sans-serif; overflow-y: hidden; } h1 { color: var(--title-colour); font-size: 70px; font-display: optional; font-family: "Montserrat", sans-serif; } h2 { color: var(--title-colour); font-size: 40px; font-display: optional; font-family: "Montserrat", sans-serif; } h3 { color: var(--title-colour); font-size: 24px; font-display: optional; font-family: "Roboto Slab", serif; } q, blockquote { font-style: italic; white-space: pre-wrap; padding-left: 42px; } pre { margin: 32px; white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word; } strong { background: var(--gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent; font-weight: bold; } code { border-radius: 8px; background-color: var(--code-background); } pre { white-space: pre-wrap; } .info-container { max-width: 400px; margin: 32px; } .info-container p { margin-inline: 16px; margin-block: 32px; text-align: justify; font-size: 18px; } .labeled-img { max-width: 100%; position: relative; } .labeled-img div { position: absolute; bottom: 0; width: 100%; height: 70%; background: linear-gradient(to bottom, transparent, black); border-radius: var(--border-radius); } .labeled-img div h2 { color: white; position: absolute; bottom: 0; left: 32px; } .labeled-img img { width: 100%; border-radius: var(--border-radius); } a { background: var(--gradient); background-clip: none; color: var(--background-colour); font-weight: bold; text-decoration: none; border-radius: 3px; } a:hover { background: var(--text-colour); } .link, .link:hover { background: none; } button { background: var(--gradient); color: var(--background-colour); box-shadow: none; border: none; border-radius: 48px; padding: 8px; padding-left: 32px; padding-right: 32px; margin: 24px; font-size: 24px; font-display: optional; font-family: "Montserrat", sans-serif; font-weight: bold; cursor: pointer; transition: background .2s, color .2s, opacity .2s, box-shadow .2s, transform .2s; } button:hover { box-shadow: var(--shadow-colour) 0 8px 32px; transform: translateY(-4px); } button:active { transform: none; opacity: 50%; } .clickable { padding: 2px; transition: background-color 0.05s ease-out; border-radius: var(--border-radius); } .clickable:hover { background-color: var(--shadow-colour); } .docs-container { margin: auto; margin-top: 64px; max-width: 1200px; display: grid; justify-content: center; grid-template-columns: 1fr 3fr; } .docs { max-width: 900px; } .sidebar { min-width: 250px; position: fixed; padding: 16px; display: grid; justify-content: center; grid-auto-flow: row; grid-gap: 32px; padding-top: 64px; } .sidebar * { margin: auto; display: grid; justify-content: left; grid-auto-flow: column; grid-gap: 8px; } .sidebar p { font-size: 18px; } .sidebar-item { color: var(--text-colour); background: none; padding-inline: 8px; width: 100%; height: 100%; } .sidebar-item div svg { fill: var(--text-colour); } .navbar-container { width: 100vw; height: 48px; } .navbar { position: fixed; z-index: 100; width: 100vw; background-color: var(--navbar-colour); backdrop-filter: blur(20px); display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 32px; padding: 12px; } .navbar * { margin: auto; display: grid; justify-content: center; grid-auto-flow: column; grid-gap: 8px; } .navbar p { font-size: 18px; } .navbar-logo { height: 100%; max-height: 32px; stroke: var(--text-colour); } .navbar-icon { fill: var(--text-colour); } .navbar-item { color: var(--text-colour); background-color: transparent; padding-inline: 8px; width: 100%; height: 100%; border-radius: 8px; } @media only screen and (max-width: 800px) { .navbar-item { position: absolute; visibility: hidden; } } footer { text-align: center; padding: 64px; border-radius: 64px 64px 0 0; background: -webkit-linear-gradient(50deg, transparent, var(--monitor-bleed)); } footer p { margin: auto; } .permalink { color: var(--text-colour); background: none; } .permalink:hover { background: none; } </style></head><body><html><body><div class=navbar-container><div class=navbar><a class="navbar-item clickable link" href=https://inobulles.github.io><div><svg class=navbar-logo fill=none height=24px viewbox="0 0 144 144" width=24px xmlns=http://www.w3.org/2000/svg><path d=m22,115l50,-88l50,88l-100,0z stroke-width=20 transform="rotate(180 72 72)"></path></svg><p><strong>aquaBSD</strong></p></div></a><a class="navbar-item clickable link" href=https://inobulles.github.io/docs><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"></path></svg><p>Develop</p></div></a><a class="navbar-item clickable link" href=mailto:inobulles@gmail.com><div><svg class=navbar-icon fill=none height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M6.54 5c.06.89.21 1.76.45 2.59l-1.2 1.2c-.41-1.2-.67-2.47-.76-3.79h1.51m9.86 12.02c.85.24 1.72.39 2.6.45v1.49c-1.32-.09-2.59-.35-3.8-.75l1.2-1.19M7.5 3H4c-.55 0-1 .45-1 1 0 9.39 7.61 17 17 17 .55 0 1-.45 1-1v-3.49c0-.55-.45-1-1-1-1.24 0-2.45-.2-3.57-.57-.1-.04-.21-.05-.31-.05-.26 0-.51.1-.71.29l-2.2 2.2c-2.83-1.45-5.15-3.76-6.59-6.59l2.2-2.2c.28-.28.36-.67.25-1.02C8.7 6.45 8.5 5.25 8.5 4c0-.55-.45-1-1-1z"></path></svg><p>Contact</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><path d="M12,2C6.48,2,2,6.48,2,12c0,5.52,4.48,10,10,10s10-4.48,10-10C22,6.48,17.52,2,12,2z M19.46,9.12l-2.78,1.15 c-0.51-1.36-1.58-2.44-2.95-2.94l1.15-2.78C16.98,5.35,18.65,7.02,19.46,9.12z M12,15c-1.66,0-3-1.34-3-3s1.34-3,3-3s3,1.34,3,3 S13.66,15,12,15z M9.13,4.54l1.17,2.78c-1.38,0.5-2.47,1.59-2.98,2.97L4.54,9.13C5.35,7.02,7.02,5.35,9.13,4.54z M4.54,14.87 l2.78-1.15c0.51,1.38,1.59,2.46,2.97,2.96l-1.17,2.78C7.02,18.65,5.35,16.98,4.54,14.87z M14.88,19.46l-1.15-2.78 c1.37-0.51,2.45-1.59,2.95-2.97l2.78,1.17C18.65,16.98,16.98,18.65,14.88,19.46z"></path></g></svg><p>Support</p></div></a><a class="navbar-item clickable link" href=#><div><svg class=navbar-icon fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 12 7.4l3.38 4.6L17 10.83 14.92 8H20v6z"></path></svg><p>Log in</p></div></a></div></div></body></html><div class=docs-container><html><body><div class=sidebar-container><div class=sidebar><a class="sidebar-item clickable" href=https://inobulles.github.io/docs><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M12.36 6l.4 2H18v6h-3.36l-.4-2H7V6h5.36M14 4H5v17h2v-7h5.6l.4 2h7V6h-5.6L14 4z"></path></svg><p>Introduction</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/struct><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><rect fill=none height=24 width=24></rect><path d="M22,11V3h-7v3H9V3H2v8h7V8h2v10h4v3h7v-8h-7v3h-2V8h2v3H22z M7,9H4V5h3V9z M17,15h3v4h-3V15z M17,5h3v4h-3V5z"></path></svg><p>OS Components</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/dev-tools><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><rect height=8.48 transform="matrix(0.7071 -0.7071 0.7071 0.7071 -6.8717 17.6255)" width=3 x=16.34 y=12.87></rect><path d="M17.5,10c1.93,0,3.5-1.57,3.5-3.5c0-0.58-0.16-1.12-0.41-1.6l-2.7,2.7L16.4,6.11l2.7-2.7C18.62,3.16,18.08,3,17.5,3 C15.57,3,14,4.57,14,6.5c0,0.41,0.08,0.8,0.21,1.16l-1.85,1.85l-1.78-1.78l0.71-0.71L9.88,5.61L12,3.49 c-1.17-1.17-3.07-1.17-4.24,0L4.22,7.03l1.41,1.41H2.81L2.1,9.15l3.54,3.54l0.71-0.71V9.15l1.41,1.41l0.71-0.71l1.78,1.78 l-7.41,7.41l2.12,2.12L16.34,9.79C16.7,9.92,17.09,10,17.5,10z"></path></g></g></svg><p>Developer Tools</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/create-app><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24 x=0></rect></g><g><g><polygon points="19,9 20.25,6.25 23,5 20.25,3.75 19,1 17.75,3.75 15,5 17.75,6.25"></polygon><polygon points="19,15 17.75,17.75 15,19 17.75,20.25 19,23 20.25,20.25 23,19 20.25,17.75"></polygon><path d="M11.5,9.5L9,4L6.5,9.5L1,12l5.5,2.5L9,20l2.5-5.5L17,12L11.5,9.5z M9.99,12.99L9,15.17l-0.99-2.18L5.83,12l2.18-0.99 L9,8.83l0.99,2.18L12.17,12L9.99,12.99z"></path></g></g></svg><p>Creating an App</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/packaging><div><svg enable-background="new 0 0 24 24" fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><g><rect fill=none height=24 width=24></rect></g><g><g><path d="M20,2H4C3,2,2,2.9,2,4v3.01C2,7.73,2.43,8.35,3,8.7V20c0,1.1,1.1,2,2,2h14c0.9,0,2-0.9,2-2V8.7c0.57-0.35,1-0.97,1-1.69V4 C22,2.9,21,2,20,2z M19,20H5V9h14V20z M20,7H4V4h16V7z"></path><rect height=2 width=6 x=9 y=12></rect></g></g></svg><p>Packaging Apps</p></div></a><a class="sidebar-item clickable" href=https://inobulles.github.io/docs/publishing><div><svg fill=#000000 height=24px viewbox="0 0 24 24" width=24px xmlns=http://www.w3.org/2000/svg><path d="M0 0h24v24H0V0z" fill=none></path><path d="M13 3v1h-2V3h2m-1 7.11l5.38 1.77 2.39.78-1.12 3.97c-.54-.3-.94-.71-1.14-.94L16 13.96l-1.51 1.72c-.34.4-1.28 1.32-2.49 1.32s-2.15-.92-2.49-1.32L8 13.96l-1.51 1.72c-.2.23-.6.63-1.14.93l-1.13-3.96 2.4-.79L12 10.11M15 1H9v3H6c-1.1 0-2 .9-2 2v4.62l-1.29.42c-.26.08-.48.26-.6.5s-.15.52-.06.78L3.95 19H4c1.6 0 3.02-.88 4-2 .98 1.12 2.4 2 4 2s3.02-.88 4-2c.98 1.12 2.4 2 4 2h.05l1.89-6.68c.08-.26.06-.54-.06-.78s-.34-.42-.6-.5L20 10.62V6c0-1.1-.9-2-2-2h-3V1zM6 9.97V6h12v3.97L12 8 6 9.97zm10 9.71c-1.22.85-2.61 1.28-4 1.28s-2.78-.43-4-1.28C6.78 20.53 5.39 21 4 21H2v2h2c1.38 0 2.74-.35 4-.99 1.26.64 2.63.97 4 .97s2.74-.32 4-.97c1.26.65 2.62.99 4 .99h2v-2h-2c-1.39 0-2.78-.47-4-1.32z"></path></svg><p>Publishing Apps</p></div></a></div></div></body></html><div class=docs><h1>X509_VERIFY_PARAM_add1_host(3)</h1><table class=head><tr><td class=head-ltitle>X509_VERIFY_PARAM_SET_FLAGS(3)</td><td class=head-vol>OpenSSL</td><td class=head-rtitle>X509_VERIFY_PARAM_SET_FLAGS(3)</td></tr></table><div class=manual-text><br><section class=Sh><h2 class=Sh id=NAME><a class=permalink href=#NAME>NAME</a></h2> X509_VERIFY_PARAM_set_flags, X509_VERIFY_PARAM_clear_flags, X509_VERIFY_PARAM_get_flags, X509_VERIFY_PARAM_set_purpose, X509_VERIFY_PARAM_get_inh_flags, X509_VERIFY_PARAM_set_inh_flags, X509_VERIFY_PARAM_set_trust, X509_VERIFY_PARAM_set_depth, X509_VERIFY_PARAM_get_depth, X509_VERIFY_PARAM_set_auth_level, X509_VERIFY_PARAM_get_auth_level, X509_VERIFY_PARAM_set_time, X509_VERIFY_PARAM_get_time, X509_VERIFY_PARAM_add0_policy, X509_VERIFY_PARAM_set1_policies, X509_VERIFY_PARAM_set1_host, X509_VERIFY_PARAM_add1_host, X509_VERIFY_PARAM_set_hostflags, X509_VERIFY_PARAM_get_hostflags, X509_VERIFY_PARAM_get0_peername, X509_VERIFY_PARAM_set1_email, X509_VERIFY_PARAM_set1_ip, X509_VERIFY_PARAM_set1_ip_asc - X509 verification parameters </section><section class=Sh><h2 class=Sh id=SYNOPSIS><a class=permalink href=#SYNOPSIS>SYNOPSIS</a></h2><pre>
 #include &lt;openssl/x509_vfy.h&gt;

 int X509_VERIFY_PARAM_set_flags(X509_VERIFY_PARAM *param,
                                 unsigned long flags);
 int X509_VERIFY_PARAM_clear_flags(X509_VERIFY_PARAM *param,
                                   unsigned long flags);
 unsigned long X509_VERIFY_PARAM_get_flags(X509_VERIFY_PARAM *param);

 int X509_VERIFY_PARAM_set_inh_flags(X509_VERIFY_PARAM *param,
                                     uint32_t flags);
 uint32_t X509_VERIFY_PARAM_get_inh_flags(const X509_VERIFY_PARAM *param);

 int X509_VERIFY_PARAM_set_purpose(X509_VERIFY_PARAM *param, int purpose);
 int X509_VERIFY_PARAM_set_trust(X509_VERIFY_PARAM *param, int trust);

 void X509_VERIFY_PARAM_set_time(X509_VERIFY_PARAM *param, time_t t);
 time_t X509_VERIFY_PARAM_get_time(const X509_VERIFY_PARAM *param);

 int X509_VERIFY_PARAM_add0_policy(X509_VERIFY_PARAM *param,
                                   ASN1_OBJECT *policy);
 int X509_VERIFY_PARAM_set1_policies(X509_VERIFY_PARAM *param,
                                     STACK_OF(ASN1_OBJECT) *policies);

 void X509_VERIFY_PARAM_set_depth(X509_VERIFY_PARAM *param, int depth);
 int X509_VERIFY_PARAM_get_depth(const X509_VERIFY_PARAM *param);

 void X509_VERIFY_PARAM_set_auth_level(X509_VERIFY_PARAM *param,
                                       int auth_level);
 int X509_VERIFY_PARAM_get_auth_level(const X509_VERIFY_PARAM *param);

 int X509_VERIFY_PARAM_set1_host(X509_VERIFY_PARAM *param,
                                 const char *name, size_t namelen);
 int X509_VERIFY_PARAM_add1_host(X509_VERIFY_PARAM *param,
                                 const char *name, size_t namelen);
 void X509_VERIFY_PARAM_set_hostflags(X509_VERIFY_PARAM *param,
                                      unsigned int flags);
 unsigned int X509_VERIFY_PARAM_get_hostflags(const X509_VERIFY_PARAM *param);
 char *X509_VERIFY_PARAM_get0_peername(X509_VERIFY_PARAM *param);
 int X509_VERIFY_PARAM_set1_email(X509_VERIFY_PARAM *param,
                                  const char *email, size_t emaillen);
 int X509_VERIFY_PARAM_set1_ip(X509_VERIFY_PARAM *param,
                               const unsigned char *ip, size_t iplen);
 int X509_VERIFY_PARAM_set1_ip_asc(X509_VERIFY_PARAM *param, const char *ipasc);
</pre></section><section class=Sh><h2 class=Sh id=DESCRIPTION><a class=permalink href=#DESCRIPTION>DESCRIPTION</a></h2> These functions manipulate the <b>X509_VERIFY_PARAM</b> structure associated with a certificate verification operation. <p class=Pp>The <b>X509_VERIFY_PARAM_set_flags()</b> function sets the flags in <b>param</b> by oring it with <b>flags</b>. See the <b>VERIFICATION FLAGS</b> section for a complete description of values the <b>flags</b> parameter can take.</p><p class=Pp><b>X509_VERIFY_PARAM_get_flags()</b> returns the flags in <b>param</b>.</p><p class=Pp><b>X509_VERIFY_PARAM_get_inh_flags()</b> returns the inheritance flags in <b>param</b> which specifies how verification flags are copied from one structure to another. <b>X509_VERIFY_PARAM_set_inh_flags()</b> sets the inheritance flags. See the <b>INHERITANCE FLAGS</b> section for a description of these bits.</p><p class=Pp><b>X509_VERIFY_PARAM_clear_flags()</b> clears the flags <b>flags</b> in <b>param</b>.</p><p class=Pp><b>X509_VERIFY_PARAM_set_purpose()</b> sets the verification purpose in <b>param</b> to <b>purpose</b>. This determines the acceptable purpose of the certificate chain, for example SSL client or SSL server.</p><p class=Pp><b>X509_VERIFY_PARAM_set_trust()</b> sets the trust setting in <b>param</b> to <b>trust</b>.</p><p class=Pp><b>X509_VERIFY_PARAM_set_time()</b> sets the verification time in <b>param</b> to <b>t</b>. Normally the current time is used.</p><p class=Pp><b>X509_VERIFY_PARAM_add0_policy()</b> enables policy checking (it is disabled by default) and adds <b>policy</b> to the acceptable policy set.</p><p class=Pp><b>X509_VERIFY_PARAM_set1_policies()</b> enables policy checking (it is disabled by default) and sets the acceptable policy set to <b>policies</b>. Any existing policy set is cleared. The <b>policies</b> parameter can be <b>NULL</b> to clear an existing policy set.</p><p class=Pp><b>X509_VERIFY_PARAM_set_depth()</b> sets the maximum verification depth to <b>depth</b>. That is the maximum number of intermediate CA certificates that can appear in a chain. A maximal depth chain contains 2 more certificates than the limit, since neither the end-entity certificate nor the trust-anchor count against this limit. Thus a <b>depth</b> limit of 0 only allows the end-entity certificate to be signed directly by the trust-anchor, while with a <b>depth</b> limit of 1 there can be one intermediate CA certificate between the trust-anchor and the end-entity certificate.</p><p class=Pp><b>X509_VERIFY_PARAM_set_auth_level()</b> sets the authentication security level to <b>auth_level</b>. The authentication security level determines the acceptable signature and public key strength when verifying certificate chains. For a certificate chain to validate, the public keys of all the certificates must meet the specified security level. The signature algorithm security level is not enforced for the chain's <i>trust</i><i>anchor</i> certificate, which is either directly trusted or validated by means other than its signature. See <b>SSL_CTX_set_security_level</b>(3) for the definitions of the available levels. The default security level is -1, or "not set". At security level 0 or lower all algorithms are acceptable. Security level 1 requires at least 80-bit-equivalent security and is broadly interoperable, though it will, for example, reject MD5 signatures or RSA keys shorter than 1024 bits.</p><p class=Pp><b>X509_VERIFY_PARAM_set1_host()</b> sets the expected DNS hostname to <b>name</b> clearing any previously specified hostname or names. If <b>name</b> is NULL, or empty the list of hostnames is cleared, and name checks are not performed on the peer certificate. If <b>name</b> is NUL-terminated, <b>namelen</b> may be zero, otherwise <b>namelen</b> must be set to the length of <b>name</b>.</p><p class=Pp>When a hostname is specified, certificate verification automatically invokes <b>X509_check_host</b>(3) with flags equal to the <b>flags</b> argument given to <b>X509_VERIFY_PARAM_set_hostflags()</b> (default zero). Applications are strongly advised to use this interface in preference to explicitly calling <b>X509_check_host</b>(3), hostname checks may be out of scope with the <b>DANE-EE</b>(3) certificate usage, and the internal check will be suppressed as appropriate when DANE verification is enabled.</p><p class=Pp>When the subject CommonName will not be ignored, whether as a result of the <b>X509_CHECK_FLAG_ALWAYS_CHECK_SUBJECT</b> host flag, or because no DNS subject alternative names are present in the certificate, any DNS name constraints in issuer certificates apply to the subject CommonName as well as the subject alternative name extension.</p><p class=Pp>When the subject CommonName will be ignored, whether as a result of the <b>X509_CHECK_FLAG_NEVER_CHECK_SUBJECT</b> host flag, or because some DNS subject alternative names are present in the certificate, DNS name constraints in issuer certificates will not be applied to the subject DN. As described in <b>X509_check_host</b>(3) the <b>X509_CHECK_FLAG_NEVER_CHECK_SUBJECT</b> flag takes precedence over the <b>X509_CHECK_FLAG_ALWAYS_CHECK_SUBJECT</b> flag.</p><p class=Pp><b>X509_VERIFY_PARAM_get_hostflags()</b> returns any host flags previously set via a call to <b>X509_VERIFY_PARAM_set_hostflags()</b>.</p><p class=Pp><b>X509_VERIFY_PARAM_add1_host()</b> adds <b>name</b> as an additional reference identifier that can match the peer's certificate. Any previous names set via <b>X509_VERIFY_PARAM_set1_host()</b> or <b>X509_VERIFY_PARAM_add1_host()</b> are retained, no change is made if <b>name</b> is NULL or empty. When multiple names are configured, the peer is considered verified when any name matches.</p><p class=Pp><b>X509_VERIFY_PARAM_get0_peername()</b> returns the DNS hostname or subject CommonName from the peer certificate that matched one of the reference identifiers. When wildcard matching is not disabled, or when a reference identifier specifies a parent domain (starts with ".") rather than a hostname, the peer name may be a wildcard name or a sub-domain of the reference identifier respectively. The return string is allocated by the library and is no longer valid once the associated <b>param</b> argument is freed. Applications must not free the return value.</p><p class=Pp><b>X509_VERIFY_PARAM_set1_email()</b> sets the expected RFC822 email address to <b>email</b>. If <b>email</b> is NUL-terminated, <b>emaillen</b> may be zero, otherwise <b>emaillen</b> must be set to the length of <b>email</b>. When an email address is specified, certificate verification automatically invokes <b>X509_check_email</b>(3).</p><p class=Pp><b>X509_VERIFY_PARAM_set1_ip()</b> sets the expected IP address to <b>ip</b>. The <b>ip</b> argument is in binary format, in network byte-order and <b>iplen</b> must be set to 4 for IPv4 and 16 for IPv6. When an IP address is specified, certificate verification automatically invokes <b>X509_check_ip</b>(3).</p><p class=Pp><b>X509_VERIFY_PARAM_set1_ip_asc()</b> sets the expected IP address to <b>ipasc</b>. The <b>ipasc</b> argument is a NUL-terminal ASCII string: dotted decimal quad for IPv4 and colon-separated hexadecimal for IPv6. The condensed "::" notation is supported for IPv6 addresses.</p></section><section class=Sh><h2 class=Sh id=RETURN_VALUES><a class=permalink href=#RETURN_VALUES>RETURN VALUES</a></h2><b>X509_VERIFY_PARAM_set_flags()</b>, <b>X509_VERIFY_PARAM_clear_flags()</b>, <b>X509_VERIFY_PARAM_set_inh_flags()</b>, <b>X509_VERIFY_PARAM_set_purpose()</b>, <b>X509_VERIFY_PARAM_set_trust()</b>, <b>X509_VERIFY_PARAM_add0_policy()</b><b>X509_VERIFY_PARAM_set1_policies()</b>, <b>X509_VERIFY_PARAM_set1_host()</b>, <b>X509_VERIFY_PARAM_add1_host()</b>, <b>X509_VERIFY_PARAM_set1_email()</b>, <b>X509_VERIFY_PARAM_set1_ip()</b> and <b>X509_VERIFY_PARAM_set1_ip_asc()</b> return 1 for success and 0 for failure. <p class=Pp><b>X509_VERIFY_PARAM_get_flags()</b> returns the current verification flags.</p><p class=Pp><b>X509_VERIFY_PARAM_get_hostflags()</b> returns any current host flags.</p><p class=Pp><b>X509_VERIFY_PARAM_get_inh_flags()</b> returns the current inheritance flags.</p><p class=Pp><b>X509_VERIFY_PARAM_set_time()</b> and <b>X509_VERIFY_PARAM_set_depth()</b> do not return values.</p><p class=Pp><b>X509_VERIFY_PARAM_get_depth()</b> returns the current verification depth.</p><p class=Pp><b>X509_VERIFY_PARAM_get_auth_level()</b> returns the current authentication security level.</p></section><section class=Sh><h2 class=Sh id=VERIFICATION_FLAGS><a class=permalink href=#VERIFICATION_FLAGS>VERIFICATION FLAGS</a></h2> The verification flags consists of zero or more of the following flags ored together. <p class=Pp><b>X509_V_FLAG_CRL_CHECK</b> enables CRL checking for the certificate chain leaf certificate. An error occurs if a suitable CRL cannot be found.</p><p class=Pp><b>X509_V_FLAG_CRL_CHECK_ALL</b> enables CRL checking for the entire certificate chain.</p><p class=Pp><b>X509_V_FLAG_IGNORE_CRITICAL</b> disabled critical extension checking. By default any unhandled critical extensions in certificates or (if checked) CRLs results in a fatal error. If this flag is set unhandled critical extensions are ignored. <b>WARNING</b> setting this option for anything other than debugging purposes can be a security risk. Finer control over which extensions are supported can be performed in the verification callback.</p><p class=Pp>The <b>X509_V_FLAG_X509_STRICT</b> flag disables workarounds for some broken certificates and makes the verification strictly apply <b>X509</b> rules.</p><p class=Pp><b>X509_V_FLAG_ALLOW_PROXY_CERTS</b> enables proxy certificate verification.</p><p class=Pp><b>X509_V_FLAG_POLICY_CHECK</b> enables certificate policy checking, by default no policy checking is performed. Additional information is sent to the verification callback relating to policy checking.</p><p class=Pp><b>X509_V_FLAG_EXPLICIT_POLICY</b>, <b>X509_V_FLAG_INHIBIT_ANY</b> and <b>X509_V_FLAG_INHIBIT_MAP</b> set the <b>require explicit policy</b>, <b>inhibit any</b><b>policy</b> and <b>inhibit policy mapping</b> flags respectively as defined in <b>RFC3280</b>. Policy checking is automatically enabled if any of these flags are set.</p><p class=Pp>If <b>X509_V_FLAG_NOTIFY_POLICY</b> is set and the policy checking is successful a special status code is set to the verification callback. This permits it to examine the valid policy tree and perform additional checks or simply log it for debugging purposes.</p><p class=Pp>By default some additional features such as indirect CRLs and CRLs signed by different keys are disabled. If <b>X509_V_FLAG_EXTENDED_CRL_SUPPORT</b> is set they are enabled.</p><p class=Pp>If <b>X509_V_FLAG_USE_DELTAS</b> is set delta CRLs (if present) are used to determine certificate status. If not set deltas are ignored.</p><p class=Pp><b>X509_V_FLAG_CHECK_SS_SIGNATURE</b> requests checking the signature of the last certificate in a chain if the certificate is supposedly self-signed. This is prohibited and will result in an error if it is a non-conforming CA certificate with key usage restrictions not including the keyCertSign bit. By default this check is disabled because it doesn't add any additional security but in some cases applications might want to check the signature anyway. A side effect of not checking the self-signature of such a certificate is that disabled or unsupported message digests used for the signature are not treated as fatal errors.</p><p class=Pp>When <b>X509_V_FLAG_TRUSTED_FIRST</b> is set, construction of the certificate chain in <b>X509_verify_cert</b>(3) will search the trust store for issuer certificates before searching the provided untrusted certificates. Local issuer certificates are often more likely to satisfy local security requirements and lead to a locally trusted root. This is especially important when some certificates in the trust store have explicit trust settings (see "TRUST SETTINGS" in <b>x509</b>(1)). As of OpenSSL 1.1.0 this option is on by default.</p><p class=Pp>The <b>X509_V_FLAG_NO_ALT_CHAINS</b> flag suppresses checking for alternative chains. By default, unless <b>X509_V_FLAG_TRUSTED_FIRST</b> is set, when building a certificate chain, if the first certificate chain found is not trusted, then OpenSSL will attempt to replace untrusted certificates supplied by the peer with certificates from the trust store to see if an alternative chain can be found that is trusted. As of OpenSSL 1.1.0, with <b>X509_V_FLAG_TRUSTED_FIRST</b> always set, this option has no effect.</p><p class=Pp>The <b>X509_V_FLAG_PARTIAL_CHAIN</b> flag causes intermediate certificates in the trust store to be treated as trust-anchors, in the same way as the self-signed root CA certificates. This makes it possible to trust certificates issued by an intermediate CA without having to trust its ancestor root CA. With OpenSSL 1.1.0 and later and &lt;X509_V_FLAG_PARTIAL_CHAIN&gt; set, chain construction stops as soon as the first certificate from the trust store is added to the chain, whether that certificate is a self-signed "root" certificate or a not self-signed intermediate certificate. Thus, when an intermediate certificate is found in the trust store, the verified chain passed to callbacks may be shorter than it otherwise would be without the <b>X509_V_FLAG_PARTIAL_CHAIN</b> flag.</p><p class=Pp>The <b>X509_V_FLAG_NO_CHECK_TIME</b> flag suppresses checking the validity period of certificates and CRLs against the current time. If <b>X509_VERIFY_PARAM_set_time()</b> is used to specify a verification time, the check is not suppressed.</p></section><section class=Sh><h2 class=Sh id=INHERITANCE_FLAGS><a class=permalink href=#INHERITANCE_FLAGS>INHERITANCE FLAGS</a></h2> These flags specify how parameters are "inherited" from one structure to another. <p class=Pp>If <b>X509_VP_FLAG_ONCE</b> is set then the current setting is zeroed after the next call.</p><p class=Pp>If <b>X509_VP_FLAG_LOCKED</b> is set then no values are copied. This overrides all of the following flags.</p><p class=Pp>If <b>X509_VP_FLAG_DEFAULT</b> is set then anything set in the source is copied to the destination. Effectively the values in "to" become default values which will be used only if nothing new is set in "from". This is the default.</p><p class=Pp>If <b>X509_VP_FLAG_OVERWRITE</b> is set then all value are copied across whether they are set or not. Flags is still Ored though.</p><p class=Pp>If <b>X509_VP_FLAG_RESET_FLAGS</b> is set then the flags value is copied instead of ORed.</p></section><section class=Sh><h2 class=Sh id=NOTES><a class=permalink href=#NOTES>NOTES</a></h2> The above functions should be used to manipulate verification parameters instead of functions which work in specific structures such as <b>X509_STORE_CTX_set_flags()</b> which are likely to be deprecated in a future release. </section><section class=Sh><h2 class=Sh id=BUGS><a class=permalink href=#BUGS>BUGS</a></h2> Delta CRL checking is currently primitive. Only a single delta can be used and (partly due to limitations of <b>X509_STORE</b>) constructed CRLs are not maintained. <p class=Pp>If CRLs checking is enable CRLs are expected to be available in the corresponding <b>X509_STORE</b> structure. No attempt is made to download CRLs from the CRL distribution points extension.</p></section><section class=Sh><h2 class=Sh id=EXAMPLES><a class=permalink href=#EXAMPLES>EXAMPLES</a></h2> Enable CRL checking when performing certificate verification during SSL connections associated with an <b>SSL_CTX</b> structure <b>ctx</b>: <p class=Pp></p><pre>
 X509_VERIFY_PARAM *param;

 param = X509_VERIFY_PARAM_new();
 X509_VERIFY_PARAM_set_flags(param, X509_V_FLAG_CRL_CHECK);
 SSL_CTX_set1_param(ctx, param);
 X509_VERIFY_PARAM_free(param);
</pre></section><section class=Sh><h2 class=Sh id=SEE_ALSO><a class=permalink href=#SEE_ALSO>SEE ALSO</a></h2><b>X509_verify_cert</b>(3), <b>X509_check_host</b>(3), <b>X509_check_email</b>(3), <b>X509_check_ip</b>(3), <b>x509</b>(1) </section><section class=Sh><h2 class=Sh id=HISTORY><a class=permalink href=#HISTORY>HISTORY</a></h2> The <b>X509_V_FLAG_NO_ALT_CHAINS</b> flag was added in OpenSSL 1.1.0. The flag <b>X509_V_FLAG_CB_ISSUER_CHECK</b> was deprecated in OpenSSL 1.1.0 and has no effect. <p class=Pp>The <b>X509_VERIFY_PARAM_get_hostflags()</b> function was added in OpenSSL 1.1.0i.</p></section><section class=Sh><h2 class=Sh id=COPYRIGHT><a class=permalink href=#COPYRIGHT>COPYRIGHT</a></h2> Copyright 2009-2020 The OpenSSL Project Authors. All Rights Reserved. <p class=Pp>Licensed under the OpenSSL license (the "License"). You may not use this file except in compliance with the License. You can obtain a copy in the file LICENSE in the source distribution or at &lt;https://www.openssl.org/source/license.html&gt;.</p></section></div><table class=foot><tr><td class=foot-date>2020-09-22</td><td class=foot-os>1.1.1h</td></tr></table></div></div><html><body><footer><p>©️ 2023 Inobulles</p></footer></body></html></body></html>